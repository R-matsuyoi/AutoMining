
                   ###################################################################### 转换、检查、纠正基础数据字典（Info.field_base） 

20220322-16:39:52  field_base: 84行
20220322-16:39:52  删除5个available“不可用”字段：['gprs_flow_tnet', 'days_outside', 'aaa', 'bbb', 'ccc']
20220322-16:39:52  field_base: 79行

20220322-16:39:52  删除1个基于“不可用”字段加工的手动衍生_py字段：
                           field_name                    formula
                   56  days_outside_p  days_outside / days_month
20220322-16:39:52  field_base: 78行


C:\Users\higher\Desktop\to伟鹏的代码_v2\ModelProject\selfmodule\binarymodule\modelinfo.py:77: UserWarning: 确定下列时长类字段的renmark是否限制 ‘不参与近n月自动衍生’：
                     field_name                   comment remark
12  monthsaready_last_stop_date  最后停机时间：已发生时长    NaN
13  monthsremain_last_stop_date    最后停机时间：剩余时长    NaN
  warnings.warn(s)

                   ###################################################################### 加工训练账期近n月基础数据
                    
20220322-16:39:55  开始时间：2022-03-22 16:39:55
20220322-16:39:55  month: 202011
20220322-16:39:55  参数设置：
                       step: train
                       Info.model_name: 模型示例
                       Info.n_recent: 3
                       drop_midtable: True
                       cover_table_all: True
                       Info.Pcase_limit: 10000
                       Info.traintable_ratio: 2
                       Info.Pcumsum_limit: 2
                       Info.timein_count: 500

                   ------------------------------------- 检查各前置表 --------------------------------------------------- 
20220322-16:39:55  检查 ml.ml_feature_info_yw_user_m
20220322-16:39:56      72 列
20220322-16:39:56      202011账期： 10000行
20220322-16:39:56      202010账期： 15000行
20220322-16:39:56      202009账期： 18000行


20220322-16:39:56  检查 ml.ml_feature_add_yw_user_m
20220322-16:39:56      4 列
20220322-16:39:56      202011账期： 10000行
20220322-16:39:56      202010账期： 15000行
20220322-16:39:56      202009账期： 18000行


20220322-16:39:56  未设置Info.table_day



20220322-16:39:56  检查 ml.ml_target_info_yw_user_m
20220322-16:39:57      7 列
20220322-16:39:57      202011账期： 10000行

20220322-16:39:57      获取目标字段flag_eg类型：integer



                   -------------------- 汇总当期特征与目标：ml.dm_zc_moxing_info_target_202011 -------------------------- 
20220322-16:39:57  查询表： 
                       select concat(table_schema, '.', table_name) full_name
                       from information_schema.tables 
                       where table_schema = 'ml' and table_name='dm_zc_moxing_info_target_202011'
                       存在1个表 
20220322-16:39:57  ml.dm_zc_moxing_info_target_202011已存在，将重建覆盖
20220322-16:39:57  建表语句： 
                       drop table if exists ml.dm_zc_moxing_info_target_202011;
                       select pg_sleep(10);
                       create table ml.dm_zc_moxing_info_target_202011 as
                       select * from (
                           select a.* 
                           , a2.age_add, a2.sex_add
                           ,b.flag_eg, b.ymonth_flag_eg2, b.ymonth, b.exe_sam, b.flag_eg2
                           from (select * from ml.ml_feature_info_yw_user_m where cast(acct_month as text)='202011') a 
                           left join (select*from ml.ml_feature_add_yw_user_m where cast(acct_month as text)='202011') a2 on a.user_id = a2.user_id
                           left join (select * from ml.ml_target_info_yw_user_m where cast(acct_month as text)='202011') b on a.user_id = b.user_id
                       ) t where 
                           phone_no_null is null and
                           last_stop_date is not null and
                           innet_months >= 3
20220322-16:40:07      sql执行完毕
20220322-16:40:07  统计 ml.dm_zc_moxing_info_target_202011 的行列数
20220322-16:40:07      8354行，79列
20220322-16:40:07  正负例分布： select cast(flag_eg as text) flag_eg, count(1) from ml.dm_zc_moxing_info_target_202011  group by flag_eg
20220322-16:40:07      dis_train_total: {'count': 8354, 'Pcount': 1201, 'prop': 0.144}


                   ------------------- 限定模型目标用户范围：ml.mid_eg_model_train_202011 ------------------------------- 
20220322-16:40:07  建表语句（限定202011账期当月目标用户）： 
                       drop table if exists ml.mid_eg_model_train_202011;
                       select pg_sleep(10);
                       create table ml.mid_eg_model_train_202011 as 
                       select * ,row_number() over(order by random()) rn from ml.dm_zc_moxing_info_target_202011
                       where user_status='在网-正常' and 
                           phone_no_null is null and
                           last_stop_date is not null and
                           innet_months >= 3 and flag_eg is not null
20220322-16:40:18      sql执行完毕
20220322-16:40:18  统计ml.mid_eg_model_train_202011行列数
20220322-16:40:18      8223行，80列

                   ------------------- 加工训练集[验证集]-当月账期数据：ml.mid_eg_now_train_202011 ---------------------- 
20220322-16:40:18  data_tarin: rn > 500
20220322-16:40:18  正负例分布： select cast(flag_eg as text) flag_eg, count(1) from ml.mid_eg_model_train_202011 where rn > 500 group by flag_eg
20220322-16:40:18      dis_train_model {'count': 7723, 'Pcount': 1090, 'prop': 0.141}

20220322-16:40:18  202011账期的正例样本总量为1090,小于Info.Pcase_limit（10000）,向前累计正样本
20220322-16:40:18  Info.Pcumsum_limit=2
20220322-16:40:18  ml.ml_feature_info_yw_user_m的观察期最小可设为202010, 当月账期202011， 将Info.Pcumsum_limit修正为1
20220322-16:40:18  ml.ml_target_info_yw_user_m最小可设为202011, 当月账期202011， 将Info.Pcumsum_limit修正为1
20220322-16:40:18  Info.Pcumsum_limit修正为0，不向前累计
20220322-16:40:18  正例样本：1090
20220322-16:40:18      <=Pcase_limit（10000）, 故只取全部：1090
20220322-16:40:18  负例样本总量：6633
20220322-16:40:18      从中随机抽取2180（1090*2）

20220322-16:40:18  拼接当月正负例抽样语句

20220322-16:40:18  加工当月data_timein数据
20220322-16:40:18  建表语句： 
                       drop table if exists ml.mid_eg_now_timein_202011;
                       select pg_sleep(10);
                       create table ml.mid_eg_now_timein_202011 as
                       select * from ml.mid_eg_model_train_202011 where rn <= 500
20220322-16:40:28      sql执行完毕
20220322-16:40:28  正负例分布： select cast(flag_eg as text) flag_eg, count(1) from ml.mid_eg_now_timein_202011  group by flag_eg
20220322-16:40:28      dis_timein_sample {'count': 500, 'Pcount': 80, 'prop': 0.16}

20220322-16:40:28      dis_timein_sample 较 dis_train_model 正例占比 变动幅度13.47518% (0.16 较 0.141)



C:\Users\higher\Desktop\to伟鹏的代码_v2\ModelProject\selfmodule\tablemodule\tablefun.py:413: UserWarning:     dis_timein_sample 较 dis_train_model 正例占比 变动幅度13.47518% (0.16 较 0.141)

  warnings.warn(s)
20220322-16:40:28  建表语句（202011账期当月数据） 
                       drop table if exists ml.mid_eg_now_train_202011;
                       select pg_sleep(10);
                       create table ml.mid_eg_now_train_202011 as
                       (select * from ml.mid_eg_model_train_202011 where rn > 500 and cast(flag_eg as text)='1' order by random() limit 1090) 
                       union all 
                       (select * from ml.mid_eg_model_train_202011 where rn > 500 and cast(flag_eg as text)='0' order by random() limit 2180)
20220322-16:40:38      sql执行完毕
20220322-16:40:38  正负例分布： select cast(flag_eg as text) flag_eg, count(1) from ml.mid_eg_now_train_202011  group by flag_eg
20220322-16:40:39      dis_train_sample {'count': 3270, 'Pcount': 1090, 'prop': 0.333}


                   ------------------------ 合并近n月数据：ml.mid_eg_recent_train_202011  -------------------------------- 
20220322-16:40:39  建表语句： 
                       drop table if exists ml.mid_eg_recent_train_202011;
                       select pg_sleep(10);
                       create table ml.mid_eg_recent_train_202011 as 
                       select user_acct_month, data_use, acct_month, user_id, phone_no_null, phone_no_tm, dinner_id, account_id, innet_date, innet_months, age, sex, user_status, last_stop_date, dinner, dinner_fee, gprs_last_defer, gprs_resource, gprs_now_rest, call_use, if_nolimit, if_5g_dinner, if_5g_term, if_jt, start_level, cred_type, if_cred_multi, arpu, pay_cnt, pay_fee, acct_balance, term_model, term_brand, term_type, sk_type, if_new_term, calling_cnt, calling_dura, called_cnt, called_dura, calling_diff_cnt, calling_diff_dura, gprs_flow, gprs_flow_4g, gprs_flow_5g, gprs_flow_busy, gprs_flow_idle, gprs_now_defer, gprs_flow_roam, call_dura_roam, days_roam, gprs_flow_gat, days_gat, days_gprs, days_call, nos_call, nos_calling, nos_calling_diff, sms_cnt, call_fee_local, call_fee_roam, gprs_income, gprs_fee, call_fee, gprs_flow_video, gprs_flow_short, gprs_flow_music, gprs_flow_commu, gprs_flow_game, flag_eg
                       from (
                           select cast(202011 as text) user_acct_month, cast('data_train'  as text) data_use, * from ml.mid_eg_now_train_202011
                       ) t0
                       union all 
                       select user_acct_month, data_use, acct_month, user_id, phone_no_null, phone_no_tm, dinner_id, account_id, innet_date, innet_months, age, sex, user_status, last_stop_date, dinner, dinner_fee, gprs_last_defer, gprs_resource, gprs_now_rest, call_use, if_nolimit, if_5g_dinner, if_5g_term, if_jt, start_level, cred_type, if_cred_multi, arpu, pay_cnt, pay_fee, acct_balance, term_model, term_brand, term_type, sk_type, if_new_term, calling_cnt, calling_dura, called_cnt, called_dura, calling_diff_cnt, calling_diff_dura, gprs_flow, gprs_flow_4g, gprs_flow_5g, gprs_flow_busy, gprs_flow_idle, gprs_now_defer, gprs_flow_roam, call_dura_roam, days_roam, gprs_flow_gat, days_gat, days_gprs, days_call, nos_call, nos_calling, nos_calling_diff, sms_cnt, call_fee_local, call_fee_roam, gprs_income, gprs_fee, call_fee, gprs_flow_video, gprs_flow_short, gprs_flow_music, gprs_flow_commu, gprs_flow_game, flag_eg
                       from (
                           select cast(202011 as text) user_acct_month, cast('data_train'  as text) data_use, 
                           b.* 
                           , a2.age_add, a2.sex_add 
                           , cast(NUlL as integer) flag_eg 
                           , cast(NULL as int) rn 
                           from ml.mid_eg_now_train_202011 a
                           inner join (select * from ml.ml_feature_info_yw_user_m where cast(acct_month as text)='202010') b on a.user_id = b.user_id
                           left join (select*from ml.ml_feature_add_yw_user_m where cast(acct_month as text)='202010') a2 on a.user_id = a2.user_id
                       ) t1
                       union all
                       select user_acct_month, data_use, acct_month, user_id, phone_no_null, phone_no_tm, dinner_id, account_id, innet_date, innet_months, age, sex, user_status, last_stop_date, dinner, dinner_fee, gprs_last_defer, gprs_resource, gprs_now_rest, call_use, if_nolimit, if_5g_dinner, if_5g_term, if_jt, start_level, cred_type, if_cred_multi, arpu, pay_cnt, pay_fee, acct_balance, term_model, term_brand, term_type, sk_type, if_new_term, calling_cnt, calling_dura, called_cnt, called_dura, calling_diff_cnt, calling_diff_dura, gprs_flow, gprs_flow_4g, gprs_flow_5g, gprs_flow_busy, gprs_flow_idle, gprs_now_defer, gprs_flow_roam, call_dura_roam, days_roam, gprs_flow_gat, days_gat, days_gprs, days_call, nos_call, nos_calling, nos_calling_diff, sms_cnt, call_fee_local, call_fee_roam, gprs_income, gprs_fee, call_fee, gprs_flow_video, gprs_flow_short, gprs_flow_music, gprs_flow_commu, gprs_flow_game, flag_eg
                       from (
                           select cast(202011 as text) user_acct_month, cast('data_train'  as text) data_use, 
                           b.* 
                           , a2.age_add, a2.sex_add 
                           , cast(NUlL as integer) flag_eg 
                           , cast(NULL as int) rn 
                           from ml.mid_eg_now_train_202011 a
                           inner join (select * from ml.ml_feature_info_yw_user_m where cast(acct_month as text)='202009') b on a.user_id = b.user_id
                           left join (select*from ml.ml_feature_add_yw_user_m where cast(acct_month as text)='202009') a2 on a.user_id = a2.user_id
                       ) t2
                       
                       
                       union all
                       
                        select user_acct_month, data_use, acct_month, user_id, phone_no_null, phone_no_tm, dinner_id, account_id, innet_date, innet_months, age, sex, user_status, last_stop_date, dinner, dinner_fee, gprs_last_defer, gprs_resource, gprs_now_rest, call_use, if_nolimit, if_5g_dinner, if_5g_term, if_jt, start_level, cred_type, if_cred_multi, arpu, pay_cnt, pay_fee, acct_balance, term_model, term_brand, term_type, sk_type, if_new_term, calling_cnt, calling_dura, called_cnt, called_dura, calling_diff_cnt, calling_diff_dura, gprs_flow, gprs_flow_4g, gprs_flow_5g, gprs_flow_busy, gprs_flow_idle, gprs_now_defer, gprs_flow_roam, call_dura_roam, days_roam, gprs_flow_gat, days_gat, days_gprs, days_call, nos_call, nos_calling, nos_calling_diff, sms_cnt, call_fee_local, call_fee_roam, gprs_income, gprs_fee, call_fee, gprs_flow_video, gprs_flow_short, gprs_flow_music, gprs_flow_commu, gprs_flow_game, flag_eg
                       from (
                           select cast(202011 as text) user_acct_month, cast('data_timein'  as text) data_use, * from ml.mid_eg_now_timein_202011
                       ) t3
                       union all 
                       select user_acct_month, data_use, acct_month, user_id, phone_no_null, phone_no_tm, dinner_id, account_id, innet_date, innet_months, age, sex, user_status, last_stop_date, dinner, dinner_fee, gprs_last_defer, gprs_resource, gprs_now_rest, call_use, if_nolimit, if_5g_dinner, if_5g_term, if_jt, start_level, cred_type, if_cred_multi, arpu, pay_cnt, pay_fee, acct_balance, term_model, term_brand, term_type, sk_type, if_new_term, calling_cnt, calling_dura, called_cnt, called_dura, calling_diff_cnt, calling_diff_dura, gprs_flow, gprs_flow_4g, gprs_flow_5g, gprs_flow_busy, gprs_flow_idle, gprs_now_defer, gprs_flow_roam, call_dura_roam, days_roam, gprs_flow_gat, days_gat, days_gprs, days_call, nos_call, nos_calling, nos_calling_diff, sms_cnt, call_fee_local, call_fee_roam, gprs_income, gprs_fee, call_fee, gprs_flow_video, gprs_flow_short, gprs_flow_music, gprs_flow_commu, gprs_flow_game, flag_eg
                       from (
                           select cast(202011 as text) user_acct_month, cast('data_timein'  as text) data_use, 
                           b.* 
                           , a2.age_add, a2.sex_add 
                           , cast(NUlL as integer) flag_eg 
                           , cast(NULL as int) rn 
                           from ml.mid_eg_now_timein_202011 a
                           inner join (select * from ml.ml_feature_info_yw_user_m where cast(acct_month as text)='202010') b on a.user_id = b.user_id
                           left join (select*from ml.ml_feature_add_yw_user_m where cast(acct_month as text)='202010') a2 on a.user_id = a2.user_id
                       ) t4
                       union all
                       select user_acct_month, data_use, acct_month, user_id, phone_no_null, phone_no_tm, dinner_id, account_id, innet_date, innet_months, age, sex, user_status, last_stop_date, dinner, dinner_fee, gprs_last_defer, gprs_resource, gprs_now_rest, call_use, if_nolimit, if_5g_dinner, if_5g_term, if_jt, start_level, cred_type, if_cred_multi, arpu, pay_cnt, pay_fee, acct_balance, term_model, term_brand, term_type, sk_type, if_new_term, calling_cnt, calling_dura, called_cnt, called_dura, calling_diff_cnt, calling_diff_dura, gprs_flow, gprs_flow_4g, gprs_flow_5g, gprs_flow_busy, gprs_flow_idle, gprs_now_defer, gprs_flow_roam, call_dura_roam, days_roam, gprs_flow_gat, days_gat, days_gprs, days_call, nos_call, nos_calling, nos_calling_diff, sms_cnt, call_fee_local, call_fee_roam, gprs_income, gprs_fee, call_fee, gprs_flow_video, gprs_flow_short, gprs_flow_music, gprs_flow_commu, gprs_flow_game, flag_eg
                       from (
                           select cast(202011 as text) user_acct_month, cast('data_timein'  as text) data_use, 
                           b.* 
                           , a2.age_add, a2.sex_add 
                           , cast(NUlL as integer) flag_eg 
                           , cast(NULL as int) rn 
                           from ml.mid_eg_now_timein_202011 a
                           inner join (select * from ml.ml_feature_info_yw_user_m where cast(acct_month as text)='202009') b on a.user_id = b.user_id
                           left join (select*from ml.ml_feature_add_yw_user_m where cast(acct_month as text)='202009') a2 on a.user_id = a2.user_id
                       ) t5
20220322-16:40:49      sql执行完毕
20220322-16:40:49  统计ml.mid_eg_recent_train_202011行列数
20220322-16:40:49      3754行，70列

                   --------------------------------- 核验各账期数据量  -------------------------------------------------- 
20220322-16:40:49  sql语句： 
                       select user_acct_month, data_use, acct_month, flag_eg, count(1) 
                       from ml.mid_eg_recent_train_202011 
                       group by user_acct_month, data_use, acct_month, flag_eg 
                       order by user_acct_month, data_use, acct_month, flag_eg

20220322-16:40:50  结果：
                     user_acct_month     data_use  acct_month  flag_eg  count
                   0          202011  data_timein      202009      NaN    499
                   1          202011  data_timein      202010      NaN    499
                   2          202011  data_timein      202011      0.0    420
                   3          202011  data_timein      202011      1.0     80
                   4          202011   data_train      202009      NaN   3255
                   5          202011   data_train      202010      NaN   3255
                   6          202011   data_train      202011      0.0   2180
                   7          202011   data_train      202011      1.0   1090


C:\Users\higher\Desktop\to伟鹏的代码_v2\ModelProject\selfmodule\tablemodule\tablefun.py:910: UserWarning: 下列账期用户量不同，请检查！
                             acct_month  flag_eg  count
user_acct_month data_use                               
202011          data_timein      202009      0.0    499
                data_timein      202010      0.0    499
                data_timein      202011      1.0    500
                data_train       202009      0.0   3255
                data_train       202010      0.0   3255
                data_train       202011      1.0   3270
  warnings.warn(w)

                   -------------------------------- 删除中间表 ----------------------------------------------------- 
20220322-16:40:50  sql语句： drop table if exists ml.mid_eg_model_train_202011
20220322-16:40:50      sql执行完毕
20220322-16:40:50  sql语句： drop table if exists ml.mid_eg_now_train_202011
20220322-16:40:50      sql执行完毕
20220322-16:40:50  sql语句： drop table if exists ml.mid_eg_now_timein_202011
20220322-16:40:50      sql执行完毕

20220322-16:40:50  返回结果表名：ml.mid_eg_recent_train_202011
20220322-16:40:50  将Info保存至./binaryclassify/eg/traintest~202011~202012/Info~base_train.pkl

20220322-16:40:50  结束时间：2022-03-22 16:40:50
20220322-16:40:50  耗时：54 s

                   ###################################################################### 探索模型宽表
                    
20220322-16:41:05  开始时间：2022-03-22 16:41:05
20220322-16:41:05  参数设置：
                       step: train
                       table_in: ml.mid_eg_recent_train_202011
                       Info.model_name: 模型示例
                       Info.iv_limit: 0.05
                       stage: explore
                       Info.auto_pair2: False
                       Info.r_limit: 0.95

20220322-16:41:05  field_base: 78行

20220322-16:41:05  删除3个available_notzd“不可用”字段：['cred_type', 'called_dura', 'days_roam']
20220322-16:41:05  field_base: 75行

20220322-16:41:05  删除1个基于“不可用”字段加工的手动衍生_py字段：
                        field_name                 formula
                   52  days_roam_p  days_roam / days_month
20220322-16:41:05  field_base: 74行
20220322-16:41:05  ------------------------- 读取数据: ml.mid_eg_recent_train_202011 2022-03-22 16:41:05 -------------------------
20220322-16:41:05      src: gp
20220322-16:41:05      condition: data_use='data_train'
20220322-16:41:05      col_need(67): ['user_acct_month', 'data_use', 'acct_month', 'user_id', 'innet_months', 'age', 'dinner_fee', 'gprs_last_defer', 'gprs_resource', 'gprs_now_rest', 'call_use', 'arpu', 'pay_cnt', 'pay_fee', 'acct_balance', 'calling_cnt', 'calling_dura', 'called_cnt', 'calling_diff_cnt', 'calling_diff_dura', 'gprs_flow', 'gprs_flow_4g', 'gprs_flow_5g', 'gprs_flow_busy', 'gprs_flow_idle', 'gprs_now_defer', 'gprs_flow_roam', 'call_dura_roam', 'gprs_flow_gat', 'days_gat', 'days_gprs', 'days_call', 'nos_call', 'nos_calling', 'nos_calling_diff', 'sms_cnt', 'call_fee_local', 'call_fee_roam', 'gprs_income', 'gprs_fee', 'call_fee', 'gprs_flow_video', 'gprs_flow_short', 'gprs_flow_music', 'gprs_flow_commu', 'gprs_flow_game', 'innet_date', 'last_stop_date', 'phone_no_null', 'phone_no_tm', 'dinner_id', 'account_id', 'sex', 'user_status', 'dinner', 'if_nolimit', 'if_5g_dinner', 'if_5g_term', 'if_jt', 'start_level', 'if_cred_multi', 'term_model', 'term_brand', 'term_type', 'sk_type', 'if_new_term', 'flag_eg']
20220322-16:41:05      col_del: None
20220322-16:41:05      col_char(21): ['acct_month', 'phone_no_null', 'phone_no_tm', 'user_id', 'dinner_id', 'account_id', 'sex', 'user_status', 'dinner', 'if_nolimit', 'if_5g_dinner', 'if_5g_term', 'if_jt', 'start_level', 'if_cred_multi', 'term_model', 'term_brand', 'term_type', 'sk_type', 'if_new_term', 'flag_eg']
20220322-16:41:05      col_num(42): ['innet_months', 'age', 'dinner_fee', 'gprs_last_defer', 'gprs_resource', 'gprs_now_rest', 'call_use', 'arpu', 'pay_cnt', 'pay_fee', 'acct_balance', 'calling_cnt', 'calling_dura', 'called_cnt', 'calling_diff_cnt', 'calling_diff_dura', 'gprs_flow', 'gprs_flow_4g', 'gprs_flow_5g', 'gprs_flow_busy', 'gprs_flow_idle', 'gprs_now_defer', 'gprs_flow_roam', 'call_dura_roam', 'gprs_flow_gat', 'days_gat', 'days_gprs', 'days_call', 'nos_call', 'nos_calling', 'nos_calling_diff', 'sms_cnt', 'call_fee_local', 'call_fee_roam', 'gprs_income', 'gprs_fee', 'call_fee', 'gprs_flow_video', 'gprs_flow_short', 'gprs_flow_music', 'gprs_flow_commu', 'gprs_flow_game']
20220322-16:41:05      col_date(2): ['innet_date', 'last_stop_date']
20220322-16:41:05      nrows: None
20220322-16:41:05      if_coltolower: True
20220322-16:41:05      kwargs: {}

20220322-16:41:05      读取
20220322-16:41:06      shape: (9780, 67)



Traceback (most recent call last):
  File "C:\Users\higher\Anaconda3\lib\site-packages\IPython\core\interactiveshell.py", line 2961, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-8-e438afbf1570>", line 1, in <module>
    exp, Info = tab_explore_create(base_train[model_name], Info, 'explore')
  File "C:\Users\higher\Desktop\to伟鹏的代码_v2\ModelProject\selfmodule\tablemodule\tablefun.py", line 1833, in tab_explore_create
    data_recent = read_data(table_in, 'gp', condition, col_need, col_char=col_char, col_num=col_num, col_date=col_date)
  File "C:\Users\higher\Desktop\to伟鹏的代码_v2\ModelProject\selfmodule\toolmodule\datatrans.py", line 502, in read_data
    d = data[dict_date.keys()].dtypes.astype(str)
  File "C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\frame.py", line 2688, in __getitem__
    return self._getitem_column(key)
  File "C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\frame.py", line 2695, in _getitem_column
    return self._get_item_cache(key)
  File "C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\generic.py", line 2487, in _get_item_cache
    res = cache.get(item)
TypeError: unhashable type: 'dict_keys'
20220322-16:42:59  开始时间：2022-03-22 16:42:59
20220322-16:42:59  参数设置：
                       step: train
                       table_in: ml.mid_eg_recent_train_202011
                       Info.model_name: 模型示例
                       Info.iv_limit: 0.05
                       stage: explore
                       Info.auto_pair2: False
                       Info.r_limit: 0.95

20220322-16:42:59  field_base: 78行

20220322-16:42:59  删除3个available_notzd“不可用”字段：['cred_type', 'called_dura', 'days_roam']
20220322-16:42:59  field_base: 75行

20220322-16:42:59  删除1个基于“不可用”字段加工的手动衍生_py字段：
                        field_name                 formula
                   52  days_roam_p  days_roam / days_month
20220322-16:42:59  field_base: 74行


C:\Users\higher\Desktop\to伟鹏的代码_v2\ModelProject\selfmodule\toolmodule\dataprep.py:9: UserWarning: Pipeline_DF：verbose参数值被赋予print_indent后默认参数设置为None
  from collections import OrderedDict


C:\Users\higher\Desktop\to伟鹏的代码_v2\ModelProject\selfmodule\toolmodule\dataprep.py:9: UserWarning: FeatureUnion_DF：verbose参数值被赋予print_indent后默认参数设置为None
  from collections import OrderedDict
20220322-16:43:02  ------------------------- 读取数据: ml.mid_eg_recent_train_202011 2022-03-22 16:43:02 -------------------------
20220322-16:43:02      src: gp
20220322-16:43:02      condition: data_use='data_train'
20220322-16:43:02      col_need(67): ['user_acct_month', 'data_use', 'acct_month', 'user_id', 'innet_months', 'age', 'dinner_fee', 'gprs_last_defer', 'gprs_resource', 'gprs_now_rest', 'call_use', 'arpu', 'pay_cnt', 'pay_fee', 'acct_balance', 'calling_cnt', 'calling_dura', 'called_cnt', 'calling_diff_cnt', 'calling_diff_dura', 'gprs_flow', 'gprs_flow_4g', 'gprs_flow_5g', 'gprs_flow_busy', 'gprs_flow_idle', 'gprs_now_defer', 'gprs_flow_roam', 'call_dura_roam', 'gprs_flow_gat', 'days_gat', 'days_gprs', 'days_call', 'nos_call', 'nos_calling', 'nos_calling_diff', 'sms_cnt', 'call_fee_local', 'call_fee_roam', 'gprs_income', 'gprs_fee', 'call_fee', 'gprs_flow_video', 'gprs_flow_short', 'gprs_flow_music', 'gprs_flow_commu', 'gprs_flow_game', 'innet_date', 'last_stop_date', 'phone_no_null', 'phone_no_tm', 'dinner_id', 'account_id', 'sex', 'user_status', 'dinner', 'if_nolimit', 'if_5g_dinner', 'if_5g_term', 'if_jt', 'start_level', 'if_cred_multi', 'term_model', 'term_brand', 'term_type', 'sk_type', 'if_new_term', 'flag_eg']
20220322-16:43:02      col_del: None
20220322-16:43:02      col_char(21): ['acct_month', 'phone_no_null', 'phone_no_tm', 'user_id', 'dinner_id', 'account_id', 'sex', 'user_status', 'dinner', 'if_nolimit', 'if_5g_dinner', 'if_5g_term', 'if_jt', 'start_level', 'if_cred_multi', 'term_model', 'term_brand', 'term_type', 'sk_type', 'if_new_term', 'flag_eg']
20220322-16:43:02      col_num(42): ['innet_months', 'age', 'dinner_fee', 'gprs_last_defer', 'gprs_resource', 'gprs_now_rest', 'call_use', 'arpu', 'pay_cnt', 'pay_fee', 'acct_balance', 'calling_cnt', 'calling_dura', 'called_cnt', 'calling_diff_cnt', 'calling_diff_dura', 'gprs_flow', 'gprs_flow_4g', 'gprs_flow_5g', 'gprs_flow_busy', 'gprs_flow_idle', 'gprs_now_defer', 'gprs_flow_roam', 'call_dura_roam', 'gprs_flow_gat', 'days_gat', 'days_gprs', 'days_call', 'nos_call', 'nos_calling', 'nos_calling_diff', 'sms_cnt', 'call_fee_local', 'call_fee_roam', 'gprs_income', 'gprs_fee', 'call_fee', 'gprs_flow_video', 'gprs_flow_short', 'gprs_flow_music', 'gprs_flow_commu', 'gprs_flow_game']
20220322-16:43:02      col_date(2): ['innet_date', 'last_stop_date']
20220322-16:43:02      nrows: None
20220322-16:43:02      if_coltolower: True
20220322-16:43:02      kwargs: {}

20220322-16:43:02      读取
20220322-16:43:03      shape: (9780, 67)



Traceback (most recent call last):
  File "C:\Users\higher\Anaconda3\lib\site-packages\IPython\core\interactiveshell.py", line 2961, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-13-b150016d5c1f>", line 1, in <module>
    data_recent = read_data(table_in, 'gp', condition, col_need, col_char=col_char, col_num=col_num, col_date=col_date)
  File "C:\Users\higher\Desktop\to伟鹏的代码_v2\ModelProject\selfmodule\toolmodule\datatrans.py", line 502, in read_data
    d = data[dict_date.keys()].dtypes.astype(str)
  File "C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\frame.py", line 2688, in __getitem__
    return self._getitem_column(key)
  File "C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\frame.py", line 2695, in _getitem_column
    return self._get_item_cache(key)
  File "C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\generic.py", line 2487, in _get_item_cache
    res = cache.get(item)
TypeError: unhashable type: 'dict_keys'
20220322-16:43:59  ------------------------- 读取数据: ml.mid_eg_recent_train_202011 2022-03-22 16:43:59 -------------------------
20220322-16:43:59      src: gp
20220322-16:43:59      condition: data_use='data_train'
20220322-16:43:59      col_need(67): ['user_acct_month', 'data_use', 'acct_month', 'user_id', 'innet_months', 'age', 'dinner_fee', 'gprs_last_defer', 'gprs_resource', 'gprs_now_rest', 'call_use', 'arpu', 'pay_cnt', 'pay_fee', 'acct_balance', 'calling_cnt', 'calling_dura', 'called_cnt', 'calling_diff_cnt', 'calling_diff_dura', 'gprs_flow', 'gprs_flow_4g', 'gprs_flow_5g', 'gprs_flow_busy', 'gprs_flow_idle', 'gprs_now_defer', 'gprs_flow_roam', 'call_dura_roam', 'gprs_flow_gat', 'days_gat', 'days_gprs', 'days_call', 'nos_call', 'nos_calling', 'nos_calling_diff', 'sms_cnt', 'call_fee_local', 'call_fee_roam', 'gprs_income', 'gprs_fee', 'call_fee', 'gprs_flow_video', 'gprs_flow_short', 'gprs_flow_music', 'gprs_flow_commu', 'gprs_flow_game', 'innet_date', 'last_stop_date', 'phone_no_null', 'phone_no_tm', 'dinner_id', 'account_id', 'sex', 'user_status', 'dinner', 'if_nolimit', 'if_5g_dinner', 'if_5g_term', 'if_jt', 'start_level', 'if_cred_multi', 'term_model', 'term_brand', 'term_type', 'sk_type', 'if_new_term', 'flag_eg']


Traceback (most recent call last):
  File "C:\Users\higher\Anaconda3\lib\site-packages\IPython\core\interactiveshell.py", line 2961, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-20-f0ee3865690b>", line 10, in <module>
    print(f"    col_del{my_len(col_del)}: {col_del}")
NameError: name 'col_del' is not defined
                   Out[21]: 20220322-16:44:06  
                   ['user_acct_month',
                    'data_use',
                    'acct_month',
                    'user_id',
                    'innet_months',
                    'age',
                    'dinner_fee',
                    'gprs_last_defer',
                    'gprs_resource',
                    'gprs_now_rest',
                    'call_use',
                    'arpu',
                    'pay_cnt',
                    'pay_fee',
                    'acct_balance',
                    'calling_cnt',
                    'calling_dura',
                    'called_cnt',
                    'calling_diff_cnt',
                    'calling_diff_dura',
                    'gprs_flow',
                    'gprs_flow_4g',
                    'gprs_flow_5g',
                    'gprs_flow_busy',
                    'gprs_flow_idle',
                    'gprs_now_defer',
                    'gprs_flow_roam',
                    'call_dura_roam',
                    'gprs_flow_gat',
                    'days_gat',
                    'days_gprs',
                    'days_call',
                    'nos_call',
                    'nos_calling',
                    'nos_calling_diff',
                    'sms_cnt',
                    'call_fee_local',
                    'call_fee_roam',
                    'gprs_income',
                    'gprs_fee',
                    'call_fee',
                    'gprs_flow_video',
                    'gprs_flow_short',
                    'gprs_flow_music',
                    'gprs_flow_commu',
                    'gprs_flow_game',
                    'innet_date',
                    'last_stop_date',
                    'phone_no_null',
                    'phone_no_tm',
                    'dinner_id',
                    'account_id',
                    'sex',
                    'user_status',
                    'dinner',
                    'if_nolimit',
                    'if_5g_dinner',
                    'if_5g_term',
                    'if_jt',
                    'start_level',
                    'if_cred_multi',
                    'term_model',
                    'term_brand',
                    'term_type',
                    'sk_type',
                    'if_new_term',
                    'flag_eg']
20220322-16:44:26  ------------------------- 读取数据: ml.mid_eg_recent_train_202011 2022-03-22 16:44:26 -------------------------
20220322-16:44:26      src: gp
20220322-16:44:26      condition: data_use='data_train'
20220322-16:44:26      col_need(67): ['user_acct_month', 'data_use', 'acct_month', 'user_id', 'innet_months', 'age', 'dinner_fee', 'gprs_last_defer', 'gprs_resource', 'gprs_now_rest', 'call_use', 'arpu', 'pay_cnt', 'pay_fee', 'acct_balance', 'calling_cnt', 'calling_dura', 'called_cnt', 'calling_diff_cnt', 'calling_diff_dura', 'gprs_flow', 'gprs_flow_4g', 'gprs_flow_5g', 'gprs_flow_busy', 'gprs_flow_idle', 'gprs_now_defer', 'gprs_flow_roam', 'call_dura_roam', 'gprs_flow_gat', 'days_gat', 'days_gprs', 'days_call', 'nos_call', 'nos_calling', 'nos_calling_diff', 'sms_cnt', 'call_fee_local', 'call_fee_roam', 'gprs_income', 'gprs_fee', 'call_fee', 'gprs_flow_video', 'gprs_flow_short', 'gprs_flow_music', 'gprs_flow_commu', 'gprs_flow_game', 'innet_date', 'last_stop_date', 'phone_no_null', 'phone_no_tm', 'dinner_id', 'account_id', 'sex', 'user_status', 'dinner', 'if_nolimit', 'if_5g_dinner', 'if_5g_term', 'if_jt', 'start_level', 'if_cred_multi', 'term_model', 'term_brand', 'term_type', 'sk_type', 'if_new_term', 'flag_eg']
20220322-16:44:26      col_del: None
20220322-16:44:26      col_char: None
20220322-16:44:26      col_num(42): ['innet_months', 'age', 'dinner_fee', 'gprs_last_defer', 'gprs_resource', 'gprs_now_rest', 'call_use', 'arpu', 'pay_cnt', 'pay_fee', 'acct_balance', 'calling_cnt', 'calling_dura', 'called_cnt', 'calling_diff_cnt', 'calling_diff_dura', 'gprs_flow', 'gprs_flow_4g', 'gprs_flow_5g', 'gprs_flow_busy', 'gprs_flow_idle', 'gprs_now_defer', 'gprs_flow_roam', 'call_dura_roam', 'gprs_flow_gat', 'days_gat', 'days_gprs', 'days_call', 'nos_call', 'nos_calling', 'nos_calling_diff', 'sms_cnt', 'call_fee_local', 'call_fee_roam', 'gprs_income', 'gprs_fee', 'call_fee', 'gprs_flow_video', 'gprs_flow_short', 'gprs_flow_music', 'gprs_flow_commu', 'gprs_flow_game']
20220322-16:44:26      col_date(2): ['innet_date', 'last_stop_date']
20220322-16:44:26      nrows: None
20220322-16:44:26      if_coltolower: True
  File "<ipython-input-27-9e8768b43e81>", line 12
    1
    ^
SyntaxError: invalid syntax

20220322-16:44:54      读取
                   Out[31]: 20220322-16:44:57  False


Traceback (most recent call last):
  File "C:\Users\higher\Anaconda3\lib\site-packages\IPython\core\interactiveshell.py", line 2961, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-36-7c655e67aaf3>", line 1, in <module>
    data = my_sql_fun(sql, method='read', db=src, parse_dates=col_date, **kwargs)
NameError: name 'kwargs' is not defined


Traceback (most recent call last):
  File "C:\Users\higher\Anaconda3\lib\site-packages\IPython\core\interactiveshell.py", line 2961, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-37-d8c648f020ed>", line 1, in <module>
    print(f'    shape: {data.shape}\n')
NameError: name 'data' is not defined
  File "<ipython-input-38-64c43b55f0b0>", line 1
    else:
       ^
SyntaxError: invalid syntax

  File "<ipython-input-40-c1a229141d18>", line 1
    data = my_sql_fun(sql, method='read', db=src, parse_dates=col_date）
                                                                      ^
SyntaxError: invalid character in identifier

20220322-16:45:25      shape: (9780, 67)

                   Out[45]: 20220322-16:45:41  {'innet_date': '', 'last_stop_date': ''}


Traceback (most recent call last):
  File "C:\Users\higher\Anaconda3\lib\site-packages\IPython\core\interactiveshell.py", line 2961, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-46-9ddccaec4917>", line 1, in <module>
    d = data[dict_date.keys()].dtypes.astype(str)
  File "C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\frame.py", line 2688, in __getitem__
    return self._getitem_column(key)
  File "C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\frame.py", line 2695, in _getitem_column
    return self._get_item_cache(key)
  File "C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\generic.py", line 2487, in _get_item_cache
    res = cache.get(item)
TypeError: unhashable type: 'dict_keys'


Traceback (most recent call last):
  File "C:\Users\higher\Anaconda3\lib\site-packages\IPython\core\interactiveshell.py", line 2961, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-47-49f76be5d50f>", line 1, in <module>
    d = data[dict_date.keys()].dtypes.astype(str)
  File "C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\frame.py", line 2688, in __getitem__
    return self._getitem_column(key)
  File "C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\frame.py", line 2695, in _getitem_column
    return self._get_item_cache(key)
  File "C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\generic.py", line 2487, in _get_item_cache
    res = cache.get(item)
TypeError: unhashable type: 'dict_keys'
                   Out[48]: 20220322-16:46:01  dict_keys(['innet_date', 'last_stop_date'])


Traceback (most recent call last):
  File "C:\Users\higher\Anaconda3\lib\site-packages\IPython\core\interactiveshell.py", line 2961, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-49-d5fdb61da725>", line 1, in <module>
    data[dict_date.keys()]
  File "C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\frame.py", line 2688, in __getitem__
    return self._getitem_column(key)
  File "C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\frame.py", line 2695, in _getitem_column
    return self._get_item_cache(key)
  File "C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\generic.py", line 2487, in _get_item_cache
    res = cache.get(item)
TypeError: unhashable type: 'dict_keys'
20220322-16:46:21  创建sqldf函数
20220322-16:46:24  ------------------------- 读取数据: ml.mid_eg_recent_train_202011 2022-03-22 16:46:24 -------------------------
20220322-16:46:24      src: gp
20220322-16:46:24      condition: data_use='data_train'
20220322-16:46:24      col_need(67): ['user_acct_month', 'data_use', 'acct_month', 'user_id', 'innet_months', 'age', 'dinner_fee', 'gprs_last_defer', 'gprs_resource', 'gprs_now_rest', 'call_use', 'arpu', 'pay_cnt', 'pay_fee', 'acct_balance', 'calling_cnt', 'calling_dura', 'called_cnt', 'calling_diff_cnt', 'calling_diff_dura', 'gprs_flow', 'gprs_flow_4g', 'gprs_flow_5g', 'gprs_flow_busy', 'gprs_flow_idle', 'gprs_now_defer', 'gprs_flow_roam', 'call_dura_roam', 'gprs_flow_gat', 'days_gat', 'days_gprs', 'days_call', 'nos_call', 'nos_calling', 'nos_calling_diff', 'sms_cnt', 'call_fee_local', 'call_fee_roam', 'gprs_income', 'gprs_fee', 'call_fee', 'gprs_flow_video', 'gprs_flow_short', 'gprs_flow_music', 'gprs_flow_commu', 'gprs_flow_game', 'innet_date', 'last_stop_date', 'phone_no_null', 'phone_no_tm', 'dinner_id', 'account_id', 'sex', 'user_status', 'dinner', 'if_nolimit', 'if_5g_dinner', 'if_5g_term', 'if_jt', 'start_level', 'if_cred_multi', 'term_model', 'term_brand', 'term_type', 'sk_type', 'if_new_term', 'flag_eg']
20220322-16:46:24      col_del: None
20220322-16:46:24      col_char: None
20220322-16:46:24      col_num(42): ['innet_months', 'age', 'dinner_fee', 'gprs_last_defer', 'gprs_resource', 'gprs_now_rest', 'call_use', 'arpu', 'pay_cnt', 'pay_fee', 'acct_balance', 'calling_cnt', 'calling_dura', 'called_cnt', 'calling_diff_cnt', 'calling_diff_dura', 'gprs_flow', 'gprs_flow_4g', 'gprs_flow_5g', 'gprs_flow_busy', 'gprs_flow_idle', 'gprs_now_defer', 'gprs_flow_roam', 'call_dura_roam', 'gprs_flow_gat', 'days_gat', 'days_gprs', 'days_call', 'nos_call', 'nos_calling', 'nos_calling_diff', 'sms_cnt', 'call_fee_local', 'call_fee_roam', 'gprs_income', 'gprs_fee', 'call_fee', 'gprs_flow_video', 'gprs_flow_short', 'gprs_flow_music', 'gprs_flow_commu', 'gprs_flow_game']
20220322-16:46:24      col_date(2): ['innet_date', 'last_stop_date']
20220322-16:46:24      nrows: None
20220322-16:46:24      if_coltolower: True
20220322-16:46:24      kwargs: {}

20220322-16:46:24      读取
20220322-16:46:27      shape: (9780, 67)

20220322-16:46:27  -------------------------读取完毕: (9780, 67) 2022-03-22 16:46:27 -------------------------


                   ###################################################################### 探索模型宽表
                    
20220322-16:46:51  开始时间：2022-03-22 16:46:51
20220322-16:46:52  参数设置：
                       step: train
                       table_in: ml.mid_eg_recent_train_202011
                       Info.model_name: 模型示例
                       Info.iv_limit: 0.05
                       stage: explore
                       Info.auto_pair2: False
                       Info.r_limit: 0.95

20220322-16:46:52  field_base: 78行

20220322-16:46:53  删除3个available_notzd“不可用”字段：['cred_type', 'called_dura', 'days_roam']
20220322-16:46:53  field_base: 75行

20220322-16:46:53  删除1个基于“不可用”字段加工的手动衍生_py字段：
                        field_name                 formula
                   52  days_roam_p  days_roam / days_month
20220322-16:46:54  field_base: 74行
20220322-16:46:55  ------------------------- 读取数据: ml.mid_eg_recent_train_202011 2022-03-22 16:46:55 -------------------------
20220322-16:46:55      src: gp
20220322-16:46:55      condition: data_use='data_train'
20220322-16:46:55      col_need(67): ['user_acct_month', 'data_use', 'acct_month', 'user_id', 'innet_months', 'age', 'dinner_fee', 'gprs_last_defer', 'gprs_resource', 'gprs_now_rest', 'call_use', 'arpu', 'pay_cnt', 'pay_fee', 'acct_balance', 'calling_cnt', 'calling_dura', 'called_cnt', 'calling_diff_cnt', 'calling_diff_dura', 'gprs_flow', 'gprs_flow_4g', 'gprs_flow_5g', 'gprs_flow_busy', 'gprs_flow_idle', 'gprs_now_defer', 'gprs_flow_roam', 'call_dura_roam', 'gprs_flow_gat', 'days_gat', 'days_gprs', 'days_call', 'nos_call', 'nos_calling', 'nos_calling_diff', 'sms_cnt', 'call_fee_local', 'call_fee_roam', 'gprs_income', 'gprs_fee', 'call_fee', 'gprs_flow_video', 'gprs_flow_short', 'gprs_flow_music', 'gprs_flow_commu', 'gprs_flow_game', 'innet_date', 'last_stop_date', 'phone_no_null', 'phone_no_tm', 'dinner_id', 'account_id', 'sex', 'user_status', 'dinner', 'if_nolimit', 'if_5g_dinner', 'if_5g_term', 'if_jt', 'start_level', 'if_cred_multi', 'term_model', 'term_brand', 'term_type', 'sk_type', 'if_new_term', 'flag_eg']
20220322-16:46:55      col_del: None
20220322-16:46:55      col_char(21): ['acct_month', 'phone_no_null', 'phone_no_tm', 'user_id', 'dinner_id', 'account_id', 'sex', 'user_status', 'dinner', 'if_nolimit', 'if_5g_dinner', 'if_5g_term', 'if_jt', 'start_level', 'if_cred_multi', 'term_model', 'term_brand', 'term_type', 'sk_type', 'if_new_term', 'flag_eg']
20220322-16:46:55      col_num(42): ['innet_months', 'age', 'dinner_fee', 'gprs_last_defer', 'gprs_resource', 'gprs_now_rest', 'call_use', 'arpu', 'pay_cnt', 'pay_fee', 'acct_balance', 'calling_cnt', 'calling_dura', 'called_cnt', 'calling_diff_cnt', 'calling_diff_dura', 'gprs_flow', 'gprs_flow_4g', 'gprs_flow_5g', 'gprs_flow_busy', 'gprs_flow_idle', 'gprs_now_defer', 'gprs_flow_roam', 'call_dura_roam', 'gprs_flow_gat', 'days_gat', 'days_gprs', 'days_call', 'nos_call', 'nos_calling', 'nos_calling_diff', 'sms_cnt', 'call_fee_local', 'call_fee_roam', 'gprs_income', 'gprs_fee', 'call_fee', 'gprs_flow_video', 'gprs_flow_short', 'gprs_flow_music', 'gprs_flow_commu', 'gprs_flow_game']
20220322-16:46:55      col_date(2): ['innet_date', 'last_stop_date']
20220322-16:46:55      nrows: None
20220322-16:46:55      if_coltolower: True
20220322-16:46:55      kwargs: {}

20220322-16:46:55      读取
20220322-16:46:56      shape: (9780, 67)

20220322-16:46:56  -------------------------读取完毕: (9780, 67) 2022-03-22 16:46:56 -------------------------

20220322-16:46:56  手动衍生_py10个字段: {'monthsaready_last_stop_date': '最后停机时间：已发生时长', 'monthsremain_last_stop_date': '最后停机时间：剩余时长', 'days_gprs_p': '上网天数占比', 'days_call_p': '通话天数占比', 'days_call_p_1': '通话天数占比_1', 'days_call_p_2': '通话天数占比_2', 'days_call_p_3': '通话天数占比_3', 'days_call_p_4': '通话天数占比_4', 'greatest_gprs_app': 'app偏好', 'paste_dinner_innet_months': '主套餐、入网时长：交叉'}
20220322-16:46:56  monthsaready_last_stop_date: current_date - last_stop_date
20220322-16:46:56      将 monthsaready_last_stop_date 字段的 4 个缺失值赋值为: -99999 （非缺失的最小值-2.0）
20220322-16:46:56  monthsremain_last_stop_date: last_stop_date - current_date
20220322-16:46:56      将 monthsremain_last_stop_date 字段的 4 个缺失值赋值为: -99999 （非缺失的最小值-101.0）
20220322-16:46:56  days_gprs_p: days_gprs / days_month
20220322-16:46:56  days_call_p: days_call / days_month
20220322-16:46:56  days_call_p_1: days_call_p + days_gprs
20220322-16:46:56  days_call_p_2: days_call_p_1 + days_gprs
20220322-16:46:56  days_call_p_3: days_call_p_2 + days_gprs
20220322-16:46:56  days_call_p_4: days_call_p_3 + days_gprs
20220322-16:46:56  greatest_gprs_app: {'gprs_flow_video': 'video', 'gprs_flow_short': 'short', 'gprs_flow_music': 'music', 'gprs_flow_commu': 'commu', 'gprs_flow_game': 'game'}


Traceback (most recent call last):
  File "C:\Users\higher\Anaconda3\lib\site-packages\IPython\core\interactiveshell.py", line 2961, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-55-e438afbf1570>", line 1, in <module>
    exp, Info = tab_explore_create(base_train[model_name], Info, 'explore')
  File "<ipython-input-53-345359140ef3>", line 234, in tab_explore_create
    data_recent, col_need_ad = manual_fun(data_recent, Info, field_manual)
  File "<ipython-input-11-3388f6c54c37>", line 1278, in manual_fun
    data_recent[field_name_i] = now_greatest_fun(data_recent, greatest_dict, Info, col_add=None)[0]
  File "<ipython-input-11-3388f6c54c37>", line 1205, in now_greatest_fun
    data[c] = data[k_v.keys()].apply(greatest_fun, axis=1)
  File "C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\frame.py", line 2688, in __getitem__
    return self._getitem_column(key)
  File "C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\frame.py", line 2695, in _getitem_column
    return self._get_item_cache(key)
  File "C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\generic.py", line 2487, in _get_item_cache
    res = cache.get(item)
TypeError: unhashable type: 'dict_keys'
20220322-16:47:14  创建sqldf函数
20220322-16:51:05  ------------------------- 读取数据: ml.mid_eg_recent_train_202011 2022-03-22 16:51:05 -------------------------
20220322-16:51:05      src: gp
20220322-16:51:05      condition: data_use='data_train'
20220322-16:51:05      col_need(67): ['user_acct_month', 'data_use', 'acct_month', 'user_id', 'innet_months', 'age', 'dinner_fee', 'gprs_last_defer', 'gprs_resource', 'gprs_now_rest', 'call_use', 'arpu', 'pay_cnt', 'pay_fee', 'acct_balance', 'calling_cnt', 'calling_dura', 'called_cnt', 'calling_diff_cnt', 'calling_diff_dura', 'gprs_flow', 'gprs_flow_4g', 'gprs_flow_5g', 'gprs_flow_busy', 'gprs_flow_idle', 'gprs_now_defer', 'gprs_flow_roam', 'call_dura_roam', 'gprs_flow_gat', 'days_gat', 'days_gprs', 'days_call', 'nos_call', 'nos_calling', 'nos_calling_diff', 'sms_cnt', 'call_fee_local', 'call_fee_roam', 'gprs_income', 'gprs_fee', 'call_fee', 'gprs_flow_video', 'gprs_flow_short', 'gprs_flow_music', 'gprs_flow_commu', 'gprs_flow_game', 'innet_date', 'last_stop_date', 'phone_no_null', 'phone_no_tm', 'dinner_id', 'account_id', 'sex', 'user_status', 'dinner', 'if_nolimit', 'if_5g_dinner', 'if_5g_term', 'if_jt', 'start_level', 'if_cred_multi', 'term_model', 'term_brand', 'term_type', 'sk_type', 'if_new_term', 'flag_eg']
20220322-16:51:05      col_del: None
20220322-16:51:05      col_char: None
20220322-16:51:05      col_num(42): ['innet_months', 'age', 'dinner_fee', 'gprs_last_defer', 'gprs_resource', 'gprs_now_rest', 'call_use', 'arpu', 'pay_cnt', 'pay_fee', 'acct_balance', 'calling_cnt', 'calling_dura', 'called_cnt', 'calling_diff_cnt', 'calling_diff_dura', 'gprs_flow', 'gprs_flow_4g', 'gprs_flow_5g', 'gprs_flow_busy', 'gprs_flow_idle', 'gprs_now_defer', 'gprs_flow_roam', 'call_dura_roam', 'gprs_flow_gat', 'days_gat', 'days_gprs', 'days_call', 'nos_call', 'nos_calling', 'nos_calling_diff', 'sms_cnt', 'call_fee_local', 'call_fee_roam', 'gprs_income', 'gprs_fee', 'call_fee', 'gprs_flow_video', 'gprs_flow_short', 'gprs_flow_music', 'gprs_flow_commu', 'gprs_flow_game']
20220322-16:51:05      col_date(2): ['innet_date', 'last_stop_date']
20220322-16:51:05      nrows: None
20220322-16:51:06      if_coltolower: True
20220322-16:51:06      kwargs: {}

20220322-16:51:06      读取
20220322-16:51:07      shape: (9780, 67)

20220322-16:51:07  -------------------------读取完毕: (9780, 67) 2022-03-22 16:51:07 -------------------------

20220322-16:51:07  手动衍生_py10个字段: {'monthsaready_last_stop_date': '最后停机时间：已发生时长', 'monthsremain_last_stop_date': '最后停机时间：剩余时长', 'days_gprs_p': '上网天数占比', 'days_call_p': '通话天数占比', 'days_call_p_1': '通话天数占比_1', 'days_call_p_2': '通话天数占比_2', 'days_call_p_3': '通话天数占比_3', 'days_call_p_4': '通话天数占比_4', 'greatest_gprs_app': 'app偏好', 'paste_dinner_innet_months': '主套餐、入网时长：交叉'}


Traceback (most recent call last):
  File "C:\Users\higher\Anaconda3\lib\site-packages\IPython\core\interactiveshell.py", line 2961, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-57-5d5141a0a035>", line 30, in <module>
    data_recent, col_need_ad = manual_fun(data_recent, Info, field_manual)
  File "<ipython-input-11-3388f6c54c37>", line 1236, in manual_fun
    data_recent['days_month'] = data_recent[Info.col_month].apply(lambda x:  calendar.monthrange(int(x[:4]), int(x[4:]))[1])
  File "C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\series.py", line 3194, in apply
    mapped = lib.map_infer(values, f, convert=convert_dtype)
  File "pandas/_libs/src\inference.pyx", line 1472, in pandas._libs.lib.map_infer
  File "<ipython-input-11-3388f6c54c37>", line 1236, in <lambda>
    data_recent['days_month'] = data_recent[Info.col_month].apply(lambda x:  calendar.monthrange(int(x[:4]), int(x[4:]))[1])
TypeError: 'int' object is not subscriptable
20220322-16:51:42  手动衍生_py10个字段: {'monthsaready_last_stop_date': '最后停机时间：已发生时长', 'monthsremain_last_stop_date': '最后停机时间：剩余时长', 'days_gprs_p': '上网天数占比', 'days_call_p': '通话天数占比', 'days_call_p_1': '通话天数占比_1', 'days_call_p_2': '通话天数占比_2', 'days_call_p_3': '通话天数占比_3', 'days_call_p_4': '通话天数占比_4', 'greatest_gprs_app': 'app偏好', 'paste_dinner_innet_months': '主套餐、入网时长：交叉'}


Traceback (most recent call last):
  File "C:\Users\higher\Anaconda3\lib\site-packages\IPython\core\interactiveshell.py", line 2961, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-59-a429f7d6797b>", line 1, in <module>
    data_recent, col_need_ad = manual_fun(data_recent, Info, field_manual)
  File "<ipython-input-11-3388f6c54c37>", line 1236, in manual_fun
    data_recent['days_month'] = data_recent[Info.col_month].apply(lambda x:  calendar.monthrange(int(x[:4]), int(x[4:]))[1])
  File "C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\series.py", line 3194, in apply
    mapped = lib.map_infer(values, f, convert=convert_dtype)
  File "pandas/_libs/src\inference.pyx", line 1472, in pandas._libs.lib.map_infer
  File "<ipython-input-11-3388f6c54c37>", line 1236, in <lambda>
    data_recent['days_month'] = data_recent[Info.col_month].apply(lambda x:  calendar.monthrange(int(x[:4]), int(x[4:]))[1])
TypeError: 'int' object is not subscriptable
20220322-16:51:45  数据量: (9780, 67)

                   Out[61]: 20220322-16:51:57  
                                        field_name                   comment dtype_classify    field_src available available_notzd  available_zd                                            formula remark must_remain into_model is_cause  NaN  NaN  NaN  NaN  NaN  NaN
                   12  monthsaready_last_stop_date  最后停机时间：已发生时长         数值型  手动衍生_py       NaN             NaN           NaN                      current_date - last_stop_date    NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   13  monthsremain_last_stop_date    最后停机时间：剩余时长         数值型  手动衍生_py       NaN             NaN           NaN                      last_stop_date - current_date    NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   58                  days_gprs_p              上网天数占比         数值型  手动衍生_py       NaN             NaN           NaN                             days_gprs / days_month    NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   60                  days_call_p              通话天数占比         数值型  手动衍生_py       NaN             NaN           NaN                             days_call / days_month    NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   61                days_call_p_1            通话天数占比_1         数值型  手动衍生_py       NaN             NaN           NaN                            days_call_p + days_gprs    NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   62                days_call_p_2            通话天数占比_2         数值型  手动衍生_py       NaN             NaN           NaN                          days_call_p_1 + days_gprs    NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   63                days_call_p_3            通话天数占比_3         数值型  手动衍生_py       NaN             NaN           NaN                          days_call_p_2 + days_gprs    NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   64                days_call_p_4            通话天数占比_4         数值型  手动衍生_py       NaN             NaN           NaN                          days_call_p_3 + days_gprs    NaN          是        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   79            greatest_gprs_app                   app偏好         类别型  手动衍生_py       NaN             NaN           NaN  {'gprs_flow_video': 'video', 'gprs_flow_short'...    NaN          是        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   80    paste_dinner_innet_months    主套餐、入网时长：交叉         类别型  手动衍生_py       NaN             NaN           NaN                             (dinner, innet_months)    NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
20220322-16:52:14  手动衍生_py10个字段: {'monthsaready_last_stop_date': '最后停机时间：已发生时长', 'monthsremain_last_stop_date': '最后停机时间：剩余时长', 'days_gprs_p': '上网天数占比', 'days_call_p': '通话天数占比', 'days_call_p_1': '通话天数占比_1', 'days_call_p_2': '通话天数占比_2', 'days_call_p_3': '通话天数占比_3', 'days_call_p_4': '通话天数占比_4', 'greatest_gprs_app': 'app偏好', 'paste_dinner_innet_months': '主套餐、入网时长：交叉'}


Traceback (most recent call last):
  File "C:\Users\higher\Anaconda3\lib\site-packages\IPython\core\interactiveshell.py", line 2961, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-63-12459ae059a3>", line 13, in <module>
    data_recent['days_month'] = data_recent[Info.col_month].apply(lambda x:  calendar.monthrange(int(x[:4]), int(x[4:]))[1])
  File "C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\series.py", line 3194, in apply
    mapped = lib.map_infer(values, f, convert=convert_dtype)
  File "pandas/_libs/src\inference.pyx", line 1472, in pandas._libs.lib.map_infer
  File "<ipython-input-63-12459ae059a3>", line 13, in <lambda>
    data_recent['days_month'] = data_recent[Info.col_month].apply(lambda x:  calendar.monthrange(int(x[:4]), int(x[4:]))[1])
TypeError: 'int' object is not subscriptable
20220322-16:52:27  手动衍生_py10个字段: {'monthsaready_last_stop_date': '最后停机时间：已发生时长', 'monthsremain_last_stop_date': '最后停机时间：剩余时长', 'days_gprs_p': '上网天数占比', 'days_call_p': '通话天数占比', 'days_call_p_1': '通话天数占比_1', 'days_call_p_2': '通话天数占比_2', 'days_call_p_3': '通话天数占比_3', 'days_call_p_4': '通话天数占比_4', 'greatest_gprs_app': 'app偏好', 'paste_dinner_innet_months': '主套餐、入网时长：交叉'}


Traceback (most recent call last):
  File "C:\Users\higher\Anaconda3\lib\site-packages\IPython\core\interactiveshell.py", line 2961, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-66-4bcbeed25ea4>", line 3, in <module>
    data_recent['days_month'] = data_recent[Info.col_month].apply(lambda x:  calendar.monthrange(int(x[:4]), int(x[4:]))[1])
  File "C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\series.py", line 3194, in apply
    mapped = lib.map_infer(values, f, convert=convert_dtype)
  File "pandas/_libs/src\inference.pyx", line 1472, in pandas._libs.lib.map_infer
  File "<ipython-input-66-4bcbeed25ea4>", line 3, in <lambda>
    data_recent['days_month'] = data_recent[Info.col_month].apply(lambda x:  calendar.monthrange(int(x[:4]), int(x[4:]))[1])
TypeError: 'int' object is not subscriptable
                   Out[67]: 20220322-16:52:36  'acct_month'
                   Out[68]: 20220322-16:52:40  
                   0       202011
                   1       202011
                   2       202011
                   3       202011
                   4       202011
                   5       202011
                   6       202011
                   7       202011
                   8       202011
                   9       202011
                   10      202011
                   11      202011
                   12      202011
                   13      202011
                   14      202011
                   15      202011
                   16      202011
                   17      202011
                   18      202011
                   19      202011
                   20      202011
                   21      202011
                   22      202011
                   23      202011
                   24      202011
                   25      202011
                   26      202011
                   27      202011
                   28      202011
                   29      202011
                   30      202011
                   31      202011
                   32      202011
                   33      202011
                   34      202011
                   35      202011
                   36      202011
                   37      202011
                   38      202011
                   39      202011
                   40      202011
                   41      202011
                   42      202011
                   43      202011
                   44      202011
                   45      202011
                   46      202011
                   47      202011
                   48      202011
                   49      202011
                   50      202011
                   51      202011
                   52      202011
                   53      202011
                   54      202011
                   55      202011
                   56      202011
                   57      202011
                   58      202011
                   59      202011
                   60      202011
                   61      202011
                   62      202011
                   63      202011
                   64      202011
                   65      202011
                   66      202011
                   67      202011
                   68      202011
                   69      202011
                   70      202011
                   71      202011
                   72      202011
                   73      202011
                   74      202011
                   75      202011
                   76      202011
                   77      202011
                   78      202011
                   79      202011
                   80      202011
                   81      202011
                   82      202011
                   83      202011
                   84      202011
                   85      202011
                   86      202011
                   87      202011
                   88      202011
                   89      202011
                   90      202011
                   91      202011
                   92      202011
                   93      202011
                   94      202011
                   95      202011
                   96      202011
                   97      202011
                   98      202011
                   99      202011
                   100     202011
                   101     202011
                   102     202011
                   103     202011
                   104     202011
                   105     202011
                   106     202011
                   107     202011
                   108     202011
                   109     202011
                   110     202011
                   111     202011
                   112     202011
                   113     202011
                   114     202011
                   115     202011
                   116     202011
                   117     202011
                   118     202011
                   119     202011
                   120     202011
                   121     202011
                   122     202011
                   123     202011
                   124     202011
                   125     202011
                   126     202011
                   127     202011
                   128     202011
                   129     202011
                   130     202011
                   131     202011
                   132     202011
                   133     202011
                   134     202011
                   135     202011
                   136     202011
                   137     202011
                   138     202011
                   139     202011
                   140     202011
                   141     202011
                   142     202011
                   143     202011
                   144     202011
                   145     202011
                   146     202011
                   147     202011
                   148     202011
                   149     202011
                   150     202011
                   151     202011
                   152     202011
                   153     202011
                   154     202011
                   155     202011
                   156     202011
                   157     202011
                   158     202011
                   159     202011
                   160     202011
                   161     202011
                   162     202011
                   163     202011
                   164     202011
                   165     202011
                   166     202011
                   167     202011
                   168     202011
                   169     202011
                   170     202011
                   171     202011
                   172     202011
                   173     202011
                   174     202011
                   175     202011
                   176     202011
                   177     202011
                   178     202011
                   179     202011
                   180     202011
                   181     202011
                   182     202011
                   183     202011
                   184     202011
                   185     202011
                   186     202011
                   187     202011
                   188     202011
                   189     202011
                   190     202011
                   191     202011
                   192     202011
                   193     202011
                   194     202011
                   195     202011
                   196     202011
                   197     202011
                   198     202011
                   199     202011
                   200     202011
                   201     202011
                   202     202011
                   203     202011
                   204     202011
                   205     202011
                   206     202011
                   207     202011
                   208     202011
                   209     202011
                   210     202011
                   211     202011
                   212     202011
                   213     202011
                   214     202011
                   215     202011
                   216     202011
                   217     202011
                   218     202011
                   219     202011
                   220     202011
                   221     202011
                   222     202011
                   223     202011
                   224     202011
                   225     202011
                   226     202011
                   227     202011
                   228     202011
                   229     202011
                   230     202011
                   231     202011
                   232     202011
                   233     202011
                   234     202011
                   235     202011
                   236     202011
                   237     202011
                   238     202011
                   239     202011
                   240     202011
                   241     202011
                   242     202011
                   243     202011
                   244     202011
                   245     202011
                   246     202011
                   247     202011
                   248     202011
                   249     202011
                            ...  
                   9530    202010
                   9531    202010
                   9532    202010
                   9533    202010
                   9534    202010
                   9535    202010
                   9536    202010
                   9537    202010
                   9538    202010
                   9539    202010
                   9540    202010
                   9541    202010
                   9542    202010
                   9543    202010
                   9544    202010
                   9545    202010
                   9546    202010
                   9547    202010
                   9548    202010
                   9549    202010
                   9550    202010
                   9551    202010
                   9552    202010
                   9553    202010
                   9554    202010
                   9555    202010
                   9556    202010
                   9557    202010
                   9558    202010
                   9559    202010
                   9560    202010
                   9561    202010
                   9562    202010
                   9563    202010
                   9564    202010
                   9565    202010
                   9566    202010
                   9567    202010
                   9568    202010
                   9569    202010
                   9570    202010
                   9571    202010
                   9572    202010
                   9573    202010
                   9574    202010
                   9575    202010
                   9576    202010
                   9577    202010
                   9578    202010
                   9579    202010
                   9580    202010
                   9581    202010
                   9582    202010
                   9583    202010
                   9584    202010
                   9585    202010
                   9586    202010
                   9587    202010
                   9588    202010
                   9589    202010
                   9590    202010
                   9591    202010
                   9592    202010
                   9593    202010
                   9594    202010
                   9595    202010
                   9596    202010
                   9597    202010
                   9598    202010
                   9599    202010
                   9600    202010
                   9601    202010
                   9602    202010
                   9603    202010
                   9604    202010
                   9605    202010
                   9606    202010
                   9607    202010
                   9608    202010
                   9609    202010
                   9610    202010
                   9611    202010
                   9612    202010
                   9613    202010
                   9614    202010
                   9615    202010
                   9616    202010
                   9617    202010
                   9618    202010
                   9619    202010
                   9620    202010
                   9621    202010
                   9622    202010
                   9623    202010
                   9624    202010
                   9625    202010
                   9626    202010
                   9627    202010
                   9628    202010
                   9629    202010
                   9630    202010
                   9631    202010
                   9632    202010
                   9633    202010
                   9634    202010
                   9635    202010
                   9636    202010
                   9637    202010
                   9638    202010
                   9639    202010
                   9640    202010
                   9641    202010
                   9642    202010
                   9643    202010
                   9644    202010
                   9645    202010
                   9646    202010
                   9647    202010
                   9648    202010
                   9649    202010
                   9650    202010
                   9651    202010
                   9652    202010
                   9653    202010
                   9654    202010
                   9655    202010
                   9656    202010
                   9657    202010
                   9658    202010
                   9659    202010
                   9660    202010
                   9661    202010
                   9662    202010
                   9663    202010
                   9664    202010
                   9665    202010
                   9666    202010
                   9667    202010
                   9668    202010
                   9669    202010
                   9670    202010
                   9671    202010
                   9672    202010
                   9673    202010
                   9674    202010
                   9675    202010
                   9676    202010
                   9677    202010
                   9678    202010
                   9679    202010
                   9680    202010
                   9681    202010
                   9682    202010
                   9683    202010
                   9684    202010
                   9685    202010
                   9686    202010
                   9687    202010
                   9688    202010
                   9689    202010
                   9690    202010
                   9691    202010
                   9692    202010
                   9693    202010
                   9694    202010
                   9695    202010
                   9696    202010
                   9697    202010
                   9698    202010
                   9699    202010
                   9700    202010
                   9701    202010
                   9702    202010
                   9703    202010
                   9704    202010
                   9705    202010
                   9706    202010
                   9707    202010
                   9708    202010
                   9709    202010
                   9710    202010
                   9711    202010
                   9712    202010
                   9713    202010
                   9714    202010
                   9715    202010
                   9716    202010
                   9717    202010
                   9718    202010
                   9719    202010
                   9720    202010
                   9721    202010
                   9722    202010
                   9723    202010
                   9724    202010
                   9725    202010
                   9726    202010
                   9727    202010
                   9728    202010
                   9729    202010
                   9730    202010
                   9731    202010
                   9732    202010
                   9733    202010
                   9734    202010
                   9735    202010
                   9736    202010
                   9737    202010
                   9738    202010
                   9739    202010
                   9740    202010
                   9741    202010
                   9742    202010
                   9743    202010
                   9744    202010
                   9745    202010
                   9746    202010
                   9747    202010
                   9748    202010
                   9749    202010
                   9750    202010
                   9751    202010
                   9752    202010
                   9753    202010
                   9754    202010
                   9755    202010
                   9756    202010
                   9757    202010
                   9758    202010
                   9759    202010
                   9760    202010
                   9761    202010
                   9762    202010
                   9763    202010
                   9764    202010
                   9765    202010
                   9766    202010
                   9767    202010
                   9768    202010
                   9769    202010
                   9770    202010
                   9771    202010
                   9772    202010
                   9773    202010
                   9774    202010
                   9775    202010
                   9776    202010
                   9777    202010
                   9778    202010
                   9779    202010
                   Name: acct_month, Length: 9780, dtype: int64
20220322-16:53:35  手动衍生_py10个字段: {'monthsaready_last_stop_date': '最后停机时间：已发生时长', 'monthsremain_last_stop_date': '最后停机时间：剩余时长', 'days_gprs_p': '上网天数占比', 'days_call_p': '通话天数占比', 'days_call_p_1': '通话天数占比_1', 'days_call_p_2': '通话天数占比_2', 'days_call_p_3': '通话天数占比_3', 'days_call_p_4': '通话天数占比_4', 'greatest_gprs_app': 'app偏好', 'paste_dinner_innet_months': '主套餐、入网时长：交叉'}
20220322-16:53:35  monthsaready_last_stop_date: current_date - last_stop_date
20220322-16:53:36      将 monthsaready_last_stop_date 字段的 4 个缺失值赋值为: -99999 （非缺失的最小值-2.0）
20220322-16:53:36  monthsremain_last_stop_date: last_stop_date - current_date
20220322-16:53:37      将 monthsremain_last_stop_date 字段的 4 个缺失值赋值为: -99999 （非缺失的最小值-101.0）
20220322-16:53:37  days_gprs_p: days_gprs / days_month
20220322-16:53:38  days_call_p: days_call / days_month
20220322-16:53:38  days_call_p_1: days_call_p + days_gprs
20220322-16:53:38  days_call_p_2: days_call_p_1 + days_gprs
20220322-16:53:38  days_call_p_3: days_call_p_2 + days_gprs
20220322-16:53:38  days_call_p_4: days_call_p_3 + days_gprs
20220322-16:53:38  greatest_gprs_app: {'gprs_flow_video': 'video', 'gprs_flow_short': 'short', 'gprs_flow_music': 'music', 'gprs_flow_commu': 'commu', 'gprs_flow_game': 'game'}


Traceback (most recent call last):
  File "C:\Users\higher\Anaconda3\lib\site-packages\IPython\core\interactiveshell.py", line 2961, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-72-a429f7d6797b>", line 1, in <module>
    data_recent, col_need_ad = manual_fun(data_recent, Info, field_manual)
  File "<ipython-input-70-06586aebb743>", line 67, in manual_fun
    data_recent[field_name_i] = now_greatest_fun(data_recent, greatest_dict, Info, col_add=None)[0]
  File "<ipython-input-11-3388f6c54c37>", line 1205, in now_greatest_fun
    data[c] = data[k_v.keys()].apply(greatest_fun, axis=1)
  File "C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\frame.py", line 2688, in __getitem__
    return self._getitem_column(key)
  File "C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\frame.py", line 2695, in _getitem_column
    return self._get_item_cache(key)
  File "C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\generic.py", line 2487, in _get_item_cache
    res = cache.get(item)
TypeError: unhashable type: 'dict_keys'
20220322-16:54:13  手动衍生_py10个字段: {'monthsaready_last_stop_date': '最后停机时间：已发生时长', 'monthsremain_last_stop_date': '最后停机时间：剩余时长', 'days_gprs_p': '上网天数占比', 'days_call_p': '通话天数占比', 'days_call_p_1': '通话天数占比_1', 'days_call_p_2': '通话天数占比_2', 'days_call_p_3': '通话天数占比_3', 'days_call_p_4': '通话天数占比_4', 'greatest_gprs_app': 'app偏好', 'paste_dinner_innet_months': '主套餐、入网时长：交叉'}
20220322-16:54:30  monthsaready_last_stop_date: current_date - last_stop_date
20220322-16:54:31      将 monthsaready_last_stop_date 字段的 4 个缺失值赋值为: -99999 （非缺失的最小值-2.0）
20220322-16:54:31  monthsremain_last_stop_date: last_stop_date - current_date
20220322-16:54:31      将 monthsremain_last_stop_date 字段的 4 个缺失值赋值为: -99999 （非缺失的最小值-101.0）
20220322-16:54:32  days_gprs_p: days_gprs / days_month
20220322-16:54:32  days_call_p: days_call / days_month
20220322-16:54:32  days_call_p_1: days_call_p + days_gprs
20220322-16:54:32  days_call_p_2: days_call_p_1 + days_gprs
20220322-16:54:32  days_call_p_3: days_call_p_2 + days_gprs
20220322-16:54:32  days_call_p_4: days_call_p_3 + days_gprs
20220322-16:54:32  greatest_gprs_app: {'gprs_flow_video': 'video', 'gprs_flow_short': 'short', 'gprs_flow_music': 'music', 'gprs_flow_commu': 'commu', 'gprs_flow_game': 'game'}


Traceback (most recent call last):
  File "C:\Users\higher\Anaconda3\lib\site-packages\IPython\core\interactiveshell.py", line 2961, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-74-5bdafad1dd0a>", line 40, in <module>
    data_recent[field_name_i] = now_greatest_fun(data_recent, greatest_dict, Info, col_add=None)[0]
  File "<ipython-input-11-3388f6c54c37>", line 1205, in now_greatest_fun
    data[c] = data[k_v.keys()].apply(greatest_fun, axis=1)
  File "C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\frame.py", line 2688, in __getitem__
    return self._getitem_column(key)
  File "C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\frame.py", line 2695, in _getitem_column
    return self._get_item_cache(key)
  File "C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\generic.py", line 2487, in _get_item_cache
    res = cache.get(item)
TypeError: unhashable type: 'dict_keys'
                   Out[75]: 20220322-16:54:46  'greatest_gprs_app'
                   Out[76]: 20220322-16:54:49  "{'gprs_flow_video': 'video', 'gprs_flow_short': 'short', 'gprs_flow_music': 'music', 'gprs_flow_commu': 'commu', 'gprs_flow_game': 'game'}"
                   Out[78]: 20220322-16:55:13  True


Traceback (most recent call last):
  File "C:\Users\higher\Anaconda3\lib\site-packages\IPython\core\interactiveshell.py", line 2961, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-79-8c1f9c47970b>", line 1, in <module>
    data_recent[field_name_i] = now_greatest_fun(data_recent, greatest_dict, Info, col_add=None)[0]
  File "<ipython-input-11-3388f6c54c37>", line 1205, in now_greatest_fun
    data[c] = data[k_v.keys()].apply(greatest_fun, axis=1)
  File "C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\frame.py", line 2688, in __getitem__
    return self._getitem_column(key)
  File "C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\frame.py", line 2695, in _getitem_column
    return self._get_item_cache(key)
  File "C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\generic.py", line 2487, in _get_item_cache
    res = cache.get(item)
TypeError: unhashable type: 'dict_keys'
                   Out[80]: 20220322-16:55:24  
                   {'greatest_gprs_app': {'gprs_flow_video': 'video',
                     'gprs_flow_short': 'short',
                     'gprs_flow_music': 'music',
                     'gprs_flow_commu': 'commu',
                     'gprs_flow_game': 'game'}}


Traceback (most recent call last):
  File "C:\Users\higher\Anaconda3\lib\site-packages\IPython\core\interactiveshell.py", line 2961, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-81-dfd10803975d>", line 3, in <module>
    data_recent[field_name_i] = now_greatest_fun(data_recent, greatest_dict, Info, col_add=None)[0]
  File "<ipython-input-11-3388f6c54c37>", line 1204, in now_greatest_fun
    for c, k_v in greatest_dict.items():
AttributeError: 'list' object has no attribute 'items'


Traceback (most recent call last):
  File "C:\Users\higher\Anaconda3\lib\site-packages\IPython\core\interactiveshell.py", line 2961, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-83-10dd9dc9aa8a>", line 1, in <module>
    test_f
NameError: name 'test_f' is not defined
                   Out[84]: 20220322-16:56:12  float


Traceback (most recent call last):
  File "C:\Users\higher\Anaconda3\lib\site-packages\IPython\core\interactiveshell.py", line 2961, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-85-8c1f9c47970b>", line 1, in <module>
    data_recent[field_name_i] = now_greatest_fun(data_recent, greatest_dict, Info, col_add=None)[0]
  File "<ipython-input-11-3388f6c54c37>", line 1205, in now_greatest_fun
    data[c] = data[k_v.keys()].apply(greatest_fun, axis=1)
  File "C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\frame.py", line 2688, in __getitem__
    return self._getitem_column(key)
  File "C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\frame.py", line 2695, in _getitem_column
    return self._get_item_cache(key)
  File "C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\generic.py", line 2487, in _get_item_cache
    res = cache.get(item)
TypeError: unhashable type: 'dict_keys'
20220322-16:57:36  ------------------------- 读取数据: ml.mid_eg_recent_train_202011 2022-03-22 16:57:36 -------------------------
20220322-16:57:36      src: gp
20220322-16:57:36      condition: data_use='data_train'
20220322-16:57:36      col_need(67): ['user_acct_month', 'data_use', 'acct_month', 'user_id', 'innet_months', 'age', 'dinner_fee', 'gprs_last_defer', 'gprs_resource', 'gprs_now_rest', 'call_use', 'arpu', 'pay_cnt', 'pay_fee', 'acct_balance', 'calling_cnt', 'calling_dura', 'called_cnt', 'calling_diff_cnt', 'calling_diff_dura', 'gprs_flow', 'gprs_flow_4g', 'gprs_flow_5g', 'gprs_flow_busy', 'gprs_flow_idle', 'gprs_now_defer', 'gprs_flow_roam', 'call_dura_roam', 'gprs_flow_gat', 'days_gat', 'days_gprs', 'days_call', 'nos_call', 'nos_calling', 'nos_calling_diff', 'sms_cnt', 'call_fee_local', 'call_fee_roam', 'gprs_income', 'gprs_fee', 'call_fee', 'gprs_flow_video', 'gprs_flow_short', 'gprs_flow_music', 'gprs_flow_commu', 'gprs_flow_game', 'innet_date', 'last_stop_date', 'phone_no_null', 'phone_no_tm', 'dinner_id', 'account_id', 'sex', 'user_status', 'dinner', 'if_nolimit', 'if_5g_dinner', 'if_5g_term', 'if_jt', 'start_level', 'if_cred_multi', 'term_model', 'term_brand', 'term_type', 'sk_type', 'if_new_term', 'flag_eg']
20220322-16:57:36      col_del: None
20220322-16:57:36      col_char: None
20220322-16:57:36      col_num(42): ['innet_months', 'age', 'dinner_fee', 'gprs_last_defer', 'gprs_resource', 'gprs_now_rest', 'call_use', 'arpu', 'pay_cnt', 'pay_fee', 'acct_balance', 'calling_cnt', 'calling_dura', 'called_cnt', 'calling_diff_cnt', 'calling_diff_dura', 'gprs_flow', 'gprs_flow_4g', 'gprs_flow_5g', 'gprs_flow_busy', 'gprs_flow_idle', 'gprs_now_defer', 'gprs_flow_roam', 'call_dura_roam', 'gprs_flow_gat', 'days_gat', 'days_gprs', 'days_call', 'nos_call', 'nos_calling', 'nos_calling_diff', 'sms_cnt', 'call_fee_local', 'call_fee_roam', 'gprs_income', 'gprs_fee', 'call_fee', 'gprs_flow_video', 'gprs_flow_short', 'gprs_flow_music', 'gprs_flow_commu', 'gprs_flow_game']
20220322-16:57:37      col_date(2): ['innet_date', 'last_stop_date']
20220322-16:57:37      nrows: None
20220322-16:57:37      if_coltolower: True
20220322-16:57:37      kwargs: {}

20220322-16:57:38      读取
20220322-16:57:39      shape: (9780, 67)

20220322-16:57:39  -------------------------读取完毕: (9780, 67) 2022-03-22 16:57:39 -------------------------

20220322-16:57:41  手动衍生_py10个字段: {'monthsaready_last_stop_date': '最后停机时间：已发生时长', 'monthsremain_last_stop_date': '最后停机时间：剩余时长', 'days_gprs_p': '上网天数占比', 'days_call_p': '通话天数占比', 'days_call_p_1': '通话天数占比_1', 'days_call_p_2': '通话天数占比_2', 'days_call_p_3': '通话天数占比_3', 'days_call_p_4': '通话天数占比_4', 'greatest_gprs_app': 'app偏好', 'paste_dinner_innet_months': '主套餐、入网时长：交叉'}
20220322-16:57:41  monthsaready_last_stop_date: current_date - last_stop_date
20220322-16:57:42      将 monthsaready_last_stop_date 字段的 4 个缺失值赋值为: -99999 （非缺失的最小值-2.0）
20220322-16:57:42  monthsremain_last_stop_date: last_stop_date - current_date
20220322-16:57:42      将 monthsremain_last_stop_date 字段的 4 个缺失值赋值为: -99999 （非缺失的最小值-101.0）
20220322-16:57:43  days_gprs_p: days_gprs / days_month
20220322-16:57:43  days_call_p: days_call / days_month
20220322-16:57:43  days_call_p_1: days_call_p + days_gprs
20220322-16:57:43  days_call_p_2: days_call_p_1 + days_gprs
20220322-16:57:43  days_call_p_3: days_call_p_2 + days_gprs
20220322-16:57:43  days_call_p_4: days_call_p_3 + days_gprs
20220322-16:57:43  greatest_gprs_app: {'gprs_flow_video': 'video', 'gprs_flow_short': 'short', 'gprs_flow_music': 'music', 'gprs_flow_commu': 'commu', 'gprs_flow_game': 'game'}
20220322-16:57:46  paste_dinner_innet_months: (dinner, innet_months)


C:\Program Files\JetBrains\PyCharm 2020.3.3\plugins\python\helpers\pydev\pydevconsole.py:1047: UserWarning: opera_pair_fun paste时存在非类别型字段，请确认: ['innet_months']
20220322-16:58:58  数据量: (9780, 77)

20220322-16:58:58  检查数据
20220322-16:58:58  各账期数据量分布：
                       202009  data_train    3255
                       202010  data_train    3255
                       202011  data_train    3270
                       dtype: int64
20220322-16:58:58  各账期数据量不一致
20220322-16:58:58  以nan填充缺少账期的记录
20220322-16:58:58      修改后：
                       202009  data_train    3270
                       202010  data_train    3270
                       202011  data_train    3270
                       dtype: int64)
20220322-16:58:58  
                   diff_limitweiNone,不考察近n月字段各账期取值分布, dis_exam返回None！

20220322-16:58:58  字段类型分布: 
                       float64    53
                       object    21
                       datetime64[ns]    2
                       int64    1
                       dtype: int64


C:\Program Files\JetBrains\PyCharm 2020.3.3\plugins\python\helpers\pydev\pydevconsole.py:23: UserWarning: field_base中未包括下列字段，但实际数据 多出：{'user_acct_month', 'data_use'}
  fix_getpass.fix_getpass()


C:\Program Files\JetBrains\PyCharm 2020.3.3\plugins\python\helpers\pydev\pydevconsole.py:26: UserWarning: field_base中未规定下列字段数据类型，请确认默认类型是否正确：{'user_acct_month': 'object', 'data_use': 'object'}
  


20220322-16:58:58  填充数值型&类别型字段缺失值
20220322-16:58:58  日期型字段缺失值情况：
                       innet_date    30
                       last_stop_date    34
                       dtype: int64

20220322-16:59:05  正负例分布：
                       data_train  202011  0.0    2180
                       data_train  202011  1.0    1090
                       dtype: int64

                   ----------------------------------------- 当月 数值型&类别型 原始数据 
20220322-16:59:05  新数据newdata的shape：(3270, 71)
20220322-16:59:05  数据转换


C:\Users\higher\Desktop\to伟鹏的代码_v2\ModelProject\selfmodule\toolmodule\dataprep.py:463: UserWarning:     FeaturePrefilter_DF unique_limit(5000)小于X行数(3270), 添加unique_limit_actual：len(X)*0.99=3237
  warnings.warn(s)


Traceback (most recent call last):
  File "<ipython-input-11-3388f6c54c37>", line 1509, in table_add_fun
    newdata_pipe = pipeline.fit_transform(newdata.drop(columns=de), newdata[Info.col_target])
  File "<string>", line 523, in fit_transform
  File "<string>", line 113, in fit
  File "C:\Users\higher\Anaconda3\lib\site-packages\sklearn\pipeline.py", line 330, in fit
    Xt = self._fit(X, y, **fit_params_steps)
  File "C:\Users\higher\Anaconda3\lib\site-packages\sklearn\pipeline.py", line 296, in _fit
    **fit_params_steps[name])
  File "C:\Users\higher\Anaconda3\lib\site-packages\joblib\memory.py", line 349, in __call__
    return self.func(*args, **kwargs)
  File "C:\Users\higher\Anaconda3\lib\site-packages\sklearn\pipeline.py", line 740, in _fit_transform_one
    res = transformer.fit_transform(X, y, **fit_params)
  File "<string>", line 523, in fit_transform
  File "<string>", line 113, in fit
  File "C:\Users\higher\Anaconda3\lib\site-packages\sklearn\pipeline.py", line 927, in fit
    transformers = self._parallel_func(X, y, fit_params, _fit_one)
  File "C:\Users\higher\Anaconda3\lib\site-packages\sklearn\pipeline.py", line 983, in _parallel_func
    weight) in enumerate(transformers, 1))
  File "C:\Users\higher\Anaconda3\lib\site-packages\joblib\parallel.py", line 1046, in __call__
    while self.dispatch_one_batch(iterator):
  File "C:\Users\higher\Anaconda3\lib\site-packages\joblib\parallel.py", line 861, in dispatch_one_batch
    self._dispatch(tasks)
  File "C:\Users\higher\Anaconda3\lib\site-packages\joblib\parallel.py", line 779, in _dispatch
    job = self._backend.apply_async(batch, callback=cb)
  File "C:\Users\higher\Anaconda3\lib\site-packages\joblib\_parallel_backends.py", line 208, in apply_async
    result = ImmediateResult(func)
  File "C:\Users\higher\Anaconda3\lib\site-packages\joblib\_parallel_backends.py", line 572, in __init__
    self.results = batch()
  File "C:\Users\higher\Anaconda3\lib\site-packages\joblib\parallel.py", line 263, in __call__
    for func, args, kwargs in self.items]
  File "C:\Users\higher\Anaconda3\lib\site-packages\joblib\parallel.py", line 263, in <listcomp>
    for func, args, kwargs in self.items]
  File "C:\Users\higher\Anaconda3\lib\site-packages\sklearn\pipeline.py", line 760, in _fit_one
    return transformer.fit(X, y, **fit_params)
  File "<string>", line 113, in fit
  File "C:\Users\higher\Anaconda3\lib\site-packages\sklearn\pipeline.py", line 335, in fit
    self._final_estimator.fit(Xt, y, **fit_params_last_step)
  File "<string>", line 111, in fit
  File "C:\Users\higher\Desktop\to伟鹏的代码_v2\ModelProject\selfmodule\toolmodule\dataprep.py", line 2093, in fit
    value_iv = woe_iv_fun(pd.get_dummies(X[i]), y, self.Pcase, self.Ncase)['col_iv']
  File "C:\Users\higher\Desktop\to伟鹏的代码_v2\ModelProject\selfmodule\toolmodule\dataprep.py", line 812, in _woe_iv
    raise Exception(f'WoeTransformer 参数y的取值为：{y_unique}，并不包括：\n{er}，请检查！')
Exception: WoeTransformer 参数y的取值为：[1. 0.]，并不包括：
Pcase    1
Ncase    0
dtype: object，请检查！
20220322-16:59:09  
                   During handling of the above exception, another exception occurred:


Traceback (most recent call last):
  File "C:\Users\higher\Anaconda3\lib\site-packages\IPython\core\interactiveshell.py", line 2961, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-92-e2ca01d42a6a>", line 38, in <module>
    res, comment_auto = stage_fun(Info, res, comment_auto, (data_now[col_now], None), stage, pipeline)
  File "<ipython-input-12-5e38877194fb>", line 76, in stage_fun
    res_new = table_add_fun(pipe, result[0], Info, res['table'], res['iv_accum'], res['woe_accum'])
  File "<ipython-input-11-3388f6c54c37>", line 1511, in table_add_fun
    raise Exception(er)
Exception: WoeTransformer 参数y的取值为：[1. 0.]，并不包括：
Pcase    1
Ncase    0
dtype: object，请检查！

                   ----------------------------------------- 当月 数值型&类别型 原始数据 
20220322-16:59:49  新数据newdata的shape：(3270, 71)
20220322-16:59:49  数据转换


C:\Users\higher\Desktop\to伟鹏的代码_v2\ModelProject\selfmodule\toolmodule\dataprep.py:463: UserWarning:     FeaturePrefilter_DF unique_limit(5000)小于X行数(3270), 添加unique_limit_actual：len(X)*0.99=3237
  warnings.warn(s)


Traceback (most recent call last):
  File "<ipython-input-11-3388f6c54c37>", line 1509, in table_add_fun
    newdata_pipe = pipeline.fit_transform(newdata.drop(columns=de), newdata[Info.col_target])
  File "<string>", line 523, in fit_transform
  File "<string>", line 113, in fit
  File "C:\Users\higher\Anaconda3\lib\site-packages\sklearn\pipeline.py", line 330, in fit
    Xt = self._fit(X, y, **fit_params_steps)
  File "C:\Users\higher\Anaconda3\lib\site-packages\sklearn\pipeline.py", line 296, in _fit
    **fit_params_steps[name])
  File "C:\Users\higher\Anaconda3\lib\site-packages\joblib\memory.py", line 349, in __call__
    return self.func(*args, **kwargs)
  File "C:\Users\higher\Anaconda3\lib\site-packages\sklearn\pipeline.py", line 740, in _fit_transform_one
    res = transformer.fit_transform(X, y, **fit_params)
  File "<string>", line 523, in fit_transform
  File "<string>", line 113, in fit
  File "C:\Users\higher\Anaconda3\lib\site-packages\sklearn\pipeline.py", line 927, in fit
    transformers = self._parallel_func(X, y, fit_params, _fit_one)
  File "C:\Users\higher\Anaconda3\lib\site-packages\sklearn\pipeline.py", line 983, in _parallel_func
    weight) in enumerate(transformers, 1))
  File "C:\Users\higher\Anaconda3\lib\site-packages\joblib\parallel.py", line 1046, in __call__
    while self.dispatch_one_batch(iterator):
  File "C:\Users\higher\Anaconda3\lib\site-packages\joblib\parallel.py", line 861, in dispatch_one_batch
    self._dispatch(tasks)
  File "C:\Users\higher\Anaconda3\lib\site-packages\joblib\parallel.py", line 779, in _dispatch
    job = self._backend.apply_async(batch, callback=cb)
  File "C:\Users\higher\Anaconda3\lib\site-packages\joblib\_parallel_backends.py", line 208, in apply_async
    result = ImmediateResult(func)
  File "C:\Users\higher\Anaconda3\lib\site-packages\joblib\_parallel_backends.py", line 572, in __init__
    self.results = batch()
  File "C:\Users\higher\Anaconda3\lib\site-packages\joblib\parallel.py", line 263, in __call__
    for func, args, kwargs in self.items]
  File "C:\Users\higher\Anaconda3\lib\site-packages\joblib\parallel.py", line 263, in <listcomp>
    for func, args, kwargs in self.items]
  File "C:\Users\higher\Anaconda3\lib\site-packages\sklearn\pipeline.py", line 760, in _fit_one
    return transformer.fit(X, y, **fit_params)
  File "<string>", line 113, in fit
  File "C:\Users\higher\Anaconda3\lib\site-packages\sklearn\pipeline.py", line 335, in fit
    self._final_estimator.fit(Xt, y, **fit_params_last_step)
  File "<string>", line 111, in fit
  File "C:\Users\higher\Desktop\to伟鹏的代码_v2\ModelProject\selfmodule\toolmodule\dataprep.py", line 2093, in fit
    value_iv = woe_iv_fun(pd.get_dummies(X[i]), y, self.Pcase, self.Ncase)['col_iv']
  File "C:\Users\higher\Desktop\to伟鹏的代码_v2\ModelProject\selfmodule\toolmodule\dataprep.py", line 812, in _woe_iv
    raise Exception(f'WoeTransformer 参数y的取值为：{y_unique}，并不包括：\n{er}，请检查！')
Exception: WoeTransformer 参数y的取值为：[1. 0.]，并不包括：
Pcase    1
Ncase    0
dtype: object，请检查！
20220322-16:59:53  
                   During handling of the above exception, another exception occurred:


Traceback (most recent call last):
  File "C:\Users\higher\Anaconda3\lib\site-packages\IPython\core\interactiveshell.py", line 2961, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-94-9da14b4663a3>", line 1, in <module>
    res, comment_auto = stage_fun(Info, res, comment_auto, (data_now[col_now], None), stage, pipeline)
  File "<ipython-input-12-5e38877194fb>", line 76, in stage_fun
    res_new = table_add_fun(pipe, result[0], Info, res['table'], res['iv_accum'], res['woe_accum'])
  File "<ipython-input-11-3388f6c54c37>", line 1511, in table_add_fun
    raise Exception(er)
Exception: WoeTransformer 参数y的取值为：[1. 0.]，并不包括：
Pcase    1
Ncase    0
dtype: object，请检查！
                   Out[95]: 20220322-17:00:37  
                   0              1.0
                   1              1.0
                   2              1.0
                   3              1.0
                   4              1.0
                   5              1.0
                   6              1.0
                   7              1.0
                   8              1.0
                   9              1.0
                   10             1.0
                   11             1.0
                   12             1.0
                   13             1.0
                   14             1.0
                   15             1.0
                   16             1.0
                   17             1.0
                   18             1.0
                   19             1.0
                   20             1.0
                   21             1.0
                   22             1.0
                   23             1.0
                   24             1.0
                   25             1.0
                   26             1.0
                   27             1.0
                   28             1.0
                   29             1.0
                   30             1.0
                   31             1.0
                   32             1.0
                   33             1.0
                   34             1.0
                   35             1.0
                   36             1.0
                   37             1.0
                   38             1.0
                   39             1.0
                   40             1.0
                   41             1.0
                   42             1.0
                   43             1.0
                   44             1.0
                   45             1.0
                   46             1.0
                   47             1.0
                   48             1.0
                   49             1.0
                   50             1.0
                   51             1.0
                   52             1.0
                   53             1.0
                   54             1.0
                   55             1.0
                   56             1.0
                   57             1.0
                   58             1.0
                   59             1.0
                   60             1.0
                   61             1.0
                   62             1.0
                   63             1.0
                   64             1.0
                   65             1.0
                   66             1.0
                   67             1.0
                   68             1.0
                   69             1.0
                   70             1.0
                   71             1.0
                   72             1.0
                   73             1.0
                   74             1.0
                   75             1.0
                   76             1.0
                   77             1.0
                   78             1.0
                   79             1.0
                   80             1.0
                   81             1.0
                   82             1.0
                   83             1.0
                   84             1.0
                   85             1.0
                   86             1.0
                   87             1.0
                   88             1.0
                   89             1.0
                   90             1.0
                   91             1.0
                   92             1.0
                   93             1.0
                   94             1.0
                   95             1.0
                   96             1.0
                   97             1.0
                   98             1.0
                   99             1.0
                   100            1.0
                   101            1.0
                   102            1.0
                   103            1.0
                   104            1.0
                   105            1.0
                   106            1.0
                   107            1.0
                   108            1.0
                   109            1.0
                   110            1.0
                   111            1.0
                   112            1.0
                   113            1.0
                   114            1.0
                   115            1.0
                   116            1.0
                   117            1.0
                   118            1.0
                   119            1.0
                   120            1.0
                   121            1.0
                   122            1.0
                   123            1.0
                   124            1.0
                   125            1.0
                   126            1.0
                   127            1.0
                   128            1.0
                   129            1.0
                   130            1.0
                   131            1.0
                   132            1.0
                   133            1.0
                   134            1.0
                   135            1.0
                   136            1.0
                   137            1.0
                   138            1.0
                   139            1.0
                   140            1.0
                   141            1.0
                   142            1.0
                   143            1.0
                   144            1.0
                   145            1.0
                   146            1.0
                   147            1.0
                   148            1.0
                   149            1.0
                   150            1.0
                   151            1.0
                   152            1.0
                   153            1.0
                   154            1.0
                   155            1.0
                   156            1.0
                   157            1.0
                   158            1.0
                   159            1.0
                   160            1.0
                   161            1.0
                   162            1.0
                   163            1.0
                   164            1.0
                   165            1.0
                   166            1.0
                   167            1.0
                   168            1.0
                   169            1.0
                   170            1.0
                   171            1.0
                   172            1.0
                   173            1.0
                   174            1.0
                   175            1.0
                   176            1.0
                   177            1.0
                   178            1.0
                   179            1.0
                   180            1.0
                   181            1.0
                   182            1.0
                   183            1.0
                   184            1.0
                   185            1.0
                   186            1.0
                   187            1.0
                   188            1.0
                   189            1.0
                   190            1.0
                   191            1.0
                   192            1.0
                   193            1.0
                   194            1.0
                   195            1.0
                   196            1.0
                   197            1.0
                   198            1.0
                   199            1.0
                   200            1.0
                   201            1.0
                   202            1.0
                   203            1.0
                   204            1.0
                   205            1.0
                   206            1.0
                   207            1.0
                   208            1.0
                   209            1.0
                   210            1.0
                   211            1.0
                   212            1.0
                   213            1.0
                   214            1.0
                   215            1.0
                   216            1.0
                   217            1.0
                   218            1.0
                   219            1.0
                   220            1.0
                   221            1.0
                   222            1.0
                   223            1.0
                   224            1.0
                   225            1.0
                   226            1.0
                   227            1.0
                   228            1.0
                   229            1.0
                   230            1.0
                   231            1.0
                   232            1.0
                   233            1.0
                   234            1.0
                   235            1.0
                   236            1.0
                   237            1.0
                   238            1.0
                   239            1.0
                   240            1.0
                   241            1.0
                   242            1.0
                   243            1.0
                   244            1.0
                   245            1.0
                   246            1.0
                   247            1.0
                   248            1.0
                   249            1.0
                                 ... 
                   9560           0.0
                   9561           0.0
                   9562           0.0
                   9563           0.0
                   9564           0.0
                   9565           0.0
                   9566           0.0
                   9567           0.0
                   9568           0.0
                   9569           0.0
                   9570           0.0
                   9571           0.0
                   9572           0.0
                   9573           0.0
                   9574           0.0
                   9575           0.0
                   9576           0.0
                   9577           0.0
                   9578           0.0
                   9579           0.0
                   9580           0.0
                   9581           0.0
                   9582           0.0
                   9583           0.0
                   9584           0.0
                   9585           0.0
                   9586           0.0
                   9587           0.0
                   9588           0.0
                   9589           0.0
                   9590           0.0
                   9591           0.0
                   9592           0.0
                   9593           0.0
                   9594           0.0
                   9595           0.0
                   9596           0.0
                   9597           0.0
                   9598           0.0
                   9599           0.0
                   9600           0.0
                   9601           0.0
                   9602           0.0
                   9603           0.0
                   9604           0.0
                   9605           0.0
                   9606           0.0
                   9607           0.0
                   9608           0.0
                   9609           0.0
                   9610           0.0
                   9611           0.0
                   9612           0.0
                   9613           0.0
                   9614           0.0
                   9615           0.0
                   9616           0.0
                   9617           0.0
                   9618           0.0
                   9619           0.0
                   9620           0.0
                   9621           0.0
                   9622           0.0
                   9623           0.0
                   9624           0.0
                   9625           0.0
                   9626           0.0
                   9627           0.0
                   9628           0.0
                   9629           0.0
                   9630           0.0
                   9631           0.0
                   9632           0.0
                   9633           0.0
                   9634           0.0
                   9635           0.0
                   9636           0.0
                   9637           0.0
                   9638           0.0
                   9639           0.0
                   9640           0.0
                   9641           0.0
                   9642           0.0
                   9643           0.0
                   9644           0.0
                   9645           0.0
                   9646           0.0
                   9647           0.0
                   9648           0.0
                   9649           0.0
                   9650           0.0
                   9651           0.0
                   9652           0.0
                   9653           0.0
                   9654           0.0
                   9655           0.0
                   9656           0.0
                   9657           0.0
                   9658           0.0
                   9659           0.0
                   9660           0.0
                   9661           0.0
                   9662           0.0
                   9663           0.0
                   9664           0.0
                   9665           0.0
                   9666           0.0
                   9667           0.0
                   9668           0.0
                   9669           0.0
                   9670           0.0
                   9671           0.0
                   9672           0.0
                   9673           0.0
                   9674           0.0
                   9675           0.0
                   9676           0.0
                   9677           0.0
                   9678           0.0
                   9679           0.0
                   9680           0.0
                   9681           0.0
                   9682           0.0
                   9683           0.0
                   9684           0.0
                   9685           0.0
                   9686           0.0
                   9687           0.0
                   9688           0.0
                   9689           0.0
                   9690           0.0
                   9691           0.0
                   9692           0.0
                   9693           0.0
                   9694           0.0
                   9695           0.0
                   9696           0.0
                   9697           0.0
                   9698           0.0
                   9699           0.0
                   9700           0.0
                   9701           0.0
                   9702           0.0
                   9703           0.0
                   9704           0.0
                   9705           0.0
                   9706           0.0
                   9707           0.0
                   9708           0.0
                   9709           0.0
                   9710           0.0
                   9711           0.0
                   9712           0.0
                   9713           0.0
                   9714           0.0
                   9715           0.0
                   9716           0.0
                   9717           0.0
                   9718           0.0
                   9719           0.0
                   9720           0.0
                   9721           0.0
                   9722           0.0
                   9723           0.0
                   9724           0.0
                   9725           0.0
                   9726           0.0
                   9727           0.0
                   9728           0.0
                   9729           0.0
                   9730           0.0
                   9731           0.0
                   9732           0.0
                   9733           0.0
                   9734           0.0
                   9735           0.0
                   9736           0.0
                   9737           0.0
                   9738           0.0
                   9739           0.0
                   9740           0.0
                   9741           0.0
                   9742           0.0
                   9743           0.0
                   9744           0.0
                   9745           0.0
                   9746           0.0
                   9747           0.0
                   9748           0.0
                   9749           0.0
                   9750           0.0
                   9751           0.0
                   9752           0.0
                   9753           0.0
                   9754           0.0
                   9755           0.0
                   9756           0.0
                   9757           0.0
                   9758           0.0
                   9759           0.0
                   9760           0.0
                   9761           0.0
                   9762           0.0
                   9763           0.0
                   9764           0.0
                   9765           0.0
                   9766           0.0
                   9767           0.0
                   9768           0.0
                   9769           0.0
                   9770           0.0
                   9771           0.0
                   9772           0.0
                   9773           0.0
                   9774           0.0
                   9775           0.0
                   9776           0.0
                   9777           0.0
                   9778           0.0
                   9779           0.0
                   80556481977    0.0
                   19519559896    0.0
                   17960654021    0.0
                   21115309455    0.0
                   74451042494    0.0
                   80106653999    0.0
                   76285695941    0.0
                   77680735431    0.0
                   25641173996    0.0
                   23199267830    0.0
                   24650012890    0.0
                   10116948064    0.0
                   19647672706    0.0
                   81438140134    0.0
                   10132223347    0.0
                   80556481977    0.0
                   19519559896    0.0
                   17960654021    0.0
                   21115309455    0.0
                   74451042494    0.0
                   80106653999    0.0
                   76285695941    0.0
                   77680735431    0.0
                   25641173996    0.0
                   23199267830    0.0
                   24650012890    0.0
                   10116948064    0.0
                   19647672706    0.0
                   81438140134    0.0
                   10132223347    0.0
                   Name: flag_eg, Length: 9810, dtype: float64


Traceback (most recent call last):
  File "C:\Users\higher\Anaconda3\lib\site-packages\IPython\core\interactiveshell.py", line 2961, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-97-e2068a9bb80a>", line 1, in <module>
    col_need, field_manual, col_num, col_char, col_date = get_col(Info, comment_valid)
NameError: name 'comment_valid' is not defined
                   Out[98]: 20220322-17:02:50  
                   ['user_acct_month',
                    'data_use',
                    'user_id',
                    'phone_no_null',
                    'phone_no_tm',
                    'dinner_id',
                    'sex',
                    'user_status',
                    'dinner',
                    'if_nolimit',
                    'if_5g_dinner',
                    'if_5g_term',
                    'if_jt',
                    'start_level',
                    'term_model',
                    'term_brand',
                    'term_type',
                    'sk_type',
                    'if_new_term',
                    'greatest_gprs_app',
                    'paste_dinner_innet_months',
                    'flag_eg']
20220322-17:02:56  ------------------------- 读取数据: ml.mid_eg_recent_train_202011 2022-03-22 17:02:56 -------------------------
20220322-17:02:56      src: gp
20220322-17:02:56      condition: data_use='data_train'
20220322-17:02:56      col_need(67): ['user_acct_month', 'data_use', 'acct_month', 'user_id', 'innet_months', 'age', 'dinner_fee', 'gprs_last_defer', 'gprs_resource', 'gprs_now_rest', 'call_use', 'arpu', 'pay_cnt', 'pay_fee', 'acct_balance', 'calling_cnt', 'calling_dura', 'called_cnt', 'calling_diff_cnt', 'calling_diff_dura', 'gprs_flow', 'gprs_flow_4g', 'gprs_flow_5g', 'gprs_flow_busy', 'gprs_flow_idle', 'gprs_now_defer', 'gprs_flow_roam', 'call_dura_roam', 'gprs_flow_gat', 'days_gat', 'days_gprs', 'days_call', 'nos_call', 'nos_calling', 'nos_calling_diff', 'sms_cnt', 'call_fee_local', 'call_fee_roam', 'gprs_income', 'gprs_fee', 'call_fee', 'gprs_flow_video', 'gprs_flow_short', 'gprs_flow_music', 'gprs_flow_commu', 'gprs_flow_game', 'innet_date', 'last_stop_date', 'phone_no_null', 'phone_no_tm', 'dinner_id', 'account_id', 'sex', 'user_status', 'dinner', 'if_nolimit', 'if_5g_dinner', 'if_5g_term', 'if_jt', 'start_level', 'if_cred_multi', 'term_model', 'term_brand', 'term_type', 'sk_type', 'if_new_term', 'flag_eg']
20220322-17:02:56      col_del: None
20220322-17:02:56      col_char(22): ['user_acct_month', 'data_use', 'user_id', 'phone_no_null', 'phone_no_tm', 'dinner_id', 'sex', 'user_status', 'dinner', 'if_nolimit', 'if_5g_dinner', 'if_5g_term', 'if_jt', 'start_level', 'term_model', 'term_brand', 'term_type', 'sk_type', 'if_new_term', 'greatest_gprs_app', 'paste_dinner_innet_months', 'flag_eg']
20220322-17:02:56      col_num(54): ['acct_month', 'innet_months', 'age', 'dinner_fee', 'gprs_last_defer', 'gprs_resource', 'gprs_now_rest', 'call_use', 'arpu', 'pay_cnt', 'pay_fee', 'acct_balance', 'calling_cnt', 'calling_dura', 'called_cnt', 'calling_diff_cnt', 'calling_diff_dura', 'gprs_flow', 'gprs_flow_4g', 'gprs_flow_5g', 'gprs_flow_busy', 'gprs_flow_idle', 'gprs_now_defer', 'gprs_flow_roam', 'call_dura_roam', 'gprs_flow_gat', 'days_gat', 'days_gprs', 'days_call', 'nos_call', 'nos_calling', 'nos_calling_diff', 'sms_cnt', 'call_fee_local', 'call_fee_roam', 'gprs_income', 'gprs_fee', 'call_fee', 'gprs_flow_video', 'gprs_flow_short', 'gprs_flow_music', 'gprs_flow_commu', 'gprs_flow_game', 'account_id', 'if_cred_multi', 'flag_eg', 'monthsaready_last_stop_date', 'monthsremain_last_stop_date', 'days_gprs_p', 'days_call_p', 'days_call_p_1', 'days_call_p_2', 'days_call_p_3', 'days_call_p_4']
20220322-17:02:56      col_date(2): ['innet_date', 'last_stop_date']
20220322-17:02:56      nrows: None
20220322-17:02:56      if_coltolower: True
20220322-17:02:56      kwargs: {}



Traceback (most recent call last):
  File "C:\Users\higher\Anaconda3\lib\site-packages\IPython\core\interactiveshell.py", line 2961, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-99-b150016d5c1f>", line 1, in <module>
    data_recent = read_data(table_in, 'gp', condition, col_need, col_char=col_char, col_num=col_num, col_date=col_date)
  File "<ipython-input-56-582359d8246b>", line 464, in read_data
    raise Exception('参数col_char、col_num、col_date之间存在重复字段！')
Exception: 参数col_char、col_num、col_date之间存在重复字段！
                   Out[100]: 20220322-17:03:12  
                   ['acct_month',
                    'innet_months',
                    'age',
                    'dinner_fee',
                    'gprs_last_defer',
                    'gprs_resource',
                    'gprs_now_rest',
                    'call_use',
                    'arpu',
                    'pay_cnt',
                    'pay_fee',
                    'acct_balance',
                    'calling_cnt',
                    'calling_dura',
                    'called_cnt',
                    'calling_diff_cnt',
                    'calling_diff_dura',
                    'gprs_flow',
                    'gprs_flow_4g',
                    'gprs_flow_5g',
                    'gprs_flow_busy',
                    'gprs_flow_idle',
                    'gprs_now_defer',
                    'gprs_flow_roam',
                    'call_dura_roam',
                    'gprs_flow_gat',
                    'days_gat',
                    'days_gprs',
                    'days_call',
                    'nos_call',
                    'nos_calling',
                    'nos_calling_diff',
                    'sms_cnt',
                    'call_fee_local',
                    'call_fee_roam',
                    'gprs_income',
                    'gprs_fee',
                    'call_fee',
                    'gprs_flow_video',
                    'gprs_flow_short',
                    'gprs_flow_music',
                    'gprs_flow_commu',
                    'gprs_flow_game',
                    'account_id',
                    'if_cred_multi',
                    'flag_eg',
                    'monthsaready_last_stop_date',
                    'monthsremain_last_stop_date',
                    'days_gprs_p',
                    'days_call_p',
                    'days_call_p_1',
                    'days_call_p_2',
                    'days_call_p_3',
                    'days_call_p_4']
                   Out[102]: 20220322-17:03:35  
                   ['innet_months',
                    'age',
                    'dinner_fee',
                    'gprs_last_defer',
                    'gprs_resource',
                    'gprs_now_rest',
                    'call_use',
                    'arpu',
                    'pay_cnt',
                    'pay_fee',
                    'acct_balance',
                    'calling_cnt',
                    'calling_dura',
                    'called_cnt',
                    'calling_diff_cnt',
                    'calling_diff_dura',
                    'gprs_flow',
                    'gprs_flow_4g',
                    'gprs_flow_5g',
                    'gprs_flow_busy',
                    'gprs_flow_idle',
                    'gprs_now_defer',
                    'gprs_flow_roam',
                    'call_dura_roam',
                    'gprs_flow_gat',
                    'days_gat',
                    'days_gprs',
                    'days_call',
                    'nos_call',
                    'nos_calling',
                    'nos_calling_diff',
                    'sms_cnt',
                    'call_fee_local',
                    'call_fee_roam',
                    'gprs_income',
                    'gprs_fee',
                    'call_fee',
                    'gprs_flow_video',
                    'gprs_flow_short',
                    'gprs_flow_music',
                    'gprs_flow_commu',
                    'gprs_flow_game']
                   Out[103]: 20220322-17:03:46  'explore'
20220322-17:03:55  field_base: 78行

20220322-17:03:55  删除3个available_notzd“不可用”字段：['cred_type', 'called_dura', 'days_roam']
20220322-17:03:55  field_base: 75行

20220322-17:03:55  删除1个基于“不可用”字段加工的手动衍生_py字段：
                        field_name                 formula
                   52  days_roam_p  days_roam / days_month
20220322-17:03:55  field_base: 74行


C:\Users\higher\Desktop\to伟鹏的代码_v2\ModelProject\selfmodule\toolmodule\dataprep.py:9: UserWarning: Pipeline_DF：verbose参数值被赋予print_indent后默认参数设置为None
  from collections import OrderedDict


C:\Users\higher\Desktop\to伟鹏的代码_v2\ModelProject\selfmodule\toolmodule\dataprep.py:9: UserWarning: FeatureUnion_DF：verbose参数值被赋予print_indent后默认参数设置为None
  from collections import OrderedDict
                   Out[105]: 20220322-17:03:57  
                   ['acct_month',
                    'phone_no_null',
                    'phone_no_tm',
                    'user_id',
                    'dinner_id',
                    'account_id',
                    'sex',
                    'user_status',
                    'dinner',
                    'if_nolimit',
                    'if_5g_dinner',
                    'if_5g_term',
                    'if_jt',
                    'start_level',
                    'if_cred_multi',
                    'term_model',
                    'term_brand',
                    'term_type',
                    'sk_type',
                    'if_new_term',
                    'flag_eg']
                   Out[106]: 20220322-17:04:00  
                   ['innet_months',
                    'age',
                    'dinner_fee',
                    'gprs_last_defer',
                    'gprs_resource',
                    'gprs_now_rest',
                    'call_use',
                    'arpu',
                    'pay_cnt',
                    'pay_fee',
                    'acct_balance',
                    'calling_cnt',
                    'calling_dura',
                    'called_cnt',
                    'calling_diff_cnt',
                    'calling_diff_dura',
                    'gprs_flow',
                    'gprs_flow_4g',
                    'gprs_flow_5g',
                    'gprs_flow_busy',
                    'gprs_flow_idle',
                    'gprs_now_defer',
                    'gprs_flow_roam',
                    'call_dura_roam',
                    'gprs_flow_gat',
                    'days_gat',
                    'days_gprs',
                    'days_call',
                    'nos_call',
                    'nos_calling',
                    'nos_calling_diff',
                    'sms_cnt',
                    'call_fee_local',
                    'call_fee_roam',
                    'gprs_income',
                    'gprs_fee',
                    'call_fee',
                    'gprs_flow_video',
                    'gprs_flow_short',
                    'gprs_flow_music',
                    'gprs_flow_commu',
                    'gprs_flow_game']
20220322-17:04:09  ------------------------- 读取数据: ml.mid_eg_recent_train_202011 2022-03-22 17:04:09 -------------------------
20220322-17:04:09      src: gp
20220322-17:04:09      condition: data_use='data_train'
20220322-17:04:09      col_need(67): ['user_acct_month', 'data_use', 'acct_month', 'user_id', 'innet_months', 'age', 'dinner_fee', 'gprs_last_defer', 'gprs_resource', 'gprs_now_rest', 'call_use', 'arpu', 'pay_cnt', 'pay_fee', 'acct_balance', 'calling_cnt', 'calling_dura', 'called_cnt', 'calling_diff_cnt', 'calling_diff_dura', 'gprs_flow', 'gprs_flow_4g', 'gprs_flow_5g', 'gprs_flow_busy', 'gprs_flow_idle', 'gprs_now_defer', 'gprs_flow_roam', 'call_dura_roam', 'gprs_flow_gat', 'days_gat', 'days_gprs', 'days_call', 'nos_call', 'nos_calling', 'nos_calling_diff', 'sms_cnt', 'call_fee_local', 'call_fee_roam', 'gprs_income', 'gprs_fee', 'call_fee', 'gprs_flow_video', 'gprs_flow_short', 'gprs_flow_music', 'gprs_flow_commu', 'gprs_flow_game', 'innet_date', 'last_stop_date', 'phone_no_null', 'phone_no_tm', 'dinner_id', 'account_id', 'sex', 'user_status', 'dinner', 'if_nolimit', 'if_5g_dinner', 'if_5g_term', 'if_jt', 'start_level', 'if_cred_multi', 'term_model', 'term_brand', 'term_type', 'sk_type', 'if_new_term', 'flag_eg']
20220322-17:04:09      col_del: None
20220322-17:04:09      col_char(21): ['acct_month', 'phone_no_null', 'phone_no_tm', 'user_id', 'dinner_id', 'account_id', 'sex', 'user_status', 'dinner', 'if_nolimit', 'if_5g_dinner', 'if_5g_term', 'if_jt', 'start_level', 'if_cred_multi', 'term_model', 'term_brand', 'term_type', 'sk_type', 'if_new_term', 'flag_eg']
20220322-17:04:09      col_num(42): ['innet_months', 'age', 'dinner_fee', 'gprs_last_defer', 'gprs_resource', 'gprs_now_rest', 'call_use', 'arpu', 'pay_cnt', 'pay_fee', 'acct_balance', 'calling_cnt', 'calling_dura', 'called_cnt', 'calling_diff_cnt', 'calling_diff_dura', 'gprs_flow', 'gprs_flow_4g', 'gprs_flow_5g', 'gprs_flow_busy', 'gprs_flow_idle', 'gprs_now_defer', 'gprs_flow_roam', 'call_dura_roam', 'gprs_flow_gat', 'days_gat', 'days_gprs', 'days_call', 'nos_call', 'nos_calling', 'nos_calling_diff', 'sms_cnt', 'call_fee_local', 'call_fee_roam', 'gprs_income', 'gprs_fee', 'call_fee', 'gprs_flow_video', 'gprs_flow_short', 'gprs_flow_music', 'gprs_flow_commu', 'gprs_flow_game']
20220322-17:04:09      col_date(2): ['innet_date', 'last_stop_date']
20220322-17:04:09      nrows: None
20220322-17:04:09      if_coltolower: True
20220322-17:04:09      kwargs: {}

20220322-17:04:09      读取
20220322-17:04:10      shape: (9780, 67)

20220322-17:04:10  -------------------------读取完毕: (9780, 67) 2022-03-22 17:04:10 -------------------------

                   Out[108]: 20220322-17:04:21  
                   0          1
                   1          1
                   2          1
                   3          1
                   4          1
                   5          1
                   6          1
                   7          1
                   8          1
                   9          1
                   10         1
                   11         1
                   12         1
                   13         1
                   14         1
                   15         1
                   16         1
                   17         1
                   18         1
                   19         1
                   20         1
                   21         1
                   22         1
                   23         1
                   24         1
                   25         1
                   26         1
                   27         1
                   28         1
                   29         1
                   30         1
                   31         1
                   32         1
                   33         1
                   34         1
                   35         1
                   36         1
                   37         1
                   38         1
                   39         1
                   40         1
                   41         1
                   42         1
                   43         1
                   44         1
                   45         1
                   46         1
                   47         1
                   48         1
                   49         1
                   50         1
                   51         1
                   52         1
                   53         1
                   54         1
                   55         1
                   56         1
                   57         1
                   58         1
                   59         1
                   60         1
                   61         1
                   62         1
                   63         1
                   64         1
                   65         1
                   66         1
                   67         1
                   68         1
                   69         1
                   70         1
                   71         1
                   72         1
                   73         1
                   74         1
                   75         1
                   76         1
                   77         1
                   78         1
                   79         1
                   80         1
                   81         1
                   82         1
                   83         1
                   84         1
                   85         1
                   86         1
                   87         1
                   88         1
                   89         1
                   90         1
                   91         1
                   92         1
                   93         1
                   94         1
                   95         1
                   96         1
                   97         1
                   98         1
                   99         1
                   100        1
                   101        1
                   102        1
                   103        1
                   104        1
                   105        1
                   106        1
                   107        1
                   108        1
                   109        1
                   110        1
                   111        1
                   112        1
                   113        1
                   114        1
                   115        1
                   116        1
                   117        1
                   118        1
                   119        1
                   120        1
                   121        1
                   122        1
                   123        1
                   124        1
                   125        1
                   126        1
                   127        1
                   128        1
                   129        1
                   130        1
                   131        1
                   132        1
                   133        1
                   134        1
                   135        1
                   136        1
                   137        1
                   138        1
                   139        1
                   140        1
                   141        1
                   142        1
                   143        1
                   144        1
                   145        1
                   146        1
                   147        1
                   148        1
                   149        1
                   150        1
                   151        1
                   152        1
                   153        1
                   154        1
                   155        1
                   156        1
                   157        1
                   158        1
                   159        1
                   160        1
                   161        1
                   162        1
                   163        1
                   164        1
                   165        1
                   166        1
                   167        1
                   168        1
                   169        1
                   170        1
                   171        1
                   172        1
                   173        1
                   174        1
                   175        1
                   176        1
                   177        1
                   178        1
                   179        1
                   180        1
                   181        1
                   182        1
                   183        1
                   184        1
                   185        1
                   186        1
                   187        1
                   188        1
                   189        1
                   190        1
                   191        1
                   192        1
                   193        1
                   194        1
                   195        1
                   196        1
                   197        1
                   198        1
                   199        1
                   200        1
                   201        1
                   202        1
                   203        1
                   204        1
                   205        1
                   206        1
                   207        1
                   208        1
                   209        1
                   210        1
                   211        1
                   212        1
                   213        1
                   214        1
                   215        1
                   216        1
                   217        1
                   218        1
                   219        1
                   220        1
                   221        1
                   222        1
                   223        1
                   224        1
                   225        1
                   226        1
                   227        1
                   228        1
                   229        1
                   230        1
                   231        1
                   232        1
                   233        1
                   234        1
                   235        1
                   236        1
                   237        1
                   238        1
                   239        1
                   240        1
                   241        1
                   242        1
                   243        1
                   244        1
                   245        1
                   246        1
                   247        1
                   248        1
                   249        1
                           ... 
                   9530    None
                   9531    None
                   9532    None
                   9533    None
                   9534    None
                   9535    None
                   9536    None
                   9537    None
                   9538    None
                   9539    None
                   9540    None
                   9541    None
                   9542    None
                   9543    None
                   9544    None
                   9545    None
                   9546    None
                   9547    None
                   9548    None
                   9549    None
                   9550    None
                   9551    None
                   9552    None
                   9553    None
                   9554    None
                   9555    None
                   9556    None
                   9557    None
                   9558    None
                   9559    None
                   9560    None
                   9561    None
                   9562    None
                   9563    None
                   9564    None
                   9565    None
                   9566    None
                   9567    None
                   9568    None
                   9569    None
                   9570    None
                   9571    None
                   9572    None
                   9573    None
                   9574    None
                   9575    None
                   9576    None
                   9577    None
                   9578    None
                   9579    None
                   9580    None
                   9581    None
                   9582    None
                   9583    None
                   9584    None
                   9585    None
                   9586    None
                   9587    None
                   9588    None
                   9589    None
                   9590    None
                   9591    None
                   9592    None
                   9593    None
                   9594    None
                   9595    None
                   9596    None
                   9597    None
                   9598    None
                   9599    None
                   9600    None
                   9601    None
                   9602    None
                   9603    None
                   9604    None
                   9605    None
                   9606    None
                   9607    None
                   9608    None
                   9609    None
                   9610    None
                   9611    None
                   9612    None
                   9613    None
                   9614    None
                   9615    None
                   9616    None
                   9617    None
                   9618    None
                   9619    None
                   9620    None
                   9621    None
                   9622    None
                   9623    None
                   9624    None
                   9625    None
                   9626    None
                   9627    None
                   9628    None
                   9629    None
                   9630    None
                   9631    None
                   9632    None
                   9633    None
                   9634    None
                   9635    None
                   9636    None
                   9637    None
                   9638    None
                   9639    None
                   9640    None
                   9641    None
                   9642    None
                   9643    None
                   9644    None
                   9645    None
                   9646    None
                   9647    None
                   9648    None
                   9649    None
                   9650    None
                   9651    None
                   9652    None
                   9653    None
                   9654    None
                   9655    None
                   9656    None
                   9657    None
                   9658    None
                   9659    None
                   9660    None
                   9661    None
                   9662    None
                   9663    None
                   9664    None
                   9665    None
                   9666    None
                   9667    None
                   9668    None
                   9669    None
                   9670    None
                   9671    None
                   9672    None
                   9673    None
                   9674    None
                   9675    None
                   9676    None
                   9677    None
                   9678    None
                   9679    None
                   9680    None
                   9681    None
                   9682    None
                   9683    None
                   9684    None
                   9685    None
                   9686    None
                   9687    None
                   9688    None
                   9689    None
                   9690    None
                   9691    None
                   9692    None
                   9693    None
                   9694    None
                   9695    None
                   9696    None
                   9697    None
                   9698    None
                   9699    None
                   9700    None
                   9701    None
                   9702    None
                   9703    None
                   9704    None
                   9705    None
                   9706    None
                   9707    None
                   9708    None
                   9709    None
                   9710    None
                   9711    None
                   9712    None
                   9713    None
                   9714    None
                   9715    None
                   9716    None
                   9717    None
                   9718    None
                   9719    None
                   9720    None
                   9721    None
                   9722    None
                   9723    None
                   9724    None
                   9725    None
                   9726    None
                   9727    None
                   9728    None
                   9729    None
                   9730    None
                   9731    None
                   9732    None
                   9733    None
                   9734    None
                   9735    None
                   9736    None
                   9737    None
                   9738    None
                   9739    None
                   9740    None
                   9741    None
                   9742    None
                   9743    None
                   9744    None
                   9745    None
                   9746    None
                   9747    None
                   9748    None
                   9749    None
                   9750    None
                   9751    None
                   9752    None
                   9753    None
                   9754    None
                   9755    None
                   9756    None
                   9757    None
                   9758    None
                   9759    None
                   9760    None
                   9761    None
                   9762    None
                   9763    None
                   9764    None
                   9765    None
                   9766    None
                   9767    None
                   9768    None
                   9769    None
                   9770    None
                   9771    None
                   9772    None
                   9773    None
                   9774    None
                   9775    None
                   9776    None
                   9777    None
                   9778    None
                   9779    None
                   Name: flag_eg, Length: 9780, dtype: object
20220322-17:04:30  手动衍生_py10个字段: {'monthsaready_last_stop_date': '最后停机时间：已发生时长', 'monthsremain_last_stop_date': '最后停机时间：剩余时长', 'days_gprs_p': '上网天数占比', 'days_call_p': '通话天数占比', 'days_call_p_1': '通话天数占比_1', 'days_call_p_2': '通话天数占比_2', 'days_call_p_3': '通话天数占比_3', 'days_call_p_4': '通话天数占比_4', 'greatest_gprs_app': 'app偏好', 'paste_dinner_innet_months': '主套餐、入网时长：交叉'}
20220322-17:04:30  monthsaready_last_stop_date: current_date - last_stop_date
20220322-17:04:30      将 monthsaready_last_stop_date 字段的 4 个缺失值赋值为: -99999 （非缺失的最小值-2.0）
20220322-17:04:30  monthsremain_last_stop_date: last_stop_date - current_date
20220322-17:04:30      将 monthsremain_last_stop_date 字段的 4 个缺失值赋值为: -99999 （非缺失的最小值-101.0）
20220322-17:04:30  days_gprs_p: days_gprs / days_month
20220322-17:04:30  days_call_p: days_call / days_month
20220322-17:04:30  days_call_p_1: days_call_p + days_gprs
20220322-17:04:30  days_call_p_2: days_call_p_1 + days_gprs
20220322-17:04:30  days_call_p_3: days_call_p_2 + days_gprs
20220322-17:04:30  days_call_p_4: days_call_p_3 + days_gprs
20220322-17:04:30  greatest_gprs_app: {'gprs_flow_video': 'video', 'gprs_flow_short': 'short', 'gprs_flow_music': 'music', 'gprs_flow_commu': 'commu', 'gprs_flow_game': 'game'}
20220322-17:04:33  paste_dinner_innet_months: (dinner, innet_months)


C:\Program Files\JetBrains\PyCharm 2020.3.3\plugins\python\helpers\pydev\pydevconsole.py:1047: UserWarning: opera_pair_fun paste时存在非类别型字段，请确认: ['innet_months']
20220322-17:04:33  数据量: (9780, 77)

                   Out[110]: 20220322-17:04:46  
                   0          1
                   1          1
                   2          1
                   3          1
                   4          1
                   5          1
                   6          1
                   7          1
                   8          1
                   9          1
                   10         1
                   11         1
                   12         1
                   13         1
                   14         1
                   15         1
                   16         1
                   17         1
                   18         1
                   19         1
                   20         1
                   21         1
                   22         1
                   23         1
                   24         1
                   25         1
                   26         1
                   27         1
                   28         1
                   29         1
                   30         1
                   31         1
                   32         1
                   33         1
                   34         1
                   35         1
                   36         1
                   37         1
                   38         1
                   39         1
                   40         1
                   41         1
                   42         1
                   43         1
                   44         1
                   45         1
                   46         1
                   47         1
                   48         1
                   49         1
                   50         1
                   51         1
                   52         1
                   53         1
                   54         1
                   55         1
                   56         1
                   57         1
                   58         1
                   59         1
                   60         1
                   61         1
                   62         1
                   63         1
                   64         1
                   65         1
                   66         1
                   67         1
                   68         1
                   69         1
                   70         1
                   71         1
                   72         1
                   73         1
                   74         1
                   75         1
                   76         1
                   77         1
                   78         1
                   79         1
                   80         1
                   81         1
                   82         1
                   83         1
                   84         1
                   85         1
                   86         1
                   87         1
                   88         1
                   89         1
                   90         1
                   91         1
                   92         1
                   93         1
                   94         1
                   95         1
                   96         1
                   97         1
                   98         1
                   99         1
                   100        1
                   101        1
                   102        1
                   103        1
                   104        1
                   105        1
                   106        1
                   107        1
                   108        1
                   109        1
                   110        1
                   111        1
                   112        1
                   113        1
                   114        1
                   115        1
                   116        1
                   117        1
                   118        1
                   119        1
                   120        1
                   121        1
                   122        1
                   123        1
                   124        1
                   125        1
                   126        1
                   127        1
                   128        1
                   129        1
                   130        1
                   131        1
                   132        1
                   133        1
                   134        1
                   135        1
                   136        1
                   137        1
                   138        1
                   139        1
                   140        1
                   141        1
                   142        1
                   143        1
                   144        1
                   145        1
                   146        1
                   147        1
                   148        1
                   149        1
                   150        1
                   151        1
                   152        1
                   153        1
                   154        1
                   155        1
                   156        1
                   157        1
                   158        1
                   159        1
                   160        1
                   161        1
                   162        1
                   163        1
                   164        1
                   165        1
                   166        1
                   167        1
                   168        1
                   169        1
                   170        1
                   171        1
                   172        1
                   173        1
                   174        1
                   175        1
                   176        1
                   177        1
                   178        1
                   179        1
                   180        1
                   181        1
                   182        1
                   183        1
                   184        1
                   185        1
                   186        1
                   187        1
                   188        1
                   189        1
                   190        1
                   191        1
                   192        1
                   193        1
                   194        1
                   195        1
                   196        1
                   197        1
                   198        1
                   199        1
                   200        1
                   201        1
                   202        1
                   203        1
                   204        1
                   205        1
                   206        1
                   207        1
                   208        1
                   209        1
                   210        1
                   211        1
                   212        1
                   213        1
                   214        1
                   215        1
                   216        1
                   217        1
                   218        1
                   219        1
                   220        1
                   221        1
                   222        1
                   223        1
                   224        1
                   225        1
                   226        1
                   227        1
                   228        1
                   229        1
                   230        1
                   231        1
                   232        1
                   233        1
                   234        1
                   235        1
                   236        1
                   237        1
                   238        1
                   239        1
                   240        1
                   241        1
                   242        1
                   243        1
                   244        1
                   245        1
                   246        1
                   247        1
                   248        1
                   249        1
                           ... 
                   9530    None
                   9531    None
                   9532    None
                   9533    None
                   9534    None
                   9535    None
                   9536    None
                   9537    None
                   9538    None
                   9539    None
                   9540    None
                   9541    None
                   9542    None
                   9543    None
                   9544    None
                   9545    None
                   9546    None
                   9547    None
                   9548    None
                   9549    None
                   9550    None
                   9551    None
                   9552    None
                   9553    None
                   9554    None
                   9555    None
                   9556    None
                   9557    None
                   9558    None
                   9559    None
                   9560    None
                   9561    None
                   9562    None
                   9563    None
                   9564    None
                   9565    None
                   9566    None
                   9567    None
                   9568    None
                   9569    None
                   9570    None
                   9571    None
                   9572    None
                   9573    None
                   9574    None
                   9575    None
                   9576    None
                   9577    None
                   9578    None
                   9579    None
                   9580    None
                   9581    None
                   9582    None
                   9583    None
                   9584    None
                   9585    None
                   9586    None
                   9587    None
                   9588    None
                   9589    None
                   9590    None
                   9591    None
                   9592    None
                   9593    None
                   9594    None
                   9595    None
                   9596    None
                   9597    None
                   9598    None
                   9599    None
                   9600    None
                   9601    None
                   9602    None
                   9603    None
                   9604    None
                   9605    None
                   9606    None
                   9607    None
                   9608    None
                   9609    None
                   9610    None
                   9611    None
                   9612    None
                   9613    None
                   9614    None
                   9615    None
                   9616    None
                   9617    None
                   9618    None
                   9619    None
                   9620    None
                   9621    None
                   9622    None
                   9623    None
                   9624    None
                   9625    None
                   9626    None
                   9627    None
                   9628    None
                   9629    None
                   9630    None
                   9631    None
                   9632    None
                   9633    None
                   9634    None
                   9635    None
                   9636    None
                   9637    None
                   9638    None
                   9639    None
                   9640    None
                   9641    None
                   9642    None
                   9643    None
                   9644    None
                   9645    None
                   9646    None
                   9647    None
                   9648    None
                   9649    None
                   9650    None
                   9651    None
                   9652    None
                   9653    None
                   9654    None
                   9655    None
                   9656    None
                   9657    None
                   9658    None
                   9659    None
                   9660    None
                   9661    None
                   9662    None
                   9663    None
                   9664    None
                   9665    None
                   9666    None
                   9667    None
                   9668    None
                   9669    None
                   9670    None
                   9671    None
                   9672    None
                   9673    None
                   9674    None
                   9675    None
                   9676    None
                   9677    None
                   9678    None
                   9679    None
                   9680    None
                   9681    None
                   9682    None
                   9683    None
                   9684    None
                   9685    None
                   9686    None
                   9687    None
                   9688    None
                   9689    None
                   9690    None
                   9691    None
                   9692    None
                   9693    None
                   9694    None
                   9695    None
                   9696    None
                   9697    None
                   9698    None
                   9699    None
                   9700    None
                   9701    None
                   9702    None
                   9703    None
                   9704    None
                   9705    None
                   9706    None
                   9707    None
                   9708    None
                   9709    None
                   9710    None
                   9711    None
                   9712    None
                   9713    None
                   9714    None
                   9715    None
                   9716    None
                   9717    None
                   9718    None
                   9719    None
                   9720    None
                   9721    None
                   9722    None
                   9723    None
                   9724    None
                   9725    None
                   9726    None
                   9727    None
                   9728    None
                   9729    None
                   9730    None
                   9731    None
                   9732    None
                   9733    None
                   9734    None
                   9735    None
                   9736    None
                   9737    None
                   9738    None
                   9739    None
                   9740    None
                   9741    None
                   9742    None
                   9743    None
                   9744    None
                   9745    None
                   9746    None
                   9747    None
                   9748    None
                   9749    None
                   9750    None
                   9751    None
                   9752    None
                   9753    None
                   9754    None
                   9755    None
                   9756    None
                   9757    None
                   9758    None
                   9759    None
                   9760    None
                   9761    None
                   9762    None
                   9763    None
                   9764    None
                   9765    None
                   9766    None
                   9767    None
                   9768    None
                   9769    None
                   9770    None
                   9771    None
                   9772    None
                   9773    None
                   9774    None
                   9775    None
                   9776    None
                   9777    None
                   9778    None
                   9779    None
                   Name: flag_eg, Length: 9780, dtype: object
20220322-17:04:56  检查数据
20220322-17:04:56  各账期数据量分布：
                       202009  data_train    3255
                       202010  data_train    3255
                       202011  data_train    3270
                       dtype: int64
20220322-17:04:56  各账期数据量不一致
20220322-17:04:56  以nan填充缺少账期的记录
20220322-17:04:57      修改后：
                       202009  data_train    3270
                       202010  data_train    3270
                       202011  data_train    3270
                       dtype: int64)
20220322-17:04:57  
                   diff_limitweiNone,不考察近n月字段各账期取值分布, dis_exam返回None！

20220322-17:04:57  字段类型分布: 
                       float64    50
                       object    25
                       datetime64[ns]    2
                       dtype: int64


C:\Program Files\JetBrains\PyCharm 2020.3.3\plugins\python\helpers\pydev\pydevconsole.py:21: UserWarning: field_base中未包括下列字段，但实际数据 多出：{'user_acct_month', 'data_use'}
  


C:\Program Files\JetBrains\PyCharm 2020.3.3\plugins\python\helpers\pydev\pydevconsole.py:24: UserWarning: field_base中未规定下列字段数据类型，请确认默认类型是否正确：{'user_acct_month': 'object', 'data_use': 'object'}
  


20220322-17:04:57  填充数值型&类别型字段缺失值
20220322-17:04:57  日期型字段缺失值情况：
                       innet_date    30
                       last_stop_date    34
                       dtype: int64
                   Out[112]: 20220322-17:05:16  
                   0                    1
                   1                    1
                   2                    1
                   3                    1
                   4                    1
                   5                    1
                   6                    1
                   7                    1
                   8                    1
                   9                    1
                   10                   1
                   11                   1
                   12                   1
                   13                   1
                   14                   1
                   15                   1
                   16                   1
                   17                   1
                   18                   1
                   19                   1
                   20                   1
                   21                   1
                   22                   1
                   23                   1
                   24                   1
                   25                   1
                   26                   1
                   27                   1
                   28                   1
                   29                   1
                   30                   1
                   31                   1
                   32                   1
                   33                   1
                   34                   1
                   35                   1
                   36                   1
                   37                   1
                   38                   1
                   39                   1
                   40                   1
                   41                   1
                   42                   1
                   43                   1
                   44                   1
                   45                   1
                   46                   1
                   47                   1
                   48                   1
                   49                   1
                   50                   1
                   51                   1
                   52                   1
                   53                   1
                   54                   1
                   55                   1
                   56                   1
                   57                   1
                   58                   1
                   59                   1
                   60                   1
                   61                   1
                   62                   1
                   63                   1
                   64                   1
                   65                   1
                   66                   1
                   67                   1
                   68                   1
                   69                   1
                   70                   1
                   71                   1
                   72                   1
                   73                   1
                   74                   1
                   75                   1
                   76                   1
                   77                   1
                   78                   1
                   79                   1
                   80                   1
                   81                   1
                   82                   1
                   83                   1
                   84                   1
                   85                   1
                   86                   1
                   87                   1
                   88                   1
                   89                   1
                   90                   1
                   91                   1
                   92                   1
                   93                   1
                   94                   1
                   95                   1
                   96                   1
                   97                   1
                   98                   1
                   99                   1
                   100                  1
                   101                  1
                   102                  1
                   103                  1
                   104                  1
                   105                  1
                   106                  1
                   107                  1
                   108                  1
                   109                  1
                   110                  1
                   111                  1
                   112                  1
                   113                  1
                   114                  1
                   115                  1
                   116                  1
                   117                  1
                   118                  1
                   119                  1
                   120                  1
                   121                  1
                   122                  1
                   123                  1
                   124                  1
                   125                  1
                   126                  1
                   127                  1
                   128                  1
                   129                  1
                   130                  1
                   131                  1
                   132                  1
                   133                  1
                   134                  1
                   135                  1
                   136                  1
                   137                  1
                   138                  1
                   139                  1
                   140                  1
                   141                  1
                   142                  1
                   143                  1
                   144                  1
                   145                  1
                   146                  1
                   147                  1
                   148                  1
                   149                  1
                   150                  1
                   151                  1
                   152                  1
                   153                  1
                   154                  1
                   155                  1
                   156                  1
                   157                  1
                   158                  1
                   159                  1
                   160                  1
                   161                  1
                   162                  1
                   163                  1
                   164                  1
                   165                  1
                   166                  1
                   167                  1
                   168                  1
                   169                  1
                   170                  1
                   171                  1
                   172                  1
                   173                  1
                   174                  1
                   175                  1
                   176                  1
                   177                  1
                   178                  1
                   179                  1
                   180                  1
                   181                  1
                   182                  1
                   183                  1
                   184                  1
                   185                  1
                   186                  1
                   187                  1
                   188                  1
                   189                  1
                   190                  1
                   191                  1
                   192                  1
                   193                  1
                   194                  1
                   195                  1
                   196                  1
                   197                  1
                   198                  1
                   199                  1
                   200                  1
                   201                  1
                   202                  1
                   203                  1
                   204                  1
                   205                  1
                   206                  1
                   207                  1
                   208                  1
                   209                  1
                   210                  1
                   211                  1
                   212                  1
                   213                  1
                   214                  1
                   215                  1
                   216                  1
                   217                  1
                   218                  1
                   219                  1
                   220                  1
                   221                  1
                   222                  1
                   223                  1
                   224                  1
                   225                  1
                   226                  1
                   227                  1
                   228                  1
                   229                  1
                   230                  1
                   231                  1
                   232                  1
                   233                  1
                   234                  1
                   235                  1
                   236                  1
                   237                  1
                   238                  1
                   239                  1
                   240                  1
                   241                  1
                   242                  1
                   243                  1
                   244                  1
                   245                  1
                   246                  1
                   247                  1
                   248                  1
                   249                  1
                                   ...   
                   9560           unknown
                   9561           unknown
                   9562           unknown
                   9563           unknown
                   9564           unknown
                   9565           unknown
                   9566           unknown
                   9567           unknown
                   9568           unknown
                   9569           unknown
                   9570           unknown
                   9571           unknown
                   9572           unknown
                   9573           unknown
                   9574           unknown
                   9575           unknown
                   9576           unknown
                   9577           unknown
                   9578           unknown
                   9579           unknown
                   9580           unknown
                   9581           unknown
                   9582           unknown
                   9583           unknown
                   9584           unknown
                   9585           unknown
                   9586           unknown
                   9587           unknown
                   9588           unknown
                   9589           unknown
                   9590           unknown
                   9591           unknown
                   9592           unknown
                   9593           unknown
                   9594           unknown
                   9595           unknown
                   9596           unknown
                   9597           unknown
                   9598           unknown
                   9599           unknown
                   9600           unknown
                   9601           unknown
                   9602           unknown
                   9603           unknown
                   9604           unknown
                   9605           unknown
                   9606           unknown
                   9607           unknown
                   9608           unknown
                   9609           unknown
                   9610           unknown
                   9611           unknown
                   9612           unknown
                   9613           unknown
                   9614           unknown
                   9615           unknown
                   9616           unknown
                   9617           unknown
                   9618           unknown
                   9619           unknown
                   9620           unknown
                   9621           unknown
                   9622           unknown
                   9623           unknown
                   9624           unknown
                   9625           unknown
                   9626           unknown
                   9627           unknown
                   9628           unknown
                   9629           unknown
                   9630           unknown
                   9631           unknown
                   9632           unknown
                   9633           unknown
                   9634           unknown
                   9635           unknown
                   9636           unknown
                   9637           unknown
                   9638           unknown
                   9639           unknown
                   9640           unknown
                   9641           unknown
                   9642           unknown
                   9643           unknown
                   9644           unknown
                   9645           unknown
                   9646           unknown
                   9647           unknown
                   9648           unknown
                   9649           unknown
                   9650           unknown
                   9651           unknown
                   9652           unknown
                   9653           unknown
                   9654           unknown
                   9655           unknown
                   9656           unknown
                   9657           unknown
                   9658           unknown
                   9659           unknown
                   9660           unknown
                   9661           unknown
                   9662           unknown
                   9663           unknown
                   9664           unknown
                   9665           unknown
                   9666           unknown
                   9667           unknown
                   9668           unknown
                   9669           unknown
                   9670           unknown
                   9671           unknown
                   9672           unknown
                   9673           unknown
                   9674           unknown
                   9675           unknown
                   9676           unknown
                   9677           unknown
                   9678           unknown
                   9679           unknown
                   9680           unknown
                   9681           unknown
                   9682           unknown
                   9683           unknown
                   9684           unknown
                   9685           unknown
                   9686           unknown
                   9687           unknown
                   9688           unknown
                   9689           unknown
                   9690           unknown
                   9691           unknown
                   9692           unknown
                   9693           unknown
                   9694           unknown
                   9695           unknown
                   9696           unknown
                   9697           unknown
                   9698           unknown
                   9699           unknown
                   9700           unknown
                   9701           unknown
                   9702           unknown
                   9703           unknown
                   9704           unknown
                   9705           unknown
                   9706           unknown
                   9707           unknown
                   9708           unknown
                   9709           unknown
                   9710           unknown
                   9711           unknown
                   9712           unknown
                   9713           unknown
                   9714           unknown
                   9715           unknown
                   9716           unknown
                   9717           unknown
                   9718           unknown
                   9719           unknown
                   9720           unknown
                   9721           unknown
                   9722           unknown
                   9723           unknown
                   9724           unknown
                   9725           unknown
                   9726           unknown
                   9727           unknown
                   9728           unknown
                   9729           unknown
                   9730           unknown
                   9731           unknown
                   9732           unknown
                   9733           unknown
                   9734           unknown
                   9735           unknown
                   9736           unknown
                   9737           unknown
                   9738           unknown
                   9739           unknown
                   9740           unknown
                   9741           unknown
                   9742           unknown
                   9743           unknown
                   9744           unknown
                   9745           unknown
                   9746           unknown
                   9747           unknown
                   9748           unknown
                   9749           unknown
                   9750           unknown
                   9751           unknown
                   9752           unknown
                   9753           unknown
                   9754           unknown
                   9755           unknown
                   9756           unknown
                   9757           unknown
                   9758           unknown
                   9759           unknown
                   9760           unknown
                   9761           unknown
                   9762           unknown
                   9763           unknown
                   9764           unknown
                   9765           unknown
                   9766           unknown
                   9767           unknown
                   9768           unknown
                   9769           unknown
                   9770           unknown
                   9771           unknown
                   9772           unknown
                   9773           unknown
                   9774           unknown
                   9775           unknown
                   9776           unknown
                   9777           unknown
                   9778           unknown
                   9779           unknown
                   80556481977    unknown
                   19519559896    unknown
                   17960654021    unknown
                   21115309455    unknown
                   74451042494    unknown
                   80106653999    unknown
                   76285695941    unknown
                   77680735431    unknown
                   25641173996    unknown
                   23199267830    unknown
                   24650012890    unknown
                   10116948064    unknown
                   19647672706    unknown
                   81438140134    unknown
                   10132223347    unknown
                   80556481977    unknown
                   19519559896    unknown
                   17960654021    unknown
                   21115309455    unknown
                   74451042494    unknown
                   80106653999    unknown
                   76285695941    unknown
                   77680735431    unknown
                   25641173996    unknown
                   23199267830    unknown
                   24650012890    unknown
                   10116948064    unknown
                   19647672706    unknown
                   81438140134    unknown
                   10132223347    unknown
                   Name: flag_eg, Length: 9810, dtype: object

20220322-17:05:31  正负例分布：
                       data_train  202011  0    2180
                       data_train  202011  1    1090
                       dtype: int64
                   Out[114]: 20220322-17:05:33  
                   0                    1
                   1                    1
                   2                    1
                   3                    1
                   4                    1
                   5                    1
                   6                    1
                   7                    1
                   8                    1
                   9                    1
                   10                   1
                   11                   1
                   12                   1
                   13                   1
                   14                   1
                   15                   1
                   16                   1
                   17                   1
                   18                   1
                   19                   1
                   20                   1
                   21                   1
                   22                   1
                   23                   1
                   24                   1
                   25                   1
                   26                   1
                   27                   1
                   28                   1
                   29                   1
                   30                   1
                   31                   1
                   32                   1
                   33                   1
                   34                   1
                   35                   1
                   36                   1
                   37                   1
                   38                   1
                   39                   1
                   40                   1
                   41                   1
                   42                   1
                   43                   1
                   44                   1
                   45                   1
                   46                   1
                   47                   1
                   48                   1
                   49                   1
                   50                   1
                   51                   1
                   52                   1
                   53                   1
                   54                   1
                   55                   1
                   56                   1
                   57                   1
                   58                   1
                   59                   1
                   60                   1
                   61                   1
                   62                   1
                   63                   1
                   64                   1
                   65                   1
                   66                   1
                   67                   1
                   68                   1
                   69                   1
                   70                   1
                   71                   1
                   72                   1
                   73                   1
                   74                   1
                   75                   1
                   76                   1
                   77                   1
                   78                   1
                   79                   1
                   80                   1
                   81                   1
                   82                   1
                   83                   1
                   84                   1
                   85                   1
                   86                   1
                   87                   1
                   88                   1
                   89                   1
                   90                   1
                   91                   1
                   92                   1
                   93                   1
                   94                   1
                   95                   1
                   96                   1
                   97                   1
                   98                   1
                   99                   1
                   100                  1
                   101                  1
                   102                  1
                   103                  1
                   104                  1
                   105                  1
                   106                  1
                   107                  1
                   108                  1
                   109                  1
                   110                  1
                   111                  1
                   112                  1
                   113                  1
                   114                  1
                   115                  1
                   116                  1
                   117                  1
                   118                  1
                   119                  1
                   120                  1
                   121                  1
                   122                  1
                   123                  1
                   124                  1
                   125                  1
                   126                  1
                   127                  1
                   128                  1
                   129                  1
                   130                  1
                   131                  1
                   132                  1
                   133                  1
                   134                  1
                   135                  1
                   136                  1
                   137                  1
                   138                  1
                   139                  1
                   140                  1
                   141                  1
                   142                  1
                   143                  1
                   144                  1
                   145                  1
                   146                  1
                   147                  1
                   148                  1
                   149                  1
                   150                  1
                   151                  1
                   152                  1
                   153                  1
                   154                  1
                   155                  1
                   156                  1
                   157                  1
                   158                  1
                   159                  1
                   160                  1
                   161                  1
                   162                  1
                   163                  1
                   164                  1
                   165                  1
                   166                  1
                   167                  1
                   168                  1
                   169                  1
                   170                  1
                   171                  1
                   172                  1
                   173                  1
                   174                  1
                   175                  1
                   176                  1
                   177                  1
                   178                  1
                   179                  1
                   180                  1
                   181                  1
                   182                  1
                   183                  1
                   184                  1
                   185                  1
                   186                  1
                   187                  1
                   188                  1
                   189                  1
                   190                  1
                   191                  1
                   192                  1
                   193                  1
                   194                  1
                   195                  1
                   196                  1
                   197                  1
                   198                  1
                   199                  1
                   200                  1
                   201                  1
                   202                  1
                   203                  1
                   204                  1
                   205                  1
                   206                  1
                   207                  1
                   208                  1
                   209                  1
                   210                  1
                   211                  1
                   212                  1
                   213                  1
                   214                  1
                   215                  1
                   216                  1
                   217                  1
                   218                  1
                   219                  1
                   220                  1
                   221                  1
                   222                  1
                   223                  1
                   224                  1
                   225                  1
                   226                  1
                   227                  1
                   228                  1
                   229                  1
                   230                  1
                   231                  1
                   232                  1
                   233                  1
                   234                  1
                   235                  1
                   236                  1
                   237                  1
                   238                  1
                   239                  1
                   240                  1
                   241                  1
                   242                  1
                   243                  1
                   244                  1
                   245                  1
                   246                  1
                   247                  1
                   248                  1
                   249                  1
                                   ...   
                   9560           unknown
                   9561           unknown
                   9562           unknown
                   9563           unknown
                   9564           unknown
                   9565           unknown
                   9566           unknown
                   9567           unknown
                   9568           unknown
                   9569           unknown
                   9570           unknown
                   9571           unknown
                   9572           unknown
                   9573           unknown
                   9574           unknown
                   9575           unknown
                   9576           unknown
                   9577           unknown
                   9578           unknown
                   9579           unknown
                   9580           unknown
                   9581           unknown
                   9582           unknown
                   9583           unknown
                   9584           unknown
                   9585           unknown
                   9586           unknown
                   9587           unknown
                   9588           unknown
                   9589           unknown
                   9590           unknown
                   9591           unknown
                   9592           unknown
                   9593           unknown
                   9594           unknown
                   9595           unknown
                   9596           unknown
                   9597           unknown
                   9598           unknown
                   9599           unknown
                   9600           unknown
                   9601           unknown
                   9602           unknown
                   9603           unknown
                   9604           unknown
                   9605           unknown
                   9606           unknown
                   9607           unknown
                   9608           unknown
                   9609           unknown
                   9610           unknown
                   9611           unknown
                   9612           unknown
                   9613           unknown
                   9614           unknown
                   9615           unknown
                   9616           unknown
                   9617           unknown
                   9618           unknown
                   9619           unknown
                   9620           unknown
                   9621           unknown
                   9622           unknown
                   9623           unknown
                   9624           unknown
                   9625           unknown
                   9626           unknown
                   9627           unknown
                   9628           unknown
                   9629           unknown
                   9630           unknown
                   9631           unknown
                   9632           unknown
                   9633           unknown
                   9634           unknown
                   9635           unknown
                   9636           unknown
                   9637           unknown
                   9638           unknown
                   9639           unknown
                   9640           unknown
                   9641           unknown
                   9642           unknown
                   9643           unknown
                   9644           unknown
                   9645           unknown
                   9646           unknown
                   9647           unknown
                   9648           unknown
                   9649           unknown
                   9650           unknown
                   9651           unknown
                   9652           unknown
                   9653           unknown
                   9654           unknown
                   9655           unknown
                   9656           unknown
                   9657           unknown
                   9658           unknown
                   9659           unknown
                   9660           unknown
                   9661           unknown
                   9662           unknown
                   9663           unknown
                   9664           unknown
                   9665           unknown
                   9666           unknown
                   9667           unknown
                   9668           unknown
                   9669           unknown
                   9670           unknown
                   9671           unknown
                   9672           unknown
                   9673           unknown
                   9674           unknown
                   9675           unknown
                   9676           unknown
                   9677           unknown
                   9678           unknown
                   9679           unknown
                   9680           unknown
                   9681           unknown
                   9682           unknown
                   9683           unknown
                   9684           unknown
                   9685           unknown
                   9686           unknown
                   9687           unknown
                   9688           unknown
                   9689           unknown
                   9690           unknown
                   9691           unknown
                   9692           unknown
                   9693           unknown
                   9694           unknown
                   9695           unknown
                   9696           unknown
                   9697           unknown
                   9698           unknown
                   9699           unknown
                   9700           unknown
                   9701           unknown
                   9702           unknown
                   9703           unknown
                   9704           unknown
                   9705           unknown
                   9706           unknown
                   9707           unknown
                   9708           unknown
                   9709           unknown
                   9710           unknown
                   9711           unknown
                   9712           unknown
                   9713           unknown
                   9714           unknown
                   9715           unknown
                   9716           unknown
                   9717           unknown
                   9718           unknown
                   9719           unknown
                   9720           unknown
                   9721           unknown
                   9722           unknown
                   9723           unknown
                   9724           unknown
                   9725           unknown
                   9726           unknown
                   9727           unknown
                   9728           unknown
                   9729           unknown
                   9730           unknown
                   9731           unknown
                   9732           unknown
                   9733           unknown
                   9734           unknown
                   9735           unknown
                   9736           unknown
                   9737           unknown
                   9738           unknown
                   9739           unknown
                   9740           unknown
                   9741           unknown
                   9742           unknown
                   9743           unknown
                   9744           unknown
                   9745           unknown
                   9746           unknown
                   9747           unknown
                   9748           unknown
                   9749           unknown
                   9750           unknown
                   9751           unknown
                   9752           unknown
                   9753           unknown
                   9754           unknown
                   9755           unknown
                   9756           unknown
                   9757           unknown
                   9758           unknown
                   9759           unknown
                   9760           unknown
                   9761           unknown
                   9762           unknown
                   9763           unknown
                   9764           unknown
                   9765           unknown
                   9766           unknown
                   9767           unknown
                   9768           unknown
                   9769           unknown
                   9770           unknown
                   9771           unknown
                   9772           unknown
                   9773           unknown
                   9774           unknown
                   9775           unknown
                   9776           unknown
                   9777           unknown
                   9778           unknown
                   9779           unknown
                   80556481977    unknown
                   19519559896    unknown
                   17960654021    unknown
                   21115309455    unknown
                   74451042494    unknown
                   80106653999    unknown
                   76285695941    unknown
                   77680735431    unknown
                   25641173996    unknown
                   23199267830    unknown
                   24650012890    unknown
                   10116948064    unknown
                   19647672706    unknown
                   81438140134    unknown
                   10132223347    unknown
                   80556481977    unknown
                   19519559896    unknown
                   17960654021    unknown
                   21115309455    unknown
                   74451042494    unknown
                   80106653999    unknown
                   76285695941    unknown
                   77680735431    unknown
                   25641173996    unknown
                   23199267830    unknown
                   24650012890    unknown
                   10116948064    unknown
                   19647672706    unknown
                   81438140134    unknown
                   10132223347    unknown
                   Name: flag_eg, Length: 9810, dtype: object

                   ----------------------------------------- 当月 数值型&类别型 原始数据 
20220322-17:05:38  新数据newdata的shape：(3270, 71)
20220322-17:05:38  数据转换


C:\Users\higher\Desktop\to伟鹏的代码_v2\ModelProject\selfmodule\toolmodule\dataprep.py:463: UserWarning:     FeaturePrefilter_DF unique_limit(5000)小于X行数(3270), 添加unique_limit_actual：len(X)*0.99=3237
  warnings.warn(s)
20220322-17:05:46  转换后shape：(3270, 30)
20220322-17:05:47  从流水线中获取WoeTransformer_DF
20220322-17:05:47  首个数据集，直接返回woe编码结果
20220322-17:06:04  筛选衍生字段的 原始/手动衍生_sql 字段
20220322-17:06:04  数值型字段：有效字段25个，其中当月自动衍生字段24个，近n月自动衍生字段24个
20220322-17:06:04  类别型字段：有效字段5个（强制加入0个）:
20220322-17:06:04      当月自动衍生_py字段4个: ['if_nolimit~是', 'if_5g_dinner~是', 'greatest_gprs_app~commu', 'greatest_gprs_app~video']
20220322-17:06:04      近n月自动衍生_py字段5个: ['account_id~其他_countlow', 'if_nolimit~是', 'if_5g_dinner~是', 'greatest_gprs_app~commu', 'greatest_gprs_app~video']

                   ----------------------------------------- 近n月 数值型 近3月均值 
20220322-17:06:04  字段个数：24, 添加字段：['flag_eg']
20220322-17:06:04  新数据newdata的shape：(3270, 25)
20220322-17:06:04  数据转换


C:\Users\higher\Desktop\to伟鹏的代码_v2\ModelProject\selfmodule\toolmodule\dataprep.py:375: UserWarning:     NumStrSpliter 数据中未出现非数值型字段！
  warnings.warn(s)
20220322-17:06:08  转换后shape：(3270, 23)
20220322-17:06:08  从流水线中获取WoeTransformer_DF
20220322-17:06:10  待新增字段与原宽表字段 相关性系数大于Info.r_limit（0.95）的字段对有2对
20220322-17:06:10      从中二者中剔除字段2个字段:['avg__dinner_fee', 'monthsremain_last_stop_date']
20220322-17:06:10      其中待新增中剔除1个
20220322-17:06:10      其中原宽表中剔除1个

20220322-17:06:10  已有宽表shape：(3270, 30)
20220322-17:06:10  向宽表中加入字段（22个）：['avg__calling_cnt', 'avg__calling_dura', 'avg__call_use', 'avg__gprs_flow_video', 'avg__gprs_now_rest', 'avg__gprs_flow_game', 'avg__gprs_flow_roam', 'avg__gprs_resource', 'avg__calling_diff_cnt', 'avg__monthsremain_last_stop_date', 'avg__gprs_flow_music', 'avg__nos_calling_diff', 'avg__arpu', 'avg__calling_diff_dura', 'avg__call_dura_roam', 'avg__gprs_last_defer', 'avg__gprs_flow_5g', 'avg__gprs_now_defer', 'avg__gprs_flow_busy', 'avg__gprs_flow_commu', 'avg__nos_calling', 'avg__gprs_flow_short']
20220322-17:06:10  从宽表中删除字段（1个）：['monthsremain_last_stop_date']
20220322-17:06:10  目前宽表shape：(3270, 51)

                   ----------------------------------------- 近n月 数值型 近3月离散系数 
20220322-17:06:10  字段个数：24, 添加字段：['flag_eg']
20220322-17:06:11  新数据newdata的shape：(3270, 25)
20220322-17:06:11  数据转换


C:\Users\higher\Desktop\to伟鹏的代码_v2\ModelProject\selfmodule\toolmodule\dataprep.py:375: UserWarning:     NumStrSpliter 数据中未出现非数值型字段！
  warnings.warn(s)
20220322-17:06:13  转换后shape：(3270, 11)
20220322-17:06:13  从流水线中获取WoeTransformer_DF
20220322-17:06:14  待新增字段与原宽表字段 相关性系数大于Info.r_limit（0.95）的字段对有1对
20220322-17:06:14      从中二者中剔除字段1个字段:['sep__gprs_flow_game']
20220322-17:06:14      其中待新增中剔除1个
20220322-17:06:14      其中原宽表中剔除0个

20220322-17:06:14  已有宽表shape：(3270, 51)
20220322-17:06:14  向宽表中加入字段（10个）：['sep__gprs_last_defer', 'sep__gprs_flow_5g', 'sep__calling_diff_dura', 'sep__gprs_flow_short', 'sep__gprs_flow_video', 'sep__gprs_flow_music', 'sep__gprs_flow_commu', 'sep__gprs_now_rest', 'sep__gprs_resource', 'sep__nos_calling']
20220322-17:06:14  从宽表中删除字段（0个）：[]
20220322-17:06:14  目前宽表shape：(3270, 61)

                   ----------------------------------------- 近n月 数值型 近3月波动性 
20220322-17:06:14  字段个数：24, 添加字段：['flag_eg']
20220322-17:06:14  新数据newdata的shape：(3270, 25)
20220322-17:06:14  数据转换


C:\Users\higher\Desktop\to伟鹏的代码_v2\ModelProject\selfmodule\toolmodule\dataprep.py:375: UserWarning:     NumStrSpliter 数据中未出现非数值型字段！
  warnings.warn(s)
20220322-17:06:17  转换后shape：(3270, 13)
20220322-17:06:17  从流水线中获取WoeTransformer_DF
20220322-17:06:17  待新增字段与原宽表字段 相关性系数大于Info.r_limit（0.95）的字段对有6对
20220322-17:06:17      从中二者中剔除字段6个字段:['sep__gprs_flow_music', 'sep__gprs_resource', 'sep__gprs_flow_short', 'wave__gprs_flow_video', 'wave__gprs_flow_game', 'wave__gprs_flow_commu']
20220322-17:06:17      其中待新增中剔除3个
20220322-17:06:17      其中原宽表中剔除3个

20220322-17:06:17  已有宽表shape：(3270, 61)
20220322-17:06:17  向宽表中加入字段（10个）：['wave__gprs_flow_music', 'wave__gprs_now_rest', 'wave__gprs_last_defer', 'wave__gprs_resource', 'wave__gprs_flow_short', 'wave__calling_cnt', 'wave__gprs_flow_5g', 'wave__calling_dura', 'wave__call_use', 'wave__gprs_now_defer']
20220322-17:06:17  从宽表中删除字段（3个）：['sep__gprs_flow_music', 'sep__gprs_flow_short', 'sep__gprs_resource']
20220322-17:06:17  目前宽表shape：(3270, 68)

                   ----------------------------------------- 近n月 数值型 近3月成长率 
20220322-17:06:18  字段个数：24, 添加字段：['flag_eg']
20220322-17:06:18  新数据newdata的shape：(3270, 25)
20220322-17:06:18  数据转换


C:\Users\higher\Desktop\to伟鹏的代码_v2\ModelProject\selfmodule\toolmodule\dataprep.py:375: UserWarning:     NumStrSpliter 数据中未出现非数值型字段！
  warnings.warn(s)
20220322-17:06:21  转换后shape：(3270, 20)
20220322-17:06:21  从流水线中获取WoeTransformer_DF
20220322-17:06:22  待新增字段与原宽表字段 相关性系数大于Info.r_limit（0.95）的字段对有9对
20220322-17:06:22      从中二者中剔除字段9个字段:['grow__gprs_flow_music', 'grow__gprs_flow_game', 'grow__gprs_resource', 'dinner_fee', 'grow__gprs_flow_5g', 'grow__arpu', 'grow__gprs_flow_busy', 'grow__monthsremain_last_stop_date', 'grow__gprs_flow_short']
20220322-17:06:22      其中待新增中剔除8个
20220322-17:06:22      其中原宽表中剔除1个

20220322-17:06:22  已有宽表shape：(3270, 68)
20220322-17:06:22  向宽表中加入字段（12个）：['grow__gprs_last_defer', 'grow__dinner_fee', 'grow__nos_calling', 'grow__call_use', 'grow__calling_diff_dura', 'grow__gprs_flow_commu', 'grow__gprs_now_defer', 'grow__nos_calling_diff', 'grow__calling_cnt', 'grow__gprs_now_rest', 'grow__calling_dura', 'grow__gprs_flow_video']
20220322-17:06:22  从宽表中删除字段（1个）：['dinner_fee']
20220322-17:06:22  目前宽表shape：(3270, 79)

                   ----------------------------------------- 近n月 数值型 近3月最大值 
20220322-17:06:22  字段个数：24, 添加字段：['flag_eg']
20220322-17:06:22  新数据newdata的shape：(3270, 25)
20220322-17:06:22  数据转换


C:\Users\higher\Desktop\to伟鹏的代码_v2\ModelProject\selfmodule\toolmodule\dataprep.py:375: UserWarning:     NumStrSpliter 数据中未出现非数值型字段！
  warnings.warn(s)
20220322-17:06:25  转换后shape：(3270, 23)
20220322-17:06:26  从流水线中获取WoeTransformer_DF
20220322-17:06:26  待新增字段与原宽表字段 相关性系数大于Info.r_limit（0.95）的字段对有11对
20220322-17:06:26      从中二者中剔除字段10个字段:['max__gprs_flow_music', 'max__gprs_flow_game', 'avg__gprs_flow_5g', 'max__dinner_fee', 'max__gprs_flow_video', 'max__gprs_flow_short', 'max__gprs_now_defer', 'max__gprs_flow_commu', 'max__gprs_resource', 'max__gprs_flow_busy']
20220322-17:06:26      其中待新增中剔除9个
20220322-17:06:26      其中原宽表中剔除1个

20220322-17:06:26  已有宽表shape：(3270, 79)
20220322-17:06:26  向宽表中加入字段（14个）：['max__gprs_last_defer', 'max__calling_diff_dura', 'max__call_dura_roam', 'max__nos_calling', 'max__arpu', 'max__call_use', 'max__calling_diff_cnt', 'max__gprs_flow_5g', 'max__calling_cnt', 'max__nos_calling_diff', 'max__gprs_flow_roam', 'max__monthsremain_last_stop_date', 'max__gprs_now_rest', 'max__calling_dura']
20220322-17:06:26  从宽表中删除字段（1个）：['avg__gprs_flow_5g']
20220322-17:06:26  目前宽表shape：(3270, 92)

                   ----------------------------------------- 近n月 数值型 近3月最小值 
20220322-17:06:26  字段个数：24, 添加字段：['flag_eg']
20220322-17:06:26  新数据newdata的shape：(3270, 25)
20220322-17:06:26  数据转换


C:\Users\higher\Desktop\to伟鹏的代码_v2\ModelProject\selfmodule\toolmodule\dataprep.py:375: UserWarning:     NumStrSpliter 数据中未出现非数值型字段！
  warnings.warn(s)
20220322-17:06:30  转换后shape：(3270, 22)
20220322-17:06:30  从流水线中获取WoeTransformer_DF
20220322-17:06:31  待新增字段与原宽表字段 相关性系数大于Info.r_limit（0.95）的字段对有3对
20220322-17:06:31      从中二者中剔除字段3个字段:['min__monthsremain_last_stop_date', 'min__gprs_now_defer', 'min__dinner_fee']
20220322-17:06:31      其中待新增中剔除3个
20220322-17:06:31      其中原宽表中剔除0个

20220322-17:06:31  已有宽表shape：(3270, 92)
20220322-17:06:31  向宽表中加入字段（19个）：['min__gprs_flow_short', 'min__call_use', 'min__calling_diff_cnt', 'min__gprs_flow_commu', 'min__nos_calling', 'min__calling_dura', 'min__gprs_flow_music', 'min__calling_diff_dura', 'min__days_call_p_4', 'min__gprs_flow_roam', 'min__gprs_last_defer', 'min__calling_cnt', 'min__gprs_flow_game', 'min__gprs_resource', 'min__gprs_flow_video', 'min__arpu', 'min__gprs_flow_busy', 'min__nos_calling_diff', 'min__gprs_now_rest']
20220322-17:06:31  从宽表中删除字段（0个）：[]
20220322-17:06:31  目前宽表shape：(3270, 111)

                   ----------------------------------------- 近n月 数值型 近3月标准差 
20220322-17:06:31  字段个数：24, 添加字段：['flag_eg']
20220322-17:06:31  新数据newdata的shape：(3270, 25)
20220322-17:06:31  数据转换


C:\Users\higher\Desktop\to伟鹏的代码_v2\ModelProject\selfmodule\toolmodule\dataprep.py:375: UserWarning:     NumStrSpliter 数据中未出现非数值型字段！
  warnings.warn(s)
20220322-17:06:33  转换后shape：(3270, 20)
20220322-17:06:34  从流水线中获取WoeTransformer_DF
20220322-17:06:35  待新增字段与原宽表字段 相关性系数大于Info.r_limit（0.95）的字段对有5对
20220322-17:06:35      从中二者中剔除字段5个字段:['std__gprs_flow_5g', 'std__gprs_flow_music', 'std__gprs_flow_game', 'std__gprs_flow_roam', 'std__gprs_flow_video']
20220322-17:06:35      其中待新增中剔除5个
20220322-17:06:35      其中原宽表中剔除0个

20220322-17:06:35  已有宽表shape：(3270, 111)
20220322-17:06:35  向宽表中加入字段（15个）：['std__calling_diff_dura', 'std__calling_diff_cnt', 'std__nos_calling', 'std__gprs_last_defer', 'std__calling_cnt', 'std__calling_dura', 'std__call_use', 'std__arpu', 'std__gprs_flow_commu', 'std__gprs_flow_short', 'std__gprs_flow_busy', 'std__gprs_now_rest', 'std__call_dura_roam', 'std__gprs_resource', 'std__nos_calling_diff']
20220322-17:06:35  从宽表中删除字段（0个）：[]
20220322-17:06:35  目前宽表shape：(3270, 126)

                   ----------------------------------------- 近n月 数值型 大于x的月份数 
20220322-17:06:35  ('more0cnt', '近3月大于0的月份数')
20220322-17:06:35  ('moreq25cnt', '近3月大于第一四分位数的月份数')
20220322-17:06:36  新数据newdata的shape：(3270, 49)
20220322-17:06:36  数据转换


C:\Users\higher\Desktop\to伟鹏的代码_v2\ModelProject\selfmodule\toolmodule\dataprep.py:375: UserWarning:     NumStrSpliter 数据中未出现非数值型字段！
  warnings.warn(s)
20220322-17:06:40  转换后shape：(3270, 17)
20220322-17:06:40  从流水线中获取WoeTransformer_DF
20220322-17:06:46  待新增字段与原宽表字段 相关性系数大于Info.r_limit（0.95）的字段对有4对
20220322-17:06:46      从中二者中剔除字段4个字段:['moreq25cnt__gprs_flow_game', 'moreq25cnt__gprs_flow_music', 'moreq25cnt__gprs_flow_commu', 'wave__gprs_flow_short']
20220322-17:06:46      其中待新增中剔除3个
20220322-17:06:46      其中原宽表中剔除1个

20220322-17:06:46  已有宽表shape：(3270, 126)
20220322-17:06:46  向宽表中加入字段（14个）：['moreq25cnt__gprs_flow_busy', 'moreq25cnt__gprs_now_defer', 'moreq25cnt__calling_dura', 'moreq25cnt__gprs_resource', 'moreq25cnt__arpu', 'moreq25cnt__nos_calling_diff', 'moreq25cnt__nos_calling', 'moreq25cnt__gprs_flow_5g', 'moreq25cnt__calling_cnt', 'moreq25cnt__gprs_flow_short', 'more0cnt__calling_cnt', 'moreq25cnt__gprs_last_defer', 'moreq25cnt__gprs_flow_video', 'moreq25cnt__calling_diff_dura']
20220322-17:06:46  从宽表中删除字段（1个）：['wave__gprs_flow_short']
20220322-17:06:46  目前宽表shape：(3270, 139)

                   ----------------------------------------- 近n月 类别型 取某值的月份数 
20220322-17:06:46  字段个数：5, 添加字段：['flag_eg']
20220322-17:06:47  新数据newdata的shape：(3270, 6)
20220322-17:06:47  数据转换


C:\Users\higher\Desktop\to伟鹏的代码_v2\ModelProject\selfmodule\toolmodule\dataprep.py:380: UserWarning: NumStrSpliter 下列字段未被归类到数值型和类别型字段集合中，请确认：
valuecnt__account_id~其他_countlow    bool
dtype: object
  warnings.warn(s)


C:\Users\higher\Desktop\to伟鹏的代码_v2\ModelProject\selfmodule\toolmodule\dataprep.py:375: UserWarning:     NumStrSpliter 数据中未出现非数值型字段！
  warnings.warn(s)


C:\Users\higher\Desktop\to伟鹏的代码_v2\ModelProject\selfmodule\toolmodule\dataprep.py:380: UserWarning: NumStrSpliter 下列字段未被归类到数值型和类别型字段集合中，请确认：
valuecnt__account_id~其他_countlow    bool
dtype: object
  warnings.warn(s)
20220322-17:06:47  转换后shape：(3270, 2)
20220322-17:06:48  从流水线中获取WoeTransformer_DF
20220322-17:06:49  待新增字段与原宽表字段 相关性系数大于Info.r_limit（0.95）的字段对有2对
20220322-17:06:49      从中二者中剔除字段2个字段:['if_nolimit~是', 'if_5g_dinner~是']
20220322-17:06:49      其中待新增中剔除0个
20220322-17:06:49      其中原宽表中剔除2个

20220322-17:06:49  已有宽表shape：(3270, 139)
20220322-17:06:49  向宽表中加入字段（2个）：['valuecnt__if_5g_dinner~是', 'valuecnt__if_nolimit~是']
20220322-17:06:49  从宽表中删除字段（2个）：['if_5g_dinner~是', 'if_nolimit~是']
20220322-17:06:49  目前宽表shape：(3270, 139)

                   ----------------------------------------- 汇总最终宽表 
20220322-17:08:13  计算字段之间的相关性系数
20220322-17:08:13  
                       count    9591.0
                       mean    0.272
                       std    0.18
                       min    0.0
                       25%    0.145
                       50%    0.225
                       75%    0.351
                       max    0.948
                       dtype: float64

20220322-17:08:13  iv分布：
                       count    139.0
                       mean    0.169
                       std    0.142
                       min    0.05
                       25%    0.07
                       50%    0.093
                       75%    0.249
                       max    0.683
                       dtype: float64

20220322-17:08:14  woe_accum(累计)概览：                                            value    0    1       woe    weight  woe_weight  ALL
                       grow__gprs_flow_busy            (0.1589, inf]  199  422  1.444848  0.295872    0.427489  621
                       avg__gprs_flow_commu         (31.166666, inf]  191  384  1.391516  0.264679    0.368305  575
                       moreq25cnt__gprs_flow_commu        (2.5, inf]  193  350  1.288390  0.232569    0.299639  543
                       more0cnt__gprs_flow_commu          (2.5, inf]  193  350  1.288390  0.232569    0.299639  543
                       std__gprs_flow_busy          (1330688.0, inf]  238  430  1.284662  0.285321    0.366541  668

20220322-17:08:14  最终宽表字段列表col_all:
20220322-17:08:14      len(col_all): 139
20220322-17:08:14      补充3个的字段（must_remain=是）：{'greatest_gprs_app', 'user_status', 'account_id'}
20220322-17:08:14      len(col_all): 142
20220322-17:08:14      补充账期、数据集名称、用户标识等，目标字段(Info.col_mark、Info.col_target)
20220322-17:08:14      len(col_all): 147

20220322-17:08:14      补充4个的字段（col_mark、col_target、condition、dict_sortscore、col_out）：{'last_stop_date', 'phone_no_null', 'sms_cnt', 'call_fee_local'}
20220322-17:08:14      len(col_all): 151
20220322-17:08:14  整理宽表数据字典


Traceback (most recent call last):
  File "C:\Users\higher\Anaconda3\lib\site-packages\IPython\core\interactiveshell.py", line 2961, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-117-ecc3564d880c>", line 67, in <module>
    comment_all = pd.concat([Info.field_base[Info.field_base.field_src != '自动衍生_py'], char_validvalue_df, comment_auto, field_base[field_base.field_src == '自动衍生_py']])
  File "C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\reshape\concat.py", line 226, in concat
    return op.get_result()
  File "C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\reshape\concat.py", line 423, in get_result
    copy=self.copy)
  File "C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\internals.py", line 5406, in concatenate_block_managers
    for placement, join_units in concat_plan:
  File "C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\internals.py", line 5699, in combine_concat_plans
    raise ValueError("Plan shapes are not aligned")
ValueError: Plan shapes are not aligned
20220322-17:08:37  整理宽表数据字典


Traceback (most recent call last):
  File "C:\Users\higher\Anaconda3\lib\site-packages\IPython\core\interactiveshell.py", line 2961, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-131-1b7536992c86>", line 1, in <module>
    comment_all = pd.concat([Info.field_base[Info.field_base.field_src != '自动衍生_py'], char_validvalue_df, comment_auto, field_base[field_base.field_src == '自动衍生_py']])
  File "C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\reshape\concat.py", line 226, in concat
    return op.get_result()
  File "C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\reshape\concat.py", line 423, in get_result
    copy=self.copy)
  File "C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\internals.py", line 5406, in concatenate_block_managers
    for placement, join_units in concat_plan:
  File "C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\internals.py", line 5699, in combine_concat_plans
    raise ValueError("Plan shapes are not aligned")
ValueError: Plan shapes are not aligned


Traceback (most recent call last):
  File "C:\Users\higher\Anaconda3\lib\site-packages\IPython\core\interactiveshell.py", line 2961, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-132-1b7536992c86>", line 1, in <module>
    comment_all = pd.concat([Info.field_base[Info.field_base.field_src != '自动衍生_py'], char_validvalue_df, comment_auto, field_base[field_base.field_src == '自动衍生_py']])
  File "C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\reshape\concat.py", line 226, in concat
    return op.get_result()
  File "C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\reshape\concat.py", line 423, in get_result
    copy=self.copy)
  File "C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\internals.py", line 5406, in concatenate_block_managers
    for placement, join_units in concat_plan:
  File "C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\internals.py", line 5699, in combine_concat_plans
    raise ValueError("Plan shapes are not aligned")
ValueError: Plan shapes are not aligned


Traceback (most recent call last):
  File "C:\Users\higher\Anaconda3\lib\site-packages\IPython\core\interactiveshell.py", line 2961, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-133-1b7536992c86>", line 1, in <module>
    comment_all = pd.concat([Info.field_base[Info.field_base.field_src != '自动衍生_py'], char_validvalue_df, comment_auto, field_base[field_base.field_src == '自动衍生_py']])
  File "C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\reshape\concat.py", line 226, in concat
    return op.get_result()
  File "C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\reshape\concat.py", line 423, in get_result
    copy=self.copy)
  File "C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\internals.py", line 5406, in concatenate_block_managers
    for placement, join_units in concat_plan:
  File "C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\internals.py", line 5699, in combine_concat_plans
    raise ValueError("Plan shapes are not aligned")
ValueError: Plan shapes are not aligned
                   Out[134]: 20220322-17:09:30  
                                        field_name                   comment dtype_classify    field_src available available_notzd  available_zd                                            formula               remark must_remain into_model is_cause  NaN  NaN  NaN  NaN  NaN  NaN
                   0                    acct_month                      账期         类别型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN       否  NaN  NaN  NaN  NaN  NaN  NaN
                   1                 phone_no_null                  手机号码         类别型         原始       NaN             NaN           NaN                                                NaN       不参与自动衍生         NaN       删除       否  NaN  NaN  NaN  NaN  NaN  NaN
                   2                   phone_no_tm                模糊手机号         类别型         原始       NaN             NaN           NaN                                                NaN       不参与自动衍生         NaN       删除       否  NaN  NaN  NaN  NaN  NaN  NaN
                   3                       user_id                  手机号id         类别型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN       否  NaN  NaN  NaN  NaN  NaN  NaN
                   4                     dinner_id              主套餐策划id         类别型         原始       NaN             NaN           NaN                                                NaN   不参与当月自动衍生         NaN        NaN       否  NaN  NaN  NaN  NaN  NaN  NaN
                   5                    account_id                  帐户编号         类别型         原始       NaN             NaN           NaN                                                NaN   不参与当月自动衍生          是        NaN       否  NaN  NaN  NaN  NaN  NaN  NaN
                   6                    innet_date                  入网日期         日期型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN       删除       否  NaN  NaN  NaN  NaN  NaN  NaN
                   7                  innet_months                  入网时长         数值型         原始       NaN             NaN           NaN                                                NaN  不参与近n月自动衍生         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   8                           age                      年龄         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   9                           sex                      性别         类别型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN       否  NaN  NaN  NaN  NaN  NaN  NaN
                   10                  user_status                  用户状态         类别型         原始       NaN             NaN           NaN                                                NaN                  NaN          是        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   11               last_stop_date              最后停机时间         日期型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN       删除       否  NaN  NaN  NaN  NaN  NaN  NaN
                   12  monthsaready_last_stop_date  最后停机时间：已发生时长         数值型  手动衍生_py       NaN             NaN           NaN                      current_date - last_stop_date                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   13  monthsremain_last_stop_date    最后停机时间：剩余时长         数值型  手动衍生_py       NaN             NaN           NaN                      last_stop_date - current_date                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   14                       dinner                    主套餐         类别型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   15                   dinner_fee                套餐月租费         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   16              gprs_last_defer              流量滚存资源         数值型         原始       NaN             NaN           NaN                                                NaN   不参与当月自动衍生         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   17                gprs_resource          gprs国内资源总量         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   18                gprs_now_rest          当月gprs资源余量         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   19                     call_use            语音资源使用量         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   20                   if_nolimit    是否不限量套餐到达用户         类别型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   21                 if_5g_dinner                是否5g套餐         类别型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   22                   if_5g_term            是否5g终端客户         类别型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   23                        if_jt              是否集团成员         类别型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   24                  start_level              客户星级标识         类别型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   25                    cred_type              机主证件类型         类别型         原始       NaN          不可用           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   26                if_cred_multi               一证n号标识         类别型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   27                         arpu                  当月arpu         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   28                      pay_cnt                自充值次数         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   29                      pay_fee                自充值额度         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   30                 acct_balance                  账户余额         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   31                   term_model              终端品牌类型         类别型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   32                   term_brand                  终端品牌         类别型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   33                    term_type                  终端类型         类别型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   34                      sk_type                  双卡类型         类别型         原始       NaN             NaN           NaN                                                NaN       不参与自动衍生         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   35                  if_new_term              是否新机用户         类别型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   36                  calling_cnt              主叫通话次数         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   37                 calling_dura          当月主叫通话时长         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   38                   called_cnt              被叫通话次数         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   39                  called_dura          当月被叫通话时长         数值型         原始       NaN          不可用           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   40             calling_diff_cnt          主叫异网通话次数         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   41            calling_diff_dura        主叫异网通话分钟数         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   42                    gprs_flow                gprs总流量         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   44                 gprs_flow_4g                gprs4g流量         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   45                 gprs_flow_5g               gprs 5g流量         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   46               gprs_flow_busy            gprs-忙时-流量         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   47               gprs_flow_idle            gprs-闲时-流量         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   48               gprs_now_defer        可延递流量资源总量         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   49               gprs_flow_roam        gprs-国内漫游-流量         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   50               call_dura_roam             省际漫游-时长         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   51                    days_roam              国内漫出天数         数值型         原始       NaN          不可用           NaN                                                NaN       不参与自动衍生         NaN       删除      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   52                  days_roam_p     国内漫出天数/当月天数         数值型  手动衍生_py       NaN             NaN           NaN                             days_roam / days_month                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   53                gprs_flow_gat      gprs-港澳台漫游-流量         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   54                     days_gat           港澳台漫游-时长         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   57                    days_gprs                  上网天数         数值型         原始       NaN             NaN           NaN                                                NaN       不参与自动衍生         NaN       删除      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   58                  days_gprs_p              上网天数占比         数值型  手动衍生_py       NaN             NaN           NaN                             days_gprs / days_month                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   59                    days_call                  通话天数         数值型         原始       NaN             NaN           NaN                                                NaN       不参与自动衍生         NaN       删除      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   60                  days_call_p              通话天数占比         数值型  手动衍生_py       NaN             NaN           NaN                             days_call / days_month                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   61                days_call_p_1            通话天数占比_1         数值型  手动衍生_py       NaN             NaN           NaN                            days_call_p + days_gprs                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   62                days_call_p_2            通话天数占比_2         数值型  手动衍生_py       NaN             NaN           NaN                          days_call_p_1 + days_gprs                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   63                days_call_p_3            通话天数占比_3         数值型  手动衍生_py       NaN             NaN           NaN                          days_call_p_2 + days_gprs                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   64                days_call_p_4            通话天数占比_4         数值型  手动衍生_py       NaN             NaN           NaN                          days_call_p_3 + days_gprs                  NaN          是        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   65                     nos_call    用户通信对端手机号码数         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   66                  nos_calling      主叫通话对端号码个数         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   67             nos_calling_diff      主叫异网对端号码个数         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   68                      sms_cnt      短信-点对点短信-条数         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   69               call_fee_local                本地通话费         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   70                call_fee_roam                漫游通话费         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   71                  gprs_income              流量出账收入         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   72                     gprs_fee           流量出账-流量费         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   73                     call_fee              套餐外语音费         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   74              gprs_flow_video            视频类应用流量         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   75              gprs_flow_short           小视频系app流量         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN          是        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   76              gprs_flow_music            音乐类应用流量         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN          是        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   77              gprs_flow_commu            通信类应用流量         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN          是        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   78               gprs_flow_game            游戏类应用流量         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN          是        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   79            greatest_gprs_app                   app偏好         类别型  手动衍生_py       NaN             NaN           NaN  {'gprs_flow_video': 'video', 'gprs_flow_short'...                  NaN          是        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   80    paste_dinner_innet_months    主套餐、入网时长：交叉         类别型  手动衍生_py       NaN             NaN           NaN                             (dinner, innet_months)                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   Out[135]: 20220322-17:09:33  
                                    field_name                               comment    field_src is_cause
                   0  account_id~其他_countlow     帐户编号：取值是否为其他_countlow  自动衍生_py       否
                   1             if_nolimit~是  是否不限量套餐到达用户：取值是否为是  自动衍生_py      NaN
                   2           if_5g_dinner~是              是否5g套餐：取值是否为是  自动衍生_py      NaN
                   3   greatest_gprs_app~commu              app偏好：取值是否为commu  自动衍生_py      NaN
                   4   greatest_gprs_app~video              app偏好：取值是否为video  自动衍生_py      NaN


Traceback (most recent call last):
  File "C:\Users\higher\Anaconda3\lib\site-packages\IPython\core\interactiveshell.py", line 2961, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-136-1f03043ba40b>", line 2, in <module>
    field_base[field_base.field_src == '自动衍生_py']])
  File "C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\reshape\concat.py", line 226, in concat
    return op.get_result()
  File "C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\reshape\concat.py", line 423, in get_result
    copy=self.copy)
  File "C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\internals.py", line 5406, in concatenate_block_managers
    for placement, join_units in concat_plan:
  File "C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\internals.py", line 5699, in combine_concat_plans
    raise ValueError("Plan shapes are not aligned")
ValueError: Plan shapes are not aligned
                   Out[137]: 20220322-17:11:24  
                                    field_name                               comment    field_src is_cause
                   0  account_id~其他_countlow     帐户编号：取值是否为其他_countlow  自动衍生_py       否
                   1             if_nolimit~是  是否不限量套餐到达用户：取值是否为是  自动衍生_py      NaN
                   2           if_5g_dinner~是              是否5g套餐：取值是否为是  自动衍生_py      NaN
                   3   greatest_gprs_app~commu              app偏好：取值是否为commu  自动衍生_py      NaN
                   4   greatest_gprs_app~video              app偏好：取值是否为video  自动衍生_py      NaN
                   Out[138]: 20220322-17:11:27  
                                    field_name                               comment    field_src is_cause
                   0  account_id~其他_countlow     帐户编号：取值是否为其他_countlow  自动衍生_py       否
                   1             if_nolimit~是  是否不限量套餐到达用户：取值是否为是  自动衍生_py      NaN
                   2           if_5g_dinner~是              是否5g套餐：取值是否为是  自动衍生_py      NaN
                   3   greatest_gprs_app~commu              app偏好：取值是否为commu  自动衍生_py      NaN
                   4   greatest_gprs_app~video              app偏好：取值是否为video  自动衍生_py      NaN


Traceback (most recent call last):
  File "C:\Users\higher\Anaconda3\lib\site-packages\IPython\core\interactiveshell.py", line 2961, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-139-24126985cc9b>", line 3, in <module>
    field_base[field_base.field_src == '自动衍生_py'].reset_index(drop=True)])
  File "C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\reshape\concat.py", line 226, in concat
    return op.get_result()
  File "C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\reshape\concat.py", line 423, in get_result
    copy=self.copy)
  File "C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\internals.py", line 5406, in concatenate_block_managers
    for placement, join_units in concat_plan:
  File "C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\internals.py", line 5699, in combine_concat_plans
    raise ValueError("Plan shapes are not aligned")
ValueError: Plan shapes are not aligned
                   Out[140]: 20220322-17:11:57  
                   Empty DataFrame
                   Columns: [field_name, comment, dtype_classify, field_src, available, available_notzd, available_zd, formula, remark, must_remain, into_model, is_cause, nan, nan, nan, nan, nan, nan]
                   Index: []


Traceback (most recent call last):
  File "C:\Users\higher\Anaconda3\lib\site-packages\IPython\core\interactiveshell.py", line 2961, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-141-81d972fd985f>", line 2, in <module>
    [a, b]
NameError: name 'b' is not defined
                   Out[144]: 20220322-17:13:26  
                      col1  col2
                   0     1     2
                   Out[145]: 20220322-17:13:30  
                      col11  col22
                   0      1      2
                   Out[146]: 20220322-17:13:42  
                      col1  col11  col2  col22
                   0   1.0    NaN   2.0    NaN
                   0   NaN    1.0   NaN    2.0
                   Out[148]: 20220322-17:13:53  
                      col1  col2
                   0     1     2
                   Out[149]: 20220322-17:13:53  
                      col1  col22
                   0     1      2
                   Out[150]: 20220322-17:13:56  
                      col1  col2  col22
                   0     1   2.0    NaN
                   0     1   NaN    2.0


Traceback (most recent call last):
  File "C:\Users\higher\Anaconda3\lib\site-packages\IPython\core\interactiveshell.py", line 2961, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-152-43fef994f556>", line 1, in <module>
    pd.concat([a1, a2, a3, a4])
  File "C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\reshape\concat.py", line 226, in concat
    return op.get_result()
  File "C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\reshape\concat.py", line 423, in get_result
    copy=self.copy)
  File "C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\internals.py", line 5406, in concatenate_block_managers
    for placement, join_units in concat_plan:
  File "C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\internals.py", line 5699, in combine_concat_plans
    raise ValueError("Plan shapes are not aligned")
ValueError: Plan shapes are not aligned


Traceback (most recent call last):
  File "C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\indexing.py", line 2070, in _get_list_axis
    return self.obj._take(key, axis=axis)
  File "C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\generic.py", line 2789, in _take
    verify=True)
  File "C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\internals.py", line 4530, in take
    indexer = maybe_convert_indices(indexer, n)
  File "C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\indexing.py", line 2480, in maybe_convert_indices
    raise IndexError("indices are out-of-bounds")
IndexError: indices are out-of-bounds
20220322-17:15:27  
                   During handling of the above exception, another exception occurred:


Traceback (most recent call last):
  File "C:\Users\higher\Anaconda3\lib\site-packages\IPython\core\interactiveshell.py", line 2961, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-153-674281417a84>", line 1, in <module>
    pd.concat([a1.iloc[[0]], a2.iloc[[0]], a3.iloc[[0]], a4.iloc[[0]]])
  File "C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\indexing.py", line 1478, in __getitem__
    return self._getitem_axis(maybe_callable, axis=axis)
  File "C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\indexing.py", line 2091, in _getitem_axis
    return self._get_list_axis(key, axis=axis)
  File "C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\indexing.py", line 2073, in _get_list_axis
    raise IndexError("positional indexers are out-of-bounds")
IndexError: positional indexers are out-of-bounds
                   Out[154]: 20220322-17:15:32  
                      field_name comment dtype_classify field_src available available_notzd  available_zd formula remark must_remain into_model is_cause  NaN  NaN  NaN  NaN  NaN  NaN
                   0  acct_month    账期         类别型      原始       NaN             NaN           NaN     NaN    NaN         NaN        NaN       否  NaN  NaN  NaN  NaN  NaN  NaN
                   Out[155]: 20220322-17:15:37  
                                    field_name                            comment    field_src is_cause
                   0  account_id~其他_countlow  帐户编号：取值是否为其他_countlow  自动衍生_py       否


Traceback (most recent call last):
  File "C:\Users\higher\Anaconda3\lib\site-packages\IPython\core\interactiveshell.py", line 2961, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-156-67785f0b0fbe>", line 1, in <module>
    pd.concat([a1.iloc[[0]], a2.iloc[[0]]])
  File "C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\reshape\concat.py", line 226, in concat
    return op.get_result()
  File "C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\reshape\concat.py", line 423, in get_result
    copy=self.copy)
  File "C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\internals.py", line 5406, in concatenate_block_managers
    for placement, join_units in concat_plan:
  File "C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\internals.py", line 5699, in combine_concat_plans
    raise ValueError("Plan shapes are not aligned")
ValueError: Plan shapes are not aligned
                   Out[157]: 20220322-17:15:54  
                      field_name comment dtype_classify field_src available available_notzd  available_zd formula remark must_remain into_model is_cause  NaN  NaN  NaN  NaN  NaN  NaN
                   0  acct_month    账期         类别型      原始       NaN             NaN           NaN     NaN    NaN         NaN        NaN       否  NaN  NaN  NaN  NaN  NaN  NaN
                   Out[158]: 20220322-17:15:58  
                                    field_name                            comment    field_src is_cause
                   0  account_id~其他_countlow  帐户编号：取值是否为其他_countlow  自动衍生_py       否
                   Out[159]: 20220322-17:16:34  
                                                                                                                comment dtype_classify    field_src                               field_name is_cause
                   field_name                                                                                                                                                                        
                   avg__gprs_flow_5g                                                   gprs 5g流量：近3月均值                   数值型  自动衍生_py                        avg__gprs_flow_5g      NaN
                   avg__calling_dura                                              当月主叫通话时长：近3月均值                   数值型  自动衍生_py                        avg__calling_dura      NaN
                   avg__gprs_resource                                             gprs国内资源总量：近3月均值                   数值型  自动衍生_py                       avg__gprs_resource      NaN
                   avg__call_dura_roam                                               省际漫游-时长：近3月均值                   数值型  自动衍生_py                      avg__call_dura_roam      NaN
                   avg__calling_diff_cnt                                          主叫异网通话次数：近3月均值                   数值型  自动衍生_py                    avg__calling_diff_cnt      NaN
                   avg__gprs_flow_busy                                              gprs-忙时-流量：近3月均值                   数值型  自动衍生_py                      avg__gprs_flow_busy      NaN
                   avg__gprs_flow_music                                             音乐类应用流量：近3月均值                   数值型  自动衍生_py                     avg__gprs_flow_music      NaN
                   avg__gprs_last_defer                                               流量滚存资源：近3月均值                   数值型  自动衍生_py                     avg__gprs_last_defer      NaN
                   avg__gprs_now_defer                                          可延递流量资源总量：近3月均值                   数值型  自动衍生_py                      avg__gprs_now_defer      NaN
                   avg__nos_calling                                           主叫通话对端号码个数：近3月均值                   数值型  自动衍生_py                         avg__nos_calling      NaN
                   avg__gprs_flow_roam                                          gprs-国内漫游-流量：近3月均值                   数值型  自动衍生_py                      avg__gprs_flow_roam      NaN
                   avg__calling_diff_dura                                       主叫异网通话分钟数：近3月均值                   数值型  自动衍生_py                   avg__calling_diff_dura      NaN
                   avg__gprs_now_rest                                             当月gprs资源余量：近3月均值                   数值型  自动衍生_py                       avg__gprs_now_rest      NaN
                   avg__monthsremain_last_stop_date                         最后停机时间：剩余时长：近3月均值                   数值型  自动衍生_py         avg__monthsremain_last_stop_date      NaN
                   avg__dinner_fee                                                      套餐月租费：近3月均值                   数值型  自动衍生_py                          avg__dinner_fee      NaN
                   avg__gprs_flow_short                                            小视频系app流量：近3月均值                   数值型  自动衍生_py                     avg__gprs_flow_short      NaN
                   avg__gprs_flow_commu                                             通信类应用流量：近3月均值                   数值型  自动衍生_py                     avg__gprs_flow_commu      NaN
                   avg__call_use                                                    语音资源使用量：近3月均值                   数值型  自动衍生_py                            avg__call_use      NaN
                   avg__gprs_flow_game                                              游戏类应用流量：近3月均值                   数值型  自动衍生_py                      avg__gprs_flow_game      NaN
                   avg__days_call_p_4                                               通话天数占比_4：近3月均值                   数值型  自动衍生_py                       avg__days_call_p_4      NaN
                   avg__arpu                                                              当月arpu：近3月均值                   数值型  自动衍生_py                                avg__arpu      NaN
                   avg__nos_calling_diff                                      主叫异网对端号码个数：近3月均值                   数值型  自动衍生_py                    avg__nos_calling_diff      NaN
                   avg__calling_cnt                                                   主叫通话次数：近3月均值                   数值型  自动衍生_py                         avg__calling_cnt      NaN
                   avg__gprs_flow_video                                             视频类应用流量：近3月均值                   数值型  自动衍生_py                     avg__gprs_flow_video      NaN
                   sep__gprs_flow_5g                                               gprs 5g流量：近3月离散系数                   数值型  自动衍生_py                        sep__gprs_flow_5g      NaN
                   sep__calling_dura                                          当月主叫通话时长：近3月离散系数                   数值型  自动衍生_py                        sep__calling_dura      NaN
                   sep__gprs_resource                                         gprs国内资源总量：近3月离散系数                   数值型  自动衍生_py                       sep__gprs_resource      NaN
                   sep__call_dura_roam                                           省际漫游-时长：近3月离散系数                   数值型  自动衍生_py                      sep__call_dura_roam      NaN
                   sep__calling_diff_cnt                                      主叫异网通话次数：近3月离散系数                   数值型  自动衍生_py                    sep__calling_diff_cnt      NaN
                   sep__gprs_flow_busy                                          gprs-忙时-流量：近3月离散系数                   数值型  自动衍生_py                      sep__gprs_flow_busy      NaN
                   sep__gprs_flow_music                                         音乐类应用流量：近3月离散系数                   数值型  自动衍生_py                     sep__gprs_flow_music      NaN
                   sep__gprs_last_defer                                           流量滚存资源：近3月离散系数                   数值型  自动衍生_py                     sep__gprs_last_defer      NaN
                   sep__gprs_now_defer                                      可延递流量资源总量：近3月离散系数                   数值型  自动衍生_py                      sep__gprs_now_defer      NaN
                   sep__nos_calling                                       主叫通话对端号码个数：近3月离散系数                   数值型  自动衍生_py                         sep__nos_calling      NaN
                   sep__gprs_flow_roam                                      gprs-国内漫游-流量：近3月离散系数                   数值型  自动衍生_py                      sep__gprs_flow_roam      NaN
                   sep__calling_diff_dura                                   主叫异网通话分钟数：近3月离散系数                   数值型  自动衍生_py                   sep__calling_diff_dura      NaN
                   sep__gprs_now_rest                                         当月gprs资源余量：近3月离散系数                   数值型  自动衍生_py                       sep__gprs_now_rest      NaN
                   sep__monthsremain_last_stop_date                     最后停机时间：剩余时长：近3月离散系数                   数值型  自动衍生_py         sep__monthsremain_last_stop_date      NaN
                   sep__dinner_fee                                                  套餐月租费：近3月离散系数                   数值型  自动衍生_py                          sep__dinner_fee      NaN
                   sep__gprs_flow_short                                        小视频系app流量：近3月离散系数                   数值型  自动衍生_py                     sep__gprs_flow_short      NaN
                   sep__gprs_flow_commu                                         通信类应用流量：近3月离散系数                   数值型  自动衍生_py                     sep__gprs_flow_commu      NaN
                   sep__call_use                                                语音资源使用量：近3月离散系数                   数值型  自动衍生_py                            sep__call_use      NaN
                   sep__gprs_flow_game                                          游戏类应用流量：近3月离散系数                   数值型  自动衍生_py                      sep__gprs_flow_game      NaN
                   sep__days_call_p_4                                           通话天数占比_4：近3月离散系数                   数值型  自动衍生_py                       sep__days_call_p_4      NaN
                   sep__arpu                                                          当月arpu：近3月离散系数                   数值型  自动衍生_py                                sep__arpu      NaN
                   sep__nos_calling_diff                                  主叫异网对端号码个数：近3月离散系数                   数值型  自动衍生_py                    sep__nos_calling_diff      NaN
                   sep__calling_cnt                                               主叫通话次数：近3月离散系数                   数值型  自动衍生_py                         sep__calling_cnt      NaN
                   sep__gprs_flow_video                                         视频类应用流量：近3月离散系数                   数值型  自动衍生_py                     sep__gprs_flow_video      NaN
                   wave__gprs_flow_5g                                                gprs 5g流量：近3月波动性                   数值型  自动衍生_py                       wave__gprs_flow_5g      NaN
                   wave__calling_dura                                           当月主叫通话时长：近3月波动性                   数值型  自动衍生_py                       wave__calling_dura      NaN
                   wave__gprs_resource                                          gprs国内资源总量：近3月波动性                   数值型  自动衍生_py                      wave__gprs_resource      NaN
                   wave__call_dura_roam                                            省际漫游-时长：近3月波动性                   数值型  自动衍生_py                     wave__call_dura_roam      NaN
                   wave__calling_diff_cnt                                       主叫异网通话次数：近3月波动性                   数值型  自动衍生_py                   wave__calling_diff_cnt      NaN
                   wave__gprs_flow_busy                                           gprs-忙时-流量：近3月波动性                   数值型  自动衍生_py                     wave__gprs_flow_busy      NaN
                   wave__gprs_flow_music                                          音乐类应用流量：近3月波动性                   数值型  自动衍生_py                    wave__gprs_flow_music      NaN
                   wave__gprs_last_defer                                            流量滚存资源：近3月波动性                   数值型  自动衍生_py                    wave__gprs_last_defer      NaN
                   wave__gprs_now_defer                                       可延递流量资源总量：近3月波动性                   数值型  自动衍生_py                     wave__gprs_now_defer      NaN
                   wave__nos_calling                                        主叫通话对端号码个数：近3月波动性                   数值型  自动衍生_py                        wave__nos_calling      NaN
                   wave__gprs_flow_roam                                       gprs-国内漫游-流量：近3月波动性                   数值型  自动衍生_py                     wave__gprs_flow_roam      NaN
                   wave__calling_diff_dura                                    主叫异网通话分钟数：近3月波动性                   数值型  自动衍生_py                  wave__calling_diff_dura      NaN
                   wave__gprs_now_rest                                          当月gprs资源余量：近3月波动性                   数值型  自动衍生_py                      wave__gprs_now_rest      NaN
                   wave__monthsremain_last_stop_date                      最后停机时间：剩余时长：近3月波动性                   数值型  自动衍生_py        wave__monthsremain_last_stop_date      NaN
                   wave__dinner_fee                                                   套餐月租费：近3月波动性                   数值型  自动衍生_py                         wave__dinner_fee      NaN
                   wave__gprs_flow_short                                         小视频系app流量：近3月波动性                   数值型  自动衍生_py                    wave__gprs_flow_short      NaN
                   wave__gprs_flow_commu                                          通信类应用流量：近3月波动性                   数值型  自动衍生_py                    wave__gprs_flow_commu      NaN
                   wave__call_use                                                 语音资源使用量：近3月波动性                   数值型  自动衍生_py                           wave__call_use      NaN
                   wave__gprs_flow_game                                           游戏类应用流量：近3月波动性                   数值型  自动衍生_py                     wave__gprs_flow_game      NaN
                   wave__days_call_p_4                                            通话天数占比_4：近3月波动性                   数值型  自动衍生_py                      wave__days_call_p_4      NaN
                   wave__arpu                                                           当月arpu：近3月波动性                   数值型  自动衍生_py                               wave__arpu      NaN
                   wave__nos_calling_diff                                   主叫异网对端号码个数：近3月波动性                   数值型  自动衍生_py                   wave__nos_calling_diff      NaN
                   wave__calling_cnt                                                主叫通话次数：近3月波动性                   数值型  自动衍生_py                        wave__calling_cnt      NaN
                   wave__gprs_flow_video                                          视频类应用流量：近3月波动性                   数值型  自动衍生_py                    wave__gprs_flow_video      NaN
                   grow__gprs_flow_5g                                                gprs 5g流量：近3月成长率                   数值型  自动衍生_py                       grow__gprs_flow_5g      NaN
                   grow__calling_dura                                           当月主叫通话时长：近3月成长率                   数值型  自动衍生_py                       grow__calling_dura      NaN
                   grow__gprs_resource                                          gprs国内资源总量：近3月成长率                   数值型  自动衍生_py                      grow__gprs_resource      NaN
                   grow__call_dura_roam                                            省际漫游-时长：近3月成长率                   数值型  自动衍生_py                     grow__call_dura_roam      NaN
                   grow__calling_diff_cnt                                       主叫异网通话次数：近3月成长率                   数值型  自动衍生_py                   grow__calling_diff_cnt      NaN
                   grow__gprs_flow_busy                                           gprs-忙时-流量：近3月成长率                   数值型  自动衍生_py                     grow__gprs_flow_busy      NaN
                   grow__gprs_flow_music                                          音乐类应用流量：近3月成长率                   数值型  自动衍生_py                    grow__gprs_flow_music      NaN
                   grow__gprs_last_defer                                            流量滚存资源：近3月成长率                   数值型  自动衍生_py                    grow__gprs_last_defer      NaN
                   grow__gprs_now_defer                                       可延递流量资源总量：近3月成长率                   数值型  自动衍生_py                     grow__gprs_now_defer      NaN
                   grow__nos_calling                                        主叫通话对端号码个数：近3月成长率                   数值型  自动衍生_py                        grow__nos_calling      NaN
                   grow__gprs_flow_roam                                       gprs-国内漫游-流量：近3月成长率                   数值型  自动衍生_py                     grow__gprs_flow_roam      NaN
                   grow__calling_diff_dura                                    主叫异网通话分钟数：近3月成长率                   数值型  自动衍生_py                  grow__calling_diff_dura      NaN
                   grow__gprs_now_rest                                          当月gprs资源余量：近3月成长率                   数值型  自动衍生_py                      grow__gprs_now_rest      NaN
                   grow__monthsremain_last_stop_date                      最后停机时间：剩余时长：近3月成长率                   数值型  自动衍生_py        grow__monthsremain_last_stop_date      NaN
                   grow__dinner_fee                                                   套餐月租费：近3月成长率                   数值型  自动衍生_py                         grow__dinner_fee      NaN
                   grow__gprs_flow_short                                         小视频系app流量：近3月成长率                   数值型  自动衍生_py                    grow__gprs_flow_short      NaN
                   grow__gprs_flow_commu                                          通信类应用流量：近3月成长率                   数值型  自动衍生_py                    grow__gprs_flow_commu      NaN
                   grow__call_use                                                 语音资源使用量：近3月成长率                   数值型  自动衍生_py                           grow__call_use      NaN
                   grow__gprs_flow_game                                           游戏类应用流量：近3月成长率                   数值型  自动衍生_py                     grow__gprs_flow_game      NaN
                   grow__days_call_p_4                                            通话天数占比_4：近3月成长率                   数值型  自动衍生_py                      grow__days_call_p_4      NaN
                   grow__arpu                                                           当月arpu：近3月成长率                   数值型  自动衍生_py                               grow__arpu      NaN
                   grow__nos_calling_diff                                   主叫异网对端号码个数：近3月成长率                   数值型  自动衍生_py                   grow__nos_calling_diff      NaN
                   grow__calling_cnt                                                主叫通话次数：近3月成长率                   数值型  自动衍生_py                        grow__calling_cnt      NaN
                   grow__gprs_flow_video                                          视频类应用流量：近3月成长率                   数值型  自动衍生_py                    grow__gprs_flow_video      NaN
                   max__gprs_flow_5g                                                 gprs 5g流量：近3月最大值                   数值型  自动衍生_py                        max__gprs_flow_5g      NaN
                   max__calling_dura                                            当月主叫通话时长：近3月最大值                   数值型  自动衍生_py                        max__calling_dura      NaN
                   max__gprs_resource                                           gprs国内资源总量：近3月最大值                   数值型  自动衍生_py                       max__gprs_resource      NaN
                   max__call_dura_roam                                             省际漫游-时长：近3月最大值                   数值型  自动衍生_py                      max__call_dura_roam      NaN
                   max__calling_diff_cnt                                        主叫异网通话次数：近3月最大值                   数值型  自动衍生_py                    max__calling_diff_cnt      NaN
                   max__gprs_flow_busy                                            gprs-忙时-流量：近3月最大值                   数值型  自动衍生_py                      max__gprs_flow_busy      NaN
                   max__gprs_flow_music                                           音乐类应用流量：近3月最大值                   数值型  自动衍生_py                     max__gprs_flow_music      NaN
                   max__gprs_last_defer                                             流量滚存资源：近3月最大值                   数值型  自动衍生_py                     max__gprs_last_defer      NaN
                   max__gprs_now_defer                                        可延递流量资源总量：近3月最大值                   数值型  自动衍生_py                      max__gprs_now_defer      NaN
                   max__nos_calling                                         主叫通话对端号码个数：近3月最大值                   数值型  自动衍生_py                         max__nos_calling      NaN
                   max__gprs_flow_roam                                        gprs-国内漫游-流量：近3月最大值                   数值型  自动衍生_py                      max__gprs_flow_roam      NaN
                   max__calling_diff_dura                                     主叫异网通话分钟数：近3月最大值                   数值型  自动衍生_py                   max__calling_diff_dura      NaN
                   max__gprs_now_rest                                           当月gprs资源余量：近3月最大值                   数值型  自动衍生_py                       max__gprs_now_rest      NaN
                   max__monthsremain_last_stop_date                       最后停机时间：剩余时长：近3月最大值                   数值型  自动衍生_py         max__monthsremain_last_stop_date      NaN
                   max__dinner_fee                                                    套餐月租费：近3月最大值                   数值型  自动衍生_py                          max__dinner_fee      NaN
                   max__gprs_flow_short                                          小视频系app流量：近3月最大值                   数值型  自动衍生_py                     max__gprs_flow_short      NaN
                   max__gprs_flow_commu                                           通信类应用流量：近3月最大值                   数值型  自动衍生_py                     max__gprs_flow_commu      NaN
                   max__call_use                                                  语音资源使用量：近3月最大值                   数值型  自动衍生_py                            max__call_use      NaN
                   max__gprs_flow_game                                            游戏类应用流量：近3月最大值                   数值型  自动衍生_py                      max__gprs_flow_game      NaN
                   max__days_call_p_4                                             通话天数占比_4：近3月最大值                   数值型  自动衍生_py                       max__days_call_p_4      NaN
                   max__arpu                                                            当月arpu：近3月最大值                   数值型  自动衍生_py                                max__arpu      NaN
                   max__nos_calling_diff                                    主叫异网对端号码个数：近3月最大值                   数值型  自动衍生_py                    max__nos_calling_diff      NaN
                   max__calling_cnt                                                 主叫通话次数：近3月最大值                   数值型  自动衍生_py                         max__calling_cnt      NaN
                   max__gprs_flow_video                                           视频类应用流量：近3月最大值                   数值型  自动衍生_py                     max__gprs_flow_video      NaN
                   min__gprs_flow_5g                                                 gprs 5g流量：近3月最小值                   数值型  自动衍生_py                        min__gprs_flow_5g      NaN
                   min__calling_dura                                            当月主叫通话时长：近3月最小值                   数值型  自动衍生_py                        min__calling_dura      NaN
                   min__gprs_resource                                           gprs国内资源总量：近3月最小值                   数值型  自动衍生_py                       min__gprs_resource      NaN
                   min__call_dura_roam                                             省际漫游-时长：近3月最小值                   数值型  自动衍生_py                      min__call_dura_roam      NaN
                   min__calling_diff_cnt                                        主叫异网通话次数：近3月最小值                   数值型  自动衍生_py                    min__calling_diff_cnt      NaN
                   min__gprs_flow_busy                                            gprs-忙时-流量：近3月最小值                   数值型  自动衍生_py                      min__gprs_flow_busy      NaN
                   min__gprs_flow_music                                           音乐类应用流量：近3月最小值                   数值型  自动衍生_py                     min__gprs_flow_music      NaN
                   min__gprs_last_defer                                             流量滚存资源：近3月最小值                   数值型  自动衍生_py                     min__gprs_last_defer      NaN
                   min__gprs_now_defer                                        可延递流量资源总量：近3月最小值                   数值型  自动衍生_py                      min__gprs_now_defer      NaN
                   min__nos_calling                                         主叫通话对端号码个数：近3月最小值                   数值型  自动衍生_py                         min__nos_calling      NaN
                   min__gprs_flow_roam                                        gprs-国内漫游-流量：近3月最小值                   数值型  自动衍生_py                      min__gprs_flow_roam      NaN
                   min__calling_diff_dura                                     主叫异网通话分钟数：近3月最小值                   数值型  自动衍生_py                   min__calling_diff_dura      NaN
                   min__gprs_now_rest                                           当月gprs资源余量：近3月最小值                   数值型  自动衍生_py                       min__gprs_now_rest      NaN
                   min__monthsremain_last_stop_date                       最后停机时间：剩余时长：近3月最小值                   数值型  自动衍生_py         min__monthsremain_last_stop_date      NaN
                   min__dinner_fee                                                    套餐月租费：近3月最小值                   数值型  自动衍生_py                          min__dinner_fee      NaN
                   min__gprs_flow_short                                          小视频系app流量：近3月最小值                   数值型  自动衍生_py                     min__gprs_flow_short      NaN
                   min__gprs_flow_commu                                           通信类应用流量：近3月最小值                   数值型  自动衍生_py                     min__gprs_flow_commu      NaN
                   min__call_use                                                  语音资源使用量：近3月最小值                   数值型  自动衍生_py                            min__call_use      NaN
                   min__gprs_flow_game                                            游戏类应用流量：近3月最小值                   数值型  自动衍生_py                      min__gprs_flow_game      NaN
                   min__days_call_p_4                                             通话天数占比_4：近3月最小值                   数值型  自动衍生_py                       min__days_call_p_4      NaN
                   min__arpu                                                            当月arpu：近3月最小值                   数值型  自动衍生_py                                min__arpu      NaN
                   min__nos_calling_diff                                    主叫异网对端号码个数：近3月最小值                   数值型  自动衍生_py                    min__nos_calling_diff      NaN
                   min__calling_cnt                                                 主叫通话次数：近3月最小值                   数值型  自动衍生_py                         min__calling_cnt      NaN
                   min__gprs_flow_video                                           视频类应用流量：近3月最小值                   数值型  自动衍生_py                     min__gprs_flow_video      NaN
                   std__gprs_flow_5g                                                 gprs 5g流量：近3月标准差                   数值型  自动衍生_py                        std__gprs_flow_5g      NaN
                   std__calling_dura                                            当月主叫通话时长：近3月标准差                   数值型  自动衍生_py                        std__calling_dura      NaN
                   std__gprs_resource                                           gprs国内资源总量：近3月标准差                   数值型  自动衍生_py                       std__gprs_resource      NaN
                   std__call_dura_roam                                             省际漫游-时长：近3月标准差                   数值型  自动衍生_py                      std__call_dura_roam      NaN
                   std__calling_diff_cnt                                        主叫异网通话次数：近3月标准差                   数值型  自动衍生_py                    std__calling_diff_cnt      NaN
                   std__gprs_flow_busy                                            gprs-忙时-流量：近3月标准差                   数值型  自动衍生_py                      std__gprs_flow_busy      NaN
                   std__gprs_flow_music                                           音乐类应用流量：近3月标准差                   数值型  自动衍生_py                     std__gprs_flow_music      NaN
                   std__gprs_last_defer                                             流量滚存资源：近3月标准差                   数值型  自动衍生_py                     std__gprs_last_defer      NaN
                   std__gprs_now_defer                                        可延递流量资源总量：近3月标准差                   数值型  自动衍生_py                      std__gprs_now_defer      NaN
                   std__nos_calling                                         主叫通话对端号码个数：近3月标准差                   数值型  自动衍生_py                         std__nos_calling      NaN
                   std__gprs_flow_roam                                        gprs-国内漫游-流量：近3月标准差                   数值型  自动衍生_py                      std__gprs_flow_roam      NaN
                   std__calling_diff_dura                                     主叫异网通话分钟数：近3月标准差                   数值型  自动衍生_py                   std__calling_diff_dura      NaN
                   std__gprs_now_rest                                           当月gprs资源余量：近3月标准差                   数值型  自动衍生_py                       std__gprs_now_rest      NaN
                   std__monthsremain_last_stop_date                       最后停机时间：剩余时长：近3月标准差                   数值型  自动衍生_py         std__monthsremain_last_stop_date      NaN
                   std__dinner_fee                                                    套餐月租费：近3月标准差                   数值型  自动衍生_py                          std__dinner_fee      NaN
                   std__gprs_flow_short                                          小视频系app流量：近3月标准差                   数值型  自动衍生_py                     std__gprs_flow_short      NaN
                   std__gprs_flow_commu                                           通信类应用流量：近3月标准差                   数值型  自动衍生_py                     std__gprs_flow_commu      NaN
                   std__call_use                                                  语音资源使用量：近3月标准差                   数值型  自动衍生_py                            std__call_use      NaN
                   std__gprs_flow_game                                            游戏类应用流量：近3月标准差                   数值型  自动衍生_py                      std__gprs_flow_game      NaN
                   std__days_call_p_4                                             通话天数占比_4：近3月标准差                   数值型  自动衍生_py                       std__days_call_p_4      NaN
                   std__arpu                                                            当月arpu：近3月标准差                   数值型  自动衍生_py                                std__arpu      NaN
                   std__nos_calling_diff                                    主叫异网对端号码个数：近3月标准差                   数值型  自动衍生_py                    std__nos_calling_diff      NaN
                   std__calling_cnt                                                 主叫通话次数：近3月标准差                   数值型  自动衍生_py                         std__calling_cnt      NaN
                   std__gprs_flow_video                                           视频类应用流量：近3月标准差                   数值型  自动衍生_py                     std__gprs_flow_video      NaN
                   flag_eg                                                                            flag_eg                   类别型  自动衍生_py                                  flag_eg      NaN
                   more0cnt__gprs_flow_5g                                     gprs 5g流量：近3月大于0的月份数                   数值型  自动衍生_py                   more0cnt__gprs_flow_5g      NaN
                   more0cnt__calling_dura                                当月主叫通话时长：近3月大于0的月份数                   数值型  自动衍生_py                   more0cnt__calling_dura      NaN
                   more0cnt__gprs_resource                               gprs国内资源总量：近3月大于0的月份数                   数值型  自动衍生_py                  more0cnt__gprs_resource      NaN
                   more0cnt__call_dura_roam                                 省际漫游-时长：近3月大于0的月份数                   数值型  自动衍生_py                 more0cnt__call_dura_roam      NaN
                   more0cnt__calling_diff_cnt                            主叫异网通话次数：近3月大于0的月份数                   数值型  自动衍生_py               more0cnt__calling_diff_cnt      NaN
                   more0cnt__gprs_flow_busy                                gprs-忙时-流量：近3月大于0的月份数                   数值型  自动衍生_py                 more0cnt__gprs_flow_busy      NaN
                   more0cnt__gprs_flow_music                               音乐类应用流量：近3月大于0的月份数                   数值型  自动衍生_py                more0cnt__gprs_flow_music      NaN
                   more0cnt__gprs_last_defer                                 流量滚存资源：近3月大于0的月份数                   数值型  自动衍生_py                more0cnt__gprs_last_defer      NaN
                   more0cnt__gprs_now_defer                            可延递流量资源总量：近3月大于0的月份数                   数值型  自动衍生_py                 more0cnt__gprs_now_defer      NaN
                   more0cnt__nos_calling                             主叫通话对端号码个数：近3月大于0的月份数                   数值型  自动衍生_py                    more0cnt__nos_calling      NaN
                   more0cnt__gprs_flow_roam                            gprs-国内漫游-流量：近3月大于0的月份数                   数值型  自动衍生_py                 more0cnt__gprs_flow_roam      NaN
                   more0cnt__calling_diff_dura                         主叫异网通话分钟数：近3月大于0的月份数                   数值型  自动衍生_py              more0cnt__calling_diff_dura      NaN
                   more0cnt__gprs_now_rest                               当月gprs资源余量：近3月大于0的月份数                   数值型  自动衍生_py                  more0cnt__gprs_now_rest      NaN
                   more0cnt__monthsremain_last_stop_date           最后停机时间：剩余时长：近3月大于0的月份数                   数值型  自动衍生_py    more0cnt__monthsremain_last_stop_date      NaN
                   more0cnt__dinner_fee                                        套餐月租费：近3月大于0的月份数                   数值型  自动衍生_py                     more0cnt__dinner_fee      NaN
                   more0cnt__gprs_flow_short                              小视频系app流量：近3月大于0的月份数                   数值型  自动衍生_py                more0cnt__gprs_flow_short      NaN
                   more0cnt__gprs_flow_commu                               通信类应用流量：近3月大于0的月份数                   数值型  自动衍生_py                more0cnt__gprs_flow_commu      NaN
                   more0cnt__call_use                                      语音资源使用量：近3月大于0的月份数                   数值型  自动衍生_py                       more0cnt__call_use      NaN
                   more0cnt__gprs_flow_game                                游戏类应用流量：近3月大于0的月份数                   数值型  自动衍生_py                 more0cnt__gprs_flow_game      NaN
                   more0cnt__days_call_p_4                                 通话天数占比_4：近3月大于0的月份数                   数值型  自动衍生_py                  more0cnt__days_call_p_4      NaN
                   more0cnt__arpu                                                当月arpu：近3月大于0的月份数                   数值型  自动衍生_py                           more0cnt__arpu      NaN
                   more0cnt__nos_calling_diff                        主叫异网对端号码个数：近3月大于0的月份数                   数值型  自动衍生_py               more0cnt__nos_calling_diff      NaN
                   more0cnt__calling_cnt                                     主叫通话次数：近3月大于0的月份数                   数值型  自动衍生_py                    more0cnt__calling_cnt      NaN
                   more0cnt__gprs_flow_video                               视频类应用流量：近3月大于0的月份数                   数值型  自动衍生_py                more0cnt__gprs_flow_video      NaN
                   moreq25cnt__gprs_flow_5g                        gprs 5g流量：近3月大于第一四分位数的月份数                   数值型  自动衍生_py                 moreq25cnt__gprs_flow_5g      NaN
                   moreq25cnt__calling_dura                   当月主叫通话时长：近3月大于第一四分位数的月份数                   数值型  自动衍生_py                 moreq25cnt__calling_dura      NaN
                   moreq25cnt__gprs_resource                  gprs国内资源总量：近3月大于第一四分位数的月份数                   数值型  自动衍生_py                moreq25cnt__gprs_resource      NaN
                   moreq25cnt__call_dura_roam                    省际漫游-时长：近3月大于第一四分位数的月份数                   数值型  自动衍生_py               moreq25cnt__call_dura_roam      NaN
                   moreq25cnt__calling_diff_cnt               主叫异网通话次数：近3月大于第一四分位数的月份数                   数值型  自动衍生_py             moreq25cnt__calling_diff_cnt      NaN
                   moreq25cnt__gprs_flow_busy                   gprs-忙时-流量：近3月大于第一四分位数的月份数                   数值型  自动衍生_py               moreq25cnt__gprs_flow_busy      NaN
                   moreq25cnt__gprs_flow_music                  音乐类应用流量：近3月大于第一四分位数的月份数                   数值型  自动衍生_py              moreq25cnt__gprs_flow_music      NaN
                   moreq25cnt__gprs_last_defer                    流量滚存资源：近3月大于第一四分位数的月份数                   数值型  自动衍生_py              moreq25cnt__gprs_last_defer      NaN
                   moreq25cnt__gprs_now_defer               可延递流量资源总量：近3月大于第一四分位数的月份数                   数值型  自动衍生_py               moreq25cnt__gprs_now_defer      NaN
                   moreq25cnt__nos_calling                  主叫通话对端号码个数：近3月大于第一四分位数的月份数......           数值型  自动衍生_py                  moreq25cnt__nos_calling      NaN
                   moreq25cnt__gprs_flow_roam               gprs-国内漫游-流量：近3月大于第一四分位数的月份数                   数值型  自动衍生_py               moreq25cnt__gprs_flow_roam      NaN
                   moreq25cnt__calling_diff_dura            主叫异网通话分钟数：近3月大于第一四分位数的月份数                   数值型  自动衍生_py            moreq25cnt__calling_diff_dura      NaN
                   moreq25cnt__gprs_now_rest                  当月gprs资源余量：近3月大于第一四分位数的月份数                   数值型  自动衍生_py                moreq25cnt__gprs_now_rest      NaN
                   moreq25cnt__monthsremain_last_stop_date  最后停机时间：剩余时长：近3月大于第一四分位数的月份数......         数值型  自动衍生_py  moreq25cnt__monthsremain_last_stop_date      NaN
                   moreq25cnt__dinner_fee                           套餐月租费：近3月大于第一四分位数的月份数                   数值型  自动衍生_py                   moreq25cnt__dinner_fee      NaN
                   moreq25cnt__gprs_flow_short                 小视频系app流量：近3月大于第一四分位数的月份数                   数值型  自动衍生_py              moreq25cnt__gprs_flow_short      NaN
                   moreq25cnt__gprs_flow_commu                  通信类应用流量：近3月大于第一四分位数的月份数                   数值型  自动衍生_py              moreq25cnt__gprs_flow_commu      NaN
                   moreq25cnt__call_use                         语音资源使用量：近3月大于第一四分位数的月份数                   数值型  自动衍生_py                     moreq25cnt__call_use      NaN
                   moreq25cnt__gprs_flow_game                   游戏类应用流量：近3月大于第一四分位数的月份数                   数值型  自动衍生_py               moreq25cnt__gprs_flow_game      NaN
                   moreq25cnt__days_call_p_4                    通话天数占比_4：近3月大于第一四分位数的月份数                   数值型  自动衍生_py                moreq25cnt__days_call_p_4      NaN
                   moreq25cnt__arpu                                   当月arpu：近3月大于第一四分位数的月份数                   数值型  自动衍生_py                         moreq25cnt__arpu      NaN
                   moreq25cnt__nos_calling_diff             主叫异网对端号码个数：近3月大于第一四分位数的月份数......           数值型  自动衍生_py             moreq25cnt__nos_calling_diff      NaN
                   moreq25cnt__calling_cnt                        主叫通话次数：近3月大于第一四分位数的月份数                   数值型  自动衍生_py                  moreq25cnt__calling_cnt      NaN
                   moreq25cnt__gprs_flow_video                  视频类应用流量：近3月大于第一四分位数的月份数                   数值型  自动衍生_py              moreq25cnt__gprs_flow_video      NaN
                   flag_eg                                                                            flag_eg                   类别型  自动衍生_py                                  flag_eg      NaN
                   valuecnt__account_id~其他_countlow              帐户编号：近3月取值为其他_countlow的月份数                   数值型  自动衍生_py       valuecnt__account_id~其他_countlow       否
                   valuecnt__if_nolimit~是                      是否不限量套餐到达用户：近3月取值为是的月份数                   数值型  自动衍生_py                  valuecnt__if_nolimit~是      NaN
                   valuecnt__if_5g_dinner~是                                是否5g套餐：近3月取值为是的月份数                   数值型  自动衍生_py                valuecnt__if_5g_dinner~是      NaN
                   valuecnt__greatest_gprs_app~commu                        app偏好：近3月取值为commu的月份数                   数值型  自动衍生_py        valuecnt__greatest_gprs_app~commu      NaN
                   valuecnt__greatest_gprs_app~video                        app偏好：近3月取值为video的月份数                   数值型  自动衍生_py        valuecnt__greatest_gprs_app~video      NaN
                   Out[160]: 20220322-17:16:42  Index(['field_name', 'comment', 'dtype_classify', 'field_src', 'available', 'available_notzd', 'available_zd', 'formula', 'remark', 'must_remain', 'into_model', 'is_cause', nan, nan, nan, nan, nan, nan], dtype='object')
                   Out[161]: 20220322-17:16:49  Index(['field_name', 'comment', 'field_src', 'is_cause'], dtype='object')
                   Out[162]: 20220322-17:16:53  Index(['comment', 'dtype_classify', 'field_src', 'field_name', 'is_cause'], dtype='object')
                   Out[163]: 20220322-17:16:58  Index(['field_name', 'comment', 'dtype_classify', 'field_src', 'available', 'available_notzd', 'available_zd', 'formula', 'remark', 'must_remain', 'into_model', 'is_cause', nan, nan, nan, nan, nan, nan], dtype='object')


Traceback (most recent call last):
  File "C:\Users\higher\Anaconda3\lib\site-packages\IPython\core\interactiveshell.py", line 2961, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-164-076722455b7f>", line 1, in <module>
    pd.concat([a2, a3, a4])
  File "C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\reshape\concat.py", line 226, in concat
    return op.get_result()
  File "C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\reshape\concat.py", line 423, in get_result
    copy=self.copy)
  File "C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\internals.py", line 5406, in concatenate_block_managers
    for placement, join_units in concat_plan:
  File "C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\internals.py", line 5699, in combine_concat_plans
    raise ValueError("Plan shapes are not aligned")
ValueError: Plan shapes are not aligned
                   Out[165]: 20220322-17:17:16  
                                    field_name                               comment    field_src is_cause
                   0  account_id~其他_countlow     帐户编号：取值是否为其他_countlow  自动衍生_py       否
                   1             if_nolimit~是  是否不限量套餐到达用户：取值是否为是  自动衍生_py      NaN
                   2           if_5g_dinner~是              是否5g套餐：取值是否为是  自动衍生_py      NaN
                   3   greatest_gprs_app~commu              app偏好：取值是否为commu  自动衍生_py      NaN
                   4   greatest_gprs_app~video              app偏好：取值是否为video  自动衍生_py      NaN
                   Out[166]: 20220322-17:17:20  
                                                                                                                comment dtype_classify    field_src                               field_name is_cause
                   field_name                                                                                                                                                                        
                   avg__gprs_flow_5g                                                   gprs 5g流量：近3月均值                   数值型  自动衍生_py                        avg__gprs_flow_5g      NaN
                   avg__calling_dura                                              当月主叫通话时长：近3月均值                   数值型  自动衍生_py                        avg__calling_dura      NaN
                   avg__gprs_resource                                             gprs国内资源总量：近3月均值                   数值型  自动衍生_py                       avg__gprs_resource      NaN
                   avg__call_dura_roam                                               省际漫游-时长：近3月均值                   数值型  自动衍生_py                      avg__call_dura_roam      NaN
                   avg__calling_diff_cnt                                          主叫异网通话次数：近3月均值                   数值型  自动衍生_py                    avg__calling_diff_cnt      NaN
                   avg__gprs_flow_busy                                              gprs-忙时-流量：近3月均值                   数值型  自动衍生_py                      avg__gprs_flow_busy      NaN
                   avg__gprs_flow_music                                             音乐类应用流量：近3月均值                   数值型  自动衍生_py                     avg__gprs_flow_music      NaN
                   avg__gprs_last_defer                                               流量滚存资源：近3月均值                   数值型  自动衍生_py                     avg__gprs_last_defer      NaN
                   avg__gprs_now_defer                                          可延递流量资源总量：近3月均值                   数值型  自动衍生_py                      avg__gprs_now_defer      NaN
                   avg__nos_calling                                           主叫通话对端号码个数：近3月均值                   数值型  自动衍生_py                         avg__nos_calling      NaN
                   avg__gprs_flow_roam                                          gprs-国内漫游-流量：近3月均值                   数值型  自动衍生_py                      avg__gprs_flow_roam      NaN
                   avg__calling_diff_dura                                       主叫异网通话分钟数：近3月均值                   数值型  自动衍生_py                   avg__calling_diff_dura      NaN
                   avg__gprs_now_rest                                             当月gprs资源余量：近3月均值                   数值型  自动衍生_py                       avg__gprs_now_rest      NaN
                   avg__monthsremain_last_stop_date                         最后停机时间：剩余时长：近3月均值                   数值型  自动衍生_py         avg__monthsremain_last_stop_date      NaN
                   avg__dinner_fee                                                      套餐月租费：近3月均值                   数值型  自动衍生_py                          avg__dinner_fee      NaN
                   avg__gprs_flow_short                                            小视频系app流量：近3月均值                   数值型  自动衍生_py                     avg__gprs_flow_short      NaN
                   avg__gprs_flow_commu                                             通信类应用流量：近3月均值                   数值型  自动衍生_py                     avg__gprs_flow_commu      NaN
                   avg__call_use                                                    语音资源使用量：近3月均值                   数值型  自动衍生_py                            avg__call_use      NaN
                   avg__gprs_flow_game                                              游戏类应用流量：近3月均值                   数值型  自动衍生_py                      avg__gprs_flow_game      NaN
                   avg__days_call_p_4                                               通话天数占比_4：近3月均值                   数值型  自动衍生_py                       avg__days_call_p_4      NaN
                   avg__arpu                                                              当月arpu：近3月均值                   数值型  自动衍生_py                                avg__arpu      NaN
                   avg__nos_calling_diff                                      主叫异网对端号码个数：近3月均值                   数值型  自动衍生_py                    avg__nos_calling_diff      NaN
                   avg__calling_cnt                                                   主叫通话次数：近3月均值                   数值型  自动衍生_py                         avg__calling_cnt      NaN
                   avg__gprs_flow_video                                             视频类应用流量：近3月均值                   数值型  自动衍生_py                     avg__gprs_flow_video      NaN
                   sep__gprs_flow_5g                                               gprs 5g流量：近3月离散系数                   数值型  自动衍生_py                        sep__gprs_flow_5g      NaN
                   sep__calling_dura                                          当月主叫通话时长：近3月离散系数                   数值型  自动衍生_py                        sep__calling_dura      NaN
                   sep__gprs_resource                                         gprs国内资源总量：近3月离散系数                   数值型  自动衍生_py                       sep__gprs_resource      NaN
                   sep__call_dura_roam                                           省际漫游-时长：近3月离散系数                   数值型  自动衍生_py                      sep__call_dura_roam      NaN
                   sep__calling_diff_cnt                                      主叫异网通话次数：近3月离散系数                   数值型  自动衍生_py                    sep__calling_diff_cnt      NaN
                   sep__gprs_flow_busy                                          gprs-忙时-流量：近3月离散系数                   数值型  自动衍生_py                      sep__gprs_flow_busy      NaN
                   sep__gprs_flow_music                                         音乐类应用流量：近3月离散系数                   数值型  自动衍生_py                     sep__gprs_flow_music      NaN
                   sep__gprs_last_defer                                           流量滚存资源：近3月离散系数                   数值型  自动衍生_py                     sep__gprs_last_defer      NaN
                   sep__gprs_now_defer                                      可延递流量资源总量：近3月离散系数                   数值型  自动衍生_py                      sep__gprs_now_defer      NaN
                   sep__nos_calling                                       主叫通话对端号码个数：近3月离散系数                   数值型  自动衍生_py                         sep__nos_calling      NaN
                   sep__gprs_flow_roam                                      gprs-国内漫游-流量：近3月离散系数                   数值型  自动衍生_py                      sep__gprs_flow_roam      NaN
                   sep__calling_diff_dura                                   主叫异网通话分钟数：近3月离散系数                   数值型  自动衍生_py                   sep__calling_diff_dura      NaN
                   sep__gprs_now_rest                                         当月gprs资源余量：近3月离散系数                   数值型  自动衍生_py                       sep__gprs_now_rest      NaN
                   sep__monthsremain_last_stop_date                     最后停机时间：剩余时长：近3月离散系数                   数值型  自动衍生_py         sep__monthsremain_last_stop_date      NaN
                   sep__dinner_fee                                                  套餐月租费：近3月离散系数                   数值型  自动衍生_py                          sep__dinner_fee      NaN
                   sep__gprs_flow_short                                        小视频系app流量：近3月离散系数                   数值型  自动衍生_py                     sep__gprs_flow_short      NaN
                   sep__gprs_flow_commu                                         通信类应用流量：近3月离散系数                   数值型  自动衍生_py                     sep__gprs_flow_commu      NaN
                   sep__call_use                                                语音资源使用量：近3月离散系数                   数值型  自动衍生_py                            sep__call_use      NaN
                   sep__gprs_flow_game                                          游戏类应用流量：近3月离散系数                   数值型  自动衍生_py                      sep__gprs_flow_game      NaN
                   sep__days_call_p_4                                           通话天数占比_4：近3月离散系数                   数值型  自动衍生_py                       sep__days_call_p_4      NaN
                   sep__arpu                                                          当月arpu：近3月离散系数                   数值型  自动衍生_py                                sep__arpu      NaN
                   sep__nos_calling_diff                                  主叫异网对端号码个数：近3月离散系数                   数值型  自动衍生_py                    sep__nos_calling_diff      NaN
                   sep__calling_cnt                                               主叫通话次数：近3月离散系数                   数值型  自动衍生_py                         sep__calling_cnt      NaN
                   sep__gprs_flow_video                                         视频类应用流量：近3月离散系数                   数值型  自动衍生_py                     sep__gprs_flow_video      NaN
                   wave__gprs_flow_5g                                                gprs 5g流量：近3月波动性                   数值型  自动衍生_py                       wave__gprs_flow_5g      NaN
                   wave__calling_dura                                           当月主叫通话时长：近3月波动性                   数值型  自动衍生_py                       wave__calling_dura      NaN
                   wave__gprs_resource                                          gprs国内资源总量：近3月波动性                   数值型  自动衍生_py                      wave__gprs_resource      NaN
                   wave__call_dura_roam                                            省际漫游-时长：近3月波动性                   数值型  自动衍生_py                     wave__call_dura_roam      NaN
                   wave__calling_diff_cnt                                       主叫异网通话次数：近3月波动性                   数值型  自动衍生_py                   wave__calling_diff_cnt      NaN
                   wave__gprs_flow_busy                                           gprs-忙时-流量：近3月波动性                   数值型  自动衍生_py                     wave__gprs_flow_busy      NaN
                   wave__gprs_flow_music                                          音乐类应用流量：近3月波动性                   数值型  自动衍生_py                    wave__gprs_flow_music      NaN
                   wave__gprs_last_defer                                            流量滚存资源：近3月波动性                   数值型  自动衍生_py                    wave__gprs_last_defer      NaN
                   wave__gprs_now_defer                                       可延递流量资源总量：近3月波动性                   数值型  自动衍生_py                     wave__gprs_now_defer      NaN
                   wave__nos_calling                                        主叫通话对端号码个数：近3月波动性                   数值型  自动衍生_py                        wave__nos_calling      NaN
                   wave__gprs_flow_roam                                       gprs-国内漫游-流量：近3月波动性                   数值型  自动衍生_py                     wave__gprs_flow_roam      NaN
                   wave__calling_diff_dura                                    主叫异网通话分钟数：近3月波动性                   数值型  自动衍生_py                  wave__calling_diff_dura      NaN
                   wave__gprs_now_rest                                          当月gprs资源余量：近3月波动性                   数值型  自动衍生_py                      wave__gprs_now_rest      NaN
                   wave__monthsremain_last_stop_date                      最后停机时间：剩余时长：近3月波动性                   数值型  自动衍生_py        wave__monthsremain_last_stop_date      NaN
                   wave__dinner_fee                                                   套餐月租费：近3月波动性                   数值型  自动衍生_py                         wave__dinner_fee      NaN
                   wave__gprs_flow_short                                         小视频系app流量：近3月波动性                   数值型  自动衍生_py                    wave__gprs_flow_short      NaN
                   wave__gprs_flow_commu                                          通信类应用流量：近3月波动性                   数值型  自动衍生_py                    wave__gprs_flow_commu      NaN
                   wave__call_use                                                 语音资源使用量：近3月波动性                   数值型  自动衍生_py                           wave__call_use      NaN
                   wave__gprs_flow_game                                           游戏类应用流量：近3月波动性                   数值型  自动衍生_py                     wave__gprs_flow_game      NaN
                   wave__days_call_p_4                                            通话天数占比_4：近3月波动性                   数值型  自动衍生_py                      wave__days_call_p_4      NaN
                   wave__arpu                                                           当月arpu：近3月波动性                   数值型  自动衍生_py                               wave__arpu      NaN
                   wave__nos_calling_diff                                   主叫异网对端号码个数：近3月波动性                   数值型  自动衍生_py                   wave__nos_calling_diff      NaN
                   wave__calling_cnt                                                主叫通话次数：近3月波动性                   数值型  自动衍生_py                        wave__calling_cnt      NaN
                   wave__gprs_flow_video                                          视频类应用流量：近3月波动性                   数值型  自动衍生_py                    wave__gprs_flow_video      NaN
                   grow__gprs_flow_5g                                                gprs 5g流量：近3月成长率                   数值型  自动衍生_py                       grow__gprs_flow_5g      NaN
                   grow__calling_dura                                           当月主叫通话时长：近3月成长率                   数值型  自动衍生_py                       grow__calling_dura      NaN
                   grow__gprs_resource                                          gprs国内资源总量：近3月成长率                   数值型  自动衍生_py                      grow__gprs_resource      NaN
                   grow__call_dura_roam                                            省际漫游-时长：近3月成长率                   数值型  自动衍生_py                     grow__call_dura_roam      NaN
                   grow__calling_diff_cnt                                       主叫异网通话次数：近3月成长率                   数值型  自动衍生_py                   grow__calling_diff_cnt      NaN
                   grow__gprs_flow_busy                                           gprs-忙时-流量：近3月成长率                   数值型  自动衍生_py                     grow__gprs_flow_busy      NaN
                   grow__gprs_flow_music                                          音乐类应用流量：近3月成长率                   数值型  自动衍生_py                    grow__gprs_flow_music      NaN
                   grow__gprs_last_defer                                            流量滚存资源：近3月成长率                   数值型  自动衍生_py                    grow__gprs_last_defer      NaN
                   grow__gprs_now_defer                                       可延递流量资源总量：近3月成长率                   数值型  自动衍生_py                     grow__gprs_now_defer      NaN
                   grow__nos_calling                                        主叫通话对端号码个数：近3月成长率                   数值型  自动衍生_py                        grow__nos_calling      NaN
                   grow__gprs_flow_roam                                       gprs-国内漫游-流量：近3月成长率                   数值型  自动衍生_py                     grow__gprs_flow_roam      NaN
                   grow__calling_diff_dura                                    主叫异网通话分钟数：近3月成长率                   数值型  自动衍生_py                  grow__calling_diff_dura      NaN
                   grow__gprs_now_rest                                          当月gprs资源余量：近3月成长率                   数值型  自动衍生_py                      grow__gprs_now_rest      NaN
                   grow__monthsremain_last_stop_date                      最后停机时间：剩余时长：近3月成长率                   数值型  自动衍生_py        grow__monthsremain_last_stop_date      NaN
                   grow__dinner_fee                                                   套餐月租费：近3月成长率                   数值型  自动衍生_py                         grow__dinner_fee      NaN
                   grow__gprs_flow_short                                         小视频系app流量：近3月成长率                   数值型  自动衍生_py                    grow__gprs_flow_short      NaN
                   grow__gprs_flow_commu                                          通信类应用流量：近3月成长率                   数值型  自动衍生_py                    grow__gprs_flow_commu      NaN
                   grow__call_use                                                 语音资源使用量：近3月成长率                   数值型  自动衍生_py                           grow__call_use      NaN
                   grow__gprs_flow_game                                           游戏类应用流量：近3月成长率                   数值型  自动衍生_py                     grow__gprs_flow_game      NaN
                   grow__days_call_p_4                                            通话天数占比_4：近3月成长率                   数值型  自动衍生_py                      grow__days_call_p_4      NaN
                   grow__arpu                                                           当月arpu：近3月成长率                   数值型  自动衍生_py                               grow__arpu      NaN
                   grow__nos_calling_diff                                   主叫异网对端号码个数：近3月成长率                   数值型  自动衍生_py                   grow__nos_calling_diff      NaN
                   grow__calling_cnt                                                主叫通话次数：近3月成长率                   数值型  自动衍生_py                        grow__calling_cnt      NaN
                   grow__gprs_flow_video                                          视频类应用流量：近3月成长率                   数值型  自动衍生_py                    grow__gprs_flow_video      NaN
                   max__gprs_flow_5g                                                 gprs 5g流量：近3月最大值                   数值型  自动衍生_py                        max__gprs_flow_5g      NaN
                   max__calling_dura                                            当月主叫通话时长：近3月最大值                   数值型  自动衍生_py                        max__calling_dura      NaN
                   max__gprs_resource                                           gprs国内资源总量：近3月最大值                   数值型  自动衍生_py                       max__gprs_resource      NaN
                   max__call_dura_roam                                             省际漫游-时长：近3月最大值                   数值型  自动衍生_py                      max__call_dura_roam      NaN
                   max__calling_diff_cnt                                        主叫异网通话次数：近3月最大值                   数值型  自动衍生_py                    max__calling_diff_cnt      NaN
                   max__gprs_flow_busy                                            gprs-忙时-流量：近3月最大值                   数值型  自动衍生_py                      max__gprs_flow_busy      NaN
                   max__gprs_flow_music                                           音乐类应用流量：近3月最大值                   数值型  自动衍生_py                     max__gprs_flow_music      NaN
                   max__gprs_last_defer                                             流量滚存资源：近3月最大值                   数值型  自动衍生_py                     max__gprs_last_defer      NaN
                   max__gprs_now_defer                                        可延递流量资源总量：近3月最大值                   数值型  自动衍生_py                      max__gprs_now_defer      NaN
                   max__nos_calling                                         主叫通话对端号码个数：近3月最大值                   数值型  自动衍生_py                         max__nos_calling      NaN
                   max__gprs_flow_roam                                        gprs-国内漫游-流量：近3月最大值                   数值型  自动衍生_py                      max__gprs_flow_roam      NaN
                   max__calling_diff_dura                                     主叫异网通话分钟数：近3月最大值                   数值型  自动衍生_py                   max__calling_diff_dura      NaN
                   max__gprs_now_rest                                           当月gprs资源余量：近3月最大值                   数值型  自动衍生_py                       max__gprs_now_rest      NaN
                   max__monthsremain_last_stop_date                       最后停机时间：剩余时长：近3月最大值                   数值型  自动衍生_py         max__monthsremain_last_stop_date      NaN
                   max__dinner_fee                                                    套餐月租费：近3月最大值                   数值型  自动衍生_py                          max__dinner_fee      NaN
                   max__gprs_flow_short                                          小视频系app流量：近3月最大值                   数值型  自动衍生_py                     max__gprs_flow_short      NaN
                   max__gprs_flow_commu                                           通信类应用流量：近3月最大值                   数值型  自动衍生_py                     max__gprs_flow_commu      NaN
                   max__call_use                                                  语音资源使用量：近3月最大值                   数值型  自动衍生_py                            max__call_use      NaN
                   max__gprs_flow_game                                            游戏类应用流量：近3月最大值                   数值型  自动衍生_py                      max__gprs_flow_game      NaN
                   max__days_call_p_4                                             通话天数占比_4：近3月最大值                   数值型  自动衍生_py                       max__days_call_p_4      NaN
                   max__arpu                                                            当月arpu：近3月最大值                   数值型  自动衍生_py                                max__arpu      NaN
                   max__nos_calling_diff                                    主叫异网对端号码个数：近3月最大值                   数值型  自动衍生_py                    max__nos_calling_diff      NaN
                   max__calling_cnt                                                 主叫通话次数：近3月最大值                   数值型  自动衍生_py                         max__calling_cnt      NaN
                   max__gprs_flow_video                                           视频类应用流量：近3月最大值                   数值型  自动衍生_py                     max__gprs_flow_video      NaN
                   min__gprs_flow_5g                                                 gprs 5g流量：近3月最小值                   数值型  自动衍生_py                        min__gprs_flow_5g      NaN
                   min__calling_dura                                            当月主叫通话时长：近3月最小值                   数值型  自动衍生_py                        min__calling_dura      NaN
                   min__gprs_resource                                           gprs国内资源总量：近3月最小值                   数值型  自动衍生_py                       min__gprs_resource      NaN
                   min__call_dura_roam                                             省际漫游-时长：近3月最小值                   数值型  自动衍生_py                      min__call_dura_roam      NaN
                   min__calling_diff_cnt                                        主叫异网通话次数：近3月最小值                   数值型  自动衍生_py                    min__calling_diff_cnt      NaN
                   min__gprs_flow_busy                                            gprs-忙时-流量：近3月最小值                   数值型  自动衍生_py                      min__gprs_flow_busy      NaN
                   min__gprs_flow_music                                           音乐类应用流量：近3月最小值                   数值型  自动衍生_py                     min__gprs_flow_music      NaN
                   min__gprs_last_defer                                             流量滚存资源：近3月最小值                   数值型  自动衍生_py                     min__gprs_last_defer      NaN
                   min__gprs_now_defer                                        可延递流量资源总量：近3月最小值                   数值型  自动衍生_py                      min__gprs_now_defer      NaN
                   min__nos_calling                                         主叫通话对端号码个数：近3月最小值                   数值型  自动衍生_py                         min__nos_calling      NaN
                   min__gprs_flow_roam                                        gprs-国内漫游-流量：近3月最小值                   数值型  自动衍生_py                      min__gprs_flow_roam      NaN
                   min__calling_diff_dura                                     主叫异网通话分钟数：近3月最小值                   数值型  自动衍生_py                   min__calling_diff_dura      NaN
                   min__gprs_now_rest                                           当月gprs资源余量：近3月最小值                   数值型  自动衍生_py                       min__gprs_now_rest      NaN
                   min__monthsremain_last_stop_date                       最后停机时间：剩余时长：近3月最小值                   数值型  自动衍生_py         min__monthsremain_last_stop_date      NaN
                   min__dinner_fee                                                    套餐月租费：近3月最小值                   数值型  自动衍生_py                          min__dinner_fee      NaN
                   min__gprs_flow_short                                          小视频系app流量：近3月最小值                   数值型  自动衍生_py                     min__gprs_flow_short      NaN
                   min__gprs_flow_commu                                           通信类应用流量：近3月最小值                   数值型  自动衍生_py                     min__gprs_flow_commu      NaN
                   min__call_use                                                  语音资源使用量：近3月最小值                   数值型  自动衍生_py                            min__call_use      NaN
                   min__gprs_flow_game                                            游戏类应用流量：近3月最小值                   数值型  自动衍生_py                      min__gprs_flow_game      NaN
                   min__days_call_p_4                                             通话天数占比_4：近3月最小值                   数值型  自动衍生_py                       min__days_call_p_4      NaN
                   min__arpu                                                            当月arpu：近3月最小值                   数值型  自动衍生_py                                min__arpu      NaN
                   min__nos_calling_diff                                    主叫异网对端号码个数：近3月最小值                   数值型  自动衍生_py                    min__nos_calling_diff      NaN
                   min__calling_cnt                                                 主叫通话次数：近3月最小值                   数值型  自动衍生_py                         min__calling_cnt      NaN
                   min__gprs_flow_video                                           视频类应用流量：近3月最小值                   数值型  自动衍生_py                     min__gprs_flow_video      NaN
                   std__gprs_flow_5g                                                 gprs 5g流量：近3月标准差                   数值型  自动衍生_py                        std__gprs_flow_5g      NaN
                   std__calling_dura                                            当月主叫通话时长：近3月标准差                   数值型  自动衍生_py                        std__calling_dura      NaN
                   std__gprs_resource                                           gprs国内资源总量：近3月标准差                   数值型  自动衍生_py                       std__gprs_resource      NaN
                   std__call_dura_roam                                             省际漫游-时长：近3月标准差                   数值型  自动衍生_py                      std__call_dura_roam      NaN
                   std__calling_diff_cnt                                        主叫异网通话次数：近3月标准差                   数值型  自动衍生_py                    std__calling_diff_cnt      NaN
                   std__gprs_flow_busy                                            gprs-忙时-流量：近3月标准差                   数值型  自动衍生_py                      std__gprs_flow_busy      NaN
                   std__gprs_flow_music                                           音乐类应用流量：近3月标准差                   数值型  自动衍生_py                     std__gprs_flow_music      NaN
                   std__gprs_last_defer                                             流量滚存资源：近3月标准差                   数值型  自动衍生_py                     std__gprs_last_defer      NaN
                   std__gprs_now_defer                                        可延递流量资源总量：近3月标准差                   数值型  自动衍生_py                      std__gprs_now_defer      NaN
                   std__nos_calling                                         主叫通话对端号码个数：近3月标准差                   数值型  自动衍生_py                         std__nos_calling      NaN
                   std__gprs_flow_roam                                        gprs-国内漫游-流量：近3月标准差                   数值型  自动衍生_py                      std__gprs_flow_roam      NaN
                   std__calling_diff_dura                                     主叫异网通话分钟数：近3月标准差                   数值型  自动衍生_py                   std__calling_diff_dura      NaN
                   std__gprs_now_rest                                           当月gprs资源余量：近3月标准差                   数值型  自动衍生_py                       std__gprs_now_rest      NaN
                   std__monthsremain_last_stop_date                       最后停机时间：剩余时长：近3月标准差                   数值型  自动衍生_py         std__monthsremain_last_stop_date      NaN
                   std__dinner_fee                                                    套餐月租费：近3月标准差                   数值型  自动衍生_py                          std__dinner_fee      NaN
                   std__gprs_flow_short                                          小视频系app流量：近3月标准差                   数值型  自动衍生_py                     std__gprs_flow_short      NaN
                   std__gprs_flow_commu                                           通信类应用流量：近3月标准差                   数值型  自动衍生_py                     std__gprs_flow_commu      NaN
                   std__call_use                                                  语音资源使用量：近3月标准差                   数值型  自动衍生_py                            std__call_use      NaN
                   std__gprs_flow_game                                            游戏类应用流量：近3月标准差                   数值型  自动衍生_py                      std__gprs_flow_game      NaN
                   std__days_call_p_4                                             通话天数占比_4：近3月标准差                   数值型  自动衍生_py                       std__days_call_p_4      NaN
                   std__arpu                                                            当月arpu：近3月标准差                   数值型  自动衍生_py                                std__arpu      NaN
                   std__nos_calling_diff                                    主叫异网对端号码个数：近3月标准差                   数值型  自动衍生_py                    std__nos_calling_diff      NaN
                   std__calling_cnt                                                 主叫通话次数：近3月标准差                   数值型  自动衍生_py                         std__calling_cnt      NaN
                   std__gprs_flow_video                                           视频类应用流量：近3月标准差                   数值型  自动衍生_py                     std__gprs_flow_video      NaN
                   flag_eg                                                                            flag_eg                   类别型  自动衍生_py                                  flag_eg      NaN
                   more0cnt__gprs_flow_5g                                     gprs 5g流量：近3月大于0的月份数                   数值型  自动衍生_py                   more0cnt__gprs_flow_5g      NaN
                   more0cnt__calling_dura                                当月主叫通话时长：近3月大于0的月份数                   数值型  自动衍生_py                   more0cnt__calling_dura      NaN
                   more0cnt__gprs_resource                               gprs国内资源总量：近3月大于0的月份数                   数值型  自动衍生_py                  more0cnt__gprs_resource      NaN
                   more0cnt__call_dura_roam                                 省际漫游-时长：近3月大于0的月份数                   数值型  自动衍生_py                 more0cnt__call_dura_roam      NaN
                   more0cnt__calling_diff_cnt                            主叫异网通话次数：近3月大于0的月份数                   数值型  自动衍生_py               more0cnt__calling_diff_cnt      NaN
                   more0cnt__gprs_flow_busy                                gprs-忙时-流量：近3月大于0的月份数                   数值型  自动衍生_py                 more0cnt__gprs_flow_busy      NaN
                   more0cnt__gprs_flow_music                               音乐类应用流量：近3月大于0的月份数                   数值型  自动衍生_py                more0cnt__gprs_flow_music      NaN
                   more0cnt__gprs_last_defer                                 流量滚存资源：近3月大于0的月份数                   数值型  自动衍生_py                more0cnt__gprs_last_defer      NaN
                   more0cnt__gprs_now_defer                            可延递流量资源总量：近3月大于0的月份数                   数值型  自动衍生_py                 more0cnt__gprs_now_defer      NaN
                   more0cnt__nos_calling                             主叫通话对端号码个数：近3月大于0的月份数                   数值型  自动衍生_py                    more0cnt__nos_calling      NaN
                   more0cnt__gprs_flow_roam                            gprs-国内漫游-流量：近3月大于0的月份数                   数值型  自动衍生_py                 more0cnt__gprs_flow_roam      NaN
                   more0cnt__calling_diff_dura                         主叫异网通话分钟数：近3月大于0的月份数                   数值型  自动衍生_py              more0cnt__calling_diff_dura      NaN
                   more0cnt__gprs_now_rest                               当月gprs资源余量：近3月大于0的月份数                   数值型  自动衍生_py                  more0cnt__gprs_now_rest      NaN
                   more0cnt__monthsremain_last_stop_date           最后停机时间：剩余时长：近3月大于0的月份数                   数值型  自动衍生_py    more0cnt__monthsremain_last_stop_date      NaN
                   more0cnt__dinner_fee                                        套餐月租费：近3月大于0的月份数                   数值型  自动衍生_py                     more0cnt__dinner_fee      NaN
                   more0cnt__gprs_flow_short                              小视频系app流量：近3月大于0的月份数                   数值型  自动衍生_py                more0cnt__gprs_flow_short      NaN
                   more0cnt__gprs_flow_commu                               通信类应用流量：近3月大于0的月份数                   数值型  自动衍生_py                more0cnt__gprs_flow_commu      NaN
                   more0cnt__call_use                                      语音资源使用量：近3月大于0的月份数                   数值型  自动衍生_py                       more0cnt__call_use      NaN
                   more0cnt__gprs_flow_game                                游戏类应用流量：近3月大于0的月份数                   数值型  自动衍生_py                 more0cnt__gprs_flow_game      NaN
                   more0cnt__days_call_p_4                                 通话天数占比_4：近3月大于0的月份数                   数值型  自动衍生_py                  more0cnt__days_call_p_4      NaN
                   more0cnt__arpu                                                当月arpu：近3月大于0的月份数                   数值型  自动衍生_py                           more0cnt__arpu      NaN
                   more0cnt__nos_calling_diff                        主叫异网对端号码个数：近3月大于0的月份数                   数值型  自动衍生_py               more0cnt__nos_calling_diff      NaN
                   more0cnt__calling_cnt                                     主叫通话次数：近3月大于0的月份数                   数值型  自动衍生_py                    more0cnt__calling_cnt      NaN
                   more0cnt__gprs_flow_video                               视频类应用流量：近3月大于0的月份数                   数值型  自动衍生_py                more0cnt__gprs_flow_video      NaN
                   moreq25cnt__gprs_flow_5g                        gprs 5g流量：近3月大于第一四分位数的月份数                   数值型  自动衍生_py                 moreq25cnt__gprs_flow_5g      NaN
                   moreq25cnt__calling_dura                   当月主叫通话时长：近3月大于第一四分位数的月份数                   数值型  自动衍生_py                 moreq25cnt__calling_dura      NaN
                   moreq25cnt__gprs_resource                  gprs国内资源总量：近3月大于第一四分位数的月份数                   数值型  自动衍生_py                moreq25cnt__gprs_resource      NaN
                   moreq25cnt__call_dura_roam                    省际漫游-时长：近3月大于第一四分位数的月份数                   数值型  自动衍生_py               moreq25cnt__call_dura_roam      NaN
                   moreq25cnt__calling_diff_cnt               主叫异网通话次数：近3月大于第一四分位数的月份数                   数值型  自动衍生_py             moreq25cnt__calling_diff_cnt      NaN
                   moreq25cnt__gprs_flow_busy                   gprs-忙时-流量：近3月大于第一四分位数的月份数                   数值型  自动衍生_py               moreq25cnt__gprs_flow_busy      NaN
                   moreq25cnt__gprs_flow_music                  音乐类应用流量：近3月大于第一四分位数的月份数                   数值型  自动衍生_py              moreq25cnt__gprs_flow_music      NaN
                   moreq25cnt__gprs_last_defer                    流量滚存资源：近3月大于第一四分位数的月份数                   数值型  自动衍生_py              moreq25cnt__gprs_last_defer      NaN
                   moreq25cnt__gprs_now_defer               可延递流量资源总量：近3月大于第一四分位数的月份数                   数值型  自动衍生_py               moreq25cnt__gprs_now_defer      NaN
                   moreq25cnt__nos_calling                  主叫通话对端号码个数：近3月大于第一四分位数的月份数......           数值型  自动衍生_py                  moreq25cnt__nos_calling      NaN
                   moreq25cnt__gprs_flow_roam               gprs-国内漫游-流量：近3月大于第一四分位数的月份数                   数值型  自动衍生_py               moreq25cnt__gprs_flow_roam      NaN
                   moreq25cnt__calling_diff_dura            主叫异网通话分钟数：近3月大于第一四分位数的月份数                   数值型  自动衍生_py            moreq25cnt__calling_diff_dura      NaN
                   moreq25cnt__gprs_now_rest                  当月gprs资源余量：近3月大于第一四分位数的月份数                   数值型  自动衍生_py                moreq25cnt__gprs_now_rest      NaN
                   moreq25cnt__monthsremain_last_stop_date  最后停机时间：剩余时长：近3月大于第一四分位数的月份数......         数值型  自动衍生_py  moreq25cnt__monthsremain_last_stop_date      NaN
                   moreq25cnt__dinner_fee                           套餐月租费：近3月大于第一四分位数的月份数                   数值型  自动衍生_py                   moreq25cnt__dinner_fee      NaN
                   moreq25cnt__gprs_flow_short                 小视频系app流量：近3月大于第一四分位数的月份数                   数值型  自动衍生_py              moreq25cnt__gprs_flow_short      NaN
                   moreq25cnt__gprs_flow_commu                  通信类应用流量：近3月大于第一四分位数的月份数                   数值型  自动衍生_py              moreq25cnt__gprs_flow_commu      NaN
                   moreq25cnt__call_use                         语音资源使用量：近3月大于第一四分位数的月份数                   数值型  自动衍生_py                     moreq25cnt__call_use      NaN
                   moreq25cnt__gprs_flow_game                   游戏类应用流量：近3月大于第一四分位数的月份数                   数值型  自动衍生_py               moreq25cnt__gprs_flow_game      NaN
                   moreq25cnt__days_call_p_4                    通话天数占比_4：近3月大于第一四分位数的月份数                   数值型  自动衍生_py                moreq25cnt__days_call_p_4      NaN
                   moreq25cnt__arpu                                   当月arpu：近3月大于第一四分位数的月份数                   数值型  自动衍生_py                         moreq25cnt__arpu      NaN
                   moreq25cnt__nos_calling_diff             主叫异网对端号码个数：近3月大于第一四分位数的月份数......           数值型  自动衍生_py             moreq25cnt__nos_calling_diff      NaN
                   moreq25cnt__calling_cnt                        主叫通话次数：近3月大于第一四分位数的月份数                   数值型  自动衍生_py                  moreq25cnt__calling_cnt      NaN
                   moreq25cnt__gprs_flow_video                  视频类应用流量：近3月大于第一四分位数的月份数                   数值型  自动衍生_py              moreq25cnt__gprs_flow_video      NaN
                   flag_eg                                                                            flag_eg                   类别型  自动衍生_py                                  flag_eg      NaN
                   valuecnt__account_id~其他_countlow              帐户编号：近3月取值为其他_countlow的月份数                   数值型  自动衍生_py       valuecnt__account_id~其他_countlow       否
                   valuecnt__if_nolimit~是                      是否不限量套餐到达用户：近3月取值为是的月份数                   数值型  自动衍生_py                  valuecnt__if_nolimit~是      NaN
                   valuecnt__if_5g_dinner~是                                是否5g套餐：近3月取值为是的月份数                   数值型  自动衍生_py                valuecnt__if_5g_dinner~是      NaN
                   valuecnt__greatest_gprs_app~commu                        app偏好：近3月取值为commu的月份数                   数值型  自动衍生_py        valuecnt__greatest_gprs_app~commu      NaN
                   valuecnt__greatest_gprs_app~video                        app偏好：近3月取值为video的月份数                   数值型  自动衍生_py        valuecnt__greatest_gprs_app~video      NaN
                   Out[167]: 20220322-17:17:50  
                                                                                                                comment dtype_classify                               field_name    field_src is_cause
                   0                                                        帐户编号：取值是否为其他_countlow                      NaN                 account_id~其他_countlow  自动衍生_py       否
                   avg__gprs_flow_5g                                                   gprs 5g流量：近3月均值                   数值型                        avg__gprs_flow_5g  自动衍生_py      NaN
                   avg__calling_dura                                              当月主叫通话时长：近3月均值                   数值型                        avg__calling_dura  自动衍生_py      NaN
                   avg__gprs_resource                                             gprs国内资源总量：近3月均值                   数值型                       avg__gprs_resource  自动衍生_py      NaN
                   avg__call_dura_roam                                               省际漫游-时长：近3月均值                   数值型                      avg__call_dura_roam  自动衍生_py      NaN
                   avg__calling_diff_cnt                                          主叫异网通话次数：近3月均值                   数值型                    avg__calling_diff_cnt  自动衍生_py      NaN
                   avg__gprs_flow_busy                                              gprs-忙时-流量：近3月均值                   数值型                      avg__gprs_flow_busy  自动衍生_py      NaN
                   avg__gprs_flow_music                                             音乐类应用流量：近3月均值                   数值型                     avg__gprs_flow_music  自动衍生_py      NaN
                   avg__gprs_last_defer                                               流量滚存资源：近3月均值                   数值型                     avg__gprs_last_defer  自动衍生_py      NaN
                   avg__gprs_now_defer                                          可延递流量资源总量：近3月均值                   数值型                      avg__gprs_now_defer  自动衍生_py      NaN
                   avg__nos_calling                                           主叫通话对端号码个数：近3月均值                   数值型                         avg__nos_calling  自动衍生_py      NaN
                   avg__gprs_flow_roam                                          gprs-国内漫游-流量：近3月均值                   数值型                      avg__gprs_flow_roam  自动衍生_py      NaN
                   avg__calling_diff_dura                                       主叫异网通话分钟数：近3月均值                   数值型                   avg__calling_diff_dura  自动衍生_py      NaN
                   avg__gprs_now_rest                                             当月gprs资源余量：近3月均值                   数值型                       avg__gprs_now_rest  自动衍生_py      NaN
                   avg__monthsremain_last_stop_date                         最后停机时间：剩余时长：近3月均值                   数值型         avg__monthsremain_last_stop_date  自动衍生_py      NaN
                   avg__dinner_fee                                                      套餐月租费：近3月均值                   数值型                          avg__dinner_fee  自动衍生_py      NaN
                   avg__gprs_flow_short                                            小视频系app流量：近3月均值                   数值型                     avg__gprs_flow_short  自动衍生_py      NaN
                   avg__gprs_flow_commu                                             通信类应用流量：近3月均值                   数值型                     avg__gprs_flow_commu  自动衍生_py      NaN
                   avg__call_use                                                    语音资源使用量：近3月均值                   数值型                            avg__call_use  自动衍生_py      NaN
                   avg__gprs_flow_game                                              游戏类应用流量：近3月均值                   数值型                      avg__gprs_flow_game  自动衍生_py      NaN
                   avg__days_call_p_4                                               通话天数占比_4：近3月均值                   数值型                       avg__days_call_p_4  自动衍生_py      NaN
                   avg__arpu                                                              当月arpu：近3月均值                   数值型                                avg__arpu  自动衍生_py      NaN
                   avg__nos_calling_diff                                      主叫异网对端号码个数：近3月均值                   数值型                    avg__nos_calling_diff  自动衍生_py      NaN
                   avg__calling_cnt                                                   主叫通话次数：近3月均值                   数值型                         avg__calling_cnt  自动衍生_py      NaN
                   avg__gprs_flow_video                                             视频类应用流量：近3月均值                   数值型                     avg__gprs_flow_video  自动衍生_py      NaN
                   sep__gprs_flow_5g                                               gprs 5g流量：近3月离散系数                   数值型                        sep__gprs_flow_5g  自动衍生_py      NaN
                   sep__calling_dura                                          当月主叫通话时长：近3月离散系数                   数值型                        sep__calling_dura  自动衍生_py      NaN
                   sep__gprs_resource                                         gprs国内资源总量：近3月离散系数                   数值型                       sep__gprs_resource  自动衍生_py      NaN
                   sep__call_dura_roam                                           省际漫游-时长：近3月离散系数                   数值型                      sep__call_dura_roam  自动衍生_py      NaN
                   sep__calling_diff_cnt                                      主叫异网通话次数：近3月离散系数                   数值型                    sep__calling_diff_cnt  自动衍生_py      NaN
                   sep__gprs_flow_busy                                          gprs-忙时-流量：近3月离散系数                   数值型                      sep__gprs_flow_busy  自动衍生_py      NaN
                   sep__gprs_flow_music                                         音乐类应用流量：近3月离散系数                   数值型                     sep__gprs_flow_music  自动衍生_py      NaN
                   sep__gprs_last_defer                                           流量滚存资源：近3月离散系数                   数值型                     sep__gprs_last_defer  自动衍生_py      NaN
                   sep__gprs_now_defer                                      可延递流量资源总量：近3月离散系数                   数值型                      sep__gprs_now_defer  自动衍生_py      NaN
                   sep__nos_calling                                       主叫通话对端号码个数：近3月离散系数                   数值型                         sep__nos_calling  自动衍生_py      NaN
                   sep__gprs_flow_roam                                      gprs-国内漫游-流量：近3月离散系数                   数值型                      sep__gprs_flow_roam  自动衍生_py      NaN
                   sep__calling_diff_dura                                   主叫异网通话分钟数：近3月离散系数                   数值型                   sep__calling_diff_dura  自动衍生_py      NaN
                   sep__gprs_now_rest                                         当月gprs资源余量：近3月离散系数                   数值型                       sep__gprs_now_rest  自动衍生_py      NaN
                   sep__monthsremain_last_stop_date                     最后停机时间：剩余时长：近3月离散系数                   数值型         sep__monthsremain_last_stop_date  自动衍生_py      NaN
                   sep__dinner_fee                                                  套餐月租费：近3月离散系数                   数值型                          sep__dinner_fee  自动衍生_py      NaN
                   sep__gprs_flow_short                                        小视频系app流量：近3月离散系数                   数值型                     sep__gprs_flow_short  自动衍生_py      NaN
                   sep__gprs_flow_commu                                         通信类应用流量：近3月离散系数                   数值型                     sep__gprs_flow_commu  自动衍生_py      NaN
                   sep__call_use                                                语音资源使用量：近3月离散系数                   数值型                            sep__call_use  自动衍生_py      NaN
                   sep__gprs_flow_game                                          游戏类应用流量：近3月离散系数                   数值型                      sep__gprs_flow_game  自动衍生_py      NaN
                   sep__days_call_p_4                                           通话天数占比_4：近3月离散系数                   数值型                       sep__days_call_p_4  自动衍生_py      NaN
                   sep__arpu                                                          当月arpu：近3月离散系数                   数值型                                sep__arpu  自动衍生_py      NaN
                   sep__nos_calling_diff                                  主叫异网对端号码个数：近3月离散系数                   数值型                    sep__nos_calling_diff  自动衍生_py      NaN
                   sep__calling_cnt                                               主叫通话次数：近3月离散系数                   数值型                         sep__calling_cnt  自动衍生_py      NaN
                   sep__gprs_flow_video                                         视频类应用流量：近3月离散系数                   数值型                     sep__gprs_flow_video  自动衍生_py      NaN
                   wave__gprs_flow_5g                                                gprs 5g流量：近3月波动性                   数值型                       wave__gprs_flow_5g  自动衍生_py      NaN
                   wave__calling_dura                                           当月主叫通话时长：近3月波动性                   数值型                       wave__calling_dura  自动衍生_py      NaN
                   wave__gprs_resource                                          gprs国内资源总量：近3月波动性                   数值型                      wave__gprs_resource  自动衍生_py      NaN
                   wave__call_dura_roam                                            省际漫游-时长：近3月波动性                   数值型                     wave__call_dura_roam  自动衍生_py      NaN
                   wave__calling_diff_cnt                                       主叫异网通话次数：近3月波动性                   数值型                   wave__calling_diff_cnt  自动衍生_py      NaN
                   wave__gprs_flow_busy                                           gprs-忙时-流量：近3月波动性                   数值型                     wave__gprs_flow_busy  自动衍生_py      NaN
                   wave__gprs_flow_music                                          音乐类应用流量：近3月波动性                   数值型                    wave__gprs_flow_music  自动衍生_py      NaN
                   wave__gprs_last_defer                                            流量滚存资源：近3月波动性                   数值型                    wave__gprs_last_defer  自动衍生_py      NaN
                   wave__gprs_now_defer                                       可延递流量资源总量：近3月波动性                   数值型                     wave__gprs_now_defer  自动衍生_py      NaN
                   wave__nos_calling                                        主叫通话对端号码个数：近3月波动性                   数值型                        wave__nos_calling  自动衍生_py      NaN
                   wave__gprs_flow_roam                                       gprs-国内漫游-流量：近3月波动性                   数值型                     wave__gprs_flow_roam  自动衍生_py      NaN
                   wave__calling_diff_dura                                    主叫异网通话分钟数：近3月波动性                   数值型                  wave__calling_diff_dura  自动衍生_py      NaN
                   wave__gprs_now_rest                                          当月gprs资源余量：近3月波动性                   数值型                      wave__gprs_now_rest  自动衍生_py      NaN
                   wave__monthsremain_last_stop_date                      最后停机时间：剩余时长：近3月波动性                   数值型        wave__monthsremain_last_stop_date  自动衍生_py      NaN
                   wave__dinner_fee                                                   套餐月租费：近3月波动性                   数值型                         wave__dinner_fee  自动衍生_py      NaN
                   wave__gprs_flow_short                                         小视频系app流量：近3月波动性                   数值型                    wave__gprs_flow_short  自动衍生_py      NaN
                   wave__gprs_flow_commu                                          通信类应用流量：近3月波动性                   数值型                    wave__gprs_flow_commu  自动衍生_py      NaN
                   wave__call_use                                                 语音资源使用量：近3月波动性                   数值型                           wave__call_use  自动衍生_py      NaN
                   wave__gprs_flow_game                                           游戏类应用流量：近3月波动性                   数值型                     wave__gprs_flow_game  自动衍生_py      NaN
                   wave__days_call_p_4                                            通话天数占比_4：近3月波动性                   数值型                      wave__days_call_p_4  自动衍生_py      NaN
                   wave__arpu                                                           当月arpu：近3月波动性                   数值型                               wave__arpu  自动衍生_py      NaN
                   wave__nos_calling_diff                                   主叫异网对端号码个数：近3月波动性                   数值型                   wave__nos_calling_diff  自动衍生_py      NaN
                   wave__calling_cnt                                                主叫通话次数：近3月波动性                   数值型                        wave__calling_cnt  自动衍生_py      NaN
                   wave__gprs_flow_video                                          视频类应用流量：近3月波动性                   数值型                    wave__gprs_flow_video  自动衍生_py      NaN
                   grow__gprs_flow_5g                                                gprs 5g流量：近3月成长率                   数值型                       grow__gprs_flow_5g  自动衍生_py      NaN
                   grow__calling_dura                                           当月主叫通话时长：近3月成长率                   数值型                       grow__calling_dura  自动衍生_py      NaN
                   grow__gprs_resource                                          gprs国内资源总量：近3月成长率                   数值型                      grow__gprs_resource  自动衍生_py      NaN
                   grow__call_dura_roam                                            省际漫游-时长：近3月成长率                   数值型                     grow__call_dura_roam  自动衍生_py      NaN
                   grow__calling_diff_cnt                                       主叫异网通话次数：近3月成长率                   数值型                   grow__calling_diff_cnt  自动衍生_py      NaN
                   grow__gprs_flow_busy                                           gprs-忙时-流量：近3月成长率                   数值型                     grow__gprs_flow_busy  自动衍生_py      NaN
                   grow__gprs_flow_music                                          音乐类应用流量：近3月成长率                   数值型                    grow__gprs_flow_music  自动衍生_py      NaN
                   grow__gprs_last_defer                                            流量滚存资源：近3月成长率                   数值型                    grow__gprs_last_defer  自动衍生_py      NaN
                   grow__gprs_now_defer                                       可延递流量资源总量：近3月成长率                   数值型                     grow__gprs_now_defer  自动衍生_py      NaN
                   grow__nos_calling                                        主叫通话对端号码个数：近3月成长率                   数值型                        grow__nos_calling  自动衍生_py      NaN
                   grow__gprs_flow_roam                                       gprs-国内漫游-流量：近3月成长率                   数值型                     grow__gprs_flow_roam  自动衍生_py      NaN
                   grow__calling_diff_dura                                    主叫异网通话分钟数：近3月成长率                   数值型                  grow__calling_diff_dura  自动衍生_py      NaN
                   grow__gprs_now_rest                                          当月gprs资源余量：近3月成长率                   数值型                      grow__gprs_now_rest  自动衍生_py      NaN
                   grow__monthsremain_last_stop_date                      最后停机时间：剩余时长：近3月成长率                   数值型        grow__monthsremain_last_stop_date  自动衍生_py      NaN
                   grow__dinner_fee                                                   套餐月租费：近3月成长率                   数值型                         grow__dinner_fee  自动衍生_py      NaN
                   grow__gprs_flow_short                                         小视频系app流量：近3月成长率                   数值型                    grow__gprs_flow_short  自动衍生_py      NaN
                   grow__gprs_flow_commu                                          通信类应用流量：近3月成长率                   数值型                    grow__gprs_flow_commu  自动衍生_py      NaN
                   grow__call_use                                                 语音资源使用量：近3月成长率                   数值型                           grow__call_use  自动衍生_py      NaN
                   grow__gprs_flow_game                                           游戏类应用流量：近3月成长率                   数值型                     grow__gprs_flow_game  自动衍生_py      NaN
                   grow__days_call_p_4                                            通话天数占比_4：近3月成长率                   数值型                      grow__days_call_p_4  自动衍生_py      NaN
                   grow__arpu                                                           当月arpu：近3月成长率                   数值型                               grow__arpu  自动衍生_py      NaN
                   grow__nos_calling_diff                                   主叫异网对端号码个数：近3月成长率                   数值型                   grow__nos_calling_diff  自动衍生_py      NaN
                   grow__calling_cnt                                                主叫通话次数：近3月成长率                   数值型                        grow__calling_cnt  自动衍生_py      NaN
                   grow__gprs_flow_video                                          视频类应用流量：近3月成长率                   数值型                    grow__gprs_flow_video  自动衍生_py      NaN
                   max__gprs_flow_5g                                                 gprs 5g流量：近3月最大值                   数值型                        max__gprs_flow_5g  自动衍生_py      NaN
                   max__calling_dura                                            当月主叫通话时长：近3月最大值                   数值型                        max__calling_dura  自动衍生_py      NaN
                   max__gprs_resource                                           gprs国内资源总量：近3月最大值                   数值型                       max__gprs_resource  自动衍生_py      NaN
                   max__call_dura_roam                                             省际漫游-时长：近3月最大值                   数值型                      max__call_dura_roam  自动衍生_py      NaN
                   max__calling_diff_cnt                                        主叫异网通话次数：近3月最大值                   数值型                    max__calling_diff_cnt  自动衍生_py      NaN
                   max__gprs_flow_busy                                            gprs-忙时-流量：近3月最大值                   数值型                      max__gprs_flow_busy  自动衍生_py      NaN
                   max__gprs_flow_music                                           音乐类应用流量：近3月最大值                   数值型                     max__gprs_flow_music  自动衍生_py      NaN
                   max__gprs_last_defer                                             流量滚存资源：近3月最大值                   数值型                     max__gprs_last_defer  自动衍生_py      NaN
                   max__gprs_now_defer                                        可延递流量资源总量：近3月最大值                   数值型                      max__gprs_now_defer  自动衍生_py      NaN
                   max__nos_calling                                         主叫通话对端号码个数：近3月最大值                   数值型                         max__nos_calling  自动衍生_py      NaN
                   max__gprs_flow_roam                                        gprs-国内漫游-流量：近3月最大值                   数值型                      max__gprs_flow_roam  自动衍生_py      NaN
                   max__calling_diff_dura                                     主叫异网通话分钟数：近3月最大值                   数值型                   max__calling_diff_dura  自动衍生_py      NaN
                   max__gprs_now_rest                                           当月gprs资源余量：近3月最大值                   数值型                       max__gprs_now_rest  自动衍生_py      NaN
                   max__monthsremain_last_stop_date                       最后停机时间：剩余时长：近3月最大值                   数值型         max__monthsremain_last_stop_date  自动衍生_py      NaN
                   max__dinner_fee                                                    套餐月租费：近3月最大值                   数值型                          max__dinner_fee  自动衍生_py      NaN
                   max__gprs_flow_short                                          小视频系app流量：近3月最大值                   数值型                     max__gprs_flow_short  自动衍生_py      NaN
                   max__gprs_flow_commu                                           通信类应用流量：近3月最大值                   数值型                     max__gprs_flow_commu  自动衍生_py      NaN
                   max__call_use                                                  语音资源使用量：近3月最大值                   数值型                            max__call_use  自动衍生_py      NaN
                   max__gprs_flow_game                                            游戏类应用流量：近3月最大值                   数值型                      max__gprs_flow_game  自动衍生_py      NaN
                   max__days_call_p_4                                             通话天数占比_4：近3月最大值                   数值型                       max__days_call_p_4  自动衍生_py      NaN
                   max__arpu                                                            当月arpu：近3月最大值                   数值型                                max__arpu  自动衍生_py      NaN
                   max__nos_calling_diff                                    主叫异网对端号码个数：近3月最大值                   数值型                    max__nos_calling_diff  自动衍生_py      NaN
                   max__calling_cnt                                                 主叫通话次数：近3月最大值                   数值型                         max__calling_cnt  自动衍生_py      NaN
                   max__gprs_flow_video                                           视频类应用流量：近3月最大值                   数值型                     max__gprs_flow_video  自动衍生_py      NaN
                   min__gprs_flow_5g                                                 gprs 5g流量：近3月最小值                   数值型                        min__gprs_flow_5g  自动衍生_py      NaN
                   min__calling_dura                                            当月主叫通话时长：近3月最小值                   数值型                        min__calling_dura  自动衍生_py      NaN
                   min__gprs_resource                                           gprs国内资源总量：近3月最小值                   数值型                       min__gprs_resource  自动衍生_py      NaN
                   min__call_dura_roam                                             省际漫游-时长：近3月最小值                   数值型                      min__call_dura_roam  自动衍生_py      NaN
                   min__calling_diff_cnt                                        主叫异网通话次数：近3月最小值                   数值型                    min__calling_diff_cnt  自动衍生_py      NaN
                   min__gprs_flow_busy                                            gprs-忙时-流量：近3月最小值                   数值型                      min__gprs_flow_busy  自动衍生_py      NaN
                   min__gprs_flow_music                                           音乐类应用流量：近3月最小值                   数值型                     min__gprs_flow_music  自动衍生_py      NaN
                   min__gprs_last_defer                                             流量滚存资源：近3月最小值                   数值型                     min__gprs_last_defer  自动衍生_py      NaN
                   min__gprs_now_defer                                        可延递流量资源总量：近3月最小值                   数值型                      min__gprs_now_defer  自动衍生_py      NaN
                   min__nos_calling                                         主叫通话对端号码个数：近3月最小值                   数值型                         min__nos_calling  自动衍生_py      NaN
                   min__gprs_flow_roam                                        gprs-国内漫游-流量：近3月最小值                   数值型                      min__gprs_flow_roam  自动衍生_py      NaN
                   min__calling_diff_dura                                     主叫异网通话分钟数：近3月最小值                   数值型                   min__calling_diff_dura  自动衍生_py      NaN
                   min__gprs_now_rest                                           当月gprs资源余量：近3月最小值                   数值型                       min__gprs_now_rest  自动衍生_py      NaN
                   min__monthsremain_last_stop_date                       最后停机时间：剩余时长：近3月最小值                   数值型         min__monthsremain_last_stop_date  自动衍生_py      NaN
                   min__dinner_fee                                                    套餐月租费：近3月最小值                   数值型                          min__dinner_fee  自动衍生_py      NaN
                   min__gprs_flow_short                                          小视频系app流量：近3月最小值                   数值型                     min__gprs_flow_short  自动衍生_py      NaN
                   min__gprs_flow_commu                                           通信类应用流量：近3月最小值                   数值型                     min__gprs_flow_commu  自动衍生_py      NaN
                   min__call_use                                                  语音资源使用量：近3月最小值                   数值型                            min__call_use  自动衍生_py      NaN
                   min__gprs_flow_game                                            游戏类应用流量：近3月最小值                   数值型                      min__gprs_flow_game  自动衍生_py      NaN
                   min__days_call_p_4                                             通话天数占比_4：近3月最小值                   数值型                       min__days_call_p_4  自动衍生_py      NaN
                   min__arpu                                                            当月arpu：近3月最小值                   数值型                                min__arpu  自动衍生_py      NaN
                   min__nos_calling_diff                                    主叫异网对端号码个数：近3月最小值                   数值型                    min__nos_calling_diff  自动衍生_py      NaN
                   min__calling_cnt                                                 主叫通话次数：近3月最小值                   数值型                         min__calling_cnt  自动衍生_py      NaN
                   min__gprs_flow_video                                           视频类应用流量：近3月最小值                   数值型                     min__gprs_flow_video  自动衍生_py      NaN
                   std__gprs_flow_5g                                                 gprs 5g流量：近3月标准差                   数值型                        std__gprs_flow_5g  自动衍生_py      NaN
                   std__calling_dura                                            当月主叫通话时长：近3月标准差                   数值型                        std__calling_dura  自动衍生_py      NaN
                   std__gprs_resource                                           gprs国内资源总量：近3月标准差                   数值型                       std__gprs_resource  自动衍生_py      NaN
                   std__call_dura_roam                                             省际漫游-时长：近3月标准差                   数值型                      std__call_dura_roam  自动衍生_py      NaN
                   std__calling_diff_cnt                                        主叫异网通话次数：近3月标准差                   数值型                    std__calling_diff_cnt  自动衍生_py      NaN
                   std__gprs_flow_busy                                            gprs-忙时-流量：近3月标准差                   数值型                      std__gprs_flow_busy  自动衍生_py      NaN
                   std__gprs_flow_music                                           音乐类应用流量：近3月标准差                   数值型                     std__gprs_flow_music  自动衍生_py      NaN
                   std__gprs_last_defer                                             流量滚存资源：近3月标准差                   数值型                     std__gprs_last_defer  自动衍生_py      NaN
                   std__gprs_now_defer                                        可延递流量资源总量：近3月标准差                   数值型                      std__gprs_now_defer  自动衍生_py      NaN
                   std__nos_calling                                         主叫通话对端号码个数：近3月标准差                   数值型                         std__nos_calling  自动衍生_py      NaN
                   std__gprs_flow_roam                                        gprs-国内漫游-流量：近3月标准差                   数值型                      std__gprs_flow_roam  自动衍生_py      NaN
                   std__calling_diff_dura                                     主叫异网通话分钟数：近3月标准差                   数值型                   std__calling_diff_dura  自动衍生_py      NaN
                   std__gprs_now_rest                                           当月gprs资源余量：近3月标准差                   数值型                       std__gprs_now_rest  自动衍生_py      NaN
                   std__monthsremain_last_stop_date                       最后停机时间：剩余时长：近3月标准差                   数值型         std__monthsremain_last_stop_date  自动衍生_py      NaN
                   std__dinner_fee                                                    套餐月租费：近3月标准差                   数值型                          std__dinner_fee  自动衍生_py      NaN
                   std__gprs_flow_short                                          小视频系app流量：近3月标准差                   数值型                     std__gprs_flow_short  自动衍生_py      NaN
                   std__gprs_flow_commu                                           通信类应用流量：近3月标准差                   数值型                     std__gprs_flow_commu  自动衍生_py      NaN
                   std__call_use                                                  语音资源使用量：近3月标准差                   数值型                            std__call_use  自动衍生_py      NaN
                   std__gprs_flow_game                                            游戏类应用流量：近3月标准差                   数值型                      std__gprs_flow_game  自动衍生_py      NaN
                   std__days_call_p_4                                             通话天数占比_4：近3月标准差                   数值型                       std__days_call_p_4  自动衍生_py      NaN
                   std__arpu                                                            当月arpu：近3月标准差                   数值型                                std__arpu  自动衍生_py      NaN
                   std__nos_calling_diff                                    主叫异网对端号码个数：近3月标准差                   数值型                    std__nos_calling_diff  自动衍生_py      NaN
                   std__calling_cnt                                                 主叫通话次数：近3月标准差                   数值型                         std__calling_cnt  自动衍生_py      NaN
                   std__gprs_flow_video                                           视频类应用流量：近3月标准差                   数值型                     std__gprs_flow_video  自动衍生_py      NaN
                   flag_eg                                                                            flag_eg                   类别型                                  flag_eg  自动衍生_py      NaN
                   more0cnt__gprs_flow_5g                                     gprs 5g流量：近3月大于0的月份数                   数值型                   more0cnt__gprs_flow_5g  自动衍生_py      NaN
                   more0cnt__calling_dura                                当月主叫通话时长：近3月大于0的月份数                   数值型                   more0cnt__calling_dura  自动衍生_py      NaN
                   more0cnt__gprs_resource                               gprs国内资源总量：近3月大于0的月份数                   数值型                  more0cnt__gprs_resource  自动衍生_py      NaN
                   more0cnt__call_dura_roam                                 省际漫游-时长：近3月大于0的月份数                   数值型                 more0cnt__call_dura_roam  自动衍生_py      NaN
                   more0cnt__calling_diff_cnt                            主叫异网通话次数：近3月大于0的月份数                   数值型               more0cnt__calling_diff_cnt  自动衍生_py      NaN
                   more0cnt__gprs_flow_busy                                gprs-忙时-流量：近3月大于0的月份数                   数值型                 more0cnt__gprs_flow_busy  自动衍生_py      NaN
                   more0cnt__gprs_flow_music                               音乐类应用流量：近3月大于0的月份数                   数值型                more0cnt__gprs_flow_music  自动衍生_py      NaN
                   more0cnt__gprs_last_defer                                 流量滚存资源：近3月大于0的月份数                   数值型                more0cnt__gprs_last_defer  自动衍生_py      NaN
                   more0cnt__gprs_now_defer                            可延递流量资源总量：近3月大于0的月份数                   数值型                 more0cnt__gprs_now_defer  自动衍生_py      NaN
                   more0cnt__nos_calling                             主叫通话对端号码个数：近3月大于0的月份数                   数值型                    more0cnt__nos_calling  自动衍生_py      NaN
                   more0cnt__gprs_flow_roam                            gprs-国内漫游-流量：近3月大于0的月份数                   数值型                 more0cnt__gprs_flow_roam  自动衍生_py      NaN
                   more0cnt__calling_diff_dura                         主叫异网通话分钟数：近3月大于0的月份数                   数值型              more0cnt__calling_diff_dura  自动衍生_py      NaN
                   more0cnt__gprs_now_rest                               当月gprs资源余量：近3月大于0的月份数                   数值型                  more0cnt__gprs_now_rest  自动衍生_py      NaN
                   more0cnt__monthsremain_last_stop_date           最后停机时间：剩余时长：近3月大于0的月份数                   数值型    more0cnt__monthsremain_last_stop_date  自动衍生_py      NaN
                   more0cnt__dinner_fee                                        套餐月租费：近3月大于0的月份数                   数值型                     more0cnt__dinner_fee  自动衍生_py      NaN
                   more0cnt__gprs_flow_short                              小视频系app流量：近3月大于0的月份数                   数值型                more0cnt__gprs_flow_short  自动衍生_py      NaN
                   more0cnt__gprs_flow_commu                               通信类应用流量：近3月大于0的月份数                   数值型                more0cnt__gprs_flow_commu  自动衍生_py      NaN
                   more0cnt__call_use                                      语音资源使用量：近3月大于0的月份数                   数值型                       more0cnt__call_use  自动衍生_py      NaN
                   more0cnt__gprs_flow_game                                游戏类应用流量：近3月大于0的月份数                   数值型                 more0cnt__gprs_flow_game  自动衍生_py      NaN
                   more0cnt__days_call_p_4                                 通话天数占比_4：近3月大于0的月份数                   数值型                  more0cnt__days_call_p_4  自动衍生_py      NaN
                   more0cnt__arpu                                                当月arpu：近3月大于0的月份数                   数值型                           more0cnt__arpu  自动衍生_py      NaN
                   more0cnt__nos_calling_diff                        主叫异网对端号码个数：近3月大于0的月份数                   数值型               more0cnt__nos_calling_diff  自动衍生_py      NaN
                   more0cnt__calling_cnt                                     主叫通话次数：近3月大于0的月份数                   数值型                    more0cnt__calling_cnt  自动衍生_py      NaN
                   more0cnt__gprs_flow_video                               视频类应用流量：近3月大于0的月份数                   数值型                more0cnt__gprs_flow_video  自动衍生_py      NaN
                   moreq25cnt__gprs_flow_5g                        gprs 5g流量：近3月大于第一四分位数的月份数                   数值型                 moreq25cnt__gprs_flow_5g  自动衍生_py      NaN
                   moreq25cnt__calling_dura                   当月主叫通话时长：近3月大于第一四分位数的月份数                   数值型                 moreq25cnt__calling_dura  自动衍生_py      NaN
                   moreq25cnt__gprs_resource                  gprs国内资源总量：近3月大于第一四分位数的月份数                   数值型                moreq25cnt__gprs_resource  自动衍生_py      NaN
                   moreq25cnt__call_dura_roam                    省际漫游-时长：近3月大于第一四分位数的月份数                   数值型               moreq25cnt__call_dura_roam  自动衍生_py      NaN
                   moreq25cnt__calling_diff_cnt               主叫异网通话次数：近3月大于第一四分位数的月份数                   数值型             moreq25cnt__calling_diff_cnt  自动衍生_py      NaN
                   moreq25cnt__gprs_flow_busy                   gprs-忙时-流量：近3月大于第一四分位数的月份数                   数值型               moreq25cnt__gprs_flow_busy  自动衍生_py      NaN
                   moreq25cnt__gprs_flow_music                  音乐类应用流量：近3月大于第一四分位数的月份数                   数值型              moreq25cnt__gprs_flow_music  自动衍生_py      NaN
                   moreq25cnt__gprs_last_defer                    流量滚存资源：近3月大于第一四分位数的月份数                   数值型              moreq25cnt__gprs_last_defer  自动衍生_py      NaN
                   moreq25cnt__gprs_now_defer               可延递流量资源总量：近3月大于第一四分位数的月份数                   数值型               moreq25cnt__gprs_now_defer  自动衍生_py      NaN
                   moreq25cnt__nos_calling                  主叫通话对端号码个数：近3月大于第一四分位数的月份数......           数值型                  moreq25cnt__nos_calling  自动衍生_py      NaN
                   moreq25cnt__gprs_flow_roam               gprs-国内漫游-流量：近3月大于第一四分位数的月份数                   数值型               moreq25cnt__gprs_flow_roam  自动衍生_py      NaN
                   moreq25cnt__calling_diff_dura            主叫异网通话分钟数：近3月大于第一四分位数的月份数                   数值型            moreq25cnt__calling_diff_dura  自动衍生_py      NaN
                   moreq25cnt__gprs_now_rest                  当月gprs资源余量：近3月大于第一四分位数的月份数                   数值型                moreq25cnt__gprs_now_rest  自动衍生_py      NaN
                   moreq25cnt__monthsremain_last_stop_date  最后停机时间：剩余时长：近3月大于第一四分位数的月份数......         数值型  moreq25cnt__monthsremain_last_stop_date  自动衍生_py      NaN
                   moreq25cnt__dinner_fee                           套餐月租费：近3月大于第一四分位数的月份数                   数值型                   moreq25cnt__dinner_fee  自动衍生_py      NaN
                   moreq25cnt__gprs_flow_short                 小视频系app流量：近3月大于第一四分位数的月份数                   数值型              moreq25cnt__gprs_flow_short  自动衍生_py      NaN
                   moreq25cnt__gprs_flow_commu                  通信类应用流量：近3月大于第一四分位数的月份数                   数值型              moreq25cnt__gprs_flow_commu  自动衍生_py      NaN
                   moreq25cnt__call_use                         语音资源使用量：近3月大于第一四分位数的月份数                   数值型                     moreq25cnt__call_use  自动衍生_py      NaN
                   moreq25cnt__gprs_flow_game                   游戏类应用流量：近3月大于第一四分位数的月份数                   数值型               moreq25cnt__gprs_flow_game  自动衍生_py      NaN
                   moreq25cnt__days_call_p_4                    通话天数占比_4：近3月大于第一四分位数的月份数                   数值型                moreq25cnt__days_call_p_4  自动衍生_py      NaN
                   moreq25cnt__arpu                                   当月arpu：近3月大于第一四分位数的月份数                   数值型                         moreq25cnt__arpu  自动衍生_py      NaN
                   moreq25cnt__nos_calling_diff             主叫异网对端号码个数：近3月大于第一四分位数的月份数......           数值型             moreq25cnt__nos_calling_diff  自动衍生_py      NaN
                   moreq25cnt__calling_cnt                        主叫通话次数：近3月大于第一四分位数的月份数                   数值型                  moreq25cnt__calling_cnt  自动衍生_py      NaN
                   moreq25cnt__gprs_flow_video                  视频类应用流量：近3月大于第一四分位数的月份数                   数值型              moreq25cnt__gprs_flow_video  自动衍生_py      NaN
                   flag_eg                                                                            flag_eg                   类别型                                  flag_eg  自动衍生_py      NaN
                   valuecnt__account_id~其他_countlow              帐户编号：近3月取值为其他_countlow的月份数                   数值型       valuecnt__account_id~其他_countlow  自动衍生_py       否
                   valuecnt__if_nolimit~是                      是否不限量套餐到达用户：近3月取值为是的月份数                   数值型                  valuecnt__if_nolimit~是  自动衍生_py      NaN
                   valuecnt__if_5g_dinner~是                                是否5g套餐：近3月取值为是的月份数                   数值型                valuecnt__if_5g_dinner~是  自动衍生_py      NaN
                   valuecnt__greatest_gprs_app~commu                        app偏好：近3月取值为commu的月份数                   数值型        valuecnt__greatest_gprs_app~commu  自动衍生_py      NaN
                   valuecnt__greatest_gprs_app~video                        app偏好：近3月取值为video的月份数                   数值型        valuecnt__greatest_gprs_app~video  自动衍生_py      NaN
                   Out[168]: 20220322-17:18:11  
                   Empty DataFrame
                   Columns: [field_name, comment, dtype_classify, field_src, available, available_notzd, available_zd, formula, remark, must_remain, into_model, is_cause, nan, nan, nan, nan, nan, nan]
                   Index: []
20220322-17:18:44  field_base: 84行
20220322-17:18:44  删除5个available“不可用”字段：['gprs_flow_tnet', 'days_outside', 'aaa', 'bbb', 'ccc']
20220322-17:18:44  field_base: 79行

20220322-17:18:44  删除1个基于“不可用”字段加工的手动衍生_py字段：
                           field_name                    formula
                   56  days_outside_p  days_outside / days_month
20220322-17:18:44  field_base: 78行


C:\Users\higher\Desktop\to伟鹏的代码_v2\ModelProject\selfmodule\binarymodule\modelinfo.py:77: UserWarning: 确定下列时长类字段的renmark是否限制 ‘不参与近n月自动衍生’：
                     field_name                   comment remark
12  monthsaready_last_stop_date  最后停机时间：已发生时长    NaN
13  monthsremain_last_stop_date    最后停机时间：剩余时长    NaN
  warnings.warn(s)
                   Out[170]: 20220322-17:18:58  
                         field_name       comment dtype_classify field_src available available_notzd  available_zd formula              remark must_remain into_model is_cause  NaN  NaN  NaN  NaN  NaN  NaN
                   0     acct_month          账期         类别型      原始       NaN             NaN           NaN     NaN                 NaN         NaN        NaN       否  NaN  NaN  NaN  NaN  NaN  NaN
                   1  phone_no_null      手机号码         类别型      原始       NaN             NaN           NaN     NaN      不参与自动衍生         NaN       删除       否  NaN  NaN  NaN  NaN  NaN  NaN
                   2    phone_no_tm    模糊手机号         类别型      原始       NaN             NaN           NaN     NaN      不参与自动衍生         NaN       删除       否  NaN  NaN  NaN  NaN  NaN  NaN
                   3        user_id      手机号id         类别型      原始       NaN             NaN           NaN     NaN                 NaN         NaN        NaN       否  NaN  NaN  NaN  NaN  NaN  NaN
                   4      dinner_id  主套餐策划id         类别型      原始       NaN             NaN           NaN     NaN  不参与当月自动衍生         NaN        NaN       否  NaN  NaN  NaN  NaN  NaN  NaN
                   Out[172]: 20220322-17:20:49  
                                        field_name                   comment dtype_classify    field_src available available_notzd  available_zd                                            formula               remark must_remain into_model is_cause  NaN  NaN  NaN  NaN  NaN  NaN
                   0                    acct_month                      账期         类别型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN       否  NaN  NaN  NaN  NaN  NaN  NaN
                   1                 phone_no_null                  手机号码         类别型         原始       NaN             NaN           NaN                                                NaN       不参与自动衍生         NaN       删除       否  NaN  NaN  NaN  NaN  NaN  NaN
                   2                   phone_no_tm                模糊手机号         类别型         原始       NaN             NaN           NaN                                                NaN       不参与自动衍生         NaN       删除       否  NaN  NaN  NaN  NaN  NaN  NaN
                   3                       user_id                  手机号id         类别型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN       否  NaN  NaN  NaN  NaN  NaN  NaN
                   4                     dinner_id              主套餐策划id         类别型         原始       NaN             NaN           NaN                                                NaN   不参与当月自动衍生         NaN        NaN       否  NaN  NaN  NaN  NaN  NaN  NaN
                   5                    account_id                  帐户编号         类别型         原始       NaN             NaN           NaN                                                NaN   不参与当月自动衍生          是        NaN       否  NaN  NaN  NaN  NaN  NaN  NaN
                   6                    innet_date                  入网日期         日期型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN       删除       否  NaN  NaN  NaN  NaN  NaN  NaN
                   7                  innet_months                  入网时长         数值型         原始       NaN             NaN           NaN                                                NaN  不参与近n月自动衍生         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   8                           age                      年龄         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   9                           sex                      性别         类别型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN       否  NaN  NaN  NaN  NaN  NaN  NaN
                   10                  user_status                  用户状态         类别型         原始       NaN             NaN           NaN                                                NaN                  NaN          是        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   11               last_stop_date              最后停机时间         日期型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN       删除       否  NaN  NaN  NaN  NaN  NaN  NaN
                   12  monthsaready_last_stop_date  最后停机时间：已发生时长         数值型  手动衍生_py       NaN             NaN           NaN                      current_date - last_stop_date                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   13  monthsremain_last_stop_date    最后停机时间：剩余时长         数值型  手动衍生_py       NaN             NaN           NaN                      last_stop_date - current_date                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   14                       dinner                    主套餐         类别型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   15                   dinner_fee                套餐月租费         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   16              gprs_last_defer              流量滚存资源         数值型         原始       NaN             NaN           NaN                                                NaN   不参与当月自动衍生         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   17                gprs_resource          gprs国内资源总量         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   18                gprs_now_rest          当月gprs资源余量         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   19                     call_use            语音资源使用量         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   20                   if_nolimit    是否不限量套餐到达用户         类别型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   21                 if_5g_dinner                是否5g套餐         类别型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   22                   if_5g_term            是否5g终端客户         类别型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   23                        if_jt              是否集团成员         类别型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   24                  start_level              客户星级标识         类别型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   25                    cred_type              机主证件类型         类别型         原始       NaN          不可用           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   26                if_cred_multi               一证n号标识         类别型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   27                         arpu                  当月arpu         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   28                      pay_cnt                自充值次数         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   29                      pay_fee                自充值额度         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   30                 acct_balance                  账户余额         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   31                   term_model              终端品牌类型         类别型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   32                   term_brand                  终端品牌         类别型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   33                    term_type                  终端类型         类别型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   34                      sk_type                  双卡类型         类别型         原始       NaN             NaN           NaN                                                NaN       不参与自动衍生         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   35                  if_new_term              是否新机用户         类别型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   36                  calling_cnt              主叫通话次数         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   37                 calling_dura          当月主叫通话时长         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   38                   called_cnt              被叫通话次数         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   39                  called_dura          当月被叫通话时长         数值型         原始       NaN          不可用           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   40             calling_diff_cnt          主叫异网通话次数         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   41            calling_diff_dura        主叫异网通话分钟数         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   42                    gprs_flow                gprs总流量         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   43               gprs_flow_tnet             gprs-t网-流量         数值型         原始    不可用             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   44                 gprs_flow_4g                gprs4g流量         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   45                 gprs_flow_5g               gprs 5g流量         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   46               gprs_flow_busy            gprs-忙时-流量         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   47               gprs_flow_idle            gprs-闲时-流量         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   48               gprs_now_defer        可延递流量资源总量         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   49               gprs_flow_roam        gprs-国内漫游-流量         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   50               call_dura_roam             省际漫游-时长         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   51                    days_roam              国内漫出天数         数值型         原始       NaN          不可用           NaN                                                NaN       不参与自动衍生         NaN       删除      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   52                  days_roam_p     国内漫出天数/当月天数         数值型  手动衍生_py       NaN             NaN           NaN                             days_roam / days_month                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   53                gprs_flow_gat      gprs-港澳台漫游-流量         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   54                     days_gat           港澳台漫游-时长         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   55                 days_outside          当月境外漫游天数         数值型         原始    不可用             NaN           NaN                                                NaN       不参与自动衍生         NaN       删除      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   56               days_outside_p      当月境外漫游天数占比         数值型  手动衍生_py       NaN             NaN           NaN                          days_outside / days_month                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   57                    days_gprs                  上网天数         数值型         原始       NaN             NaN           NaN                                                NaN       不参与自动衍生         NaN       删除      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   58                  days_gprs_p              上网天数占比         数值型  手动衍生_py       NaN             NaN           NaN                             days_gprs / days_month                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   59                    days_call                  通话天数         数值型         原始       NaN             NaN           NaN                                                NaN       不参与自动衍生         NaN       删除      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   60                  days_call_p              通话天数占比         数值型  手动衍生_py       NaN             NaN           NaN                             days_call / days_month                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   61                days_call_p_1            通话天数占比_1         数值型  手动衍生_py       NaN             NaN           NaN                            days_call_p + days_gprs                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   62                days_call_p_2            通话天数占比_2         数值型  手动衍生_py       NaN             NaN           NaN                          days_call_p_1 + days_gprs                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   63                days_call_p_3            通话天数占比_3         数值型  手动衍生_py       NaN             NaN           NaN                          days_call_p_2 + days_gprs                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   64                days_call_p_4            通话天数占比_4         数值型  手动衍生_py       NaN             NaN           NaN                          days_call_p_3 + days_gprs                  NaN          是        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   65                     nos_call    用户通信对端手机号码数         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   66                  nos_calling      主叫通话对端号码个数         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   67             nos_calling_diff      主叫异网对端号码个数         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   68                      sms_cnt      短信-点对点短信-条数         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   69               call_fee_local                本地通话费         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   70                call_fee_roam                漫游通话费         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   71                  gprs_income              流量出账收入         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   72                     gprs_fee           流量出账-流量费         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   73                     call_fee              套餐外语音费         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   74              gprs_flow_video            视频类应用流量         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   75              gprs_flow_short           小视频系app流量         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN          是        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   76              gprs_flow_music            音乐类应用流量         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN          是        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   77              gprs_flow_commu            通信类应用流量         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN          是        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   78               gprs_flow_game            游戏类应用流量         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN          是        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   79            greatest_gprs_app                   app偏好         类别型  手动衍生_py       NaN             NaN           NaN  {'gprs_flow_video': 'video', 'gprs_flow_short'...                  NaN          是        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   80    paste_dinner_innet_months    主套餐、入网时长：交叉         类别型  手动衍生_py       NaN             NaN           NaN                             (dinner, innet_months)                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   81                          aaa                       aaa         数值型         原始    不可用             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   82                          bbb                       bbb         类别型         原始    不可用             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   83                          ccc                       ccc         日期型         原始    不可用             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN  NaN  NaN  NaN  NaN  NaN  NaN
                   Out[173]: 20220322-17:21:13  Index(['field_name', 'comment', 'dtype_classify', 'field_src', 'available', 'available_notzd', 'available_zd', 'formula', 'remark', 'must_remain', 'into_model', 'is_cause', nan, nan, nan, nan, nan, nan], dtype='object')


Traceback (most recent call last):
  File "C:\Users\higher\Anaconda3\lib\site-packages\IPython\core\interactiveshell.py", line 2961, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-177-75d3ec0efe48>", line 1, in <module>
    he
NameError: name 'he' is not defined


Traceback (most recent call last):
  File "C:\Users\higher\Anaconda3\lib\site-packages\IPython\core\interactiveshell.py", line 2961, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-179-37602f2dba95>", line 1, in <module>
    col_type=Non
NameError: name 'Non' is not defined


Traceback (most recent call last):
  File "C:\Users\higher\Anaconda3\lib\site-packages\IPython\core\interactiveshell.py", line 2961, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-180-5e927187738c>", line 1, in <module>
    header=Tru
NameError: name 'Tru' is not defined
                   Out[189]: 
                                               0                         1               2            3          4                5             6                                                  7                    8            9           10        11   12   13   14   15   16   17
                   0                   field_name                   comment  dtype_classify    field_src  available  available_notzd  available_zd                                            formula               remark  must_remain  into_model  is_cause  NaN  NaN  NaN  NaN  NaN  NaN
                   0                   acct_month                      账期          类别型         原始                                                                                                                                                   否  NaN  NaN  NaN  NaN  NaN  NaN
                   0                phone_no_null                  手机号码          类别型         原始                                                                                                    不参与自动衍生                     删除        否  NaN  NaN  NaN  NaN  NaN  NaN
                   0                  phone_no_tm                模糊手机号          类别型         原始                                                                                                    不参与自动衍生                     删除        否  NaN  NaN  NaN  NaN  NaN  NaN
                   0                      user_id                  手机号ID          类别型         原始                                                                                                                                                   否  NaN  NaN  NaN  NaN  NaN  NaN
                   0                    dinner_id              主套餐策划ID          类别型         原始                                                                                                不参与当月自动衍生                                 否  NaN  NaN  NaN  NaN  NaN  NaN
                   0                   account_id                  帐户编号          类别型         原始                                                                                                不参与当月自动衍生           是                    否  NaN  NaN  NaN  NaN  NaN  NaN
                   0                   innet_date                  入网日期          日期型         原始                                                                                                                                       删除        否  NaN  NaN  NaN  NaN  NaN  NaN
                   0                 innet_months                  入网时长          数值型         原始                                                                                               不参与近n月自动衍生                                     NaN  NaN  NaN  NaN  NaN  NaN
                   0                          age                      年龄          数值型         原始                                                                                                                                                       NaN  NaN  NaN  NaN  NaN  NaN
                   0                          sex                      性别          类别型         原始                                                                                                                                                   否  NaN  NaN  NaN  NaN  NaN  NaN
                   0                  user_status                  用户状态          类别型         原始                                                                                                                             是                        NaN  NaN  NaN  NaN  NaN  NaN
                   0               last_stop_date              最后停机时间          日期型         原始                                                                                                                                       删除        否  NaN  NaN  NaN  NaN  NaN  NaN
                   0  monthsaready_last_stop_date  最后停机时间：已发生时长          数值型  手动衍生_py                                                                current_date - last_stop_date                                                          NaN  NaN  NaN  NaN  NaN  NaN
                   0  monthsremain_last_stop_date    最后停机时间：剩余时长          数值型  手动衍生_py                                                                last_stop_date - current_date                                                          NaN  NaN  NaN  NaN  NaN  NaN
                   0                       dinner                    主套餐          类别型         原始                                                                                                                                                       NaN  NaN  NaN  NaN  NaN  NaN
                   0                   dinner_fee                套餐月租费          数值型         原始                                                                                                                                                       NaN  NaN  NaN  NaN  NaN  NaN
                   0              gprs_last_defer              流量滚存资源          数值型         原始                                                                                                不参与当月自动衍生                                     NaN  NaN  NaN  NaN  NaN  NaN
                   0                gprs_resource          GPRS国内资源总量          数值型         原始                                                                                                                                                       NaN  NaN  NaN  NaN  NaN  NaN
                   0                gprs_now_rest          当月GPRS资源余量          数值型         原始                                                                                                                                                       NaN  NaN  NaN  NaN  NaN  NaN
                   0                     call_use            语音资源使用量          数值型         原始                                                                                                                                                       NaN  NaN  NaN  NaN  NaN  NaN
                   0                   if_nolimit    是否不限量套餐到达用户          类别型         原始                                                                                                                                                       NaN  NaN  NaN  NaN  NaN  NaN
                   0                 if_5g_dinner                是否5G套餐          类别型         原始                                                                                                                                                       NaN  NaN  NaN  NaN  NaN  NaN
                   0                   if_5g_term            是否5G终端客户          类别型         原始                                                                                                                                                       NaN  NaN  NaN  NaN  NaN  NaN
                   0                        if_jt              是否集团成员          类别型         原始                                                                                                                                                       NaN  NaN  NaN  NaN  NaN  NaN
                   0                  start_level              客户星级标识          类别型         原始                                                                                                                                                       NaN  NaN  NaN  NaN  NaN  NaN
                   0                    cred_type              机主证件类型          类别型         原始                      不可用                                                                                                                           NaN  NaN  NaN  NaN  NaN  NaN
                   0                if_cred_multi               一证N号标识          类别型         原始                                                                                                                                                       NaN  NaN  NaN  NaN  NaN  NaN
                   0                         arpu                  当月ARPU          数值型         原始                                                                                                                                                       NaN  NaN  NaN  NaN  NaN  NaN
                   0                      pay_cnt                自充值次数          数值型         原始                                                                                                                                                       NaN  NaN  NaN  NaN  NaN  NaN
                   0                      pay_fee                自充值额度          数值型         原始                                                                                                                                                       NaN  NaN  NaN  NaN  NaN  NaN
                   0                 acct_balance                  账户余额          数值型         原始                                                                                                                                                       NaN  NaN  NaN  NaN  NaN  NaN
                   0                   term_model              终端品牌类型          类别型         原始                                                                                                                                                       NaN  NaN  NaN  NaN  NaN  NaN
                   0                   term_brand                  终端品牌          类别型         原始                                                                                                                                                       NaN  NaN  NaN  NaN  NaN  NaN
                   0                    term_type                  终端类型          类别型         原始                                                                                                                                                       NaN  NaN  NaN  NaN  NaN  NaN
                   0                      sk_type                  双卡类型          类别型         原始                                                                                                    不参与自动衍生                                     NaN  NaN  NaN  NaN  NaN  NaN
                   0                  if_new_term              是否新机用户          类别型         原始                                                                                                                                                       NaN  NaN  NaN  NaN  NaN  NaN
                   0                  calling_cnt              主叫通话次数          数值型         原始                                                                                                                                                       NaN  NaN  NaN  NaN  NaN  NaN
                   0                 calling_dura          当月主叫通话时长          数值型         原始                                                                                                                                                       NaN  NaN  NaN  NaN  NaN  NaN
                   0                   called_cnt              被叫通话次数          数值型         原始                                                                                                                                                       NaN  NaN  NaN  NaN  NaN  NaN
                   0                  called_dura          当月被叫通话时长          数值型         原始                      不可用                                                                                                                           NaN  NaN  NaN  NaN  NaN  NaN
                   0             calling_diff_cnt          主叫异网通话次数          数值型         原始                                                                                                                                                       NaN  NaN  NaN  NaN  NaN  NaN
                   0            calling_diff_dura        主叫异网通话分钟数          数值型         原始                                                                                                                                                       NaN  NaN  NaN  NaN  NaN  NaN
                   0                    gprs_flow                GPRS总流量          数值型         原始                                                                                                                                                       NaN  NaN  NaN  NaN  NaN  NaN
                   0               gprs_flow_tnet             GPRS-T网-流量          数值型         原始     不可用                                                                                                                                            NaN  NaN  NaN  NaN  NaN  NaN
                   0                 gprs_flow_4g                GPRS4G流量          数值型         原始                                                                                                                                                       NaN  NaN  NaN  NaN  NaN  NaN
                   0                 gprs_flow_5g               GPRS 5G流量          数值型         原始                                                                                                                                                       NaN  NaN  NaN  NaN  NaN  NaN
                   0               gprs_flow_busy            GPRS-忙时-流量          数值型         原始                                                                                                                                                       NaN  NaN  NaN  NaN  NaN  NaN
                   0               gprs_flow_idle            GPRS-闲时-流量          数值型         原始                                                                                                                                                       NaN  NaN  NaN  NaN  NaN  NaN
                   0               gprs_now_defer        可延递流量资源总量          数值型         原始                                                                                                                                                       NaN  NaN  NaN  NaN  NaN  NaN
                   0               gprs_flow_roam        GPRS-国内漫游-流量          数值型         原始                                                                                                                                                       NaN  NaN  NaN  NaN  NaN  NaN
                   0               call_dura_roam             省际漫游-时长          数值型         原始                                                                                                                                                       NaN  NaN  NaN  NaN  NaN  NaN
                   0                    days_roam              国内漫出天数          数值型         原始                      不可用                                                                        不参与自动衍生                     删除            NaN  NaN  NaN  NaN  NaN  NaN
                   0                  days_roam_p     国内漫出天数/当月天数          数值型  手动衍生_py                                                                       days_roam / days_month                                                          NaN  NaN  NaN  NaN  NaN  NaN
                   0                gprs_flow_gat      GPRS-港澳台漫游-流量          数值型         原始                                                                                                                                                       NaN  NaN  NaN  NaN  NaN  NaN
                   0                     days_gat           港澳台漫游-时长          数值型         原始                                                                                                                                                       NaN  NaN  NaN  NaN  NaN  NaN
                   0                 days_outside          当月境外漫游天数          数值型         原始     不可用                                                                                         不参与自动衍生                     删除            NaN  NaN  NaN  NaN  NaN  NaN
                   0               days_outside_p      当月境外漫游天数占比          数值型  手动衍生_py                                                                   days_outside / days_month                                                           NaN  NaN  NaN  NaN  NaN  NaN
                   0                    days_gprs                  上网天数          数值型         原始                                                                                                    不参与自动衍生                     删除            NaN  NaN  NaN  NaN  NaN  NaN
                   0                  days_gprs_p              上网天数占比          数值型  手动衍生_py                                                                       days_gprs / days_month                                                          NaN  NaN  NaN  NaN  NaN  NaN
                   0                    days_call                  通话天数          数值型         原始                                                                                                    不参与自动衍生                     删除            NaN  NaN  NaN  NaN  NaN  NaN
                   0                  days_call_p              通话天数占比          数值型  手动衍生_py                                                                       days_call / days_month                                                          NaN  NaN  NaN  NaN  NaN  NaN
                   0                days_call_p_1            通话天数占比_1          数值型  手动衍生_py                                                                      days_call_p + days_gprs                                                          NaN  NaN  NaN  NaN  NaN  NaN
                   0                days_call_p_2            通话天数占比_2          数值型  手动衍生_py                                                                    days_call_p_1 + days_gprs                                                          NaN  NaN  NaN  NaN  NaN  NaN
                   0                days_call_p_3            通话天数占比_3          数值型  手动衍生_py                                                                    days_call_p_2 + days_gprs                                                          NaN  NaN  NaN  NaN  NaN  NaN
                   0                days_call_p_4            通话天数占比_4          数值型  手动衍生_py                                                                    days_call_p_3 + days_gprs                                是                        NaN  NaN  NaN  NaN  NaN  NaN
                   0                     nos_call    用户通信对端手机号码数          数值型         原始                                                                                                                                                       NaN  NaN  NaN  NaN  NaN  NaN
                   0                  nos_calling      主叫通话对端号码个数          数值型         原始                                                                                                                                                       NaN  NaN  NaN  NaN  NaN  NaN
                   0             nos_calling_diff      主叫异网对端号码个数          数值型         原始                                                                                                                                                       NaN  NaN  NaN  NaN  NaN  NaN
                   0                      sms_cnt      短信-点对点短信-条数          数值型         原始                                                                                                                                                       NaN  NaN  NaN  NaN  NaN  NaN
                   0               call_fee_local                本地通话费          数值型         原始                                                                                                                                                       NaN  NaN  NaN  NaN  NaN  NaN
                   0                call_fee_roam                漫游通话费          数值型         原始                                                                                                                                                       NaN  NaN  NaN  NaN  NaN  NaN
                   0                  gprs_income              流量出账收入          数值型         原始                                                                                                                                                       NaN  NaN  NaN  NaN  NaN  NaN
                   0                     gprs_fee           流量出账-流量费          数值型         原始                                                                                                                                                       NaN  NaN  NaN  NaN  NaN  NaN
                   0                     call_fee              套餐外语音费          数值型         原始                                                                                                                                                       NaN  NaN  NaN  NaN  NaN  NaN
                   0              gprs_flow_video            视频类应用流量          数值型         原始                                                                                                                                                       NaN  NaN  NaN  NaN  NaN  NaN
                   0              gprs_flow_short           小视频系APP流量          数值型         原始                                                                                                                             是                        NaN  NaN  NaN  NaN  NaN  NaN
                   0              gprs_flow_music            音乐类应用流量          数值型         原始                                                                                                                             是                        NaN  NaN  NaN  NaN  NaN  NaN
                   0              gprs_flow_commu            通信类应用流量          数值型         原始                                                                                                                             是                        NaN  NaN  NaN  NaN  NaN  NaN
                   0               gprs_flow_game            游戏类应用流量          数值型         原始                                                                                                                             是                        NaN  NaN  NaN  NaN  NaN  NaN
                   0            greatest_gprs_app                   app偏好          类别型  手动衍生_py                                             {'gprs_flow_video': 'video', 'gprs_flow_short...                                是                        NaN  NaN  NaN  NaN  NaN  NaN
                   0    paste_dinner_innet_months    主套餐、入网时长：交叉          类别型  手动衍生_py                                                                       (dinner, innet_months)                                                          NaN  NaN  NaN  NaN  NaN  NaN
                   0                          aaa                       aaa          数值型         原始     不可用                                                                                                                                            NaN  NaN  NaN  NaN  NaN  NaN
                   0                          bbb                       bbb          类别型         原始     不可用                                                                                                                                            NaN  NaN  NaN  NaN  NaN  NaN
                   0                          ccc                       ccc          日期型         原始     不可用                                                                                                                                                                        
                   Out[190]: 20220322-17:24:59  
                   0      0
                   1      0
                   2      0
                   3      0
                   4      0
                   5      0
                   6      0
                   7      0
                   8      0
                   9      0
                   10     0
                   11     0
                   12    84
                   13    84
                   14    84
                   15    84
                   16    84
                   17    84
                   dtype: int64
                   Out[191]: 20220322-17:25:10  
                   0     False
                   1     False
                   2     False
                   3     False
                   4     False
                   5     False
                   6     False
                   7     False
                   8     False
                   9     False
                   10    False
                   11    False
                   12    False
                   13    False
                   14    False
                   15    False
                   16    False
                   17    False
                   dtype: bool
                   Out[192]: 20220322-17:25:20  85
                   Out[193]: 20220322-17:25:44  
                                 0           1               2          3          4                5             6        7               8            9           10        11   12   13   14   15   16   17
                   0     field_name     comment  dtype_classify  field_src  available  available_notzd  available_zd  formula          remark  must_remain  into_model  is_cause  NaN  NaN  NaN  NaN  NaN  NaN
                   0     acct_month        账期          类别型       原始                                                                                                    否  NaN  NaN  NaN  NaN  NaN  NaN
                   0  phone_no_null    手机号码          类别型       原始                                                     不参与自动衍生                     删除        否  NaN  NaN  NaN  NaN  NaN  NaN
                   0    phone_no_tm  模糊手机号          类别型       原始                                                     不参与自动衍生                     删除        否  NaN  NaN  NaN  NaN  NaN  NaN
                   0        user_id    手机号ID          类别型       原始                                                                                                    否  NaN  NaN  NaN  NaN  NaN  NaN
                   Out[194]: 20220322-17:26:09  
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0       
                   Name: 16, dtype: object
                   Out[195]: 20220322-17:26:30  
                   0     True
                   0     True
                   0     True
                   0     True
                   0     True
                   0     True
                   0     True
                   0     True
                   0     True
                   0     True
                   0     True
                   0     True
                   0     True
                   0     True
                   0     True
                   0     True
                   0     True
                   0     True
                   0     True
                   0     True
                   0     True
                   0     True
                   0     True
                   0     True
                   0     True
                   0     True
                   0     True
                   0     True
                   0     True
                   0     True
                   0     True
                   0     True
                   0     True
                   0     True
                   0     True
                   0     True
                   0     True
                   0     True
                   0     True
                   0     True
                   0     True
                   0     True
                   0     True
                   0     True
                   0     True
                   0     True
                   0     True
                   0     True
                   0     True
                   0     True
                   0     True
                   0     True
                   0     True
                   0     True
                   0     True
                   0     True
                   0     True
                   0     True
                   0     True
                   0     True
                   0     True
                   0     True
                   0     True
                   0     True
                   0     True
                   0     True
                   0     True
                   0     True
                   0     True
                   0     True
                   0     True
                   0     True
                   0     True
                   0     True
                   0     True
                   0     True
                   0     True
                   0     True
                   0     True
                   0     True
                   0     True
                   0     True
                   0     True
                   0     True
                   0    False
                   Name: 16, dtype: bool
                   Out[196]: 20220322-17:26:37  
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0    NaN
                   0       
                   Name: 16, dtype: object
                   Out[198]: 20220322-17:27:30  Index(['field_name', 'comment', 'dtype_classify', 'field_src', 'available', 'available_notzd', 'available_zd', 'formula', 'remark', 'must_remain', 'into_model', 'is_cause', nan, nan, nan, nan, nan, nan], dtype='object')
                   Out[199]: 20220322-17:27:40  
                   array([ True,  True,  True,  True,  True,  True,  True,  True,  True,
                           True,  True,  True, False, False, False, False, False, False])


Traceback (most recent call last):
  File "C:\Users\higher\Anaconda3\lib\site-packages\IPython\core\interactiveshell.py", line 2961, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-200-84df25107b32>", line 1, in <module>
    table[table.columns.notnull()]
  File "C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\frame.py", line 2682, in __getitem__
    return self._getitem_array(key)
  File "C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\frame.py", line 2719, in _getitem_array
    (len(key), len(self.index)))
ValueError: Item wrong length 18 instead of 84.
                   Out[201]: 20220322-17:28:15  
                         field_name       comment dtype_classify field_src available available_notzd available_zd formula              remark must_remain into_model is_cause
                   0     acct_month          账期         类别型      原始                                                                                                 否
                   1  phone_no_null      手机号码         类别型      原始                                                     不参与自动衍生                   删除       否
                   2    phone_no_tm    模糊手机号         类别型      原始                                                     不参与自动衍生                   删除       否
                   3        user_id      手机号ID         类别型      原始                                                                                                 否
                   4      dinner_id  主套餐策划ID         类别型      原始                                                 不参与当月自动衍生                              否
20220322-17:29:00  field_base: 84行
20220322-17:29:01  删除5个available“不可用”字段：['gprs_flow_tnet', 'days_outside', 'aaa', 'bbb', 'ccc']
20220322-17:29:01  field_base: 79行

20220322-17:29:02  删除1个基于“不可用”字段加工的手动衍生_py字段：
                           field_name                    formula
                   56  days_outside_p  days_outside / days_month
20220322-17:29:03  field_base: 78行


C:\Program Files\JetBrains\PyCharm 2020.3.3\plugins\python\helpers\pydev\pydevconsole.py:59: UserWarning: 确定下列时长类字段的renmark是否限制 ‘不参与近n月自动衍生’：
                     field_name                   comment remark
12  monthsaready_last_stop_date  最后停机时间：已发生时长    NaN
13  monthsremain_last_stop_date    最后停机时间：剩余时长    NaN
  #=======================================================================================================================
                   Out[205]: 20220322-17:29:13  
                                        field_name                   comment dtype_classify    field_src available available_notzd  available_zd                                            formula               remark must_remain into_model is_cause
                   0                    acct_month                      账期         类别型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN       否
                   1                 phone_no_null                  手机号码         类别型         原始       NaN             NaN           NaN                                                NaN       不参与自动衍生         NaN       删除       否
                   2                   phone_no_tm                模糊手机号         类别型         原始       NaN             NaN           NaN                                                NaN       不参与自动衍生         NaN       删除       否
                   3                       user_id                  手机号id         类别型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN       否
                   4                     dinner_id              主套餐策划id         类别型         原始       NaN             NaN           NaN                                                NaN   不参与当月自动衍生         NaN        NaN       否
                   5                    account_id                  帐户编号         类别型         原始       NaN             NaN           NaN                                                NaN   不参与当月自动衍生          是        NaN       否
                   6                    innet_date                  入网日期         日期型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN       删除       否
                   7                  innet_months                  入网时长         数值型         原始       NaN             NaN           NaN                                                NaN  不参与近n月自动衍生         NaN        NaN      NaN
                   8                           age                      年龄         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN
                   9                           sex                      性别         类别型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN       否
                   10                  user_status                  用户状态         类别型         原始       NaN             NaN           NaN                                                NaN                  NaN          是        NaN      NaN
                   11               last_stop_date              最后停机时间         日期型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN       删除       否
                   12  monthsaready_last_stop_date  最后停机时间：已发生时长         数值型  手动衍生_py       NaN             NaN           NaN                      current_date - last_stop_date                  NaN         NaN        NaN      NaN
                   13  monthsremain_last_stop_date    最后停机时间：剩余时长         数值型  手动衍生_py       NaN             NaN           NaN                      last_stop_date - current_date                  NaN         NaN        NaN      NaN
                   14                       dinner                    主套餐         类别型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN
                   15                   dinner_fee                套餐月租费         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN
                   16              gprs_last_defer              流量滚存资源         数值型         原始       NaN             NaN           NaN                                                NaN   不参与当月自动衍生         NaN        NaN      NaN
                   17                gprs_resource          gprs国内资源总量         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN
                   18                gprs_now_rest          当月gprs资源余量         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN
                   19                     call_use            语音资源使用量         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN
                   20                   if_nolimit    是否不限量套餐到达用户         类别型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN
                   21                 if_5g_dinner                是否5g套餐         类别型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN
                   22                   if_5g_term            是否5g终端客户         类别型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN
                   23                        if_jt              是否集团成员         类别型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN
                   24                  start_level              客户星级标识         类别型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN
                   25                    cred_type              机主证件类型         类别型         原始       NaN          不可用           NaN                                                NaN                  NaN         NaN        NaN      NaN
                   26                if_cred_multi               一证n号标识         类别型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN
                   27                         arpu                  当月arpu         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN
                   28                      pay_cnt                自充值次数         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN
                   29                      pay_fee                自充值额度         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN
                   30                 acct_balance                  账户余额         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN
                   31                   term_model              终端品牌类型         类别型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN
                   32                   term_brand                  终端品牌         类别型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN
                   33                    term_type                  终端类型         类别型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN
                   34                      sk_type                  双卡类型         类别型         原始       NaN             NaN           NaN                                                NaN       不参与自动衍生         NaN        NaN      NaN
                   35                  if_new_term              是否新机用户         类别型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN
                   36                  calling_cnt              主叫通话次数         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN
                   37                 calling_dura          当月主叫通话时长         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN
                   38                   called_cnt              被叫通话次数         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN
                   39                  called_dura          当月被叫通话时长         数值型         原始       NaN          不可用           NaN                                                NaN                  NaN         NaN        NaN      NaN
                   40             calling_diff_cnt          主叫异网通话次数         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN
                   41            calling_diff_dura        主叫异网通话分钟数         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN
                   42                    gprs_flow                gprs总流量         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN
                   44                 gprs_flow_4g                gprs4g流量         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN
                   45                 gprs_flow_5g               gprs 5g流量         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN
                   46               gprs_flow_busy            gprs-忙时-流量         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN
                   47               gprs_flow_idle            gprs-闲时-流量         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN
                   48               gprs_now_defer        可延递流量资源总量         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN
                   49               gprs_flow_roam        gprs-国内漫游-流量         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN
                   50               call_dura_roam             省际漫游-时长         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN
                   51                    days_roam              国内漫出天数         数值型         原始       NaN          不可用           NaN                                                NaN       不参与自动衍生         NaN       删除      NaN
                   52                  days_roam_p     国内漫出天数/当月天数         数值型  手动衍生_py       NaN             NaN           NaN                             days_roam / days_month                  NaN         NaN        NaN      NaN
                   53                gprs_flow_gat      gprs-港澳台漫游-流量         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN
                   54                     days_gat           港澳台漫游-时长         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN
                   57                    days_gprs                  上网天数         数值型         原始       NaN             NaN           NaN                                                NaN       不参与自动衍生         NaN       删除      NaN
                   58                  days_gprs_p              上网天数占比         数值型  手动衍生_py       NaN             NaN           NaN                             days_gprs / days_month                  NaN         NaN        NaN      NaN
                   59                    days_call                  通话天数         数值型         原始       NaN             NaN           NaN                                                NaN       不参与自动衍生         NaN       删除      NaN
                   60                  days_call_p              通话天数占比         数值型  手动衍生_py       NaN             NaN           NaN                             days_call / days_month                  NaN         NaN        NaN      NaN
                   61                days_call_p_1            通话天数占比_1         数值型  手动衍生_py       NaN             NaN           NaN                            days_call_p + days_gprs                  NaN         NaN        NaN      NaN
                   62                days_call_p_2            通话天数占比_2         数值型  手动衍生_py       NaN             NaN           NaN                          days_call_p_1 + days_gprs                  NaN         NaN        NaN      NaN
                   63                days_call_p_3            通话天数占比_3         数值型  手动衍生_py       NaN             NaN           NaN                          days_call_p_2 + days_gprs                  NaN         NaN        NaN      NaN
                   64                days_call_p_4            通话天数占比_4         数值型  手动衍生_py       NaN             NaN           NaN                          days_call_p_3 + days_gprs                  NaN          是        NaN      NaN
                   65                     nos_call    用户通信对端手机号码数         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN
                   66                  nos_calling      主叫通话对端号码个数         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN
                   67             nos_calling_diff      主叫异网对端号码个数         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN
                   68                      sms_cnt      短信-点对点短信-条数         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN
                   69               call_fee_local                本地通话费         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN
                   70                call_fee_roam                漫游通话费         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN
                   71                  gprs_income              流量出账收入         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN
                   72                     gprs_fee           流量出账-流量费         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN
                   73                     call_fee              套餐外语音费         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN
                   74              gprs_flow_video            视频类应用流量         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN
                   75              gprs_flow_short           小视频系app流量         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN          是        NaN      NaN
                   76              gprs_flow_music            音乐类应用流量         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN          是        NaN      NaN
                   77              gprs_flow_commu            通信类应用流量         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN          是        NaN      NaN
                   78               gprs_flow_game            游戏类应用流量         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN          是        NaN      NaN
                   79            greatest_gprs_app                   app偏好         类别型  手动衍生_py       NaN             NaN           NaN  {'gprs_flow_video': 'video', 'gprs_flow_short'...                  NaN          是        NaN      NaN
                   80    paste_dinner_innet_months    主套餐、入网时长：交叉         类别型  手动衍生_py       NaN             NaN           NaN                             (dinner, innet_months)                  NaN         NaN        NaN      NaN

                   ###################################################################### 探索模型宽表
                    
20220322-17:29:56  开始时间：2022-03-22 17:29:56
20220322-17:29:56  参数设置：
                       step: train
                       table_in: ml.mid_eg_recent_train_202011
                       Info.model_name: 模型示例
                       Info.iv_limit: 0.05
                       stage: explore
                       Info.auto_pair2: False
                       Info.r_limit: 0.95

20220322-17:29:56  field_base: 78行

20220322-17:29:56  删除3个available_notzd“不可用”字段：['cred_type', 'called_dura', 'days_roam']
20220322-17:29:56  field_base: 75行

20220322-17:29:56  删除1个基于“不可用”字段加工的手动衍生_py字段：
                        field_name                 formula
                   52  days_roam_p  days_roam / days_month
20220322-17:29:56  field_base: 74行
20220322-17:29:56  ------------------------- 读取数据: ml.mid_eg_recent_train_202011 2022-03-22 17:29:56 -------------------------
20220322-17:29:56      src: gp
20220322-17:29:56      condition: data_use='data_train'
20220322-17:29:56      col_need(67): ['user_acct_month', 'data_use', 'acct_month', 'user_id', 'innet_months', 'age', 'dinner_fee', 'gprs_last_defer', 'gprs_resource', 'gprs_now_rest', 'call_use', 'arpu', 'pay_cnt', 'pay_fee', 'acct_balance', 'calling_cnt', 'calling_dura', 'called_cnt', 'calling_diff_cnt', 'calling_diff_dura', 'gprs_flow', 'gprs_flow_4g', 'gprs_flow_5g', 'gprs_flow_busy', 'gprs_flow_idle', 'gprs_now_defer', 'gprs_flow_roam', 'call_dura_roam', 'gprs_flow_gat', 'days_gat', 'days_gprs', 'days_call', 'nos_call', 'nos_calling', 'nos_calling_diff', 'sms_cnt', 'call_fee_local', 'call_fee_roam', 'gprs_income', 'gprs_fee', 'call_fee', 'gprs_flow_video', 'gprs_flow_short', 'gprs_flow_music', 'gprs_flow_commu', 'gprs_flow_game', 'innet_date', 'last_stop_date', 'phone_no_null', 'phone_no_tm', 'dinner_id', 'account_id', 'sex', 'user_status', 'dinner', 'if_nolimit', 'if_5g_dinner', 'if_5g_term', 'if_jt', 'start_level', 'if_cred_multi', 'term_model', 'term_brand', 'term_type', 'sk_type', 'if_new_term', 'flag_eg']
20220322-17:29:56      col_del: None
20220322-17:29:56      col_char(21): ['acct_month', 'phone_no_null', 'phone_no_tm', 'user_id', 'dinner_id', 'account_id', 'sex', 'user_status', 'dinner', 'if_nolimit', 'if_5g_dinner', 'if_5g_term', 'if_jt', 'start_level', 'if_cred_multi', 'term_model', 'term_brand', 'term_type', 'sk_type', 'if_new_term', 'flag_eg']
20220322-17:29:56      col_num(42): ['innet_months', 'age', 'dinner_fee', 'gprs_last_defer', 'gprs_resource', 'gprs_now_rest', 'call_use', 'arpu', 'pay_cnt', 'pay_fee', 'acct_balance', 'calling_cnt', 'calling_dura', 'called_cnt', 'calling_diff_cnt', 'calling_diff_dura', 'gprs_flow', 'gprs_flow_4g', 'gprs_flow_5g', 'gprs_flow_busy', 'gprs_flow_idle', 'gprs_now_defer', 'gprs_flow_roam', 'call_dura_roam', 'gprs_flow_gat', 'days_gat', 'days_gprs', 'days_call', 'nos_call', 'nos_calling', 'nos_calling_diff', 'sms_cnt', 'call_fee_local', 'call_fee_roam', 'gprs_income', 'gprs_fee', 'call_fee', 'gprs_flow_video', 'gprs_flow_short', 'gprs_flow_music', 'gprs_flow_commu', 'gprs_flow_game']
20220322-17:29:56      col_date(2): ['innet_date', 'last_stop_date']
20220322-17:29:56      nrows: None
20220322-17:29:56      if_coltolower: True
20220322-17:29:56      kwargs: {}

20220322-17:29:56      读取
20220322-17:29:57      shape: (9780, 67)

20220322-17:29:57  -------------------------读取完毕: (9780, 67) 2022-03-22 17:29:57 -------------------------

20220322-17:29:57  手动衍生_py10个字段: {'monthsaready_last_stop_date': '最后停机时间：已发生时长', 'monthsremain_last_stop_date': '最后停机时间：剩余时长', 'days_gprs_p': '上网天数占比', 'days_call_p': '通话天数占比', 'days_call_p_1': '通话天数占比_1', 'days_call_p_2': '通话天数占比_2', 'days_call_p_3': '通话天数占比_3', 'days_call_p_4': '通话天数占比_4', 'greatest_gprs_app': 'app偏好', 'paste_dinner_innet_months': '主套餐、入网时长：交叉'}
20220322-17:29:57  monthsaready_last_stop_date: current_date - last_stop_date
20220322-17:29:57      将 monthsaready_last_stop_date 字段的 4 个缺失值赋值为: -99999 （非缺失的最小值-2.0）
20220322-17:29:57  monthsremain_last_stop_date: last_stop_date - current_date
20220322-17:29:57      将 monthsremain_last_stop_date 字段的 4 个缺失值赋值为: -99999 （非缺失的最小值-101.0）
20220322-17:29:57  days_gprs_p: days_gprs / days_month
20220322-17:29:57  days_call_p: days_call / days_month
20220322-17:29:57  days_call_p_1: days_call_p + days_gprs
20220322-17:29:57  days_call_p_2: days_call_p_1 + days_gprs
20220322-17:29:57  days_call_p_3: days_call_p_2 + days_gprs
20220322-17:29:57  days_call_p_4: days_call_p_3 + days_gprs
20220322-17:29:57  greatest_gprs_app: {'gprs_flow_video': 'video', 'gprs_flow_short': 'short', 'gprs_flow_music': 'music', 'gprs_flow_commu': 'commu', 'gprs_flow_game': 'game'}
20220322-17:29:59  paste_dinner_innet_months: (dinner, innet_months)
20220322-17:29:59  数据量: (9780, 77)

20220322-17:29:59  检查数据
20220322-17:29:59  各账期数据量分布：
                       202009  data_train    3255
                       202010  data_train    3255
                       202011  data_train    3270
                       dtype: int64
20220322-17:29:59  各账期数据量不一致
20220322-17:29:59  以nan填充缺少账期的记录
20220322-17:30:00      修改后：
                       202009  data_train    3270
                       202010  data_train    3270
                       202011  data_train    3270
                       dtype: int64)
20220322-17:30:00  
                   diff_limitweiNone,不考察近n月字段各账期取值分布, dis_exam返回None！

20220322-17:30:00  字段类型分布: 
                       float64    50
                       object    25
                       datetime64[ns]    2
                       dtype: int64


20220322-17:30:00  填充数值型&类别型字段缺失值
20220322-17:30:00  日期型字段缺失值情况：
                       innet_date    30
                       last_stop_date    34
                       dtype: int64

20220322-17:30:00  正负例分布：
                       data_train  202011  0    2180
                       data_train  202011  1    1090
                       dtype: int64

                   ----------------------------------------- 当月 数值型&类别型 原始数据 
20220322-17:30:00  新数据newdata的shape：(3270, 71)
20220322-17:30:00  数据转换
20220322-17:30:08  转换后shape：(3270, 30)
20220322-17:30:08  从流水线中获取WoeTransformer_DF
20220322-17:30:08  首个数据集，直接返回woe编码结果
20220322-17:30:08  筛选衍生字段的 原始/手动衍生_sql 字段
20220322-17:30:08  数值型字段：有效字段25个，其中当月自动衍生字段24个，近n月自动衍生字段24个
20220322-17:30:08  类别型字段：有效字段5个（强制加入0个）:
20220322-17:30:08      当月自动衍生_py字段4个: ['if_nolimit~是', 'if_5g_dinner~是', 'greatest_gprs_app~commu', 'greatest_gprs_app~video']
20220322-17:30:08      近n月自动衍生_py字段5个: ['account_id~其他_countlow', 'if_nolimit~是', 'if_5g_dinner~是', 'greatest_gprs_app~commu', 'greatest_gprs_app~video']

                   ----------------------------------------- 近n月 数值型 近3月均值 
20220322-17:30:08  字段个数：24, 添加字段：['flag_eg']
20220322-17:30:08  新数据newdata的shape：(3270, 25)
20220322-17:30:08  数据转换
20220322-17:30:12  转换后shape：(3270, 23)
20220322-17:30:12  从流水线中获取WoeTransformer_DF
20220322-17:30:14  待新增字段与原宽表字段 相关性系数大于Info.r_limit（0.95）的字段对有2对
20220322-17:30:14      从中二者中剔除字段2个字段:['avg__dinner_fee', 'monthsremain_last_stop_date']
20220322-17:30:14      其中待新增中剔除1个
20220322-17:30:14      其中原宽表中剔除1个

20220322-17:30:14  已有宽表shape：(3270, 30)
20220322-17:30:14  向宽表中加入字段（22个）：['avg__calling_cnt', 'avg__calling_dura', 'avg__call_use', 'avg__gprs_flow_video', 'avg__gprs_now_rest', 'avg__gprs_flow_game', 'avg__gprs_flow_roam', 'avg__gprs_resource', 'avg__calling_diff_cnt', 'avg__monthsremain_last_stop_date', 'avg__gprs_flow_music', 'avg__nos_calling_diff', 'avg__arpu', 'avg__calling_diff_dura', 'avg__call_dura_roam', 'avg__gprs_last_defer', 'avg__gprs_flow_5g', 'avg__gprs_now_defer', 'avg__gprs_flow_busy', 'avg__gprs_flow_commu', 'avg__nos_calling', 'avg__gprs_flow_short']
20220322-17:30:14  从宽表中删除字段（1个）：['monthsremain_last_stop_date']
20220322-17:30:14  目前宽表shape：(3270, 51)

                   ----------------------------------------- 近n月 数值型 近3月离散系数 
20220322-17:30:14  字段个数：24, 添加字段：['flag_eg']
20220322-17:30:14  新数据newdata的shape：(3270, 25)
20220322-17:30:14  数据转换
20220322-17:30:17  转换后shape：(3270, 11)
20220322-17:30:17  从流水线中获取WoeTransformer_DF
20220322-17:30:17  待新增字段与原宽表字段 相关性系数大于Info.r_limit（0.95）的字段对有1对
20220322-17:30:17      从中二者中剔除字段1个字段:['sep__gprs_flow_game']
20220322-17:30:17      其中待新增中剔除1个
20220322-17:30:17      其中原宽表中剔除0个

20220322-17:30:17  已有宽表shape：(3270, 51)
20220322-17:30:17  向宽表中加入字段（10个）：['sep__gprs_last_defer', 'sep__gprs_flow_5g', 'sep__calling_diff_dura', 'sep__gprs_flow_short', 'sep__gprs_flow_video', 'sep__gprs_flow_music', 'sep__gprs_flow_commu', 'sep__gprs_now_rest', 'sep__gprs_resource', 'sep__nos_calling']
20220322-17:30:17  从宽表中删除字段（0个）：[]
20220322-17:30:17  目前宽表shape：(3270, 61)

                   ----------------------------------------- 近n月 数值型 近3月波动性 
20220322-17:30:17  字段个数：24, 添加字段：['flag_eg']
20220322-17:30:18  新数据newdata的shape：(3270, 25)
20220322-17:30:18  数据转换
20220322-17:30:20  转换后shape：(3270, 13)
20220322-17:30:21  从流水线中获取WoeTransformer_DF
20220322-17:30:21  待新增字段与原宽表字段 相关性系数大于Info.r_limit（0.95）的字段对有6对
20220322-17:30:21      从中二者中剔除字段6个字段:['sep__gprs_flow_music', 'sep__gprs_resource', 'sep__gprs_flow_short', 'wave__gprs_flow_video', 'wave__gprs_flow_game', 'wave__gprs_flow_commu']
20220322-17:30:21      其中待新增中剔除3个
20220322-17:30:21      其中原宽表中剔除3个

20220322-17:30:21  已有宽表shape：(3270, 61)
20220322-17:30:21  向宽表中加入字段（10个）：['wave__gprs_flow_music', 'wave__gprs_now_rest', 'wave__gprs_last_defer', 'wave__gprs_resource', 'wave__gprs_flow_short', 'wave__calling_cnt', 'wave__gprs_flow_5g', 'wave__calling_dura', 'wave__call_use', 'wave__gprs_now_defer']
20220322-17:30:21  从宽表中删除字段（3个）：['sep__gprs_flow_music', 'sep__gprs_flow_short', 'sep__gprs_resource']
20220322-17:30:21  目前宽表shape：(3270, 68)

                   ----------------------------------------- 近n月 数值型 近3月成长率 
20220322-17:30:21  字段个数：24, 添加字段：['flag_eg']
20220322-17:30:22  新数据newdata的shape：(3270, 25)
20220322-17:30:22  数据转换
20220322-17:30:25  转换后shape：(3270, 20)
20220322-17:30:25  从流水线中获取WoeTransformer_DF
20220322-17:30:25  待新增字段与原宽表字段 相关性系数大于Info.r_limit（0.95）的字段对有9对
20220322-17:30:25      从中二者中剔除字段9个字段:['grow__gprs_flow_music', 'grow__gprs_flow_game', 'grow__gprs_resource', 'dinner_fee', 'grow__gprs_flow_5g', 'grow__arpu', 'grow__gprs_flow_busy', 'grow__monthsremain_last_stop_date', 'grow__gprs_flow_short']
20220322-17:30:25      其中待新增中剔除8个
20220322-17:30:25      其中原宽表中剔除1个

20220322-17:30:25  已有宽表shape：(3270, 68)
20220322-17:30:25  向宽表中加入字段（12个）：['grow__gprs_last_defer', 'grow__dinner_fee', 'grow__nos_calling', 'grow__call_use', 'grow__calling_diff_dura', 'grow__gprs_flow_commu', 'grow__gprs_now_defer', 'grow__nos_calling_diff', 'grow__calling_cnt', 'grow__gprs_now_rest', 'grow__calling_dura', 'grow__gprs_flow_video']
20220322-17:30:25  从宽表中删除字段（1个）：['dinner_fee']
20220322-17:30:25  目前宽表shape：(3270, 79)

                   ----------------------------------------- 近n月 数值型 近3月最大值 
20220322-17:30:25  字段个数：24, 添加字段：['flag_eg']
20220322-17:30:25  新数据newdata的shape：(3270, 25)
20220322-17:30:25  数据转换
20220322-17:30:29  转换后shape：(3270, 23)
20220322-17:30:29  从流水线中获取WoeTransformer_DF
20220322-17:30:30  待新增字段与原宽表字段 相关性系数大于Info.r_limit（0.95）的字段对有11对
20220322-17:30:30      从中二者中剔除字段10个字段:['max__gprs_flow_music', 'max__gprs_flow_game', 'avg__gprs_flow_5g', 'max__dinner_fee', 'max__gprs_flow_video', 'max__gprs_flow_short', 'max__gprs_now_defer', 'max__gprs_flow_commu', 'max__gprs_resource', 'max__gprs_flow_busy']
20220322-17:30:30      其中待新增中剔除9个
20220322-17:30:30      其中原宽表中剔除1个

20220322-17:30:30  已有宽表shape：(3270, 79)
20220322-17:30:30  向宽表中加入字段（14个）：['max__gprs_last_defer', 'max__calling_diff_dura', 'max__call_dura_roam', 'max__nos_calling', 'max__arpu', 'max__call_use', 'max__calling_diff_cnt', 'max__gprs_flow_5g', 'max__calling_cnt', 'max__nos_calling_diff', 'max__gprs_flow_roam', 'max__monthsremain_last_stop_date', 'max__gprs_now_rest', 'max__calling_dura']
20220322-17:30:30  从宽表中删除字段（1个）：['avg__gprs_flow_5g']
20220322-17:30:30  目前宽表shape：(3270, 92)

                   ----------------------------------------- 近n月 数值型 近3月最小值 
20220322-17:30:30  字段个数：24, 添加字段：['flag_eg']
20220322-17:30:30  新数据newdata的shape：(3270, 25)
20220322-17:30:30  数据转换
20220322-17:30:33  转换后shape：(3270, 22)
20220322-17:30:33  从流水线中获取WoeTransformer_DF
20220322-17:30:34  待新增字段与原宽表字段 相关性系数大于Info.r_limit（0.95）的字段对有3对
20220322-17:30:34      从中二者中剔除字段3个字段:['min__monthsremain_last_stop_date', 'min__gprs_now_defer', 'min__dinner_fee']
20220322-17:30:34      其中待新增中剔除3个
20220322-17:30:34      其中原宽表中剔除0个

20220322-17:30:34  已有宽表shape：(3270, 92)
20220322-17:30:34  向宽表中加入字段（19个）：['min__gprs_flow_short', 'min__call_use', 'min__calling_diff_cnt', 'min__gprs_flow_commu', 'min__nos_calling', 'min__calling_dura', 'min__gprs_flow_music', 'min__calling_diff_dura', 'min__days_call_p_4', 'min__gprs_flow_roam', 'min__gprs_last_defer', 'min__calling_cnt', 'min__gprs_flow_game', 'min__gprs_resource', 'min__gprs_flow_video', 'min__arpu', 'min__gprs_flow_busy', 'min__nos_calling_diff', 'min__gprs_now_rest']
20220322-17:30:34  从宽表中删除字段（0个）：[]
20220322-17:30:34  目前宽表shape：(3270, 111)

                   ----------------------------------------- 近n月 数值型 近3月标准差 
20220322-17:30:34  字段个数：24, 添加字段：['flag_eg']
20220322-17:30:34  新数据newdata的shape：(3270, 25)
20220322-17:30:34  数据转换
20220322-17:30:37  转换后shape：(3270, 20)
20220322-17:30:37  从流水线中获取WoeTransformer_DF
20220322-17:30:38  待新增字段与原宽表字段 相关性系数大于Info.r_limit（0.95）的字段对有5对
20220322-17:30:38      从中二者中剔除字段5个字段:['std__gprs_flow_5g', 'std__gprs_flow_music', 'std__gprs_flow_game', 'std__gprs_flow_roam', 'std__gprs_flow_video']
20220322-17:30:38      其中待新增中剔除5个
20220322-17:30:38      其中原宽表中剔除0个

20220322-17:30:38  已有宽表shape：(3270, 111)
20220322-17:30:38  向宽表中加入字段（15个）：['std__calling_diff_dura', 'std__calling_diff_cnt', 'std__nos_calling', 'std__gprs_last_defer', 'std__calling_cnt', 'std__calling_dura', 'std__call_use', 'std__arpu', 'std__gprs_flow_commu', 'std__gprs_flow_short', 'std__gprs_flow_busy', 'std__gprs_now_rest', 'std__call_dura_roam', 'std__gprs_resource', 'std__nos_calling_diff']
20220322-17:30:38  从宽表中删除字段（0个）：[]
20220322-17:30:38  目前宽表shape：(3270, 126)

                   ----------------------------------------- 近n月 数值型 大于x的月份数 
20220322-17:30:38  ('more0cnt', '近3月大于0的月份数')
20220322-17:30:39  ('moreq25cnt', '近3月大于第一四分位数的月份数')
20220322-17:30:39  新数据newdata的shape：(3270, 49)
20220322-17:30:39  数据转换
20220322-17:30:44  转换后shape：(3270, 17)
20220322-17:30:44  从流水线中获取WoeTransformer_DF
20220322-17:30:49  待新增字段与原宽表字段 相关性系数大于Info.r_limit（0.95）的字段对有4对
20220322-17:30:49      从中二者中剔除字段4个字段:['moreq25cnt__gprs_flow_game', 'moreq25cnt__gprs_flow_music', 'moreq25cnt__gprs_flow_commu', 'wave__gprs_flow_short']
20220322-17:30:49      其中待新增中剔除3个
20220322-17:30:49      其中原宽表中剔除1个

20220322-17:30:49  已有宽表shape：(3270, 126)
20220322-17:30:49  向宽表中加入字段（14个）：['moreq25cnt__gprs_flow_busy', 'moreq25cnt__gprs_now_defer', 'moreq25cnt__calling_dura', 'moreq25cnt__gprs_resource', 'moreq25cnt__arpu', 'moreq25cnt__nos_calling_diff', 'moreq25cnt__nos_calling', 'moreq25cnt__gprs_flow_5g', 'moreq25cnt__calling_cnt', 'moreq25cnt__gprs_flow_short', 'more0cnt__calling_cnt', 'moreq25cnt__gprs_last_defer', 'moreq25cnt__gprs_flow_video', 'moreq25cnt__calling_diff_dura']
20220322-17:30:49  从宽表中删除字段（1个）：['wave__gprs_flow_short']
20220322-17:30:49  目前宽表shape：(3270, 139)

                   ----------------------------------------- 近n月 类别型 取某值的月份数 
20220322-17:30:50  字段个数：5, 添加字段：['flag_eg']
20220322-17:30:50  新数据newdata的shape：(3270, 6)
20220322-17:30:50  数据转换
20220322-17:30:51  转换后shape：(3270, 2)
20220322-17:30:51  从流水线中获取WoeTransformer_DF
20220322-17:30:52  待新增字段与原宽表字段 相关性系数大于Info.r_limit（0.95）的字段对有2对
20220322-17:30:52      从中二者中剔除字段2个字段:['if_nolimit~是', 'if_5g_dinner~是']
20220322-17:30:52      其中待新增中剔除0个
20220322-17:30:52      其中原宽表中剔除2个

20220322-17:30:52  已有宽表shape：(3270, 139)
20220322-17:30:52  向宽表中加入字段（2个）：['valuecnt__if_5g_dinner~是', 'valuecnt__if_nolimit~是']
20220322-17:30:52  从宽表中删除字段（2个）：['if_5g_dinner~是', 'if_nolimit~是']
20220322-17:30:52  目前宽表shape：(3270, 139)

                   ----------------------------------------- 汇总最终宽表 
20220322-17:30:52  计算字段之间的相关性系数
20220322-17:30:52  
                       count    9591.0
                       mean    0.272
                       std    0.18
                       min    0.0
                       25%    0.145
                       50%    0.225
                       75%    0.351
                       max    0.948
                       dtype: float64

20220322-17:30:52  iv分布：
                       count    139.0
                       mean    0.169
                       std    0.142
                       min    0.05
                       25%    0.07
                       50%    0.093
                       75%    0.249
                       max    0.683
                       dtype: float64

20220322-17:30:53  woe_accum(累计)概览：                                            value    0    1       woe    weight  woe_weight  ALL
                       grow__gprs_flow_busy            (0.1589, inf]  199  422  1.444848  0.295872    0.427489  621
                       avg__gprs_flow_commu         (31.166666, inf]  191  384  1.391516  0.264679    0.368305  575
                       moreq25cnt__gprs_flow_commu        (2.5, inf]  193  350  1.288390  0.232569    0.299639  543
                       more0cnt__gprs_flow_commu          (2.5, inf]  193  350  1.288390  0.232569    0.299639  543
                       std__gprs_flow_busy          (1330688.0, inf]  238  430  1.284662  0.285321    0.366541  668

20220322-17:30:53  最终宽表字段列表col_all:
20220322-17:30:53      len(col_all): 139
20220322-17:30:53      补充3个的字段（must_remain=是）：{'greatest_gprs_app', 'user_status', 'account_id'}
20220322-17:30:53      len(col_all): 142
20220322-17:30:53      补充账期、数据集名称、用户标识等，目标字段(Info.col_mark、Info.col_target)
20220322-17:30:53      len(col_all): 147

20220322-17:30:53      补充4个的字段（col_mark、col_target、condition、dict_sortscore、col_out）：{'last_stop_date', 'phone_no_null', 'sms_cnt', 'call_fee_local'}
20220322-17:30:53      len(col_all): 151
20220322-17:30:53  整理宽表数据字典
20220322-17:30:53  宽表数据字典概览 (151, 14):
                        是否宽表字段 available available_notzd  available_zd         comment dtype_classify       field_name     field_src formula into_model is_cause must_remain          remark        base_init
                                  是       NaN             NaN           NaN  观察期最后账期         类别型  user_acct_month  手动衍生_sql     NaN        NaN      NaN         NaN             NaN  user_acct_month
                                  是       NaN             NaN           NaN      数据集名称         类别型         data_use  手动衍生_sql     NaN        NaN      NaN         NaN             NaN         data_use
                                  是       NaN             NaN           NaN            账期         类别型       acct_month          原始     NaN        NaN       否         NaN             NaN       acct_month
                                  是       NaN             NaN           NaN        手机号码         类别型    phone_no_null          原始     NaN       删除       否         NaN  不参与自动衍生    phone_no_null
                                  是       NaN             NaN           NaN        手机号id         类别型          user_id          原始     NaN        NaN       否         NaN             NaN          user_id

20220322-17:30:53  保存Info至：./binaryclassify/eg/traintest~202011~202012/Info~tabexp.pkl
20220322-17:30:53  结束时间：2022-03-22 17:30:53
20220322-17:30:53  耗时：57 s


C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\series.py:3194: UserWarning: Pipeline_DF：verbose参数值被赋予print_indent后默认参数设置为None
  mapped = lib.map_infer(values, f, convert=convert_dtype)


C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\series.py:3194: UserWarning: FeatureUnion_DF：verbose参数值被赋予print_indent后默认参数设置为None
  mapped = lib.map_infer(values, f, convert=convert_dtype)


C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\series.py:3194: UserWarning: opera_pair_fun paste时存在非类别型字段，请确认: ['innet_months']
  mapped = lib.map_infer(values, f, convert=convert_dtype)


C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\series.py:3194: UserWarning: field_base中未包括下列字段，但实际数据 多出：{'user_acct_month', 'data_use'}
  mapped = lib.map_infer(values, f, convert=convert_dtype)


C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\series.py:3194: UserWarning: field_base中未规定下列字段数据类型，请确认默认类型是否正确：{'user_acct_month': 'object', 'data_use': 'object'}
  mapped = lib.map_infer(values, f, convert=convert_dtype)


C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\series.py:3194: UserWarning:     FeaturePrefilter_DF unique_limit(5000)小于X行数(3270), 添加unique_limit_actual：len(X)*0.99=3237
  mapped = lib.map_infer(values, f, convert=convert_dtype)


C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\series.py:3194: UserWarning:     NumStrSpliter 数据中未出现非数值型字段！
  mapped = lib.map_infer(values, f, convert=convert_dtype)


C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\series.py:3194: UserWarning: NumStrSpliter 下列字段未被归类到数值型和类别型字段集合中，请确认：
valuecnt__account_id~其他_countlow    bool
dtype: object
  mapped = lib.map_infer(values, f, convert=convert_dtype)

                   ###################################################################### 训练集加工
                    
20220322-17:41:23  开始时间：2022-03-22 17:41:23
20220322-17:41:23  参数设置：
                       stage: create
                       step: train
                       table_in: ml.mid_eg_recent_train_202011
                       Info.model_name: 模型示例
                       Info.iv_limit: 0.05
                       Info.auto_pair2: False
                       Info.r_limit: 0.95

20220322-17:41:23  ------------------------- 读取数据: ml.mid_eg_recent_train_202011 2022-03-22 17:41:23 -------------------------
20220322-17:41:23      src: gp
20220322-17:41:23      condition: None
20220322-17:41:23      col_need(38): ['user_acct_month', 'data_use', 'acct_month', 'phone_no_null', 'user_id', 'account_id', 'innet_months', 'user_status', 'last_stop_date', 'dinner_fee', 'gprs_last_defer', 'gprs_resource', 'gprs_now_rest', 'call_use', 'if_nolimit', 'if_5g_dinner', 'arpu', 'calling_cnt', 'calling_dura', 'calling_diff_cnt', 'calling_diff_dura', 'gprs_flow_5g', 'gprs_flow_busy', 'gprs_now_defer', 'gprs_flow_roam', 'call_dura_roam', 'days_gprs', 'days_call', 'nos_calling', 'nos_calling_diff', 'sms_cnt', 'call_fee_local', 'gprs_flow_video', 'gprs_flow_short', 'gprs_flow_music', 'gprs_flow_commu', 'gprs_flow_game', 'flag_eg']
20220322-17:41:23      col_del: None
20220322-17:41:23      col_char(10): ['user_acct_month', 'data_use', 'acct_month', 'phone_no_null', 'user_id', 'account_id', 'user_status', 'if_nolimit', 'if_5g_dinner', 'flag_eg']
20220322-17:41:23      col_num(27): ['innet_months', 'dinner_fee', 'gprs_last_defer', 'gprs_resource', 'gprs_now_rest', 'call_use', 'arpu', 'calling_cnt', 'calling_dura', 'calling_diff_cnt', 'calling_diff_dura', 'gprs_flow_5g', 'gprs_flow_busy', 'gprs_now_defer', 'gprs_flow_roam', 'call_dura_roam', 'days_gprs', 'days_call', 'nos_calling', 'nos_calling_diff', 'sms_cnt', 'call_fee_local', 'gprs_flow_video', 'gprs_flow_short', 'gprs_flow_music', 'gprs_flow_commu', 'gprs_flow_game']
20220322-17:41:23      col_date(1): ['last_stop_date']
20220322-17:41:23      nrows: None
20220322-17:41:23      if_coltolower: True
20220322-17:41:23      kwargs: {}

20220322-17:41:23      读取
20220322-17:41:23      shape: (11278, 38)

20220322-17:41:23  -------------------------读取完毕: (11278, 38) 2022-03-22 17:41:23 -------------------------

20220322-17:41:23  手动衍生_py7个字段: {'monthsremain_last_stop_date': '最后停机时间：剩余时长', 'days_call_p': '通话天数占比', 'days_call_p_1': '通话天数占比_1', 'days_call_p_2': '通话天数占比_2', 'days_call_p_3': '通话天数占比_3', 'days_call_p_4': '通话天数占比_4', 'greatest_gprs_app': 'app偏好'}
20220322-17:41:24  monthsremain_last_stop_date: last_stop_date - current_date
20220322-17:41:24      将 monthsremain_last_stop_date 字段的 4 个缺失值赋值为: -99999 （非缺失的最小值-101.0）
20220322-17:41:24  days_call_p: days_call / days_month
20220322-17:41:24  days_call_p_1: days_call_p + days_gprs
20220322-17:41:24  days_call_p_2: days_call_p_1 + days_gprs
20220322-17:41:24  days_call_p_3: days_call_p_2 + days_gprs
20220322-17:41:24  days_call_p_4: days_call_p_3 + days_gprs
20220322-17:41:24  greatest_gprs_app: {'gprs_flow_video': 'video', 'gprs_flow_short': 'short', 'gprs_flow_music': 'music', 'gprs_flow_commu': 'commu', 'gprs_flow_game': 'game'}
20220322-17:41:26  数据量: (11278, 45)

20220322-17:41:26  检查数据
20220322-17:41:26  各账期数据量分布：
                       202009  data_timein    499
                       202009  data_train    3255
                       202010  data_timein    499
                       202010  data_train    3255
                       202011  data_timein    500
                       202011  data_train    3270
                       dtype: int64
20220322-17:41:26  各账期数据量不一致
20220322-17:41:26  以nan填充缺少账期的记录
20220322-17:41:27      修改后：
                       202009  data_timein    500
                       202009  data_train    3270
                       202010  data_timein    500
                       202010  data_train    3270
                       202011  data_timein    500
                       202011  data_train    3270
                       dtype: int64)
20220322-17:41:27  
                   diff_limitweiNone,不考察近n月字段各账期取值分布, dis_exam返回None！


20220322-17:41:27  填充数值型&类别型字段缺失值
20220322-17:41:27  日期型字段缺失值情况：
                       last_stop_date    36
                       dtype: int64

20220322-17:41:27  正负例分布：
                       data_timein  202011  0    420
                       data_timein  202011  1    80
                       data_train  202011  0    2180
                       data_train  202011  1    1090
                       dtype: int64

                   ----------------------------------------- 当月 类别型 onthot 
20220322-17:41:27  ['account_id~其他_countlow', 'greatest_gprs_app~commu', 'greatest_gprs_app~video']

                   ----------------------------------------- 当月 数值型&类别型 原始数据 


Traceback (most recent call last):
  File "C:\Users\higher\Anaconda3\lib\site-packages\IPython\core\interactiveshell.py", line 2961, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-210-cff8e3aff755>", line 1, in <module>
    create_train[model_name], Info = tab_explore_create(base_train[model_name], Info, 'create')
  File "<ipython-input-206-1e4bef1c2574>", line 312, in tab_explore_create
    res, comment_auto = stage_fun(Info, res, comment_auto, (data_now[col_now], None), stage, pipeline)
  File "C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\frame.py", line 2688, in __getitem__
    return self._getitem_column(key)
  File "C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\frame.py", line 2695, in _getitem_column
    return self._get_item_cache(key)
  File "C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\generic.py", line 2487, in _get_item_cache
    res = cache.get(item)
TypeError: unhashable type: 'set'
20220322-17:42:55  开始时间：2022-03-22 17:42:55
20220322-17:42:55  参数设置：
                       stage: create
                       step: train
                       table_in: ml.mid_eg_recent_train_202011
                       Info.model_name: 模型示例
                       Info.iv_limit: 0.05
                       Info.auto_pair2: False
                       Info.r_limit: 0.95



C:\Program Files\JetBrains\PyCharm 2020.3.3\plugins\python\helpers\pydev\pydevconsole.py:158: UserWarning: stage取值为create时,r_limit, iv_limit参数无效，将被忽略
  # a process with id 0.
20220322-17:42:55  ------------------------- 读取数据: ml.mid_eg_recent_train_202011 2022-03-22 17:42:55 -------------------------
20220322-17:42:55      src: gp
20220322-17:42:55      condition: None
20220322-17:42:55      col_need(38): ['user_acct_month', 'data_use', 'acct_month', 'phone_no_null', 'user_id', 'account_id', 'innet_months', 'user_status', 'last_stop_date', 'dinner_fee', 'gprs_last_defer', 'gprs_resource', 'gprs_now_rest', 'call_use', 'if_nolimit', 'if_5g_dinner', 'arpu', 'calling_cnt', 'calling_dura', 'calling_diff_cnt', 'calling_diff_dura', 'gprs_flow_5g', 'gprs_flow_busy', 'gprs_now_defer', 'gprs_flow_roam', 'call_dura_roam', 'days_gprs', 'days_call', 'nos_calling', 'nos_calling_diff', 'sms_cnt', 'call_fee_local', 'gprs_flow_video', 'gprs_flow_short', 'gprs_flow_music', 'gprs_flow_commu', 'gprs_flow_game', 'flag_eg']
20220322-17:42:55      col_del: None
20220322-17:42:55      col_char(10): ['user_acct_month', 'data_use', 'acct_month', 'phone_no_null', 'user_id', 'account_id', 'user_status', 'if_nolimit', 'if_5g_dinner', 'flag_eg']
20220322-17:42:55      col_num(27): ['innet_months', 'dinner_fee', 'gprs_last_defer', 'gprs_resource', 'gprs_now_rest', 'call_use', 'arpu', 'calling_cnt', 'calling_dura', 'calling_diff_cnt', 'calling_diff_dura', 'gprs_flow_5g', 'gprs_flow_busy', 'gprs_now_defer', 'gprs_flow_roam', 'call_dura_roam', 'days_gprs', 'days_call', 'nos_calling', 'nos_calling_diff', 'sms_cnt', 'call_fee_local', 'gprs_flow_video', 'gprs_flow_short', 'gprs_flow_music', 'gprs_flow_commu', 'gprs_flow_game']
20220322-17:42:55      col_date(1): ['last_stop_date']
20220322-17:42:55      nrows: None
20220322-17:42:55      if_coltolower: True
20220322-17:42:55      kwargs: {}

20220322-17:42:55      读取
20220322-17:42:55      shape: (11278, 38)

20220322-17:42:55  -------------------------读取完毕: (11278, 38) 2022-03-22 17:42:55 -------------------------

20220322-17:43:10  手动衍生_py7个字段: {'monthsremain_last_stop_date': '最后停机时间：剩余时长', 'days_call_p': '通话天数占比', 'days_call_p_1': '通话天数占比_1', 'days_call_p_2': '通话天数占比_2', 'days_call_p_3': '通话天数占比_3', 'days_call_p_4': '通话天数占比_4', 'greatest_gprs_app': 'app偏好'}
20220322-17:43:10  monthsremain_last_stop_date: last_stop_date - current_date
20220322-17:43:10      将 monthsremain_last_stop_date 字段的 4 个缺失值赋值为: -99999 （非缺失的最小值-101.0）
20220322-17:43:10  days_call_p: days_call / days_month
20220322-17:43:10  days_call_p_1: days_call_p + days_gprs
20220322-17:43:10  days_call_p_2: days_call_p_1 + days_gprs
20220322-17:43:10  days_call_p_3: days_call_p_2 + days_gprs
20220322-17:43:10  days_call_p_4: days_call_p_3 + days_gprs
20220322-17:43:10  greatest_gprs_app: {'gprs_flow_video': 'video', 'gprs_flow_short': 'short', 'gprs_flow_music': 'music', 'gprs_flow_commu': 'commu', 'gprs_flow_game': 'game'}
20220322-17:43:13  数据量: (11278, 45)

20220322-17:43:13  检查数据
20220322-17:43:13  各账期数据量分布：
                       202009  data_timein    499
                       202009  data_train    3255
                       202010  data_timein    499
                       202010  data_train    3255
                       202011  data_timein    500
                       202011  data_train    3270
                       dtype: int64
20220322-17:43:13  各账期数据量不一致
20220322-17:43:13  以nan填充缺少账期的记录
20220322-17:43:13      修改后：
                       202009  data_timein    500
                       202009  data_train    3270
                       202010  data_timein    500
                       202010  data_train    3270
                       202011  data_timein    500
                       202011  data_train    3270
                       dtype: int64)
20220322-17:43:13  
                   diff_limitweiNone,不考察近n月字段各账期取值分布, dis_exam返回None！


20220322-17:43:13  填充数值型&类别型字段缺失值
20220322-17:43:13  日期型字段缺失值情况：
                       last_stop_date    36
                       dtype: int64

20220322-17:43:13  正负例分布：
                       data_timein  202011  0    420
                       data_timein  202011  1    80
                       data_train  202011  0    2180
                       data_train  202011  1    1090
                       dtype: int64

                   ----------------------------------------- 当月 类别型 onthot 
20220322-17:43:13  ['account_id~其他_countlow', 'greatest_gprs_app~commu', 'greatest_gprs_app~video']


Traceback (most recent call last):
  File "C:\Users\higher\Anaconda3\lib\site-packages\IPython\core\interactiveshell.py", line 2961, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-214-9da14b4663a3>", line 1, in <module>
    res, comment_auto = stage_fun(Info, res, comment_auto, (data_now[col_now], None), stage, pipeline)
  File "C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\frame.py", line 2688, in __getitem__
    return self._getitem_column(key)
  File "C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\frame.py", line 2695, in _getitem_column
    return self._get_item_cache(key)
  File "C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\generic.py", line 2487, in _get_item_cache
    res = cache.get(item)
TypeError: unhashable type: 'set'
                   Out[215]: 20220322-17:43:47  
                   Infotuple(model_name='模型示例', month_train=202011, month_test=202012, Pcase_limit=10000, traintable_ratio=2, Pcumsum_limit=0, timein_count=500, timeout_limit=1000, trainproc_ratiolist=[1, 2, 10], iv_limit=0.05, r_limit=0.95, marketlevel=1, short_name='eg', col_month='acct_month', col_id='user_id', col_target='flag_eg', Pcase='1', Ncase='0', table_x='ml.ml_feature_info_yw_user_m', table_x_add='ml.ml_feature_add_yw_user_m', table_y='ml.ml_target_info_yw_user_m', table_day=nan, col_stratified=nan, col_out=['acct_month', 'last_stop_date'], user_type='', col_id_type='', dict_sortscore={'sms_cnt': True, 'call_fee_local': False}, s_field_base='s_yw_fake', condition_base='\n    phone_no_null is null and\n    last_stop_date is not null and\n    innet_months >= 3', condition_add="user_status='在网-正常'", available_add='available_notzd', condition="user_status='在网-正常' and \n    phone_no_null is null and\n    last_stop_date is not null and\n    innet_months >= 3", month_tabexp=202011, model_wd_traintest='./binaryclassify/eg/traintest~202011~202012', f_field_comment='./binaryclassify/eg/traintest~202011~202012/tabexp_col_obj~202011.pkl', col_del=['user_acct_month', 'rn'], table_train='./binaryclassify/eg/traintest~202011~202012/train_data~202011.csv', table_test='./binaryclassify/eg/traintest~202011~202012/test_data~202012.csv', cover_table_all_train=True, cover_table_all_test=True, freq_limit=0.95, unique_limit=5000, valuecount_limit=50, random_state=None, n_recent=3, auto_pair2=False, diff_limit=None, tab_psi=True, tab_r=True, field_base_avails={'available_notzd'}, table_y_targets=['flag_eg'], condition_columns={'last_stop_date', 'phone_no_null', 'innet_months', 'user_status'}, col_mark=['user_acct_month', 'data_use', 'acct_month', 'user_id'], field_base=                     field_name                   comment dtype_classify    field_src available available_notzd  available_zd                                            formula               remark must_remain into_model is_cause
                   0                    acct_month                      账期         类别型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN       否
                   1                 phone_no_null                  手机号码         类别型         原始       NaN             NaN           NaN                                                NaN       不参与自动衍生         NaN       删除       否
                   2                   phone_no_tm                模糊手机号         类别型         原始       NaN             NaN           NaN                                                NaN       不参与自动衍生         NaN       删除       否
                   3                       user_id                  手机号id         类别型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN       否
                   4                     dinner_id              主套餐策划id         类别型         原始       NaN             NaN           NaN                                                NaN   不参与当月自动衍生         NaN        NaN       否
                   5                    account_id                  帐户编号         类别型         原始       NaN             NaN           NaN                                                NaN   不参与当月自动衍生          是        NaN       否
                   6                    innet_date                  入网日期         日期型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN       删除       否
                   7                  innet_months                  入网时长         数值型         原始       NaN             NaN           NaN                                                NaN  不参与近n月自动衍生         NaN        NaN      NaN
                   8                           age                      年龄         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN
                   9                           sex                      性别         类别型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN       否
                   10                  user_status                  用户状态         类别型         原始       NaN             NaN           NaN                                                NaN                  NaN          是        NaN      NaN
                   11               last_stop_date              最后停机时间         日期型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN       删除       否
                   12  monthsaready_last_stop_date  最后停机时间：已发生时长         数值型  手动衍生_py       NaN             NaN           NaN                      current_date - last_stop_date                  NaN         NaN        NaN      NaN
                   13  monthsremain_last_stop_date    最后停机时间：剩余时长         数值型  手动衍生_py       NaN             NaN           NaN                      last_stop_date - current_date                  NaN         NaN        NaN      NaN
                   14                       dinner                    主套餐         类别型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN
                   15                   dinner_fee                套餐月租费         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN
                   16              gprs_last_defer              流量滚存资源         数值型         原始       NaN             NaN           NaN                                                NaN   不参与当月自动衍生         NaN        NaN      NaN
                   17                gprs_resource          gprs国内资源总量         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN
                   18                gprs_now_rest          当月gprs资源余量         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN
                   19                     call_use            语音资源使用量         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN
                   20                   if_nolimit    是否不限量套餐到达用户         类别型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN
                   21                 if_5g_dinner                是否5g套餐         类别型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN
                   22                   if_5g_term            是否5g终端客户         类别型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN
                   23                        if_jt              是否集团成员         类别型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN
                   24                  start_level              客户星级标识         类别型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN
                   25                    cred_type              机主证件类型         类别型         原始       NaN          不可用           NaN                                                NaN                  NaN         NaN        NaN      NaN
                   26                if_cred_multi               一证n号标识         类别型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN
                   27                         arpu                  当月arpu         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN
                   28                      pay_cnt                自充值次数         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN
                   29                      pay_fee                自充值额度         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN
                   30                 acct_balance                  账户余额         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN
                   31                   term_model              终端品牌类型         类别型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN
                   32                   term_brand                  终端品牌         类别型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN
                   33                    term_type                  终端类型         类别型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN
                   34                      sk_type                  双卡类型         类别型         原始       NaN             NaN           NaN                                                NaN       不参与自动衍生         NaN        NaN      NaN
                   35                  if_new_term              是否新机用户         类别型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN
                   36                  calling_cnt              主叫通话次数         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN
                   37                 calling_dura          当月主叫通话时长         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN
                   38                   called_cnt              被叫通话次数         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN
                   39                  called_dura          当月被叫通话时长         数值型         原始       NaN          不可用           NaN                                                NaN                  NaN         NaN        NaN      NaN
                   40             calling_diff_cnt          主叫异网通话次数         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN
                   41            calling_diff_dura        主叫异网通话分钟数         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN
                   42                    gprs_flow                gprs总流量         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN
                   44                 gprs_flow_4g                gprs4g流量         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN
                   45                 gprs_flow_5g               gprs 5g流量         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN
                   46               gprs_flow_busy            gprs-忙时-流量         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN
                   47               gprs_flow_idle            gprs-闲时-流量         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN
                   48               gprs_now_defer        可延递流量资源总量         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN
                   49               gprs_flow_roam        gprs-国内漫游-流量         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN
                   50               call_dura_roam             省际漫游-时长         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN
                   51                    days_roam              国内漫出天数         数值型         原始       NaN          不可用           NaN                                                NaN       不参与自动衍生         NaN       删除      NaN
                   52                  days_roam_p     国内漫出天数/当月天数         数值型  手动衍生_py       NaN             NaN           NaN                             days_roam / days_month                  NaN         NaN        NaN      NaN
                   53                gprs_flow_gat      gprs-港澳台漫游-流量         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN
                   54                     days_gat           港澳台漫游-时长         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN
                   57                    days_gprs                  上网天数         数值型         原始       NaN             NaN           NaN                                                NaN       不参与自动衍生         NaN       删除      NaN
                   58                  days_gprs_p              上网天数占比         数值型  手动衍生_py       NaN             NaN           NaN                             days_gprs / days_month                  NaN         NaN        NaN      NaN
                   59                    days_call                  通话天数         数值型         原始       NaN             NaN           NaN                                                NaN       不参与自动衍生         NaN       删除      NaN
                   60                  days_call_p              通话天数占比         数值型  手动衍生_py       NaN             NaN           NaN                             days_call / days_month                  NaN         NaN        NaN      NaN
                   61                days_call_p_1            通话天数占比_1         数值型  手动衍生_py       NaN             NaN           NaN                            days_call_p + days_gprs                  NaN         NaN        NaN      NaN
                   62                days_call_p_2            通话天数占比_2         数值型  手动衍生_py       NaN             NaN           NaN                          days_call_p_1 + days_gprs                  NaN         NaN        NaN      NaN
                   63                days_call_p_3            通话天数占比_3         数值型  手动衍生_py       NaN             NaN           NaN                          days_call_p_2 + days_gprs                  NaN         NaN        NaN      NaN
                   64                days_call_p_4            通话天数占比_4         数值型  手动衍生_py       NaN             NaN           NaN                          days_call_p_3 + days_gprs                  NaN          是        NaN      NaN
                   65                     nos_call    用户通信对端手机号码数         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN
                   66                  nos_calling      主叫通话对端号码个数         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN
                   67             nos_calling_diff      主叫异网对端号码个数         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN
                   68                      sms_cnt      短信-点对点短信-条数         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN
                   69               call_fee_local                本地通话费         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN
                   70                call_fee_roam                漫游通话费         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN
                   71                  gprs_income              流量出账收入         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN
                   72                     gprs_fee           流量出账-流量费         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN
                   73                     call_fee              套餐外语音费         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN
                   74              gprs_flow_video            视频类应用流量         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN         NaN        NaN      NaN
                   75              gprs_flow_short           小视频系app流量         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN          是        NaN      NaN
                   76              gprs_flow_music            音乐类应用流量         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN          是        NaN      NaN
                   77              gprs_flow_commu            通信类应用流量         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN          是        NaN      NaN
                   78               gprs_flow_game            游戏类应用流量         数值型         原始       NaN             NaN           NaN                                                NaN                  NaN          是        NaN      NaN
                   79            greatest_gprs_app                   app偏好         类别型  手动衍生_py       NaN             NaN           NaN  {'gprs_flow_video': 'video', 'gprs_flow_short'...                  NaN          是        NaN      NaN
                   80    paste_dinner_innet_months    主套餐、入网时长：交叉         类别型  手动衍生_py       NaN             NaN           NaN                             (dinner, innet_months)                  NaN         NaN        NaN      NaN, dis_train_total={'count': 8354, 'Pcount': 1201, 'prop': 0.144}, dis_train_model={'count': 7723, 'Pcount': 1090, 'prop': 0.141}, dis_timein_sample={'count': 500, 'Pcount': 80, 'prop': 0.16}, dis_train_sample={'count': 3270, 'Pcount': 1090, 'prop': 0.333}, supply_must={'greatest_gprs_app', 'user_status', 'account_id'}, supply_other={'last_stop_date', 'phone_no_null', 'sms_cnt', 'call_fee_local'}, comment_all= 是否宽表字段 available available_notzd  available_zd                                                      comment dtype_classify                               field_name     field_src                                            formula into_model is_cause must_remain               remark                                          base_init
                              是       NaN             NaN           NaN                                     观察期最后账期                   类别型                          user_acct_month  手动衍生_sql                                                NaN        NaN      NaN         NaN                  NaN                                    user_acct_month
                              是       NaN             NaN           NaN                                         数据集名称                   类别型                                 data_use  手动衍生_sql                                                NaN        NaN      NaN         NaN                  NaN                                           data_use
                              是       NaN             NaN           NaN                                               账期                   类别型                               acct_month          原始                                                NaN        NaN       否         NaN                  NaN                                         acct_month
                              是       NaN             NaN           NaN                                           手机号码                   类别型                            phone_no_null          原始                                                NaN       删除       否         NaN       不参与自动衍生                                      phone_no_null
                              否       NaN             NaN           NaN                                         模糊手机号                   类别型                              phone_no_tm          原始                                                NaN       删除       否         NaN       不参与自动衍生                                        phone_no_tm
                              是       NaN             NaN           NaN                                           手机号id                   类别型                                  user_id          原始                                                NaN        NaN       否         NaN                  NaN                                            user_id
                              否       NaN             NaN           NaN                                       主套餐策划id                   类别型                                dinner_id          原始                                                NaN        NaN       否         NaN   不参与当月自动衍生                                          dinner_id
                              是       NaN             NaN           NaN                                           帐户编号                   类别型                               account_id          原始                                                NaN        NaN       否          是   不参与当月自动衍生                                         account_id
                              否       NaN             NaN           NaN                                           入网日期                   日期型                               innet_date          原始                                                NaN       删除       否         NaN                  NaN                                         innet_date
                              是       NaN             NaN           NaN                                           入网时长                   数值型                             innet_months          原始                                                NaN        NaN      NaN         NaN  不参与近n月自动衍生                                       innet_months
                              否       NaN             NaN           NaN                                               年龄                   数值型                                      age          原始                                                NaN        NaN      NaN         NaN                  NaN                                                age
                              否       NaN             NaN           NaN                                               性别                   类别型                                      sex          原始                                                NaN        NaN       否         NaN                  NaN                                                sex
                              是       NaN             NaN           NaN                                           用户状态                   类别型                              user_status          原始                                                NaN        NaN      NaN          是                  NaN                                        user_status
                              是       NaN             NaN           NaN                                       最后停机时间                   日期型                           last_stop_date          原始                                                NaN       删除       否         NaN                  NaN                                     last_stop_date
                              否       NaN             NaN           NaN                           最后停机时间：已发生时长                   数值型              monthsaready_last_stop_date   手动衍生_py                      current_date - last_stop_date        NaN      NaN         NaN                  NaN                                   [last_stop_date]
                              否       NaN             NaN           NaN                             最后停机时间：剩余时长                   数值型              monthsremain_last_stop_date   手动衍生_py                      last_stop_date - current_date        NaN      NaN         NaN                  NaN                                   [last_stop_date]
                              否       NaN             NaN           NaN                                             主套餐                   类别型                                   dinner          原始                                                NaN        NaN      NaN         NaN                  NaN                                             dinner
                              否       NaN             NaN           NaN                                         套餐月租费                   数值型                               dinner_fee          原始                                                NaN        NaN      NaN         NaN                  NaN                                         dinner_fee
                              是       NaN             NaN           NaN                                       流量滚存资源                   数值型                          gprs_last_defer          原始                                                NaN        NaN      NaN         NaN   不参与当月自动衍生                                    gprs_last_defer
                              是       NaN             NaN           NaN                                   gprs国内资源总量                   数值型                            gprs_resource          原始                                                NaN        NaN      NaN         NaN                  NaN                                      gprs_resource
                              是       NaN             NaN           NaN                                   当月gprs资源余量                   数值型                            gprs_now_rest          原始                                                NaN        NaN      NaN         NaN                  NaN                                      gprs_now_rest
                              是       NaN             NaN           NaN                                     语音资源使用量                   数值型                                 call_use          原始                                                NaN        NaN      NaN         NaN                  NaN                                           call_use
                              否       NaN             NaN           NaN                             是否不限量套餐到达用户                   类别型                               if_nolimit          原始                                                NaN        NaN      NaN         NaN                  NaN                                         if_nolimit
                              否       NaN             NaN           NaN                                         是否5g套餐                   类别型                             if_5g_dinner          原始                                                NaN        NaN      NaN         NaN                  NaN                                       if_5g_dinner
                              否       NaN             NaN           NaN                                     是否5g终端客户                   类别型                               if_5g_term          原始                                                NaN        NaN      NaN         NaN                  NaN                                         if_5g_term
                              否       NaN             NaN           NaN                                       是否集团成员                   类别型                                    if_jt          原始                                                NaN        NaN      NaN         NaN                  NaN                                              if_jt
                              否       NaN             NaN           NaN                                       客户星级标识                   类别型                              start_level          原始                                                NaN        NaN      NaN         NaN                  NaN                                        start_level
                              否       NaN          不可用           NaN                                       机主证件类型                   类别型                                cred_type          原始                                                NaN        NaN      NaN         NaN                  NaN                                          cred_type
                              否       NaN             NaN           NaN                                        一证n号标识                   类别型                            if_cred_multi          原始                                                NaN        NaN      NaN         NaN                  NaN                                      if_cred_multi
                              是       NaN             NaN           NaN                                           当月arpu                   数值型                                     arpu          原始                                                NaN        NaN      NaN         NaN                  NaN                                               arpu
                              否       NaN             NaN           NaN                                         自充值次数                   数值型                                  pay_cnt          原始                                                NaN        NaN      NaN         NaN                  NaN                                            pay_cnt
                              否       NaN             NaN           NaN                                         自充值额度                   数值型                                  pay_fee          原始                                                NaN        NaN      NaN         NaN                  NaN                                            pay_fee
                              否       NaN             NaN           NaN                                           账户余额                   数值型                             acct_balance          原始                                                NaN        NaN      NaN         NaN                  NaN                                       acct_balance
                              否       NaN             NaN           NaN                                       终端品牌类型                   类别型                               term_model          原始                                                NaN        NaN      NaN         NaN                  NaN                                         term_model
                              否       NaN             NaN           NaN                                           终端品牌                   类别型                               term_brand          原始                                                NaN        NaN      NaN         NaN                  NaN                                         term_brand
                              否       NaN             NaN           NaN                                           终端类型                   类别型                                term_type          原始                                                NaN        NaN      NaN         NaN                  NaN                                          term_type
                              否       NaN             NaN           NaN                                           双卡类型                   类别型                                  sk_type          原始                                                NaN        NaN      NaN         NaN       不参与自动衍生                                            sk_type
                              否       NaN             NaN           NaN                                       是否新机用户                   类别型                              if_new_term          原始                                                NaN        NaN      NaN         NaN                  NaN                                        if_new_term
                              是       NaN             NaN           NaN                                       主叫通话次数                   数值型                              calling_cnt          原始                                                NaN        NaN      NaN         NaN                  NaN                                        calling_cnt
                              是       NaN             NaN           NaN                                   当月主叫通话时长                   数值型                             calling_dura          原始                                                NaN        NaN      NaN         NaN                  NaN                                       calling_dura
                              否       NaN             NaN           NaN                                       被叫通话次数                   数值型                               called_cnt          原始                                                NaN        NaN      NaN         NaN                  NaN                                         called_cnt
                              否       NaN          不可用           NaN                                   当月被叫通话时长                   数值型                              called_dura          原始                                                NaN        NaN      NaN         NaN                  NaN                                        called_dura
                              是       NaN             NaN           NaN                                   主叫异网通话次数                   数值型                         calling_diff_cnt          原始                                                NaN        NaN      NaN         NaN                  NaN                                   calling_diff_cnt
                              是       NaN             NaN           NaN                                 主叫异网通话分钟数                   数值型                        calling_diff_dura          原始                                                NaN        NaN      NaN         NaN                  NaN                                  calling_diff_dura
                              否       NaN             NaN           NaN                                         gprs总流量                   数值型                                gprs_flow          原始                                                NaN        NaN      NaN         NaN                  NaN                                          gprs_flow
                              否       NaN             NaN           NaN                                         gprs4g流量                   数值型                             gprs_flow_4g          原始                                                NaN        NaN      NaN         NaN                  NaN                                       gprs_flow_4g
                              是       NaN             NaN           NaN                                        gprs 5g流量                   数值型                             gprs_flow_5g          原始                                                NaN        NaN      NaN         NaN                  NaN                                       gprs_flow_5g
                              是       NaN             NaN           NaN                                     gprs-忙时-流量                   数值型                           gprs_flow_busy          原始                                                NaN        NaN      NaN         NaN                  NaN                                     gprs_flow_busy
                              否       NaN             NaN           NaN                                     gprs-闲时-流量                   数值型                           gprs_flow_idle          原始                                                NaN        NaN      NaN         NaN                  NaN                                     gprs_flow_idle
                              是       NaN             NaN           NaN                                 可延递流量资源总量                   数值型                           gprs_now_defer          原始                                                NaN        NaN      NaN         NaN                  NaN                                     gprs_now_defer
                              是       NaN             NaN           NaN                                 gprs-国内漫游-流量                   数值型                           gprs_flow_roam          原始                                                NaN        NaN      NaN         NaN                  NaN                                     gprs_flow_roam
                              是       NaN             NaN           NaN                                      省际漫游-时长                   数值型                           call_dura_roam          原始                                                NaN        NaN      NaN         NaN                  NaN                                     call_dura_roam
                              否       NaN          不可用           NaN                                       国内漫出天数                   数值型                                days_roam          原始                                                NaN       删除      NaN         NaN       不参与自动衍生                                          days_roam
                              否       NaN             NaN           NaN                              国内漫出天数/当月天数                   数值型                              days_roam_p   手动衍生_py                             days_roam / days_month        NaN      NaN         NaN                  NaN                                                NaN
                              否       NaN             NaN           NaN                               gprs-港澳台漫游-流量                   数值型                            gprs_flow_gat          原始                                                NaN        NaN      NaN         NaN                  NaN                                      gprs_flow_gat
                              否       NaN             NaN           NaN                                    港澳台漫游-时长                   数值型                                 days_gat          原始                                                NaN        NaN      NaN         NaN                  NaN                                           days_gat
                              否       NaN             NaN           NaN                                           上网天数                   数值型                                days_gprs          原始                                                NaN       删除      NaN         NaN       不参与自动衍生                                          days_gprs
                              否       NaN             NaN           NaN                                       上网天数占比                   数值型                              days_gprs_p   手动衍生_py                             days_gprs / days_month        NaN      NaN         NaN                  NaN                                        [days_gprs]
                              否       NaN             NaN           NaN                                           通话天数                   数值型                                days_call          原始                                                NaN       删除      NaN         NaN       不参与自动衍生                                          days_call
                              否       NaN             NaN           NaN                                       通话天数占比                   数值型                              days_call_p   手动衍生_py                             days_call / days_month        NaN      NaN         NaN                  NaN                                        [days_call]
                              否       NaN             NaN           NaN                                     通话天数占比_1                   数值型                            days_call_p_1   手动衍生_py                            days_call_p + days_gprs        NaN      NaN         NaN                  NaN                [days_call_p, days_gprs, days_call]
                              否       NaN             NaN           NaN                                     通话天数占比_2                   数值型                            days_call_p_2   手动衍生_py                          days_call_p_1 + days_gprs        NaN      NaN         NaN                  NaN  [days_call_p_1, days_gprs, days_call_p, days_c...
                              否       NaN             NaN           NaN                                     通话天数占比_3                   数值型                            days_call_p_3   手动衍生_py                          days_call_p_2 + days_gprs        NaN      NaN         NaN                  NaN  [days_call_p_2, days_gprs, days_call_p_1, days...
                              是       NaN             NaN           NaN                                     通话天数占比_4                   数值型                            days_call_p_4   手动衍生_py                          days_call_p_3 + days_gprs        NaN      NaN          是                  NaN  [days_call_p_3, days_gprs, days_call_p_2, days...
                              否       NaN             NaN           NaN                             用户通信对端手机号码数                   数值型                                 nos_call          原始                                                NaN        NaN      NaN         NaN                  NaN                                           nos_call
                              是       NaN             NaN           NaN                               主叫通话对端号码个数                   数值型                              nos_calling          原始                                                NaN        NaN      NaN         NaN                  NaN                                        nos_calling
                              是       NaN             NaN           NaN                               主叫异网对端号码个数                   数值型                         nos_calling_diff          原始                                                NaN        NaN      NaN         NaN                  NaN                                   nos_calling_diff
                              是       NaN             NaN           NaN                               短信-点对点短信-条数                   数值型                                  sms_cnt          原始                                                NaN        NaN      NaN         NaN                  NaN                                            sms_cnt
                              是       NaN             NaN           NaN                                         本地通话费                   数值型                           call_fee_local          原始                                                NaN        NaN      NaN         NaN                  NaN                                     call_fee_local
                              否       NaN             NaN           NaN                                         漫游通话费                   数值型                            call_fee_roam          原始                                                NaN        NaN      NaN         NaN                  NaN                                      call_fee_roam
                              否       NaN             NaN           NaN                                       流量出账收入                   数值型                              gprs_income          原始                                                NaN        NaN      NaN         NaN                  NaN                                        gprs_income
                              否       NaN             NaN           NaN                                    流量出账-流量费                   数值型                                 gprs_fee          原始                                                NaN        NaN      NaN         NaN                  NaN                                           gprs_fee
                              否       NaN             NaN           NaN                                       套餐外语音费                   数值型                                 call_fee          原始                                                NaN        NaN      NaN         NaN                  NaN                                           call_fee
                              是       NaN             NaN           NaN                                     视频类应用流量                   数值型                          gprs_flow_video          原始                                                NaN        NaN      NaN         NaN                  NaN                                    gprs_flow_video
                              是       NaN             NaN           NaN                                    小视频系app流量                   数值型                          gprs_flow_short          原始                                                NaN        NaN      NaN          是                  NaN                                    gprs_flow_short
                              是       NaN             NaN           NaN                                     音乐类应用流量                   数值型                          gprs_flow_music          原始                                                NaN        NaN      NaN          是                  NaN                                    gprs_flow_music
                              是       NaN             NaN           NaN                                     通信类应用流量                   数值型                          gprs_flow_commu          原始                                                NaN        NaN      NaN          是                  NaN                                    gprs_flow_commu
                              是       NaN             NaN           NaN                                     游戏类应用流量                   数值型                           gprs_flow_game          原始                                                NaN        NaN      NaN          是                  NaN                                     gprs_flow_game
                              是       NaN             NaN           NaN                                            app偏好                   类别型                        greatest_gprs_app   手动衍生_py  {'gprs_flow_video': 'video', 'gprs_flow_short'...        NaN      NaN          是                  NaN  [gprs_flow_video, gprs_flow_short, gprs_flow_m...
                              否       NaN             NaN           NaN                             主套餐、入网时长：交叉                   类别型                paste_dinner_innet_months   手动衍生_py                             (dinner, innet_months)        NaN      NaN         NaN                  NaN                             [dinner, innet_months]
                              是       NaN             NaN           NaN                  帐户编号：取值是否为其他_countlow                   数值型                 account_id~其他_countlow   自动衍生_py                                                NaN        NaN       否         NaN                  NaN                                         account_id
                              否       NaN             NaN           NaN               是否不限量套餐到达用户：取值是否为是                   数值型                            if_nolimit~是   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                         if_nolimit
                              否       NaN             NaN           NaN                           是否5g套餐：取值是否为是                   数值型                          if_5g_dinner~是   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                       if_5g_dinner
                              是       NaN             NaN           NaN                           app偏好：取值是否为commu                   数值型                  greatest_gprs_app~commu   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN  [greatest_gprs_app, gprs_flow_video, gprs_flow...
                              是       NaN             NaN           NaN                           app偏好：取值是否为video                   数值型                  greatest_gprs_app~video   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN  [greatest_gprs_app, gprs_flow_video, gprs_flow...
                              否       NaN             NaN           NaN                             gprs 5g流量：近3月均值                   数值型                        avg__gprs_flow_5g   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                       gprs_flow_5g
                              是       NaN             NaN           NaN                        当月主叫通话时长：近3月均值                   数值型                        avg__calling_dura   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                       calling_dura
                              是       NaN             NaN           NaN                        gprs国内资源总量：近3月均值                   数值型                       avg__gprs_resource   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                      gprs_resource
                              是       NaN             NaN           NaN                           省际漫游-时长：近3月均值                   数值型                      avg__call_dura_roam   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                     call_dura_roam
                              是       NaN             NaN           NaN                        主叫异网通话次数：近3月均值                   数值型                    avg__calling_diff_cnt   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                   calling_diff_cnt
                              是       NaN             NaN           NaN                          gprs-忙时-流量：近3月均值                   数值型                      avg__gprs_flow_busy   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                     gprs_flow_busy
                              是       NaN             NaN           NaN                          音乐类应用流量：近3月均值                   数值型                     avg__gprs_flow_music   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                    gprs_flow_music
                              是       NaN             NaN           NaN                            流量滚存资源：近3月均值                   数值型                     avg__gprs_last_defer   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                    gprs_last_defer
                              是       NaN             NaN           NaN                      可延递流量资源总量：近3月均值                   数值型                      avg__gprs_now_defer   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                     gprs_now_defer
                              是       NaN             NaN           NaN                    主叫通话对端号码个数：近3月均值                   数值型                         avg__nos_calling   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                        nos_calling
                              是       NaN             NaN           NaN                      gprs-国内漫游-流量：近3月均值                   数值型                      avg__gprs_flow_roam   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                     gprs_flow_roam
                              是       NaN             NaN           NaN                      主叫异网通话分钟数：近3月均值                   数值型                   avg__calling_diff_dura   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                  calling_diff_dura
                              是       NaN             NaN           NaN                        当月gprs资源余量：近3月均值                   数值型                       avg__gprs_now_rest   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                      gprs_now_rest
                              是       NaN             NaN           NaN                  最后停机时间：剩余时长：近3月均值                   数值型         avg__monthsremain_last_stop_date   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN      [monthsremain_last_stop_date, last_stop_date]
                              否       NaN             NaN           NaN                              套餐月租费：近3月均值                   数值型                          avg__dinner_fee   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                         dinner_fee
                              是       NaN             NaN           NaN                         小视频系app流量：近3月均值                   数值型                     avg__gprs_flow_short   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                    gprs_flow_short
                              是       NaN             NaN           NaN                          通信类应用流量：近3月均值                   数值型                     avg__gprs_flow_commu   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                    gprs_flow_commu
                              是       NaN             NaN           NaN                          语音资源使用量：近3月均值                   数值型                            avg__call_use   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                           call_use
                              是       NaN             NaN           NaN                          游戏类应用流量：近3月均值                   数值型                      avg__gprs_flow_game   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                     gprs_flow_game
                              否       NaN             NaN           NaN                          通话天数占比_4：近3月均值                   数值型                       avg__days_call_p_4   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN  [days_call_p_4, days_call_p_3, days_gprs, days...
                              是       NaN             NaN           NaN                                当月arpu：近3月均值                   数值型                                avg__arpu   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                               arpu
                              是       NaN             NaN           NaN                    主叫异网对端号码个数：近3月均值                   数值型                    avg__nos_calling_diff   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                   nos_calling_diff
                              是       NaN             NaN           NaN                            主叫通话次数：近3月均值                   数值型                         avg__calling_cnt   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                        calling_cnt
                              是       NaN             NaN           NaN                          视频类应用流量：近3月均值                   数值型                     avg__gprs_flow_video   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                    gprs_flow_video
                              是       NaN             NaN           NaN                         gprs 5g流量：近3月离散系数                   数值型                        sep__gprs_flow_5g   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                       gprs_flow_5g
                              否       NaN             NaN           NaN                    当月主叫通话时长：近3月离散系数                   数值型                        sep__calling_dura   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                       calling_dura
                              否       NaN             NaN           NaN                    gprs国内资源总量：近3月离散系数                   数值型                       sep__gprs_resource   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                      gprs_resource
                              否       NaN             NaN           NaN                       省际漫游-时长：近3月离散系数                   数值型                      sep__call_dura_roam   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                     call_dura_roam
                              否       NaN             NaN           NaN                    主叫异网通话次数：近3月离散系数                   数值型                    sep__calling_diff_cnt   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                   calling_diff_cnt
                              否       NaN             NaN           NaN                      gprs-忙时-流量：近3月离散系数                   数值型                      sep__gprs_flow_busy   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                     gprs_flow_busy
                              否       NaN             NaN           NaN                      音乐类应用流量：近3月离散系数                   数值型                     sep__gprs_flow_music   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                    gprs_flow_music
                              是       NaN             NaN           NaN                        流量滚存资源：近3月离散系数                   数值型                     sep__gprs_last_defer   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                    gprs_last_defer
                              否       NaN             NaN           NaN                  可延递流量资源总量：近3月离散系数                   数值型                      sep__gprs_now_defer   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                     gprs_now_defer
                              是       NaN             NaN           NaN                主叫通话对端号码个数：近3月离散系数                   数值型                         sep__nos_calling   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                        nos_calling
                              否       NaN             NaN           NaN                  gprs-国内漫游-流量：近3月离散系数                   数值型                      sep__gprs_flow_roam   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                     gprs_flow_roam
                              是       NaN             NaN           NaN                  主叫异网通话分钟数：近3月离散系数                   数值型                   sep__calling_diff_dura   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                  calling_diff_dura
                              是       NaN             NaN           NaN                    当月gprs资源余量：近3月离散系数                   数值型                       sep__gprs_now_rest   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                      gprs_now_rest
                              否       NaN             NaN           NaN              最后停机时间：剩余时长：近3月离散系数                   数值型         sep__monthsremain_last_stop_date   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN      [monthsremain_last_stop_date, last_stop_date]
                              否       NaN             NaN           NaN                          套餐月租费：近3月离散系数                   数值型                          sep__dinner_fee   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                         dinner_fee
                              否       NaN             NaN           NaN                     小视频系app流量：近3月离散系数                   数值型                     sep__gprs_flow_short   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                    gprs_flow_short
                              是       NaN             NaN           NaN                      通信类应用流量：近3月离散系数                   数值型                     sep__gprs_flow_commu   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                    gprs_flow_commu
                              否       NaN             NaN           NaN                      语音资源使用量：近3月离散系数                   数值型                            sep__call_use   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                           call_use
                              否       NaN             NaN           NaN                      游戏类应用流量：近3月离散系数                   数值型                      sep__gprs_flow_game   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                     gprs_flow_game
                              否       NaN             NaN           NaN                      通话天数占比_4：近3月离散系数                   数值型                       sep__days_call_p_4   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN  [days_call_p_4, days_call_p_3, days_gprs, days...
                              否       NaN             NaN           NaN                            当月arpu：近3月离散系数                   数值型                                sep__arpu   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                               arpu
                              否       NaN             NaN           NaN                主叫异网对端号码个数：近3月离散系数                   数值型                    sep__nos_calling_diff   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                   nos_calling_diff
                              否       NaN             NaN           NaN                        主叫通话次数：近3月离散系数                   数值型                         sep__calling_cnt   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                        calling_cnt
                              是       NaN             NaN           NaN                      视频类应用流量：近3月离散系数                   数值型                     sep__gprs_flow_video   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                    gprs_flow_video
                              是       NaN             NaN           NaN                           gprs 5g流量：近3月波动性                   数值型                       wave__gprs_flow_5g   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                       gprs_flow_5g
                              是       NaN             NaN           NaN                      当月主叫通话时长：近3月波动性                   数值型                       wave__calling_dura   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                       calling_dura
                              是       NaN             NaN           NaN                      gprs国内资源总量：近3月波动性                   数值型                      wave__gprs_resource   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                      gprs_resource
                              否       NaN             NaN           NaN                         省际漫游-时长：近3月波动性                   数值型                     wave__call_dura_roam   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                     call_dura_roam
                              否       NaN             NaN           NaN                      主叫异网通话次数：近3月波动性                   数值型                   wave__calling_diff_cnt   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                   calling_diff_cnt
                              否       NaN             NaN           NaN                        gprs-忙时-流量：近3月波动性                   数值型                     wave__gprs_flow_busy   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                     gprs_flow_busy
                              是       NaN             NaN           NaN                        音乐类应用流量：近3月波动性                   数值型                    wave__gprs_flow_music   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                    gprs_flow_music
                              是       NaN             NaN           NaN                          流量滚存资源：近3月波动性                   数值型                    wave__gprs_last_defer   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                    gprs_last_defer
                              是       NaN             NaN           NaN                    可延递流量资源总量：近3月波动性                   数值型                     wave__gprs_now_defer   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                     gprs_now_defer
                              否       NaN             NaN           NaN                  主叫通话对端号码个数：近3月波动性                   数值型                        wave__nos_calling   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                        nos_calling
                              否       NaN             NaN           NaN                    gprs-国内漫游-流量：近3月波动性                   数值型                     wave__gprs_flow_roam   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                     gprs_flow_roam
                              否       NaN             NaN           NaN                    主叫异网通话分钟数：近3月波动性                   数值型                  wave__calling_diff_dura   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                  calling_diff_dura
                              是       NaN             NaN           NaN                      当月gprs资源余量：近3月波动性                   数值型                      wave__gprs_now_rest   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                      gprs_now_rest
                              否       NaN             NaN           NaN                最后停机时间：剩余时长：近3月波动性                   数值型        wave__monthsremain_last_stop_date   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN      [monthsremain_last_stop_date, last_stop_date]
                              否       NaN             NaN           NaN                            套餐月租费：近3月波动性                   数值型                         wave__dinner_fee   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                         dinner_fee
                              否       NaN             NaN           NaN                       小视频系app流量：近3月波动性                   数值型                    wave__gprs_flow_short   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                    gprs_flow_short
                              否       NaN             NaN           NaN                        通信类应用流量：近3月波动性                   数值型                    wave__gprs_flow_commu   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                    gprs_flow_commu
                              是       NaN             NaN           NaN                        语音资源使用量：近3月波动性                   数值型                           wave__call_use   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                           call_use
                              否       NaN             NaN           NaN                        游戏类应用流量：近3月波动性                   数值型                     wave__gprs_flow_game   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                     gprs_flow_game
                              否       NaN             NaN           NaN                        通话天数占比_4：近3月波动性                   数值型                      wave__days_call_p_4   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN  [days_call_p_4, days_call_p_3, days_gprs, days...
                              否       NaN             NaN           NaN                              当月arpu：近3月波动性                   数值型                               wave__arpu   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                               arpu
                              否       NaN             NaN           NaN                  主叫异网对端号码个数：近3月波动性                   数值型                   wave__nos_calling_diff   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                   nos_calling_diff
                              是       NaN             NaN           NaN                          主叫通话次数：近3月波动性                   数值型                        wave__calling_cnt   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                        calling_cnt
                              否       NaN             NaN           NaN                        视频类应用流量：近3月波动性                   数值型                    wave__gprs_flow_video   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                    gprs_flow_video
                              否       NaN             NaN           NaN                           gprs 5g流量：近3月成长率                   数值型                       grow__gprs_flow_5g   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                       gprs_flow_5g
                              是       NaN             NaN           NaN                      当月主叫通话时长：近3月成长率                   数值型                       grow__calling_dura   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                       calling_dura
                              否       NaN             NaN           NaN                      gprs国内资源总量：近3月成长率                   数值型                      grow__gprs_resource   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                      gprs_resource
                              否       NaN             NaN           NaN                         省际漫游-时长：近3月成长率                   数值型                     grow__call_dura_roam   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                     call_dura_roam
                              否       NaN             NaN           NaN                      主叫异网通话次数：近3月成长率                   数值型                   grow__calling_diff_cnt   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                   calling_diff_cnt
                              否       NaN             NaN           NaN                        gprs-忙时-流量：近3月成长率                   数值型                     grow__gprs_flow_busy   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                     gprs_flow_busy
                              否       NaN             NaN           NaN                        音乐类应用流量：近3月成长率                   数值型                    grow__gprs_flow_music   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                    gprs_flow_music
                              是       NaN             NaN           NaN                          流量滚存资源：近3月成长率                   数值型                    grow__gprs_last_defer   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                    gprs_last_defer
                              是       NaN             NaN           NaN                    可延递流量资源总量：近3月成长率                   数值型                     grow__gprs_now_defer   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                     gprs_now_defer
                              是       NaN             NaN           NaN                  主叫通话对端号码个数：近3月成长率                   数值型                        grow__nos_calling   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                        nos_calling
                              否       NaN             NaN           NaN                    gprs-国内漫游-流量：近3月成长率                   数值型                     grow__gprs_flow_roam   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                     gprs_flow_roam
                              是       NaN             NaN           NaN                    主叫异网通话分钟数：近3月成长率                   数值型                  grow__calling_diff_dura   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                  calling_diff_dura
                              是       NaN             NaN           NaN                      当月gprs资源余量：近3月成长率                   数值型                      grow__gprs_now_rest   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                      gprs_now_rest
                              否       NaN             NaN           NaN                最后停机时间：剩余时长：近3月成长率                   数值型        grow__monthsremain_last_stop_date   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN      [monthsremain_last_stop_date, last_stop_date]
                              是       NaN             NaN           NaN                            套餐月租费：近3月成长率                   数值型                         grow__dinner_fee   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                         dinner_fee
                              否       NaN             NaN           NaN                       小视频系app流量：近3月成长率                   数值型                    grow__gprs_flow_short   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                    gprs_flow_short
                              是       NaN             NaN           NaN                        通信类应用流量：近3月成长率                   数值型                    grow__gprs_flow_commu   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                    gprs_flow_commu
                              是       NaN             NaN           NaN                        语音资源使用量：近3月成长率                   数值型                           grow__call_use   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                           call_use
                              否       NaN             NaN           NaN                        游戏类应用流量：近3月成长率                   数值型                     grow__gprs_flow_game   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                     gprs_flow_game
                              否       NaN             NaN           NaN                        通话天数占比_4：近3月成长率                   数值型                      grow__days_call_p_4   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN  [days_call_p_4, days_call_p_3, days_gprs, days...
                              否       NaN             NaN           NaN                              当月arpu：近3月成长率                   数值型                               grow__arpu   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                               arpu
                              是       NaN             NaN           NaN                  主叫异网对端号码个数：近3月成长率                   数值型                   grow__nos_calling_diff   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                   nos_calling_diff
                              是       NaN             NaN           NaN                          主叫通话次数：近3月成长率                   数值型                        grow__calling_cnt   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                        calling_cnt
                              是       NaN             NaN           NaN                        视频类应用流量：近3月成长率                   数值型                    grow__gprs_flow_video   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                    gprs_flow_video
                              是       NaN             NaN           NaN                           gprs 5g流量：近3月最大值                   数值型                        max__gprs_flow_5g   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                       gprs_flow_5g
                              是       NaN             NaN           NaN                      当月主叫通话时长：近3月最大值                   数值型                        max__calling_dura   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                       calling_dura
                              否       NaN             NaN           NaN                      gprs国内资源总量：近3月最大值                   数值型                       max__gprs_resource   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                      gprs_resource
                              是       NaN             NaN           NaN                         省际漫游-时长：近3月最大值                   数值型                      max__call_dura_roam   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                     call_dura_roam
                              是       NaN             NaN           NaN                      主叫异网通话次数：近3月最大值                   数值型                    max__calling_diff_cnt   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                   calling_diff_cnt
                              否       NaN             NaN           NaN                        gprs-忙时-流量：近3月最大值                   数值型                      max__gprs_flow_busy   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                     gprs_flow_busy
                              否       NaN             NaN           NaN                        音乐类应用流量：近3月最大值                   数值型                     max__gprs_flow_music   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                    gprs_flow_music
                              是       NaN             NaN           NaN                          流量滚存资源：近3月最大值                   数值型                     max__gprs_last_defer   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                    gprs_last_defer
                              否       NaN             NaN           NaN                    可延递流量资源总量：近3月最大值                   数值型                      max__gprs_now_defer   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                     gprs_now_defer
                              是       NaN             NaN           NaN                  主叫通话对端号码个数：近3月最大值                   数值型                         max__nos_calling   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                        nos_calling
                              是       NaN             NaN           NaN                    gprs-国内漫游-流量：近3月最大值                   数值型                      max__gprs_flow_roam   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                     gprs_flow_roam
                              是       NaN             NaN           NaN                    主叫异网通话分钟数：近3月最大值                   数值型                   max__calling_diff_dura   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                  calling_diff_dura
                              是       NaN             NaN           NaN                      当月gprs资源余量：近3月最大值                   数值型                       max__gprs_now_rest   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                      gprs_now_rest
                              是       NaN             NaN           NaN                最后停机时间：剩余时长：近3月最大值                   数值型         max__monthsremain_last_stop_date   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN      [monthsremain_last_stop_date, last_stop_date]
                              否       NaN             NaN           NaN                            套餐月租费：近3月最大值                   数值型                          max__dinner_fee   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                         dinner_fee
                              否       NaN             NaN           NaN                       小视频系app流量：近3月最大值                   数值型                     max__gprs_flow_short   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                    gprs_flow_short
                              否       NaN             NaN           NaN                        通信类应用流量：近3月最大值                   数值型                     max__gprs_flow_commu   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                    gprs_flow_commu
                              是       NaN             NaN           NaN                        语音资源使用量：近3月最大值                   数值型                            max__call_use   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                           call_use
                              否       NaN             NaN           NaN                        游戏类应用流量：近3月最大值                   数值型                      max__gprs_flow_game   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                     gprs_flow_game
                              否       NaN             NaN           NaN                        通话天数占比_4：近3月最大值                   数值型                       max__days_call_p_4   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN  [days_call_p_4, days_call_p_3, days_gprs, days...
                              是       NaN             NaN           NaN                              当月arpu：近3月最大值                   数值型                                max__arpu   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                               arpu
                              是       NaN             NaN           NaN                  主叫异网对端号码个数：近3月最大值                   数值型                    max__nos_calling_diff   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                   nos_calling_diff
                              是       NaN             NaN           NaN                          主叫通话次数：近3月最大值                   数值型                         max__calling_cnt   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                        calling_cnt
                              否       NaN             NaN           NaN                        视频类应用流量：近3月最大值                   数值型                     max__gprs_flow_video   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                    gprs_flow_video
                              否       NaN             NaN           NaN                           gprs 5g流量：近3月最小值                   数值型                        min__gprs_flow_5g   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                       gprs_flow_5g
                              是       NaN             NaN           NaN                      当月主叫通话时长：近3月最小值                   数值型                        min__calling_dura   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                       calling_dura
                              是       NaN             NaN           NaN                      gprs国内资源总量：近3月最小值                   数值型                       min__gprs_resource   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                      gprs_resource
                              否       NaN             NaN           NaN                         省际漫游-时长：近3月最小值                   数值型                      min__call_dura_roam   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                     call_dura_roam
                              是       NaN             NaN           NaN                      主叫异网通话次数：近3月最小值                   数值型                    min__calling_diff_cnt   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                   calling_diff_cnt
                              是       NaN             NaN           NaN                        gprs-忙时-流量：近3月最小值                   数值型                      min__gprs_flow_busy   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                     gprs_flow_busy
                              是       NaN             NaN           NaN                        音乐类应用流量：近3月最小值                   数值型                     min__gprs_flow_music   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                    gprs_flow_music
                              是       NaN             NaN           NaN                          流量滚存资源：近3月最小值                   数值型                     min__gprs_last_defer   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                    gprs_last_defer
                              否       NaN             NaN           NaN                    可延递流量资源总量：近3月最小值                   数值型                      min__gprs_now_defer   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                     gprs_now_defer
                              是       NaN             NaN           NaN                  主叫通话对端号码个数：近3月最小值                   数值型                         min__nos_calling   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                        nos_calling
                              是       NaN             NaN           NaN                    gprs-国内漫游-流量：近3月最小值                   数值型                      min__gprs_flow_roam   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                     gprs_flow_roam
                              是       NaN             NaN           NaN                    主叫异网通话分钟数：近3月最小值                   数值型                   min__calling_diff_dura   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                  calling_diff_dura
                              是       NaN             NaN           NaN                      当月gprs资源余量：近3月最小值                   数值型                       min__gprs_now_rest   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                      gprs_now_rest
                              否       NaN             NaN           NaN                最后停机时间：剩余时长：近3月最小值                   数值型         min__monthsremain_last_stop_date   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN      [monthsremain_last_stop_date, last_stop_date]
                              否       NaN             NaN           NaN                            套餐月租费：近3月最小值                   数值型                          min__dinner_fee   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                         dinner_fee
                              是       NaN             NaN           NaN                       小视频系app流量：近3月最小值                   数值型                     min__gprs_flow_short   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                    gprs_flow_short
                              是       NaN             NaN           NaN                        通信类应用流量：近3月最小值                   数值型                     min__gprs_flow_commu   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                    gprs_flow_commu
                              是       NaN             NaN           NaN                        语音资源使用量：近3月最小值                   数值型                            min__call_use   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                           call_use
                              是       NaN             NaN           NaN                        游戏类应用流量：近3月最小值                   数值型                      min__gprs_flow_game   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                     gprs_flow_game
                              是       NaN             NaN           NaN                        通话天数占比_4：近3月最小值                   数值型                       min__days_call_p_4   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN  [days_call_p_4, days_call_p_3, days_gprs, days...
                              是       NaN             NaN           NaN                              当月arpu：近3月最小值                   数值型                                min__arpu   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                               arpu
                              是       NaN             NaN           NaN                  主叫异网对端号码个数：近3月最小值                   数值型                    min__nos_calling_diff   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                   nos_calling_diff
                              是       NaN             NaN           NaN                          主叫通话次数：近3月最小值                   数值型                         min__calling_cnt   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                        calling_cnt
                              是       NaN             NaN           NaN                        视频类应用流量：近3月最小值                   数值型                     min__gprs_flow_video   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                    gprs_flow_video
                              否       NaN             NaN           NaN                           gprs 5g流量：近3月标准差                   数值型                        std__gprs_flow_5g   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                       gprs_flow_5g
                              是       NaN             NaN           NaN                      当月主叫通话时长：近3月标准差                   数值型                        std__calling_dura   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                       calling_dura
                              是       NaN             NaN           NaN                      gprs国内资源总量：近3月标准差                   数值型                       std__gprs_resource   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                      gprs_resource
                              是       NaN             NaN           NaN                         省际漫游-时长：近3月标准差                   数值型                      std__call_dura_roam   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                     call_dura_roam
                              是       NaN             NaN           NaN                      主叫异网通话次数：近3月标准差                   数值型                    std__calling_diff_cnt   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                   calling_diff_cnt
                              是       NaN             NaN           NaN                        gprs-忙时-流量：近3月标准差                   数值型                      std__gprs_flow_busy   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                     gprs_flow_busy
                              否       NaN             NaN           NaN                        音乐类应用流量：近3月标准差                   数值型                     std__gprs_flow_music   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                    gprs_flow_music
                              是       NaN             NaN           NaN                          流量滚存资源：近3月标准差                   数值型                     std__gprs_last_defer   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                    gprs_last_defer
                              否       NaN             NaN           NaN                    可延递流量资源总量：近3月标准差                   数值型                      std__gprs_now_defer   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                     gprs_now_defer
                              是       NaN             NaN           NaN                  主叫通话对端号码个数：近3月标准差                   数值型                         std__nos_calling   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                        nos_calling
                              否       NaN             NaN           NaN                    gprs-国内漫游-流量：近3月标准差                   数值型                      std__gprs_flow_roam   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                     gprs_flow_roam
                              是       NaN             NaN           NaN                    主叫异网通话分钟数：近3月标准差                   数值型                   std__calling_diff_dura   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                  calling_diff_dura
                              是       NaN             NaN           NaN                      当月gprs资源余量：近3月标准差                   数值型                       std__gprs_now_rest   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                      gprs_now_rest
                              否       NaN             NaN           NaN                最后停机时间：剩余时长：近3月标准差                   数值型         std__monthsremain_last_stop_date   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN      [monthsremain_last_stop_date, last_stop_date]
                              否       NaN             NaN           NaN                            套餐月租费：近3月标准差                   数值型                          std__dinner_fee   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                         dinner_fee
                              是       NaN             NaN           NaN                       小视频系app流量：近3月标准差                   数值型                     std__gprs_flow_short   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                    gprs_flow_short
                              是       NaN             NaN           NaN                        通信类应用流量：近3月标准差                   数值型                     std__gprs_flow_commu   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                    gprs_flow_commu
                              是       NaN             NaN           NaN                        语音资源使用量：近3月标准差                   数值型                            std__call_use   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                           call_use
                              否       NaN             NaN           NaN                        游戏类应用流量：近3月标准差                   数值型                      std__gprs_flow_game   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                     gprs_flow_game
                              否       NaN             NaN           NaN                        通话天数占比_4：近3月标准差                   数值型                       std__days_call_p_4   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN  [days_call_p_4, days_call_p_3, days_gprs, days...
                              是       NaN             NaN           NaN                              当月arpu：近3月标准差                   数值型                                std__arpu   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                               arpu
                              是       NaN             NaN           NaN                  主叫异网对端号码个数：近3月标准差                   数值型                    std__nos_calling_diff   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                   nos_calling_diff
                              是       NaN             NaN           NaN                          主叫通话次数：近3月标准差                   数值型                         std__calling_cnt   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                        calling_cnt
                              否       NaN             NaN           NaN                        视频类应用流量：近3月标准差                   数值型                     std__gprs_flow_video   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                    gprs_flow_video
                              是       NaN             NaN           NaN                                           预测目标                   类别型                                  flag_eg  手动衍生_sql                                                NaN        NaN      NaN         NaN                  NaN                                            flag_eg
                              否       NaN             NaN           NaN                    gprs 5g流量：近3月大于0的月份数                   数值型                   more0cnt__gprs_flow_5g   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                       gprs_flow_5g
                              否       NaN             NaN           NaN               当月主叫通话时长：近3月大于0的月份数                   数值型                   more0cnt__calling_dura   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                       calling_dura
                              否       NaN             NaN           NaN               gprs国内资源总量：近3月大于0的月份数                   数值型                  more0cnt__gprs_resource   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                      gprs_resource
                              否       NaN             NaN           NaN                  省际漫游-时长：近3月大于0的月份数                   数值型                 more0cnt__call_dura_roam   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                     call_dura_roam
                              否       NaN             NaN           NaN               主叫异网通话次数：近3月大于0的月份数                   数值型               more0cnt__calling_diff_cnt   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                   calling_diff_cnt
                              否       NaN             NaN           NaN                 gprs-忙时-流量：近3月大于0的月份数                   数值型                 more0cnt__gprs_flow_busy   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                     gprs_flow_busy
                              否       NaN             NaN           NaN                 音乐类应用流量：近3月大于0的月份数                   数值型                more0cnt__gprs_flow_music   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                    gprs_flow_music
                              否       NaN             NaN           NaN                   流量滚存资源：近3月大于0的月份数                   数值型                more0cnt__gprs_last_defer   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                    gprs_last_defer
                              否       NaN             NaN           NaN             可延递流量资源总量：近3月大于0的月份数                   数值型                 more0cnt__gprs_now_defer   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                     gprs_now_defer
                              否       NaN             NaN           NaN           主叫通话对端号码个数：近3月大于0的月份数                   数值型                    more0cnt__nos_calling   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                        nos_calling
                              否       NaN             NaN           NaN             gprs-国内漫游-流量：近3月大于0的月份数                   数值型                 more0cnt__gprs_flow_roam   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                     gprs_flow_roam
                              否       NaN             NaN           NaN             主叫异网通话分钟数：近3月大于0的月份数                   数值型              more0cnt__calling_diff_dura   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                  calling_diff_dura
                              否       NaN             NaN           NaN               当月gprs资源余量：近3月大于0的月份数                   数值型                  more0cnt__gprs_now_rest   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                      gprs_now_rest
                              否       NaN             NaN           NaN         最后停机时间：剩余时长：近3月大于0的月份数                   数值型    more0cnt__monthsremain_last_stop_date   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN      [monthsremain_last_stop_date, last_stop_date]
                              否       NaN             NaN           NaN                     套餐月租费：近3月大于0的月份数                   数值型                     more0cnt__dinner_fee   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                         dinner_fee
                              否       NaN             NaN           NaN                小视频系app流量：近3月大于0的月份数                   数值型                more0cnt__gprs_flow_short   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                    gprs_flow_short
                              否       NaN             NaN           NaN                 通信类应用流量：近3月大于0的月份数                   数值型                more0cnt__gprs_flow_commu   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                    gprs_flow_commu
                              否       NaN             NaN           NaN                 语音资源使用量：近3月大于0的月份数                   数值型                       more0cnt__call_use   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                           call_use
                              否       NaN             NaN           NaN                 游戏类应用流量：近3月大于0的月份数                   数值型                 more0cnt__gprs_flow_game   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                     gprs_flow_game
                              否       NaN             NaN           NaN                 通话天数占比_4：近3月大于0的月份数                   数值型                  more0cnt__days_call_p_4   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN  [days_call_p_4, days_call_p_3, days_gprs, days...
                              否       NaN             NaN           NaN                       当月arpu：近3月大于0的月份数                   数值型                           more0cnt__arpu   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                               arpu
                              否       NaN             NaN           NaN           主叫异网对端号码个数：近3月大于0的月份数                   数值型               more0cnt__nos_calling_diff   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                   nos_calling_diff
                              是       NaN             NaN           NaN                   主叫通话次数：近3月大于0的月份数                   数值型                    more0cnt__calling_cnt   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                        calling_cnt
                              否       NaN             NaN           NaN                 视频类应用流量：近3月大于0的月份数                   数值型                more0cnt__gprs_flow_video   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                    gprs_flow_video
                              是       NaN             NaN           NaN         gprs 5g流量：近3月大于第一四分位数的月份数                   数值型                 moreq25cnt__gprs_flow_5g   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                       gprs_flow_5g
                              是       NaN             NaN           NaN    当月主叫通话时长：近3月大于第一四分位数的月份数                   数值型                 moreq25cnt__calling_dura   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                       calling_dura
                              是       NaN             NaN           NaN    gprs国内资源总量：近3月大于第一四分位数的月份数                   数值型                moreq25cnt__gprs_resource   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                      gprs_resource
                              否       NaN             NaN           NaN       省际漫游-时长：近3月大于第一四分位数的月份数                   数值型               moreq25cnt__call_dura_roam   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                     call_dura_roam
                              否       NaN             NaN           NaN    主叫异网通话次数：近3月大于第一四分位数的月份数                   数值型             moreq25cnt__calling_diff_cnt   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                   calling_diff_cnt
                              是       NaN             NaN           NaN      gprs-忙时-流量：近3月大于第一四分位数的月份数                   数值型               moreq25cnt__gprs_flow_busy   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                     gprs_flow_busy
                              否       NaN             NaN           NaN      音乐类应用流量：近3月大于第一四分位数的月份数                   数值型              moreq25cnt__gprs_flow_music   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                    gprs_flow_music
                              是       NaN             NaN           NaN        流量滚存资源：近3月大于第一四分位数的月份数                   数值型              moreq25cnt__gprs_last_defer   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                    gprs_last_defer
                              是       NaN             NaN           NaN  可延递流量资源总量：近3月大于第一四分位数的月份数                   数值型               moreq25cnt__gprs_now_defer   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                     gprs_now_defer
                              是       NaN             NaN           NaN  主叫通话对端号码个数：近3月大于第一四分位数的月份数......           数值型                  moreq25cnt__nos_calling   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                        nos_calling
                              否       NaN             NaN           NaN  gprs-国内漫游-流量：近3月大于第一四分位数的月份数                   数值型               moreq25cnt__gprs_flow_roam   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                     gprs_flow_roam
                              是       NaN             NaN           NaN  主叫异网通话分钟数：近3月大于第一四分位数的月份数                   数值型            moreq25cnt__calling_diff_dura   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                  calling_diff_dura
                              否       NaN             NaN           NaN    当月gprs资源余量：近3月大于第一四分位数的月份数                   数值型                moreq25cnt__gprs_now_rest   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                      gprs_now_rest
                              否       NaN             NaN           NaN  最后停机时间：剩余时长：近3月大于第一四分位数的月份数......         数值型  moreq25cnt__monthsremain_last_stop_date   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN      [monthsremain_last_stop_date, last_stop_date]
                              否       NaN             NaN           NaN          套餐月租费：近3月大于第一四分位数的月份数                   数值型                   moreq25cnt__dinner_fee   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                         dinner_fee
                              是       NaN             NaN           NaN     小视频系app流量：近3月大于第一四分位数的月份数                   数值型              moreq25cnt__gprs_flow_short   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                    gprs_flow_short
                              否       NaN             NaN           NaN      通信类应用流量：近3月大于第一四分位数的月份数                   数值型              moreq25cnt__gprs_flow_commu   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                    gprs_flow_commu
                              否       NaN             NaN           NaN      语音资源使用量：近3月大于第一四分位数的月份数                   数值型                     moreq25cnt__call_use   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                           call_use
                              否       NaN             NaN           NaN      游戏类应用流量：近3月大于第一四分位数的月份数                   数值型               moreq25cnt__gprs_flow_game   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                     gprs_flow_game
                              否       NaN             NaN           NaN      通话天数占比_4：近3月大于第一四分位数的月份数                   数值型                moreq25cnt__days_call_p_4   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN  [days_call_p_4, days_call_p_3, days_gprs, days...
                              是       NaN             NaN           NaN            当月arpu：近3月大于第一四分位数的月份数                   数值型                         moreq25cnt__arpu   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                               arpu
                              是       NaN             NaN           NaN  主叫异网对端号码个数：近3月大于第一四分位数的月份数......           数值型             moreq25cnt__nos_calling_diff   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                   nos_calling_diff
                              是       NaN             NaN           NaN        主叫通话次数：近3月大于第一四分位数的月份数                   数值型                  moreq25cnt__calling_cnt   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                        calling_cnt
                              是       NaN             NaN           NaN      视频类应用流量：近3月大于第一四分位数的月份数                   数值型              moreq25cnt__gprs_flow_video   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                    gprs_flow_video
                              否       NaN             NaN           NaN         帐户编号：近3月取值为其他_countlow的月份数                   数值型       valuecnt__account_id~其他_countlow   自动衍生_py                                                NaN        NaN       否         NaN                  NaN                                         account_id
                              是       NaN             NaN           NaN      是否不限量套餐到达用户：近3月取值为是的月份数                   数值型                  valuecnt__if_nolimit~是   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                         if_nolimit
                              是       NaN             NaN           NaN                  是否5g套餐：近3月取值为是的月份数                   数值型                valuecnt__if_5g_dinner~是   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN                                       if_5g_dinner
                              否       NaN             NaN           NaN                  app偏好：近3月取值为commu的月份数                   数值型        valuecnt__greatest_gprs_app~commu   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN  [greatest_gprs_app, gprs_flow_video, gprs_flow...
                              否       NaN             NaN           NaN                  app偏好：近3月取值为video的月份数                   数值型        valuecnt__greatest_gprs_app~video   自动衍生_py                                                NaN        NaN      NaN         NaN                  NaN  [greatest_gprs_app, gprs_flow_video, gprs_flow..., iv_valid=avg__calling_dura                   0.124648
                   min__call_use                       0.092164
                   max__calling_diff_dura              0.097789
                   moreq25cnt__gprs_flow_5g            0.070556
                   std__call_use                       0.076548
                   account_id~其他_countlow            0.050238
                   avg__monthsremain_last_stop_date    0.070383
                   min__gprs_last_defer                0.232632
                   avg__calling_diff_dura              0.091078
                   min__gprs_flow_video                0.406814
                   gprs_flow_music                     0.214097
                   moreq25cnt__gprs_flow_short         0.362754
                   std__gprs_flow_busy                 0.594602
                   avg__gprs_flow_short                0.355533
                   moreq25cnt__calling_diff_dura       0.055478
                   max__arpu                           0.230226
                   std__calling_dura                   0.068094
                   std__arpu                           0.071250
                   max__monthsremain_last_stop_date    0.066523
                   avg__nos_calling_diff               0.082912
                   moreq25cnt__gprs_last_defer         0.084508
                   grow__nos_calling                   0.083618
                   valuecnt__if_5g_dinner~是           0.097079
                   wave__gprs_flow_music               0.328923
                   gprs_flow_short                     0.257075
                   max__call_use                       0.127588
                   gprs_flow_game                      0.070396
                   sep__gprs_now_rest                  0.243802
                   sep__gprs_flow_video                0.434725
                   max__nos_calling                    0.087727
                   calling_cnt                         0.096362
                   gprs_flow_video                     0.397116
                   min__gprs_now_rest                  0.309660
                   avg__calling_cnt                    0.081242
                   grow__dinner_fee                    0.163497
                   moreq25cnt__nos_calling_diff        0.066922
                   max__calling_diff_cnt               0.082703
                   avg__gprs_now_rest                  0.165984
                   min__nos_calling                    0.085314
                   min__calling_dura                   0.084711
                   avg__gprs_resource                  0.323630
                   grow__calling_cnt                   0.094997
                   gprs_resource                       0.340774
                   sep__nos_calling                    0.053930
                   wave__calling_dura                  0.052596
                   std__gprs_resource                  0.112316
                   min__gprs_flow_roam                 0.144483
                   sep__gprs_flow_5g                   0.071775
                   moreq25cnt__gprs_now_defer          0.075791
                   greatest_gprs_app~commu             0.067031
                   moreq25cnt__calling_cnt             0.052568
                   std__call_dura_roam                 0.066397
                   min__nos_calling_diff               0.067006
                   min__gprs_flow_short                0.265585
                   avg__call_use                       0.092976
                   std__calling_diff_cnt               0.066157
                   grow__gprs_now_defer                0.114592
                   avg__gprs_flow_video                0.459439
                   grow__nos_calling_diff              0.062605
                   avg__gprs_flow_roam                 0.250907
                   max__calling_cnt                    0.083274
                   min__calling_diff_dura              0.080503
                   innet_months                        0.061516
                   min__calling_cnt                    0.086368
                   moreq25cnt__arpu                    0.092971
                   min__gprs_resource                  0.317424
                   std__gprs_flow_short                0.310545
                   wave__gprs_resource                 0.128629
                   avg__gprs_last_defer                0.219940
                   call_use                            0.103060
                   avg__gprs_now_defer                 0.143486
                   avg__gprs_flow_commu                0.502655
                   arpu                                0.247351
                   grow__gprs_flow_video               0.379084
                   std__nos_calling_diff               0.067463
                   gprs_flow_5g                        0.053191
                   avg__calling_diff_cnt               0.085009
                   calling_dura                        0.093657
                   grow__gprs_now_rest                 0.183989
                   std__gprs_now_rest                  0.372830
                   avg__arpu                           0.252304
                   call_dura_roam                      0.065702
                   max__call_dura_roam                 0.067397
                   moreq25cnt__calling_dura            0.061859
                   calling_diff_cnt                    0.078539
                   avg__call_dura_roam                 0.060236
                   grow__calling_diff_dura             0.065670
                   gprs_flow_busy                      0.640149
                   std__gprs_last_defer                0.107210
                   wave__gprs_last_defer               0.116375
                   greatest_gprs_app~video             0.067665
                   max__nos_calling_diff               0.092380
                   nos_calling                         0.086406
                   gprs_flow_roam                      0.172777
                   wave__call_use                      0.054339
                   calling_diff_dura                   0.094923
                   sep__gprs_last_defer                0.050413
                   min__calling_diff_cnt               0.073211
                   std__calling_cnt                    0.061166
                   max__gprs_flow_roam                 0.257581
                   avg__gprs_flow_music                0.281002
                   sep__gprs_flow_commu                0.452794
                   min__days_call_p_4                  0.053124
                   grow__call_use                      0.079147
                   max__gprs_last_defer                0.229771
                   std__calling_diff_dura              0.060281
                   std__nos_calling                    0.061217
                   gprs_flow_commu                     0.442128
                   wave__gprs_flow_5g                  0.060695
                   max__gprs_now_rest                  0.221701
                   nos_calling_diff                    0.077742
                   moreq25cnt__gprs_flow_video         0.442146
                   wave__gprs_now_defer                0.078907
                   grow__gprs_last_defer               0.185916
                   max__gprs_flow_5g                   0.081452
                   more0cnt__calling_cnt               0.056236
                   moreq25cnt__gprs_flow_busy          0.071295
                   sep__calling_diff_dura              0.055311
                   moreq25cnt__gprs_resource           0.074563
                   min__arpu                           0.260165
                   std__gprs_flow_commu                0.445250
                   gprs_last_defer                     0.256407
                   gprs_now_defer                      0.134162
                   avg__gprs_flow_busy                 0.683252
                   avg__nos_calling                    0.084577
                   min__gprs_flow_busy                 0.576946
                   max__calling_dura                   0.126012
                   gprs_now_rest                       0.367676
                   wave__gprs_now_rest                 0.266596
                   grow__gprs_flow_commu               0.355029
                   min__gprs_flow_commu                0.394022
                   avg__gprs_flow_game                 0.115994
                   min__gprs_flow_music                0.168713
                   min__gprs_flow_game                 0.081840
                   valuecnt__if_nolimit~是             0.115105
                   moreq25cnt__nos_calling             0.065104
                   wave__calling_cnt                   0.050139
                   days_call_p_4                       0.050213
                   grow__calling_dura                  0.079176
                   dtype: float64, iv_init=innet_months                   0.061516
                   age                            0.047005
                   dinner_fee                     0.161811
                   gprs_last_defer                0.256407
                   gprs_resource                  0.340774
                   gprs_now_rest                  0.367676
                   call_use                       0.103060
                   arpu                           0.247351
                   acct_balance                   0.039276
                   calling_cnt                    0.096362
                   calling_dura                   0.093657
                   called_cnt                     0.035127
                   calling_diff_cnt               0.078539
                   calling_diff_dura              0.094923
                   gprs_flow                      0.640149
                   gprs_flow_4g                   0.638354
                   gprs_flow_5g                   0.053191
                   gprs_flow_busy                 0.640149
                   gprs_now_defer                 0.134162
                   gprs_flow_roam                 0.172777
                   call_dura_roam                 0.065702
                   days_gprs                      0.035353
                   days_call                      0.046825
                   nos_call                       0.043138
                   nos_calling                    0.086406
                   nos_calling_diff               0.077742
                   gprs_flow_video                0.397116
                   gprs_flow_short                0.257075
                   gprs_flow_music                0.214097
                   gprs_flow_commu                0.442128
                   gprs_flow_game                 0.070396
                   monthsaready_last_stop_date    0.068874
                   monthsremain_last_stop_date    0.068874
                   days_gprs_p                    0.035353
                   days_call_p                    0.046825
                   days_call_p_1                  0.050213
                   days_call_p_2                  0.050213
                   days_call_p_3                  0.050213
                   days_call_p_4                  0.050213
                   account_id~30100000000000      0.050238
                   account_id~其他_countlow       0.050238
                   if_nolimit~否                  0.112470
                   if_nolimit~是                  0.112470
                   if_5g_dinner~否                0.096116
                   if_5g_dinner~是                0.096116
                   greatest_gprs_app~commu        0.067031
                   greatest_gprs_app~video        0.067665
                   dtype: float64, iv_all=innet_months                             0.061516
                   age                                      0.047005
                   dinner_fee                               0.161811
                   gprs_last_defer                          0.256407
                   gprs_resource                            0.340774
                   gprs_now_rest                            0.367676
                   call_use                                 0.103060
                   arpu                                     0.247351
                   acct_balance                             0.039276
                   calling_cnt                              0.096362
                   calling_dura                             0.093657
                   called_cnt                               0.035127
                   calling_diff_cnt                         0.078539
                   calling_diff_dura                        0.094923
                   gprs_flow                                0.640149
                   gprs_flow_4g                             0.638354
                   gprs_flow_5g                             0.053191
                   gprs_flow_busy                           0.640149
                   gprs_now_defer                           0.134162
                   gprs_flow_roam                           0.172777
                   call_dura_roam                           0.065702
                   days_gprs                                0.035353
                   days_call                                0.046825
                   nos_call                                 0.043138
                   nos_calling                              0.086406
                   nos_calling_diff                         0.077742
                   gprs_flow_video                          0.397116
                   gprs_flow_short                          0.257075
                   gprs_flow_music                          0.214097
                   gprs_flow_commu                          0.442128
                   gprs_flow_game                           0.070396
                   monthsaready_last_stop_date              0.068874
                   monthsremain_last_stop_date              0.068874
                   days_gprs_p                              0.035353
                   days_call_p                              0.046825
                   days_call_p_1                            0.050213
                   days_call_p_2                            0.050213
                   days_call_p_3                            0.050213
                   days_call_p_4                            0.050213
                   account_id~30100000000000                0.050238
                   account_id~其他_countlow                 0.050238
                   if_nolimit~否                            0.112470
                   if_nolimit~是                            0.112470
                   if_5g_dinner~否                          0.096116
                   if_5g_dinner~是                          0.096116
                   greatest_gprs_app~commu                  0.067031
                   greatest_gprs_app~video                  0.067665
                   avg__gprs_flow_5g                        0.080151
                   avg__calling_dura                        0.124648
                   avg__gprs_resource                       0.323630
                   avg__call_dura_roam                      0.060236
                   avg__calling_diff_cnt                    0.085009
                   avg__gprs_flow_busy                      0.683252
                   avg__gprs_flow_music                     0.281002
                   avg__gprs_last_defer                     0.219940
                   avg__gprs_now_defer                      0.143486
                   avg__nos_calling                         0.084577
                   avg__gprs_flow_roam                      0.250907
                   avg__calling_diff_dura                   0.091078
                   avg__gprs_now_rest                       0.165984
                   avg__monthsremain_last_stop_date         0.070383
                   avg__dinner_fee                          0.157052
                   avg__gprs_flow_short                     0.355533
                   avg__gprs_flow_commu                     0.502655
                   avg__call_use                            0.092976
                   avg__gprs_flow_game                      0.115994
                   avg__days_call_p_4                       0.047994
                   avg__arpu                                0.252304
                   avg__nos_calling_diff                    0.082912
                   avg__calling_cnt                         0.081242
                   avg__gprs_flow_video                     0.459439
                   sep__gprs_flow_5g                        0.071775
                   sep__calling_dura                        0.047647
                   sep__gprs_resource                       0.127648
                   sep__calling_diff_cnt                    0.049050
                   sep__gprs_flow_busy                      0.036951
                   sep__gprs_flow_music                     0.325491
                   sep__gprs_last_defer                     0.050413
                   sep__nos_calling                         0.053930
                   sep__gprs_flow_roam                      0.046591
                   sep__calling_diff_dura                   0.055311
                   sep__gprs_now_rest                       0.243802
                   sep__monthsremain_last_stop_date         0.043488
                   sep__gprs_flow_short                     0.346920
                   sep__gprs_flow_commu                     0.452794
                   sep__gprs_flow_game                      0.115994
                   sep__nos_calling_diff                    0.048364
                   sep__calling_cnt                         0.033183
                   sep__gprs_flow_video                     0.434725
                   wave__gprs_flow_5g                       0.060695
                   wave__calling_dura                       0.052596
                   wave__gprs_resource                      0.128629
                   wave__calling_diff_cnt                   0.043753
                   wave__gprs_flow_music                    0.328923
                   wave__gprs_last_defer                    0.116375
                   wave__gprs_now_defer                     0.078907
                   wave__nos_calling                        0.042382
                   wave__gprs_flow_roam                     0.031306
                   wave__gprs_now_rest                      0.266596
                   wave__monthsremain_last_stop_date        0.043488
                   wave__dinner_fee                         0.031488
                   wave__gprs_flow_short                    0.348210
                   wave__gprs_flow_commu                    0.428380
                   wave__call_use                           0.054339
                   wave__gprs_flow_game                     0.098435
                   wave__nos_calling_diff                   0.042477
                   wave__calling_cnt                        0.050139
                   wave__gprs_flow_video                    0.410231
                   grow__gprs_flow_5g                       0.052332
                   grow__calling_dura                       0.079176
                   grow__gprs_resource                      0.339376
                   grow__call_dura_roam                     0.048738
                   grow__calling_diff_cnt                   0.063725
                   grow__gprs_flow_busy                     0.580586
                   grow__gprs_flow_music                    0.214097
                   grow__gprs_last_defer                    0.185916
                   grow__gprs_now_defer                     0.114592
                   grow__nos_calling                        0.083618
                   grow__gprs_flow_roam                     0.044482
                   grow__calling_diff_dura                  0.065670
                   grow__gprs_now_rest                      0.183989
                   grow__monthsremain_last_stop_date        0.068874
                   grow__dinner_fee                         0.163497
                   grow__gprs_flow_short                    0.248854
                   grow__gprs_flow_commu                    0.355029
                   grow__call_use                           0.079147
                   grow__gprs_flow_game                     0.070396
                   grow__days_call_p_4                      0.036802
                   grow__arpu                               0.237642
                   grow__nos_calling_diff                   0.062605
                   grow__calling_cnt                        0.094997
                   grow__gprs_flow_video                    0.379084
                   max__gprs_flow_5g                        0.081452
                   max__calling_dura                        0.126012
                   max__gprs_resource                       0.332672
                   max__call_dura_roam                      0.067397
                   max__calling_diff_cnt                    0.082703
                   max__gprs_flow_busy                      0.675914
                   max__gprs_flow_music                     0.281002
                   max__gprs_last_defer                     0.229771
                   max__gprs_now_defer                      0.132632
                   max__nos_calling                         0.087727
                   max__gprs_flow_roam                      0.257581
                   max__calling_diff_dura                   0.097789
                   max__gprs_now_rest                       0.221701
                   max__monthsremain_last_stop_date         0.066523
                   max__dinner_fee                          0.158578
                   max__gprs_flow_short                     0.346169
                   max__gprs_flow_commu                     0.481479
                   max__call_use                            0.127588
                   max__gprs_flow_game                      0.115994
                   max__days_call_p_4                       0.040011
                   max__arpu                                0.230226
                   max__nos_calling_diff                    0.092380
                   max__calling_cnt                         0.083274
                   max__gprs_flow_video                     0.435602
                   min__gprs_flow_5g                        0.046908
                   min__calling_dura                        0.084711
                   min__gprs_resource                       0.317424
                   min__call_dura_roam                      0.046443
                   min__calling_diff_cnt                    0.073211
                   min__gprs_flow_busy                      0.576946
                   min__gprs_flow_music                     0.168713
                   min__gprs_last_defer                     0.232632
                   min__gprs_now_defer                      0.133478
                   min__nos_calling                         0.085314
                   min__gprs_flow_roam                      0.144483
                   min__calling_diff_dura                   0.080503
                   min__gprs_now_rest                       0.309660
                   min__monthsremain_last_stop_date         0.068490
                   min__dinner_fee                          0.153039
                   min__gprs_flow_short                     0.265585
                   min__gprs_flow_commu                     0.394022
                   min__call_use                            0.092164
                   min__gprs_flow_game                      0.081840
                   min__days_call_p_4                       0.053124
                   min__arpu                                0.260165
                   min__nos_calling_diff                    0.067006
                   min__calling_cnt                         0.086368
                   min__gprs_flow_video                     0.406814
                   std__gprs_flow_5g                        0.081452
                   std__calling_dura                        0.068094
                   std__gprs_resource                       0.112316
                   std__call_dura_roam                      0.066397
                   std__calling_diff_cnt                    0.066157
                   std__gprs_flow_busy                      0.594602
                   std__gprs_flow_music                     0.281002
                   std__gprs_last_defer                     0.107210
                   std__nos_calling                         0.061217
                   std__gprs_flow_roam                      0.254584
                   std__calling_diff_dura                   0.060281
                   std__gprs_now_rest                       0.372830
                   std__monthsremain_last_stop_date         0.044365
                   std__gprs_flow_short                     0.310545
                   std__gprs_flow_commu                     0.445250
                   std__call_use                            0.076548
                   std__gprs_flow_game                      0.115994
                   std__arpu                                0.071250
                   std__nos_calling_diff                    0.067463
                   std__calling_cnt                         0.061166
                   std__gprs_flow_video                     0.423620
                   more0cnt__gprs_flow_5g                   0.070556
                   more0cnt__calling_dura                   0.056236
                   more0cnt__call_dura_roam                 0.036220
                   more0cnt__calling_diff_cnt               0.055478
                   more0cnt__gprs_flow_music                0.324117
                   more0cnt__gprs_last_defer                0.084508
                   more0cnt__gprs_now_defer                 0.075791
                   more0cnt__nos_calling                    0.049666
                   more0cnt__gprs_flow_roam                 0.043240
                   more0cnt__calling_diff_dura              0.055478
                   more0cnt__monthsremain_last_stop_date    0.039204
                   more0cnt__gprs_flow_short                0.362754
                   more0cnt__gprs_flow_commu                0.429095
                   more0cnt__call_use                       0.039715
                   more0cnt__gprs_flow_game                 0.115994
                   more0cnt__nos_calling_diff               0.066922
                   more0cnt__calling_cnt                    0.056236
                   more0cnt__gprs_flow_video                0.442146
                   moreq25cnt__gprs_flow_5g                 0.070556
                   moreq25cnt__calling_dura                 0.061859
                   moreq25cnt__gprs_resource                0.074563
                   moreq25cnt__call_dura_roam               0.036220
                   moreq25cnt__calling_diff_cnt             0.055478
                   moreq25cnt__gprs_flow_busy               0.071295
                   moreq25cnt__gprs_flow_music              0.324117
                   moreq25cnt__gprs_last_defer              0.084508
                   moreq25cnt__gprs_now_defer               0.075791
                   moreq25cnt__nos_calling                  0.065104
                   moreq25cnt__gprs_flow_roam               0.043240
                   moreq25cnt__calling_diff_dura            0.055478
                   moreq25cnt__dinner_fee                   0.035760
                   moreq25cnt__gprs_flow_short              0.362754
                   moreq25cnt__gprs_flow_commu              0.429095
                   moreq25cnt__call_use                     0.039715
                   moreq25cnt__gprs_flow_game               0.115994
                   moreq25cnt__arpu                         0.092971
                   moreq25cnt__nos_calling_diff             0.066922
                   moreq25cnt__calling_cnt                  0.052568
                   moreq25cnt__gprs_flow_video              0.442146
                   valuecnt__if_nolimit~是                  0.115105
                   valuecnt__if_5g_dinner~是                0.097079
                   valuecnt__greatest_gprs_app~commu        0.044276
                   valuecnt__greatest_gprs_app~video        0.049793
                   dtype: float64, woe_accum_df=                                                              value     0     1       woe    weight  woe_weight   ALL
                   max__gprs_flow_busy                               (23156776.0, inf]    21   101  2.263745  0.083028    0.187953   122
                   gprs_flow                                         (11184921.5, inf]    36   152  2.133509  0.122936    0.262285   188
                   gprs_flow_4g                                      (11182813.5, inf]    36   152  2.133509  0.122936    0.262285   188
                   gprs_flow_busy                                    (11184921.5, inf]    36   152  2.133509  0.122936    0.262285   188
                   min__gprs_flow_game                                      (0.5, inf]    14    51  1.985915  0.040367    0.080165    65
                   avg__gprs_flow_busy                                (9385382.0, inf]    54   191  1.956437  0.150459    0.294363   245
                   min__gprs_flow_busy                                (1020372.5, inf]   109   326  1.788697  0.249083    0.445533   435
                   gprs_flow_video                                        (601.5, inf]    61   176  1.752757  0.133486    0.233969   237
                   min__gprs_flow_video                                     (1.5, inf]   104   281  1.687111  0.210092    0.354448   385
                   avg__gprs_flow_video                                   (599.5, inf]    88   237  1.683871  0.177064    0.298153   325
                   sep__gprs_flow_video                           (0.004066, 0.837428]    68   183  1.683126  0.136697    0.230079   251
                   wave__gprs_flow_video                              (-inf, 0.998648]    37    95  1.636106  0.070183    0.114828   132
                   min__gprs_flow_short                                     (2.5, inf]    80   202  1.619388  0.148624    0.240680   282
                   moreq25cnt__gprs_flow_video                              (2.5, inf]   119   289  1.580450  0.210550    0.332765   408
                   more0cnt__gprs_flow_video                                (2.5, inf]   119   289  1.580450  0.210550    0.332765   408
                   max__gprs_flow_video                                  (1002.0, inf]   104   251  1.574209  0.182569    0.287401   355
                   max__gprs_flow_short                                  (1594.0, inf]    68   163  1.567390  0.118349    0.185498   231
                   wave__gprs_flow_commu                              (-inf, 0.994117]    63   149  1.553959  0.107798    0.167514   212
                   min__gprs_flow_roam                                 (393134.0, inf]    52   122  1.545925  0.088073    0.136155   174
                   more0cnt__gprs_flow_short                                (2.5, inf]    88   206  1.543687  0.148624    0.229429   294
                   moreq25cnt__gprs_flow_short                              (2.5, inf]    88   206  1.543687  0.148624    0.229429   294
                   min__gprs_flow_music                                     (0.5, inf]    61   142  1.538100  0.102294    0.157338   203
                   min__gprs_flow_commu                                     (2.5, inf]   134   307  1.522155  0.220183    0.335153   441
                   std__gprs_flow_video                              (409.303696, inf]   110   252  1.522096  0.180734    0.275094   362
                   avg__gprs_flow_short                              (398.666656, inf]    95   213  1.500562  0.151835    0.227838   308
                   sep__gprs_flow_commu                           (0.008387, 0.830262]   115   256  1.493392  0.182110    0.271962   371
                   gprs_flow_commu                                         (18.5, inf]   146   321  1.480982  0.227523    0.336957   467
                   wave__gprs_flow_short                              (-inf, 0.999076]    31    68  1.478668  0.048165    0.071220    99
                   wave__gprs_flow_music                           (1.00298, 2.936283]   100   215  1.458615  0.151376    0.220800   315
                   grow__gprs_flow_busy                                  (0.1589, inf]   199   422  1.444848  0.295872    0.427489   621
                   avg__gprs_flow_commu                               (31.166666, inf]   191   384  1.391516  0.264679    0.368305   575
                   sep__gprs_flow_music                           (0.048622, 1.677646]   123   247  1.390351  0.170183    0.236615   370
                   min__gprs_flow_5g                                      (0.085, inf]    24    48  1.386294  0.033028    0.045786    72
                   moreq25cnt__gprs_flow_music                              (1.5, inf]   127   251  1.374413  0.172018    0.236424   378
                   more0cnt__gprs_flow_music                                (1.5, inf]   127   251  1.374413  0.172018    0.236424   378
                   grow__gprs_flow_video                          (0.001971, 5.992467]   169   330  1.362341  0.225229    0.306839   499
                   moreq25cnt__gprs_flow_commu                              (2.5, inf]   193   350  1.288390  0.232569    0.299639   543
                   more0cnt__gprs_flow_commu                                (2.5, inf]   193   350  1.288390  0.232569    0.299639   543
                   std__gprs_flow_busy                                (1330688.0, inf]   238   430  1.284662  0.285321    0.366541   668
                   sep__gprs_flow_short                            (0.01915, 1.525217]   160   287  1.277456  0.189908    0.242599   447
                   if_nolimit~是                                                     1    70   125  1.272966  0.082569    0.105107   195
                   if_nolimit~否                                                     0    70   125  1.272966  0.082569    0.105107   195
                   max__gprs_flow_commu                                    (34.5, inf]   247   439  1.268258  0.289450    0.367097   686
                   valuecnt__if_nolimit~是                                  (0.5, inf]    74   130  1.256617  0.085321    0.107216   204
                   grow__gprs_flow_music                               (0.000898, inf]   132   230  1.248425  0.150459    0.187836   362
                   gprs_flow_music                                          (0.5, inf]   132   230  1.248425  0.150459    0.187836   362
                   grow__gprs_flow_game                           (0.005831, 6.833333]    49    84  1.232144  0.054587    0.067259   133
                   gprs_flow_game                                         (0.5, 184.0]    49    84  1.232144  0.054587    0.067259   133
                   gprs_flow_short                                          (3.5, inf]   160   274  1.231101  0.177982    0.219113   434
                   if_5g_dinner~否                                                   0    66   113  1.230880  0.073394    0.090340   179
                   if_5g_dinner~是                                                   1    66   113  1.230880  0.073394    0.090340   179
                   more0cnt__gprs_flow_5g                                   (1.5, inf]    50    85  1.223775  0.055046    0.067364   135
                   moreq25cnt__gprs_flow_5g                                 (1.5, inf]    50    85  1.223775  0.055046    0.067364   135
                   wave__gprs_flow_short                           (1.00658, 2.754032]   132   222  1.213023  0.143119    0.173607   354
                   gprs_flow_busy                               (745092.5, 11184921.5]   170   283  1.202796  0.181651    0.218489   453
                   gprs_flow                                    (745092.5, 11184921.5]   170   283  1.202796  0.181651    0.218489   453
                   gprs_flow_4g                                 (744533.0, 11182813.5]   170   283  1.202796  0.181651    0.218489   453
                   valuecnt__if_5g_dinner~是                                (0.5, inf]    71   118  1.201152  0.075688    0.090913   189
                   max__gprs_flow_busy                         (2780353.0, 23156776.0]   231   375  1.177655  0.238073    0.280368   606
                   grow__gprs_flow_short                                (0.00286, inf]   179   286  1.161753  0.180275    0.209435   465
                   avg__gprs_flow_busy                       (1786311.8125, 9385382.0]   171   269  1.146195  0.168349    0.192960   440
                   std__gprs_flow_commu                               (11.888295, inf]   293   460  1.144201  0.287615    0.329089   753
                   sep__gprs_flow_game                                 (0.062775, inf]    95   149  1.143217  0.093119    0.106455   244
                   more0cnt__gprs_flow_game                                 (0.5, inf]    95   149  1.143217  0.093119    0.106455   244
                   max__gprs_flow_game                                      (0.5, inf]    95   149  1.143217  0.093119    0.106455   244
                   std__gprs_flow_game                                 (0.288675, inf]    95   149  1.143217  0.093119    0.106455   244
                   avg__gprs_flow_game                          (0.166666, 194.333336]    95   149  1.143217  0.093119    0.106455   244
                   moreq25cnt__gprs_flow_game                               (0.5, inf]    95   149  1.143217  0.093119    0.106455   244
                   max__call_use                                          (177.5, inf]    75   115  1.120591  0.071101    0.079675   190
                   wave__gprs_flow_game                                  (1.0776, inf]    91   136  1.094943  0.083028    0.090910   227
                   gprs_flow_roam                                      (120006.5, inf]   164   236  1.057113  0.141284    0.149354   400
                   std__gprs_last_defer                              (366.917206, inf]   108   155  1.054441  0.092661    0.097705   263
                   std__gprs_flow_short                               (11.888295, inf]   271   386  1.046866  0.229817    0.240587   657
                   wave__gprs_flow_video                          (1.000855, 2.992258]   222   315  1.043042  0.187156    0.195212   537
                   gprs_last_defer                                       (3142.0, inf]   111   157  1.039863  0.093119    0.096831   268
                   avg__gprs_flow_roam                            (258466.835938, inf]   234   330  1.036919  0.195413    0.202627   564
                   wave__gprs_flow_music                              (-inf, 0.999357]    23    32  1.023389  0.018807    0.019247    55
                   min__gprs_resource                                 (6516309.0, inf]   290   403  1.022203  0.236697    0.241953   693
                   max__gprs_flow_roam                                 (503427.5, inf]   247   343  1.021489  0.201376    0.205704   590
                   grow__gprs_flow_commu                               (0.008936, inf]   318   440  1.017871  0.257798    0.262405   758
                   std__gprs_flow_roam                            (243320.039062, inf]   249   343  1.013425  0.200459    0.203150   592
                   avg__gprs_resource                                 (7992786.0, inf]   307   418  1.001781  0.242661    0.243093   725
                   max__gprs_flow_5g                                        (0.6, inf]    97   131  0.993634  0.075688    0.075206   228
                   std__gprs_flow_5g                                    (0.34641, inf]    97   131  0.993634  0.075688    0.075206   228
                   std__gprs_now_rest                             (108754.894531, inf]   347   468  0.992291  0.270183    0.268101   815
                   std__gprs_flow_music                                (0.288675, inf]   282   380  0.991411  0.219266    0.217383   662
                   max__gprs_flow_music                                     (0.5, inf]   282   380  0.991411  0.219266    0.217383   662
                   avg__gprs_flow_music                                (0.166666, inf]   282   380  0.991411  0.219266    0.217383   662
                   avg__gprs_flow_5g                                        (0.2, inf]    98   131  0.983377  0.075229    0.073979   229
                   avg__gprs_last_defer                             (3141.166748, inf]   122   163  0.982876  0.093578    0.091976   285
                   max__gprs_last_defer                                  (3142.0, inf]   138   184  0.980829  0.105505    0.103482   322
                   grow__gprs_resource                                 (0.134127, inf]   347   453  0.959715  0.256422    0.246092   800
                   gprs_resource                                      (6291466.5, inf]   349   455  0.958373  0.257339    0.246627   804
                   grow__gprs_last_defer                               (1.147469, inf]    70    91  0.955511  0.051376    0.049090   161
                   grow__dinner_fee                                     (0.82007, inf]   202   260  0.945561  0.145872    0.137930   462
                   gprs_flow_5g                                           (0.035, inf]    74    95  0.942959  0.053211    0.050176   169
                   dinner_fee                                            (58.225, inf]   206   262  0.933616  0.145872    0.136188   468
                   gprs_flow_video                                        (3.5, 601.5]   143   181  0.928800  0.100459    0.093306   324
                   grow__gprs_flow_5g                                   (4.7e-05, inf]    76    96  0.926762  0.053211    0.049314   172
                   min__dinner_fee                                    (58.165001, inf]   202   254  0.922214  0.140367    0.129448   456
                   avg__dinner_fee                                       (58.225, inf]   207   260  0.921110  0.143578    0.132251   467
                   max__dinner_fee                                       (58.225, inf]   214   266  0.910667  0.145872    0.132840   480
                   max__gprs_resource                                 (6291466.5, inf]   380   472  0.909955  0.258716    0.235420   852
                   min__gprs_last_defer                                  (3142.0, inf]    92   113  0.898746  0.061468    0.055244   205
                   sep__gprs_resource                                (3e-06, 0.247643]   169   206  0.891125  0.111468    0.099332   375
                   wave__gprs_resource                                (1e-06, 0.42893]   171   208  0.889022  0.112385    0.099913   379
                   sep__gprs_flow_5g                                   (0.094645, inf]   114   138  0.884202  0.074312    0.065707   252
                   sep__gprs_flow_video                            (0.837428, 1.72535]   191   227  0.865824  0.120642    0.104455   418
                   wave__gprs_flow_5g                                  (1.219963, inf]   104   123  0.860941  0.065138    0.056080   227
                   wave__gprs_flow_commu                          (1.014323, 2.983083]   272   320  0.855666  0.168807    0.144443   592
                   std__call_use                                      (19.918584, inf]   138   159  0.834798  0.082569    0.068928   297
                   std__monthsremain_last_stop_date                   (-inf, 0.788675]    90   101  0.808458  0.051376    0.041535   191
                   greatest_gprs_app~commu                                           1   132   148  0.807558  0.075229    0.060752   280
                   max__gprs_flow_short                                 (14.5, 1594.0]   213   231  0.774273  0.114220    0.088438   444
                   min__call_use                                           (58.5, inf]   193   209  0.772791  0.103211    0.079761   402
                   avg__call_use                                      (65.833332, inf]   211   222  0.743966  0.106881    0.079516   433
                   greatest_gprs_app~video                                           0   161   169  0.741642  0.081193    0.060216   330
                   max__gprs_now_rest                                (12582921.5, inf]   441   454  0.722200  0.214220    0.154710   895
                   avg__arpu                                          (54.821667, inf]   422   429  0.709599  0.200000    0.141920   851
                   gprs_now_rest                                     (12582921.5, inf]   414   417  0.700367  0.192661    0.134933   831
                   min__arpu                                          (38.950001, inf]   474   476  0.697358  0.219266    0.152907   950
                   grow__gprs_now_rest                                 (0.299269, inf]   414   415  0.695560  0.190826    0.132731   829
                   min__gprs_now_rest                           (245476.0, 10485963.0]   190   189  0.687870  0.086239    0.059321   379
                   valuecnt__greatest_gprs_app~video                       (-inf, 1.5]   145   144  0.686227  0.065596    0.045014   289
                   avg__gprs_flow_short                         (6.833333, 398.666656]   181   179  0.682036  0.081193    0.055376   360
                   avg__calling_dura                                      (126.5, inf]   235   232  0.680299  0.105046    0.071463   467
                   max__calling_dura                                      (148.5, inf]   248   244  0.676887  0.110092    0.074520   492
                   sep__gprs_flow_commu                           (0.830262, 1.717421]   220   214  0.665496  0.095413    0.063497   434
                   sep__gprs_now_rest                                  (0.005665, inf]   558   536  0.652922  0.235780    0.153946  1094
                   avg__gprs_flow_video                                  (20.5, 599.5]   219   210  0.651183  0.092202    0.060040   429
                   max__gprs_flow_video                                 (62.5, 1002.0]   192   184  0.650588  0.080734    0.052525   376
                   std__gprs_flow_video                        (27.570754, 409.303696]   201   190  0.636866  0.082110    0.052293   391
                   gprs_now_rest                                (245768.5, 10492399.0]   165   155  0.630627  0.066514    0.041945   320
                   max__call_dura_roam                                    (115.5, inf]   233   217  0.622006  0.092202    0.057350   450
                   call_use                                                (37.5, inf]   339   313  0.613350  0.131651    0.080748   652
                   avg__gprs_now_rest                                (11101323.5, inf]   489   449  0.607808  0.187615    0.114034   938
                   std__gprs_resource                              (38780.330078, inf]   376   343  0.601288  0.142202    0.085504   719
                   avg__gprs_now_defer                            (11514762752.0, inf]   148   134  0.593775  0.055046    0.032685   282
                   grow__arpu                                          (0.606771, inf]   648   583  0.587444  0.237615    0.139585  1231
                   min__gprs_now_rest                                (12582916.5, inf]   385   346  0.586343  0.140826    0.082572   731
                   arpu                                                  (29.125, inf]   675   603  0.580352  0.243578    0.141361  1278
                   moreq25cnt__gprs_flow_short                              (0.5, 2.5]   260   230  0.570545  0.091743    0.052344   490
                   more0cnt__gprs_flow_short                                (0.5, 2.5]   260   230  0.570545  0.091743    0.052344   490
                   wave__gprs_now_rest                                 (0.009812, inf]   735   645  0.562527  0.254587    0.143212  1380
                   min__gprs_now_defer                            (11798577152.0, inf]   143   125  0.558616  0.049083    0.027418   268
                   min__calling_cnt                                        (26.5, inf]   382   326  0.534624  0.123853    0.066215   708
                   gprs_now_defer                                 (11798577152.0, inf]   154   131  0.531392  0.049541    0.026326   285
                   min__calling_dura                                       (53.5, inf]   386   327  0.527270  0.122936    0.064820   713
                   avg__gprs_flow_commu                         (11.166667, 31.166666]    89    75  0.521999  0.027982    0.014606   164
                   max__arpu                                              (29.16, inf]   767   642  0.515249  0.237156    0.122194  1409
                   wave__gprs_flow_music                               (2.936283, inf]   159   133  0.514592  0.049083    0.025258   292
                   sep__gprs_flow_music                                (1.677646, inf]   159   133  0.514592  0.049083    0.025258   292
                   avg__call_dura_roam                                (46.833334, inf]   310   259  0.513403  0.095413    0.048985   569
                   more0cnt__gprs_flow_music                                (0.5, 1.5]   155   129  0.509534  0.047248    0.024074   284
                   moreq25cnt__gprs_flow_music                              (0.5, 1.5]   155   129  0.509534  0.047248    0.024074   284
                   moreq25cnt__gprs_flow_video                              (1.5, 2.5]   146   121  0.505331  0.044037    0.022253   267
                   more0cnt__gprs_flow_video                                (1.5, 2.5]   146   121  0.505331  0.044037    0.022253   267
                   sep__monthsremain_last_stop_date                    (-0.01005, inf]   247   204  0.501879  0.073853    0.037065   451
                   wave__monthsremain_last_stop_date                  (-0.020101, inf]   247   204  0.501879  0.073853    0.037065   451
                   std__calling_dura                                  (21.650635, inf]   364   299  0.496437  0.107339    0.053287   663
                   avg__calling_cnt                                        (32.5, inf]   423   346  0.492214  0.123394    0.060736   769
                   innet_months                                           (-inf, 86.5]   346   282  0.488615  0.100000    0.048862   628
                   moreq25cnt__gprs_flow_commu                              (1.5, 2.5]   149   121  0.484991  0.042661    0.020690   270
                   more0cnt__gprs_flow_commu                                (1.5, 2.5]   149   121  0.484991  0.042661    0.020690   270
                   max__calling_diff_dura                                  (25.5, inf]   498   404  0.483962  0.142202    0.068820   902
                   avg__calling_diff_dura                             (19.166666, inf]   475   385  0.483076  0.135321    0.065370   860
                   calling_dura                                            (53.5, inf]   485   393  0.482808  0.138073    0.066663   878
                   max__gprs_now_defer                            (11798577152.0, inf]   177   143  0.479842  0.050000    0.023992   320
                   more0cnt__monthsremain_last_stop_date                    (0.5, inf]   251   202  0.475962  0.070183    0.033405   453
                   std__call_dura_roam                                (22.105774, inf]   397   317  0.468113  0.108716    0.050891   714
                   avg__calling_diff_cnt                               (9.166667, inf]   479   382  0.466867  0.130734    0.061035   861
                   sep__gprs_flow_short                                (1.525217, inf]   186   148  0.464613  0.050459    0.023444   334
                   nos_calling                                             (10.5, inf]   489   389  0.464364  0.132569    0.061560   878
                   gprs_flow_commu                                         (1.5, 18.5]   117    93  0.463573  0.031651    0.014673   210
                   sep__gprs_last_defer                                (0.165163, inf]   326   259  0.463078  0.088073    0.040785   585
                   max__monthsremain_last_stop_date                        (-0.5, inf]   407   323  0.461986  0.109633    0.050649   730
                   calling_diff_dura                                       (15.5, inf]   532   421  0.459137  0.142202    0.065290   953
                   wave__gprs_flow_short                               (2.754032, inf]   185   146  0.456398  0.049083    0.022401   331
                   std__arpu                                           (3.605552, inf]   449   352  0.449755  0.116972    0.052609   801
                   acct_balance                                           (-inf, 2.76]   289   225  0.442821  0.073853    0.032704   514
                   days_call_p_4                                     (120.816669, inf]   355   276  0.441430  0.090367    0.039891   631
                   days_call_p_3                                      (90.816669, inf]   355   276  0.441430  0.090367    0.039891   631
                   days_call_p_2                                      (60.816666, inf]   355   276  0.441430  0.090367    0.039891   631
                   days_call_p_1                                      (30.816666, inf]   355   276  0.441430  0.090367    0.039891   631
                   call_dura_roam                                          (19.5, inf]   441   342  0.438913  0.111468    0.048925   783
                   min__calling_diff_cnt                                    (5.5, inf]   491   378  0.431597  0.121560    0.052465   869
                   wave__dinner_fee                                    (0.000215, inf]   252   194  0.431576  0.062385    0.026924   446
                   valuecnt__greatest_gprs_app~commu                        (0.5, inf]   337   259  0.429892  0.083028    0.035693   596
                   min__calling_diff_dura                                   (8.5, inf]   546   416  0.421213  0.131193    0.055260   962
                   avg__monthsremain_last_stop_date                   (-3.166667, inf]   517   390  0.411251  0.120642    0.049614   907
                   min__days_call_p_4                                (120.655914, inf]   427   321  0.407804  0.098624    0.040219   748
                   min__monthsremain_last_stop_date                        (-4.5, inf]   515   387  0.407405  0.118807    0.048403   902
                   avg__days_call_p_4                                (122.058964, inf]   402   301  0.403805  0.091743    0.037046   703
                   std__calling_cnt                                    (6.639528, inf]   491   366  0.399336  0.110550    0.044147   857
                   std__gprs_flow_busy                      (156108.882812, 1330688.0]   265   197  0.396621  0.059174    0.023470   462
                   monthsaready_last_stop_date                             (-inf, 4.5]   550   407  0.392042  0.121101    0.047477   957
                   monthsremain_last_stop_date                             (-4.5, inf]   550   407  0.392042  0.121101    0.047477   957
                   grow__monthsremain_last_stop_date                       (-3.0, inf]   550   407  0.392042  0.121101    0.047477   957
                   moreq25cnt__gprs_now_defer                              (-inf, 0.5]   590   436  0.390667  0.129358    0.050536  1026
                   more0cnt__gprs_now_defer                                (-inf, 0.5]   590   436  0.390667  0.129358    0.050536  1026
                   max__gprs_now_defer                               (-inf, 5242880.0]   590   436  0.390667  0.129358    0.050536  1026
                   avg__gprs_now_defer                             (-inf, 1747626.625]   590   436  0.390667  0.129358    0.050536  1026
                   account_id~其他_countlow                                          0   443   327  0.389538  0.096789    0.037703   770
                   account_id~30100000000000                                         1   443   327  0.389538  0.096789    0.037703   770
                   grow__call_dura_roam                                (0.460983, inf]   453   331  0.379373  0.095872    0.036371   784
                   min__call_dura_roam                                      (5.5, inf]   440   321  0.377814  0.092661    0.035008   761
                   nos_calling_diff                                         (3.5, inf]   634   462  0.376663  0.133028    0.050107  1096
                   std__calling_diff_cnt                               (2.598076, inf]   573   417  0.375348  0.119725    0.044938   990
                   gprs_now_defer                                    (-inf, 5242880.0]   624   454  0.375094  0.130275    0.048865  1078
                   grow__gprs_now_defer                               (-inf, 0.000484]   624   454  0.375094  0.130275    0.048865  1078
                   min__gprs_flow_busy                           (106666.5, 1020372.5]   187   136  0.374693  0.038991    0.014610   323
                   calling_diff_cnt                                         (5.5, inf]   651   472  0.371617  0.134404    0.049947  1123
                   max__calling_diff_cnt                                    (7.5, inf]   677   490  0.369881  0.138991    0.051410  1167
                   wave__gprs_now_defer                                (0.032841, inf]   667   481  0.366224  0.135321    0.049558  1148
                   max__nos_calling                                        (10.5, inf]   715   515  0.365032  0.144495    0.052745  1230
                   min__gprs_now_defer                               (-inf, 5242880.0]   643   463  0.364730  0.129817    0.047348  1106
                   max__calling_cnt                                        (19.5, inf]   704   505  0.360927  0.140367    0.050662  1209
                   grow__calling_cnt                                    (0.59512, inf]   767   549  0.358759  0.151835    0.054472  1316
                   max__call_use                                         (37.5, 177.5]   327   234  0.358508  0.064679    0.023188   561
                   max__nos_calling_diff                                    (4.5, inf]   760   543  0.356938  0.149541    0.053377  1303
                   grow__call_use                                      (0.285834, inf]   702   500  0.353822  0.136697    0.048366  1202
                   wave__gprs_last_defer                               (0.269489, inf]   890   630  0.347646  0.169725    0.059004  1520
                   avg__nos_calling_diff                               (2.833333, inf]   769   539  0.337772  0.141743    0.047877  1308
                   nos_call                                                (25.5, inf]   513   358  0.333404  0.093119    0.031046   871
                   wave__calling_cnt                                  (-inf, 0.372334]   574   400  0.331982  0.103670    0.034417   974
                   min__nos_calling                                         (3.5, inf]   805   560  0.330242  0.144495    0.047718  1365
                   days_call_p                                         (0.816667, inf]   552   384  0.330242  0.099083    0.032721   936
                   days_call                                               (24.5, inf]   552   384  0.330242  0.099083    0.032721   936
                   grow__gprs_last_defer                              (-inf, 0.000976]   663   460  0.327599  0.117890    0.038621  1123
                   min__nos_calling_diff                                    (1.5, inf]   708   491  0.327147  0.125688    0.041119  1199
                   gprs_last_defer                                         (-inf, 1.5]   665   461  0.326758  0.117890    0.038521  1126
                   max__days_call_p_4                                (124.725807, inf]   502   348  0.326750  0.088991    0.029078   850
                   min__gprs_last_defer                                    (-inf, 1.5]   821   569  0.326505  0.145413    0.047478  1390
                   avg__nos_calling                                    (6.166667, inf]   816   565  0.325559  0.144037    0.046892  1381
                   moreq25cnt__gprs_last_defer                             (-inf, 2.5]   820   567  0.324202  0.144037    0.046697  1387
                   more0cnt__gprs_last_defer                               (-inf, 2.5]   820   567  0.324202  0.144037    0.046697  1387
                   calling_cnt                                              (7.5, inf]   919   628  0.312401  0.154587    0.048293  1547
                   std__calling_diff_dura                              (4.330127, inf]   733   497  0.304592  0.119725    0.036467  1230
                   wave__call_use                                     (-inf, 0.880832]   742   495  0.288356  0.113761    0.032804  1237
                   wave__nos_calling_diff                             (-inf, 0.989527]   645   429  0.285354  0.097706    0.027881  1074
                   avg__gprs_last_defer                               (-inf, 4.833333]   581   384  0.279039  0.085780    0.023936   965
                   max__gprs_last_defer                                    (-inf, 7.0]   565   372  0.275215  0.082110    0.022598   937
                   grow__nos_calling_diff                              (0.426406, inf]   942   607  0.253671  0.124771    0.031651  1549
                   moreq25cnt__nos_calling_diff                             (2.5, inf]   989   635  0.250078  0.128899    0.032235  1624
                   more0cnt__nos_calling_diff                               (2.5, inf]   989   635  0.250078  0.128899    0.032235  1624
                   std__nos_calling_diff                                (1.07735, inf]  1000   641  0.248421  0.129358    0.032135  1641
                   std__nos_calling                                    (2.040833, inf]   957   613  0.247709  0.123394    0.030566  1570
                   grow__nos_calling                                   (0.370899, inf]  1108   709  0.246691  0.142202    0.035080  1817
                   grow__gprs_flow_video                               (5.992467, inf]    61    39  0.245835  0.007798    0.001917   100
                   wave__calling_diff_cnt                             (-inf, 0.871024]   815   520  0.243788  0.103211    0.025162  1335
                   ...                                                             ...   ...   ...       ...       ...         ...   ...
                   max__gprs_last_defer                                 (77.0, 3142.0]   581   282 -0.029697 -0.007798    0.000232   863
                   min__gprs_flow_5g                                     (-inf, 0.085]  2156  1042 -0.033966 -0.033028    0.001122  3198
                   min__gprs_flow_game                                     (-inf, 0.5]  2166  1039 -0.041476 -0.040367    0.001674  3205
                   std__monthsremain_last_stop_date                    (0.788675, inf]  2090   989 -0.055078 -0.051376    0.002830  3079
                   gprs_flow_5g                                          (-inf, 0.035]  2106   995 -0.056656 -0.053211    0.003015  3101
                   grow__gprs_flow_5g                                  (-inf, 4.7e-05]  2104   994 -0.056711 -0.053211    0.003018  3098
                   grow__gprs_flow_game                               (-inf, 0.005831]  2131  1006 -0.057462 -0.054587    0.003137  3137
                   gprs_flow_game                                          (-inf, 0.5]  2131  1006 -0.057462 -0.054587    0.003137  3137
                   moreq25cnt__gprs_flow_5g                                (-inf, 1.5]  2130  1005 -0.057987 -0.055046    0.003192  3135
                   more0cnt__gprs_flow_5g                                  (-inf, 1.5]  2130  1005 -0.057987 -0.055046    0.003192  3135
                   wave__gprs_flow_5g                                 (-inf, 1.219963]  2076   967 -0.070853 -0.065138    0.004615  3043
                   valuecnt__greatest_gprs_app~video                        (1.5, inf]  2035   946 -0.072861 -0.065596    0.004779  2981
                   wave__dinner_fee                                   (-inf, 0.000215]  1928   896 -0.073151 -0.062385    0.004564  2824
                   if_5g_dinner~是                                                   0  2114   977 -0.078703 -0.073394    0.005776  3091
                   if_5g_dinner~否                                                   1  2114   977 -0.078703 -0.073394    0.005776  3091
                   valuecnt__if_5g_dinner~是                               (-inf, 0.5]  2109   972 -0.081466 -0.075688    0.006166  3081
                   sep__gprs_flow_5g                                  (-inf, 0.094645]  2066   952 -0.081657 -0.074312    0.006068  3018
                   avg__gprs_flow_5g                                       (-inf, 0.2]  2082   959 -0.082046 -0.075229    0.006172  3041
                   max__gprs_flow_5g                                       (-inf, 0.6]  2083   959 -0.082526 -0.075688    0.006246  3042
                   std__gprs_flow_5g                                   (-inf, 0.34641]  2083   959 -0.082526 -0.075688    0.006246  3042
                   more0cnt__monthsremain_last_stop_date                   (-inf, 0.5]  1929   888 -0.082638 -0.070183    0.005800  2817
                   greatest_gprs_app~commu                                           0  2048   942 -0.083467 -0.075229    0.006279  2990
                   wave__monthsremain_last_stop_date                 (-inf, -0.020101]  1933   886 -0.086964 -0.073853    0.006423  2819
                   sep__monthsremain_last_stop_date                   (-inf, -0.01005]  1933   886 -0.086964 -0.073853    0.006423  2819
                   acct_balance                                            (2.76, inf]  1891   865 -0.088984 -0.073853    0.006572  2756
                   if_nolimit~是                                                     0  2110   965 -0.089168 -0.082569    0.007362  3075
                   if_nolimit~否                                                     1  2110   965 -0.089168 -0.082569    0.007362  3075
                   wave__gprs_flow_game                                 (-inf, 1.0776]  2089   954 -0.090630 -0.083028    0.007525  3043
                   greatest_gprs_app~video                                           1  2019   921 -0.091750 -0.081193    0.007449  2940
                   std__call_use                                     (-inf, 19.918584]  2042   931 -0.092279 -0.082569    0.007619  2973
                   valuecnt__if_nolimit~是                                 (-inf, 0.5]  2106   960 -0.092465 -0.085321    0.007889  3066
                   min__gprs_flow_roam                                (-inf, 393134.0]  2128   968 -0.094559 -0.088073    0.008328  3096
                   more0cnt__gprs_flow_game                                (-inf, 0.5]  2085   941 -0.102434 -0.093119    0.009539  3026
                   std__gprs_flow_game                                (-inf, 0.288675]  2085   941 -0.102434 -0.093119    0.009539  3026
                   max__gprs_flow_game                                     (-inf, 0.5]  2085   941 -0.102434 -0.093119    0.009539  3026
                   sep__gprs_flow_game                                (-inf, 0.062775]  2085   941 -0.102434 -0.093119    0.009539  3026
                   avg__gprs_flow_game                                (-inf, 0.166666]  2085   941 -0.102434 -0.093119    0.009539  3026
                   moreq25cnt__gprs_flow_game                              (-inf, 0.5]  2085   941 -0.102434 -0.093119    0.009539  3026
                   std__gprs_last_defer                             (-inf, 366.917206]  2072   935 -0.102576 -0.092661    0.009505  3007
                   valuecnt__greatest_gprs_app~commu                       (-inf, 0.5]  1843   831 -0.103373 -0.083028    0.008583  2674
                   min__gprs_last_defer                                 (99.0, 3142.0]   449   202 -0.105608 -0.020642    0.002180   651
                   max__call_dura_roam                                   (-inf, 115.5]  1947   873 -0.108962 -0.092202    0.010047  2820
                   sep__gprs_last_defer                               (-inf, 0.165163]  1854   831 -0.109324 -0.088073    0.009629  2685
                   min__gprs_flow_music                                    (-inf, 0.5]  2119   948 -0.111198 -0.102294    0.011375  3067
                   days_call_p_3                                     (-inf, 90.816669]  1825   814 -0.114228 -0.090367    0.010322  2639
                   days_call_p_2                                     (-inf, 60.816666]  1825   814 -0.114228 -0.090367    0.010322  2639
                   days_call_p_1                                     (-inf, 30.816666]  1825   814 -0.114228 -0.090367    0.010322  2639
                   days_call_p_4                                    (-inf, 120.816669]  1825   814 -0.114228 -0.090367    0.010322  2639
                   avg__call_dura_roam                               (-inf, 46.833334]  1870   831 -0.117917 -0.095413    0.011251  2701
                   avg__days_call_p_4                               (-inf, 122.058964]  1778   789 -0.119331 -0.091743    0.010948  2567
                   min__call_use                                          (-inf, 58.5]  1987   881 -0.120176 -0.103211    0.012404  2868
                   max__days_call_p_4                               (-inf, 124.725807]  1678   742 -0.122861 -0.088991    0.010934  2420
                   min__call_dura_roam                                     (-inf, 5.5]  1740   769 -0.123402 -0.092661    0.011435  2509
                   avg__call_use                                     (-inf, 65.833332]  1969   868 -0.125942 -0.106881    0.013461  2837
                   innet_months                                            (86.5, inf]  1834   808 -0.126545 -0.100000    0.012655  2642
                   grow__call_dura_roam                               (-inf, 0.460983]  1727   759 -0.128992 -0.095872    0.012367  2486
                   account_id~其他_countlow                                          1  1737   763 -0.129510 -0.096789    0.012535  2500
                   account_id~30100000000000                                         0  1737   763 -0.129510 -0.096789    0.012535  2500
                   nos_call                                               (-inf, 25.5]  1667   732 -0.129853 -0.093119    0.012092  2399
                   min__days_call_p_4                               (-inf, 120.655914]  1753   769 -0.130846 -0.098624    0.012905  2522
                   std__calling_dura                                 (-inf, 21.650635]  1816   791 -0.137946 -0.107339    0.014807  2607
                   days_call_p                                        (-inf, 0.816667]  1628   706 -0.142345 -0.099083    0.014104  2334
                   days_call                                              (-inf, 24.5]  1628   706 -0.142345 -0.099083    0.014104  2334
                   std__call_dura_roam                               (-inf, 22.105774]  1783   773 -0.142626 -0.108716    0.015506  2556
                   max__monthsremain_last_stop_date                       (-inf, -0.5]  1773   767 -0.144794 -0.109633    0.015874  2540
                   wave__nos_calling_diff                              (0.989527, inf]  1535   661 -0.149385 -0.097706    0.014596  2196
                   call_dura_roam                                         (-inf, 19.5]  1739   748 -0.150515 -0.111468    0.016778  2487
                   wave__calling_cnt                                   (0.372334, inf]  1606   690 -0.151663 -0.103670    0.015723  2296
                   std__calling_cnt                                   (-inf, 6.639528]  1689   724 -0.153953 -0.110550    0.017020  2413
                   std__arpu                                          (-inf, 3.605552]  1731   738 -0.159364 -0.116972    0.018641  2469
                   min__calling_dura                                      (-inf, 53.5]  1794   763 -0.161798 -0.122936    0.019891  2557
                   min__calling_cnt                                       (-inf, 26.5]  1798   764 -0.162715 -0.123853    0.020153  2562
                   called_cnt                                             (-inf, 33.5]  1342   570 -0.163133 -0.092661    0.015116  1912
                   gprs_flow_roam                                     (-inf, 120006.5]  2016   854 -0.165792 -0.141284    0.023424  2870
                   avg__calling_cnt                                       (-inf, 32.5]  1757   744 -0.166175 -0.123394    0.020505  2501
                   min__gprs_flow_short                                    (-inf, 2.5]  2100   888 -0.167574 -0.148624    0.024905  2988
                   min__dinner_fee                                   (-inf, 58.165001]  1978   836 -0.168066 -0.140367    0.023591  2814
                   min__monthsremain_last_stop_date                       (-inf, -4.5]  1665   703 -0.169076 -0.118807    0.020088  2368
                   call_use                                               (-inf, 37.5]  1841   777 -0.169477 -0.131651    0.022312  2618
                   wave__gprs_flow_commu                               (2.983083, inf]   268   113 -0.170452 -0.019266    0.003284   381
                   sep__gprs_flow_commu                                (1.717421, inf]   268   113 -0.170452 -0.019266    0.003284   381
                   min__calling_diff_cnt                                   (-inf, 5.5]  1689   712 -0.170667 -0.121560    0.020746  2401
                   moreq25cnt__call_dura_roam                              (-inf, 1.5]  1306   550 -0.171659 -0.094495    0.016221  1856
                   more0cnt__call_dura_roam                                (-inf, 1.5]  1306   550 -0.171659 -0.094495    0.016221  1856
                   avg__monthsremain_last_stop_date                  (-inf, -3.166667]  1663   700 -0.172151 -0.120642    0.020769  2363
                   avg__dinner_fee                                      (-inf, 58.225]  1973   830 -0.172738 -0.143578    0.024801  2803
                   gprs_flow_music                                         (-inf, 0.5]  2048   860 -0.174539 -0.150459    0.026261  2908
                   grow__gprs_flow_music                              (-inf, 0.000898]  2048   860 -0.174539 -0.150459    0.026261  2908
                   grow__dinner_fee                                    (-inf, 0.82007]  1978   830 -0.175269 -0.145872    0.025567  2808
                   dinner_fee                                           (-inf, 58.225]  1974   828 -0.175657 -0.145872    0.025623  2802
                   max__dinner_fee                                      (-inf, 58.225]  1966   824 -0.176439 -0.145872    0.025737  2790
                   grow__monthsremain_last_stop_date                      (-inf, -3.0]  1630   683 -0.176693 -0.121101    0.021398  2313
                   monthsaready_last_stop_date                              (4.5, inf]  1630   683 -0.176693 -0.121101    0.021398  2313
                   monthsremain_last_stop_date                            (-inf, -4.5]  1630   683 -0.176693 -0.121101    0.021398  2313
                   std__calling_diff_cnt                              (-inf, 2.598076]  1607   673 -0.177232 -0.119725    0.021219  2280
                   wave__calling_diff_cnt                              (0.871024, inf]  1365   570 -0.180126 -0.103211    0.018591  1935
                   max__call_use                                          (-inf, 37.5]  1778   741 -0.182097 -0.135780    0.024725  2519
                   avg__calling_diff_cnt                              (-inf, 9.166667]  1701   708 -0.183380 -0.130734    0.023974  2409
                   nos_calling                                            (-inf, 10.5]  1691   701 -0.187420 -0.132569    0.024846  2392
                   std__gprs_resource                             (-inf, 38780.330078]  1804   747 -0.188549 -0.142202    0.026812  2551
                   grow__gprs_flow_roam                                  (-inf, 1e-06]  1326   549 -0.188677 -0.104587    0.019733  1875
                   wave__call_use                                      (0.880832, inf]  1438   595 -0.189300 -0.113761    0.021535  2033
                   sep__gprs_resource                                    (-inf, 3e-06]  1687   698 -0.189341 -0.133486    0.025274  2385
                   avg__calling_diff_dura                            (-inf, 19.166666]  1705   705 -0.189975 -0.135321    0.025708  2410
                   wave__gprs_resource                                   (-inf, 1e-06]  1685   696 -0.191024 -0.134404    0.025674  2381
                   wave__gprs_flow_roam                               (-inf, 1.012101]  1100   454 -0.191821 -0.088073    0.016894  1554
                   min__calling_diff_dura                                  (-inf, 8.5]  1634   674 -0.192409 -0.131193    0.025243  2308
                   more0cnt__gprs_now_defer                                 (0.5, inf]  1590   654 -0.195235 -0.129358    0.025255  2244
                   moreq25cnt__gprs_now_defer                               (0.5, inf]  1590   654 -0.195235 -0.129358    0.025255  2244
                   calling_dura                                           (-inf, 53.5]  1695   697 -0.195505 -0.138073    0.026994  2392
                   std__calling_diff_dura                             (-inf, 4.330127]  1447   593 -0.198906 -0.119725    0.023814  2040
                   max__calling_diff_dura                                 (-inf, 25.5]  1682   686 -0.203714 -0.142202    0.028969  2368
                   min__nos_calling_diff                                   (-inf, 1.5]  1472   599 -0.205969 -0.125688    0.025888  2071
                   wave__nos_calling                                   (0.969165, inf]  1198   487 -0.206997 -0.102752    0.021269  1685
                   nos_calling_diff                                        (-inf, 3.5]  1546   628 -0.207739 -0.133028    0.027635  2174
                   calling_diff_dura                                      (-inf, 15.5]  1648   669 -0.208386 -0.142202    0.029633  2317
                   calling_diff_cnt                                        (-inf, 5.5]  1529   618 -0.212734 -0.134404    0.028592  2147
                   gprs_flow_short                                         (-inf, 3.5]  2020   816 -0.213291 -0.177982    0.037962  2836
                   wave__gprs_now_defer                               (-inf, 0.032841]  1513   609 -0.216884 -0.135321    0.029349  2122
                   grow__gprs_flow_short                               (-inf, 0.00286]  2001   804 -0.218656 -0.180275    0.039418  2805
                   max__calling_diff_cnt                                   (-inf, 7.5]  1503   600 -0.225142 -0.138991    0.031293  2103
                   grow__call_use                                     (-inf, 0.285834]  1478   590 -0.225175 -0.136697    0.030781  2068
                   max__calling_cnt                                       (-inf, 19.5]  1476   585 -0.232332 -0.140367    0.032612  2061
                   max__nos_calling                                       (-inf, 10.5]  1465   575 -0.242093 -0.144495    0.034981  2040
                   wave__calling_dura                                  (0.893924, inf]  1151   451 -0.243772 -0.114220    0.027844  1602
                   moreq25cnt__dinner_fee                                  (-inf, 0.5]   913   357 -0.245853 -0.091284    0.022443  1270
                   avg__gprs_flow_roam                           (-inf, 258466.835938]  1946   760 -0.247066 -0.195413    0.048280  2706
                   avg__nos_calling_diff                              (-inf, 2.833333]  1411   551 -0.247172 -0.141743    0.035035  1962
                   more0cnt__call_use                                      (-inf, 0.5]   968   378 -0.247191 -0.097248    0.024039  1346
                   moreq25cnt__call_use                                    (-inf, 0.5]   968   378 -0.247191 -0.097248    0.024039  1346
                   grow__nos_calling_diff                             (-inf, 0.426406]  1238   483 -0.248089 -0.124771    0.030954  1721
                   std__nos_calling                                   (-inf, 2.040833]  1223   477 -0.248398 -0.123394    0.030651  1700
                   min__gprs_flow_video                                    (-inf, 1.5]  2076   809 -0.249252 -0.210092    0.052366  2885
                   std__gprs_flow_roam                           (-inf, 243320.039062]  1931   747 -0.256581 -0.200459    0.051434  2678
                   max__gprs_flow_roam                                (-inf, 503427.5]  1933   747 -0.257616 -0.201376    0.051878  2680
                   min__nos_calling                                        (-inf, 3.5]  1375   530 -0.260185 -0.144495    0.037596  1905
                   max__nos_calling_diff                                   (-inf, 4.5]  1420   547 -0.260816 -0.149541    0.039003  1967
                   avg__nos_calling                                   (-inf, 6.166667]  1364   525 -0.261631 -0.144037    0.037685  1889
                   moreq25cnt__gprs_last_defer                              (2.5, inf]  1360   523 -0.262511 -0.144037    0.037811  1883
                   more0cnt__gprs_last_defer                                (2.5, inf]  1360   523 -0.262511 -0.144037    0.037811  1883
                   grow__calling_cnt                                   (-inf, 0.59512]  1413   541 -0.266904 -0.151835    0.040525  1954
                   min__gprs_flow_commu                                    (-inf, 2.5]  2046   783 -0.267362 -0.220183    0.058869  2829
                   grow__gprs_now_rest                                (-inf, 0.299269]  1766   675 -0.268613 -0.190826    0.051258  2441
                   moreq25cnt__nos_calling_diff                            (-inf, 2.5]  1191   455 -0.269104 -0.128899    0.034687  1646
                   more0cnt__nos_calling_diff                              (-inf, 2.5]  1191   455 -0.269104 -0.128899    0.034687  1646
                   std__nos_calling_diff                               (-inf, 1.07735]  1180   449 -0.273100 -0.129358    0.035328  1629
                   avg__gprs_now_rest                               (-inf, 11101323.5]  1691   641 -0.276899 -0.187615    0.051950  2332
                   moreq25cnt__gprs_flow_roam                              (-inf, 0.5]   876   330 -0.283126 -0.099083    0.028053  1206
                   more0cnt__gprs_flow_roam                                (-inf, 0.5]   876   330 -0.283126 -0.099083    0.028053  1206
                   avg__gprs_flow_music                               (-inf, 0.166666]  1898   710 -0.290144 -0.219266    0.063619  2608
                   moreq25cnt__gprs_flow_music                             (-inf, 0.5]  1898   710 -0.290144 -0.219266    0.063619  2608
                   max__gprs_flow_music                                    (-inf, 0.5]  1898   710 -0.290144 -0.219266    0.063619  2608
                   wave__gprs_flow_music                           (0.999357, 1.00298]  1898   710 -0.290144 -0.219266    0.063619  2608
                   sep__gprs_flow_music                               (-inf, 0.048622]  1898   710 -0.290144 -0.219266    0.063619  2608
                   std__gprs_flow_music                               (-inf, 0.288675]  1898   710 -0.290144 -0.219266    0.063619  2608
                   more0cnt__gprs_flow_music                               (-inf, 0.5]  1898   710 -0.290144 -0.219266    0.063619  2608
                   sep__gprs_flow_roam                                (-inf, 0.093891]   893   334 -0.290298 -0.103211    0.029962  1227
                   moreq25cnt__nos_calling                                 (-inf, 2.5]  1087   406 -0.291677 -0.126147    0.036794  1493
                   gprs_flow_video                                         (-inf, 3.5]  1976   733 -0.298537 -0.233945    0.069841  2709
                   moreq25cnt__calling_cnt                                 (-inf, 2.5]   933   346 -0.298819 -0.110550    0.033035  1279
                   grow__gprs_flow_video                              (-inf, 0.001971]  1950   721 -0.301798 -0.233028    0.070327  2671
                   std__gprs_flow_short                              (-inf, 11.888295]  1909   704 -0.304409 -0.229817    0.069958  2613
                   avg__gprs_flow_short                               (-inf, 6.833333]  1904   698 -0.310346 -0.233028    0.072319  2602
                   max__gprs_flow_short                                   (-inf, 14.5]  1899   696 -0.310586 -0.232569    0.072233  2595
                   calling_cnt                                             (-inf, 7.5]  1261   462 -0.310948 -0.154587    0.048069  1723
                   max__gprs_now_rest                               (-inf, 12582921.5]  1739   636 -0.312720 -0.214220    0.066991  2375
                   min__gprs_resource                                (-inf, 6516309.0]  1890   687 -0.318851 -0.236697    0.075471  2577
                   max__gprs_now_defer                      (5242880.0, 11798577152.0]  1413   511 -0.323954 -0.179358    0.058104  1924
                   more0cnt__nos_calling                                   (-inf, 2.5]   812   293 -0.326181 -0.103670    0.033815  1105
                   avg__gprs_now_defer                    (1747626.625, 11514762752.0]  1442   520 -0.326810 -0.184404    0.060265  1962
                   gprs_now_defer                           (5242880.0, 11798577152.0]  1402   505 -0.327949 -0.179817    0.058971  1907
                   min__gprs_now_defer                      (5242880.0, 11798577152.0]  1394   502 -0.328185 -0.178899    0.058712  1896
                   avg__gprs_resource                                (-inf, 7992786.0]  1873   672 -0.331891 -0.242661    0.080537  2545
                   sep__gprs_flow_short                                (-inf, 0.01915]  1834   655 -0.336472 -0.240367    0.080877  2489
                   wave__gprs_flow_short                           (0.999076, 1.00658]  1832   654 -0.336909 -0.240367    0.080982  2486
                   moreq25cnt__gprs_flow_short                             (-inf, 0.5]  1832   654 -0.336909 -0.240367    0.080982  2486
                   more0cnt__gprs_flow_short                               (-inf, 0.5]  1832   654 -0.336909 -0.240367    0.080982  2486
                   wave__gprs_last_defer                              (-inf, 0.269489]  1290   460 -0.338024 -0.169725    0.057371  1750
                   grow__nos_calling                                  (-inf, 0.370899]  1072   381 -0.341335 -0.142202    0.048538  1453
                   more0cnt__gprs_flow_video                               (-inf, 1.5]  1915   680 -0.342233 -0.254587    0.087128  2595
                   moreq25cnt__gprs_flow_video                             (-inf, 1.5]  1915   680 -0.342233 -0.254587    0.087128  2595
                   sep__calling_diff_cnt                              (-inf, 0.010192]   749   265 -0.345862 -0.100459    0.034745  1014
                   gprs_flow_commu                                         (-inf, 1.5]  1917   676 -0.349176 -0.259174    0.090498  2593
                   grow__calling_diff_cnt                             (-inf, 0.038857]   863   302 -0.356840 -0.118807    0.042395  1165
                   grow__calling_diff_dura                            (-inf, 0.064269]   878   307 -0.357652 -0.121101    0.043312  1185
                   grow__gprs_flow_commu                              (-inf, 0.008936]  1862   650 -0.359287 -0.257798    0.092624  2512
                   max__gprs_flow_video                                   (-inf, 62.5]  1884   655 -0.363370 -0.263303    0.095676  2539
                   grow__gprs_resource                                (-inf, 0.134127]  1833   637 -0.363792 -0.256422    0.093284  2470
                   gprs_resource                                     (-inf, 6291466.5]  1831   635 -0.365845 -0.257339    0.094146  2466
                   std__gprs_flow_video                              (-inf, 27.570754]  1869   648 -0.366121 -0.262844    0.096233  2517
                   max__gprs_resource                                (-inf, 6291466.5]  1800   618 -0.375906 -0.258716    0.097253  2418
                   avg__gprs_flow_video                                   (-inf, 20.5]  1873   643 -0.376005 -0.269266    0.101245  2516
                   sep__gprs_now_rest                                 (-inf, 0.005665]  1622   554 -0.381103 -0.235780    0.089856  2176
                   sep__calling_cnt                                   (-inf, 0.006349]   477   162 -0.386773 -0.070183    0.027145   639
                   std__gprs_now_rest                            (-inf, 108754.894531]  1833   622 -0.387622 -0.270183    0.104729  2455
                   grow__gprs_now_defer                           (0.000484, 0.992747]  1073   363 -0.390664 -0.159174    0.062184  1436
                   wave__gprs_flow_video                          (0.998648, 1.000855]  1707   576 -0.393238 -0.254587    0.100113  2283
                   sep__gprs_flow_video                               (-inf, 0.004066]  1707   576 -0.393238 -0.254587    0.100113  2283
                   max__gprs_flow_commu                                   (-inf, 34.5]  1933   651 -0.395172 -0.289450    0.114382  2584
                   more0cnt__gprs_flow_commu                               (-inf, 1.5]  1838   619 -0.395181 -0.275229    0.108765  2457
                   moreq25cnt__gprs_flow_commu                             (-inf, 1.5]  1838   619 -0.395181 -0.275229    0.108765  2457
                   sep__calling_diff_dura                              (-inf, 0.00655]   689   232 -0.395357 -0.103211    0.040805   921
                   age                                                     (50.5, inf]   609   205 -0.395661 -0.091284    0.036118   814
                   std__gprs_flow_commu                              (-inf, 11.888295]  1887   630 -0.403877 -0.287615    0.116161  2517
                   min__gprs_flow_busy                                (-inf, 106666.5]  1884   628 -0.405465 -0.288073    0.116804  2512
                   avg__gprs_flow_commu                              (-inf, 11.166667]  1900   631 -0.409156 -0.292661    0.119744  2531
                   grow__arpu                                         (-inf, 0.606771]  1532   507 -0.412671 -0.237615    0.098057  2039
                   grow__calling_dura                                 (-inf, 0.207615]   834   275 -0.416315 -0.130275    0.054236  1109
                   min__gprs_now_rest                         (10485963.0, 12582916.5]   531   174 -0.422560 -0.083945    0.035472   705
                   moreq25cnt__calling_diff_cnt                            (-inf, 0.5]   632   207 -0.423023 -0.100000    0.042302   839
                   more0cnt__calling_diff_dura                             (-inf, 0.5]   632   207 -0.423023 -0.100000    0.042302   839
                   more0cnt__calling_diff_cnt                              (-inf, 0.5]   632   207 -0.423023 -0.100000    0.042302   839
                   moreq25cnt__calling_diff_dura                           (-inf, 0.5]   632   207 -0.423023 -0.100000    0.042302   839
                   moreq25cnt__gprs_flow_busy                              (-inf, 1.5]   758   248 -0.424107 -0.120183    0.050971  1006
                   moreq25cnt__gprs_resource                               (-inf, 0.5]   762   247 -0.433411 -0.122936    0.053282  1009
                   arpu                                                 (-inf, 29.125]  1505   487 -0.435137 -0.243578    0.105990  1992
                   wave__gprs_flow_commu                          (0.994117, 1.014323]  1577   508 -0.439651 -0.257339    0.113140  2085
                   sep__gprs_flow_commu                               (-inf, 0.008387]  1577   507 -0.441621 -0.258257    0.114052  2084
                   sep__nos_calling_diff                               (-inf, 0.04669]   528   169 -0.446050 -0.087156    0.038876   697
                   max__arpu                                             (-inf, 29.16]  1413   448 -0.455530 -0.237156    0.108032  1861
                   avg__arpu                                         (-inf, 24.193333]  1350   425 -0.462624 -0.229358    0.106106  1775
                   gprs_now_rest                              (10492399.0, 12582921.5]   550   172 -0.469277 -0.094495    0.044344   722
                   avg__gprs_last_defer                              (4.833333, 147.0]  1173   362 -0.482528 -0.205963    0.099383  1535
                   grow__gprs_flow_busy                               (-inf, 0.025818]  1776   548 -0.482696 -0.311927    0.150566  2324
                   wave__gprs_now_rest                                (-inf, 0.009812]  1445   445 -0.484643 -0.254587    0.123384  1890
                   grow__gprs_last_defer                          (0.000976, 0.954653]  1102   339 -0.485735 -0.194495    0.094473  1441
                   min__arpu                                            (-inf, 18.005]  1231   377 -0.490190 -0.218807    0.107257  1608
                   gprs_flow_4g                                       (-inf, 120618.5]  1772   541 -0.493298 -0.316514    0.156136  2313
                   gprs_flow_busy                                     (-inf, 121086.5]  1773   540 -0.495712 -0.317890    0.157582  2313
                   gprs_flow                                          (-inf, 121086.5]  1773   540 -0.495712 -0.317890    0.157582  2313
                   grow__days_call_p_4                                 (-inf, 0.07151]   341   102 -0.513762 -0.062844    0.032287   443
                   sep__calling_dura                                  (-inf, 0.002126]   420   125 -0.518794 -0.077982    0.040456   545
                   days_gprs_p                                            (-inf, 0.05]   323    96 -0.520157 -0.060092    0.031257   419
                   days_gprs                                               (-inf, 1.5]   323    96 -0.520157 -0.060092    0.031257   419
                   moreq25cnt__calling_dura                                (-inf, 0.5]   489   142 -0.543388 -0.094037    0.051098   631
                   max__calling_dura                                       (-inf, 1.5]   489   142 -0.543388 -0.094037    0.051098   631
                   gprs_last_defer                                        (1.5, 144.5]  1135   328 -0.548227 -0.219725    0.120459  1463
                   max__gprs_last_defer                                    (7.0, 77.0]   896   252 -0.575364 -0.179817    0.103460  1148
                   std__gprs_flow_busy                           (-inf, 156108.882812]  1677   463 -0.593888 -0.344495    0.204592  2140
                   avg__calling_dura                                       (-inf, 0.5]   426   117 -0.599118 -0.088073    0.052766   543
                   more0cnt__calling_dura                                  (-inf, 0.5]   380   103 -0.612295 -0.079817    0.048871   483
                   more0cnt__calling_cnt                                   (-inf, 0.5]   380   103 -0.612295 -0.079817    0.048871   483
                   avg__gprs_flow_busy                                 (-inf, 83526.0]  1510   408 -0.615451 -0.318349    0.195928  1918
                   max__gprs_flow_busy                                (-inf, 210641.5]  1578   425 -0.618677 -0.333945    0.206604  2003
                   moreq25cnt__arpu                                        (-inf, 0.5]   551   146 -0.634981 -0.118807    0.075440   697
                   min__gprs_last_defer                                    (1.5, 99.0]   818   206 -0.685839 -0.186239    0.127730  1024
                   sep__nos_calling                                   (-inf, 0.014447]   307    77 -0.689895 -0.070183    0.048419   384
                   min__gprs_now_rest                                  (0.5, 245476.0]   762   188 -0.706357 -0.177064    0.125071   950
                   gprs_now_rest                                       (0.5, 245768.5]   822   200 -0.720276 -0.193578    0.139430  1022
                   sep__gprs_flow_busy                                (-inf, 0.024484]   202    49 -0.723300 -0.047706    0.034506   251
                   
                   [560 rows x 7 columns], na_to_value={}, morecnt_thre_dict={('more0cnt', '近3月大于0的月份数'): gprs_flow_5g                   0
                   calling_dura                   0
                   gprs_resource                  0
                   call_dura_roam                 0
                   calling_diff_cnt               0
                   gprs_flow_busy                 0
                   gprs_flow_music                0
                   gprs_last_defer                0
                   gprs_now_defer                 0
                   nos_calling                    0
                   gprs_flow_roam                 0
                   calling_diff_dura              0
                   gprs_now_rest                  0
                   monthsremain_last_stop_date    0
                   dinner_fee                     0
                   gprs_flow_short                0
                   gprs_flow_commu                0
                   call_use                       0
                   gprs_flow_game                 0
                   days_call_p_4                  0
                   arpu                           0
                   nos_calling_diff               0
                   calling_cnt                    0
                   gprs_flow_video                0
                   dtype: int64, ('moreq25cnt', '近3月大于第一四分位数的月份数'): gprs_flow_5g                       0.0000
                   calling_dura                       1.0000
                   gprs_resource                     10.0000
                   call_dura_roam                     0.0000
                   calling_diff_cnt                   0.0000
                   gprs_flow_busy                  1574.0000
                   gprs_flow_music                    0.0000
                   gprs_last_defer                    0.0000
                   gprs_now_defer                     0.0000
                   nos_calling                        1.0000
                   gprs_flow_roam                     0.0000
                   calling_diff_dura                  0.0000
                   gprs_now_rest                  40970.0000
                   monthsremain_last_stop_date      -39.0000
                   dinner_fee                         8.0000
                   gprs_flow_short                    0.0000
                   gprs_flow_commu                    0.0000
                   call_use                           0.0000
                   gprs_flow_game                     0.0000
                   days_call_p_4                     96.5000
                   arpu                               9.1775
                   nos_calling_diff                   0.0000
                   calling_cnt                        1.0000
                   gprs_flow_video                    0.0000
                   Name: 0.25, dtype: float64}, now_methods_desc={'add': '之和', 'sub': '之差', 'mult': '之积', 'div': '之比'}, recent_methods_desc={'avg': '近3月均值', 'sep': '近3月离散系数', 'wave': '近3月波动性', 'grow': '近3月成长率', 'max': '近3月最大值', 'min': '近3月最小值', 'std': '近3月标准差'}, dis_exam=None, num_valid=0                    gprs_flow_5g
                   1                    calling_dura
                   2                   gprs_resource
                   3                  call_dura_roam
                   4                calling_diff_cnt
                   5                  gprs_flow_busy
                   6                 gprs_flow_music
                   7                 gprs_last_defer
                   8                  gprs_now_defer
                   9                     nos_calling
                   10                 gprs_flow_roam
                   11              calling_diff_dura
                   12                  gprs_now_rest
                   13    monthsremain_last_stop_date
                   14                     dinner_fee
                   15                   innet_months
                   16                gprs_flow_short
                   17                gprs_flow_commu
                   18                       call_use
                   19                 gprs_flow_game
                   20                  days_call_p_4
                   21                           arpu
                   22               nos_calling_diff
                   23                    calling_cnt
                   24                gprs_flow_video
                   dtype: object, char_validvalue=Index(['account_id~其他_countlow', 'if_nolimit~是', 'if_5g_dinner~是', 'greatest_gprs_app~commu', 'greatest_gprs_app~video'], dtype='object'))
                   Out[216]: 20220322-17:43:48  
                   Empty DataFrame
                   Columns: []
                   Index: []
                   Out[217]: 20220322-17:43:50  
                   Empty DataFrame
                   Columns: []
                   Index: []


Traceback (most recent call last):
  File "C:\Users\higher\Anaconda3\lib\site-packages\IPython\core\interactiveshell.py", line 2961, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-218-0ac921c19f1a>", line 1, in <module>
    result
NameError: name 'result' is not defined


Traceback (most recent call last):
  File "C:\Users\higher\Anaconda3\lib\site-packages\IPython\core\interactiveshell.py", line 2961, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-219-572e059fa342>", line 1, in <module>
    Info, res, comment_auto, result, stage, pipe = Info, res, comment_auto, (data_now[col_now], None), stage, pipeline
  File "C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\frame.py", line 2688, in __getitem__
    return self._getitem_column(key)
  File "C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\frame.py", line 2695, in _getitem_column
    return self._get_item_cache(key)
  File "C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\generic.py", line 2487, in _get_item_cache
    res = cache.get(item)
TypeError: unhashable type: 'set'


Traceback (most recent call last):
  File "C:\Users\higher\Anaconda3\lib\site-packages\IPython\core\interactiveshell.py", line 2961, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-220-572e059fa342>", line 1, in <module>
    Info, res, comment_auto, result, stage, pipe = Info, res, comment_auto, (data_now[col_now], None), stage, pipeline
  File "C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\frame.py", line 2688, in __getitem__
    return self._getitem_column(key)
  File "C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\frame.py", line 2695, in _getitem_column
    return self._get_item_cache(key)
  File "C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\generic.py", line 2487, in _get_item_cache
    res = cache.get(item)
TypeError: unhashable type: 'set'
                   Out[221]: 20220322-17:44:54  
                   {'account_id',
                    'account_id~其他_countlow',
                    'acct_month',
                    'arpu',
                    'call_dura_roam',
                    'call_fee_local',
                    'call_use',
                    'calling_cnt',
                    'calling_diff_cnt',
                    'calling_diff_dura',
                    'calling_dura',
                    'data_use',
                    'days_call_p_4',
                    'flag_eg',
                    'gprs_flow_5g',
                    'gprs_flow_busy',
                    'gprs_flow_commu',
                    'gprs_flow_game',
                    'gprs_flow_music',
                    'gprs_flow_roam',
                    'gprs_flow_short',
                    'gprs_flow_video',
                    'gprs_last_defer',
                    'gprs_now_defer',
                    'gprs_now_rest',
                    'gprs_resource',
                    'greatest_gprs_app',
                    'greatest_gprs_app~commu',
                    'greatest_gprs_app~video',
                    'innet_months',
                    'last_stop_date',
                    'nos_calling',
                    'nos_calling_diff',
                    'phone_no_null',
                    'sms_cnt',
                    'user_acct_month',
                    'user_id',
                    'user_status'}
  File "<ipython-input-222-8982c7382ad5>", line 1
    col_now = list(umns) & set(col_all) - sub_target)
                                                    ^
SyntaxError: invalid syntax


                   ----------------------------------------- 当月 数值型&类别型 原始数据 
20220322-17:45:50  (3770, 38)
20220322-17:46:06  筛选衍生字段的 原始/手动衍生_sql 字段

                   ----------------------------------------- 近n月 数值型 近3月均值 
20220322-17:46:06  字段个数：21, 添加字段：None
20220322-17:46:06  (3770, 59)

                   ----------------------------------------- 近n月 数值型 近3月离散系数 
20220322-17:46:06  字段个数：7, 添加字段：None
20220322-17:46:06  (3770, 66)

                   ----------------------------------------- 近n月 数值型 近3月波动性 
20220322-17:46:06  字段个数：9, 添加字段：None
20220322-17:46:07  (3770, 75)

                   ----------------------------------------- 近n月 数值型 近3月成长率 
20220322-17:46:07  字段个数：12, 添加字段：None
20220322-17:46:07  (3770, 87)

                   ----------------------------------------- 近n月 数值型 近3月最大值 
20220322-17:46:07  字段个数：14, 添加字段：None
20220322-17:46:07  (3770, 101)

                   ----------------------------------------- 近n月 数值型 近3月最小值 
20220322-17:46:07  字段个数：19, 添加字段：None
20220322-17:46:07  (3770, 120)

                   ----------------------------------------- 近n月 数值型 近3月标准差 
20220322-17:46:07  字段个数：15, 添加字段：None
20220322-17:46:07  (3770, 135)

                   ----------------------------------------- 近n月 数值型 大于x的月份数 
20220322-17:46:07  ('more0cnt', '近3月大于0的月份数')
20220322-17:46:07  ('moreq25cnt', '近3月大于第一四分位数的月份数')
20220322-17:46:08  (3770, 149)

                   ----------------------------------------- 近n月 类别型 取某值的月份数 
20220322-17:46:08  字段个数：2, 添加字段：None
20220322-17:46:08  (3770, 151)

                   ----------------------------------------- 汇总最终宽表 
20220322-17:46:24  table.shape:(3770, 151)

20220322-17:46:24  保存宽表结果至：./binaryclassify/eg/traintest~202011~202012/train_data~202011.csv

20220322-17:46:24  计算字段之间的相关性系数
20220322-17:46:24  
                       count    9453.0
                       mean    0.163
                       std    0.195
                       min    0.0
                       25%    0.035
                       50%    0.096
                       75%    0.208
                       max    1.0
                       dtype: float64


                   ------------------------------- 计算宽表字段psi ------------------------------------ 
20220322-17:46:24  训练集 data_train
                    
                    20220322-17:46:24  my toolmodule.dataprep.PsiTransformer_DF fit
                    20220322-17:46:24      开始时间：2022-03-22 17:46:24
                    20220322-17:46:24      data in : (3270, 142)
                    20220322-17:46:24      首次从X获取id_X属性 2250526534568
                    20220322-17:46:24      fit轨迹：PsiTransformer_DF(Ncase='0', Pcase='1', warn_mark=' PsiTransformer')
                    20220322-17:46:24      输入数据中包括139个数值型字段，先对其进行mdlp分箱：['innet_months', 'gprs_last_defer', 'gprs_resource', 'gprs_now_rest', 'call_use', 'arpu', 'calling_cnt', 'calling_dura', 'calling_diff_cnt', 'calling_diff_dura', 'gprs_flow_5g', 'gprs_flow_busy', 'gprs_now_defer', 'gprs_flow_roam', 'call_dura_roam', 'days_call_p_4', 'nos_calling', 'nos_calling_diff', 'gprs_flow_video', 'gprs_flow_short', 'gprs_flow_music', 'gprs_flow_commu', 'gprs_flow_game', 'account_id~其他_countlow', 'greatest_gprs_app~commu', 'greatest_gprs_app~video', 'avg__calling_dura', 'avg__gprs_resource', 'avg__call_dura_roam', 'avg__calling_diff_cnt', 'avg__gprs_flow_busy', 'avg__gprs_flow_music', 'avg__gprs_last_defer', 'avg__gprs_now_defer', 'avg__nos_calling', 'avg__gprs_flow_roam', 'avg__calling_diff_dura', 'avg__gprs_now_rest', 'avg__monthsremain_last_stop_date', 'avg__gprs_flow_short', 'avg__gprs_flow_commu', 'avg__call_use', 'avg__gprs_flow_game', 'avg__arpu', 'avg__nos_calling_diff', 'avg__calling_cnt', 'avg__gprs_flow_video', 'sep__gprs_flow_5g', 'sep__gprs_last_defer', 'sep__nos_calling', 'sep__calling_diff_dura', 'sep__gprs_now_rest', 'sep__gprs_flow_commu', 'sep__gprs_flow_video', 'wave__gprs_flow_5g', 'wave__calling_dura', 'wave__gprs_resource', 'wave__gprs_flow_music', 'wave__gprs_last_defer', 'wave__gprs_now_defer', 'wave__gprs_now_rest', 'wave__call_use', 'wave__calling_cnt', 'grow__calling_dura', 'grow__gprs_last_defer', 'grow__gprs_now_defer', 'grow__nos_calling', 'grow__calling_diff_dura', 'grow__gprs_now_rest', 'grow__dinner_fee', 'grow__gprs_flow_commu', 'grow__call_use', 'grow__nos_calling_diff', 'grow__calling_cnt', 'grow__gprs_flow_video', 'max__gprs_flow_5g', 'max__calling_dura', 'max__call_dura_roam', 'max__calling_diff_cnt', 'max__gprs_last_defer', 'max__nos_calling', 'max__gprs_flow_roam', 'max__calling_diff_dura', 'max__gprs_now_rest', 'max__monthsremain_last_stop_date', 'max__call_use', 'max__arpu', 'max__nos_calling_diff', 'max__calling_cnt', 'min__calling_dura', 'min__gprs_resource', 'min__calling_diff_cnt', 'min__gprs_flow_busy', 'min__gprs_flow_music', 'min__gprs_last_defer', 'min__nos_calling', 'min__gprs_flow_roam', 'min__calling_diff_dura', 'min__gprs_now_rest', 'min__gprs_flow_short', 'min__gprs_flow_commu', 'min__call_use', 'min__gprs_flow_game', 'min__days_call_p_4', 'min__arpu', 'min__nos_calling_diff', 'min__calling_cnt', 'min__gprs_flow_video', 'std__calling_dura', 'std__gprs_resource', 'std__call_dura_roam', 'std__calling_diff_cnt', 'std__gprs_flow_busy', 'std__gprs_last_defer', 'std__nos_calling', 'std__calling_diff_dura', 'std__gprs_now_rest', 'std__gprs_flow_short', 'std__gprs_flow_commu', 'std__call_use', 'std__arpu', 'std__nos_calling_diff', 'std__calling_cnt', 'more0cnt__calling_cnt', 'moreq25cnt__gprs_flow_5g', 'moreq25cnt__calling_dura', 'moreq25cnt__gprs_resource', 'moreq25cnt__gprs_flow_busy', 'moreq25cnt__gprs_last_defer', 'moreq25cnt__gprs_now_defer', 'moreq25cnt__nos_calling', 'moreq25cnt__calling_diff_dura', 'moreq25cnt__gprs_flow_short', 'moreq25cnt__arpu', 'moreq25cnt__nos_calling_diff', 'moreq25cnt__calling_cnt', 'moreq25cnt__gprs_flow_video', 'valuecnt__if_nolimit~是', 'valuecnt__if_5g_dinner~是']
                    20220322-17:46:24      ---------------------------Psi: Mdlp_dt_DF start -------------------------------
                                           
                                           20220322-17:46:24  my toolmodule.dataprep.Mdlp_dt_DF fit_transform
                                           20220322-17:46:24      开始时间：2022-03-22 17:46:24
                                           20220322-17:46:24      data in : (3270, 139)
                                               
                                               20220322-17:46:24  my toolmodule.dataprep.Mdlp_dt_DF fit
                                               20220322-17:46:24      开始时间：2022-03-22 17:46:24
                                               20220322-17:46:24      data in : (3270, 139)
                                               20220322-17:46:24      首次从X获取id_X属性 2250526080248
                                               20220322-17:46:24      fit轨迹：Mdlp_dt_DF(if_del=False, )
                                               20220322-17:46:33      提取未离散的1字段名（无有效切点）：['account_id~其他_countlow']
                                               20220322-17:46:33      结束时间：2022-03-22 17:46:33 耗时(8s)
                                               
                                               20220322-17:46:33  my toolmodule.dataprep.Mdlp_dt_DF transform
                                               20220322-17:46:33      开始时间：2022-03-22 17:46:33
                                               20220322-17:46:33      data in : (3270, 139)
                                               20220322-17:46:33      self已带有id_X属性 2250526080248
                                               20220322-17:46:33      首次从X获取id_X_new属性 2250526080248
                                               20220322-17:46:33      未剔除1个字段：['account_id~其他_countlow']
                                               20220322-17:46:35      data out: (3270, 139)
                                               20220322-17:46:35      transform轨迹：Mdlp_dt_DF(if_del=False, )
                                               20220322-17:46:35      结束时间：2022-03-22 17:46:35 耗时(1s)
                                           
                                           20220322-17:46:35      my toolmodule.dataprep.Mdlp_dt_DF fit_transform 结束时间：2022-03-22 17:46:35 耗时(10s)
                    20220322-17:46:35      ---------------------------Psi: Mdlp_dt_DF end -------------------------------
                    20220322-17:46:35      合并离散后的数值字段 与 类别字段：(3270, 142)
                    20220322-17:46:35      data_train（初次） 统计频数（区分正负例）：self.col_pop_PN_old_
                    20220322-17:46:37      不统计频数（不区分正负例）：训练数据经过抽样，非原始比例，如有需要可自行修改
                    20220322-17:46:37      结束时间：2022-03-22 17:46:37 耗时(12s)


20220322-17:46:37  时间内验证集 data_timein


C:\Program Files\JetBrains\PyCharm 2020.3.3\plugins\python\helpers\pydev\pydevconsole.py:205: UserWarning: Pandas doesn't allow columns to be created via a new attribute name - see https://pandas.pydata.org/pandas-docs/stable/indexing.html#attribute-access
  
                    
                    20220322-17:46:37  my toolmodule.dataprep.PsiTransformer_DF transform
                    20220322-17:46:37      开始时间：2022-03-22 17:46:37
                    20220322-17:46:37      data in : (500, 150)
                    20220322-17:46:37      self已带有id_X属性 2250526534568
                    20220322-17:46:37      首次从X获取id_X_new属性 2248527707832
                    20220322-17:46:37      data in2: (500, 142)


C:\Users\higher\Desktop\to伟鹏的代码_v2\ModelProject\selfmodule\toolmodule\dataprep.py:342: UserWarning: Pandas doesn't allow columns to be created via a new attribute name - see https://pandas.pydata.org/pandas-docs/stable/indexing.html#attribute-access
  return x_ad
                    20220322-17:46:37      对139个数值字段进行分箱：['innet_months', 'gprs_last_defer', 'gprs_resource', 'gprs_now_rest', 'call_use', 'arpu', 'calling_cnt', 'calling_dura', 'calling_diff_cnt', 'calling_diff_dura', 'gprs_flow_5g', 'gprs_flow_busy', 'gprs_now_defer', 'gprs_flow_roam', 'call_dura_roam', 'days_call_p_4', 'nos_calling', 'nos_calling_diff', 'gprs_flow_video', 'gprs_flow_short', 'gprs_flow_music', 'gprs_flow_commu', 'gprs_flow_game', 'account_id~其他_countlow', 'greatest_gprs_app~commu', 'greatest_gprs_app~video', 'avg__calling_dura', 'avg__gprs_resource', 'avg__call_dura_roam', 'avg__calling_diff_cnt', 'avg__gprs_flow_busy', 'avg__gprs_flow_music', 'avg__gprs_last_defer', 'avg__gprs_now_defer', 'avg__nos_calling', 'avg__gprs_flow_roam', 'avg__calling_diff_dura', 'avg__gprs_now_rest', 'avg__monthsremain_last_stop_date', 'avg__gprs_flow_short', 'avg__gprs_flow_commu', 'avg__call_use', 'avg__gprs_flow_game', 'avg__arpu', 'avg__nos_calling_diff', 'avg__calling_cnt', 'avg__gprs_flow_video', 'sep__gprs_flow_5g', 'sep__gprs_last_defer', 'sep__nos_calling', 'sep__calling_diff_dura', 'sep__gprs_now_rest', 'sep__gprs_flow_commu', 'sep__gprs_flow_video', 'wave__gprs_flow_5g', 'wave__calling_dura', 'wave__gprs_resource', 'wave__gprs_flow_music', 'wave__gprs_last_defer', 'wave__gprs_now_defer', 'wave__gprs_now_rest', 'wave__call_use', 'wave__calling_cnt', 'grow__calling_dura', 'grow__gprs_last_defer', 'grow__gprs_now_defer', 'grow__nos_calling', 'grow__calling_diff_dura', 'grow__gprs_now_rest', 'grow__dinner_fee', 'grow__gprs_flow_commu', 'grow__call_use', 'grow__nos_calling_diff', 'grow__calling_cnt', 'grow__gprs_flow_video', 'max__gprs_flow_5g', 'max__calling_dura', 'max__call_dura_roam', 'max__calling_diff_cnt', 'max__gprs_last_defer', 'max__nos_calling', 'max__gprs_flow_roam', 'max__calling_diff_dura', 'max__gprs_now_rest', 'max__monthsremain_last_stop_date', 'max__call_use', 'max__arpu', 'max__nos_calling_diff', 'max__calling_cnt', 'min__calling_dura', 'min__gprs_resource', 'min__calling_diff_cnt', 'min__gprs_flow_busy', 'min__gprs_flow_music', 'min__gprs_last_defer', 'min__nos_calling', 'min__gprs_flow_roam', 'min__calling_diff_dura', 'min__gprs_now_rest', 'min__gprs_flow_short', 'min__gprs_flow_commu', 'min__call_use', 'min__gprs_flow_game', 'min__days_call_p_4', 'min__arpu', 'min__nos_calling_diff', 'min__calling_cnt', 'min__gprs_flow_video', 'std__calling_dura', 'std__gprs_resource', 'std__call_dura_roam', 'std__calling_diff_cnt', 'std__gprs_flow_busy', 'std__gprs_last_defer', 'std__nos_calling', 'std__calling_diff_dura', 'std__gprs_now_rest', 'std__gprs_flow_short', 'std__gprs_flow_commu', 'std__call_use', 'std__arpu', 'std__nos_calling_diff', 'std__calling_cnt', 'more0cnt__calling_cnt', 'moreq25cnt__gprs_flow_5g', 'moreq25cnt__calling_dura', 'moreq25cnt__gprs_resource', 'moreq25cnt__gprs_flow_busy', 'moreq25cnt__gprs_last_defer', 'moreq25cnt__gprs_now_defer', 'moreq25cnt__nos_calling', 'moreq25cnt__calling_diff_dura', 'moreq25cnt__gprs_flow_short', 'moreq25cnt__arpu', 'moreq25cnt__nos_calling_diff', 'moreq25cnt__calling_cnt', 'moreq25cnt__gprs_flow_video', 'valuecnt__if_nolimit~是', 'valuecnt__if_5g_dinner~是']
                    20220322-17:46:41      data_timein（初次） 统计频数（不区分正负例）：self.col_pop_all_old_
                    20220322-17:46:42      data_timein 计算稳定度（区分正负例）：self.col_psi_PN_


C:\Users\higher\Desktop\to伟鹏的代码_v2\ModelProject\selfmodule\toolmodule\dataprep.py:1146: UserWarning:      PsiTransformer data_timein 计算稳定性(区分正负例)-正例（1） ['account_id']字段多出392个取值, .head(5):
                      old  new
field      value              
account_id 101919658  NaN  1.0
           102197121  NaN  1.0
           102213846  NaN  1.0
           103546965  NaN  1.0
           103747748  NaN  1.0
  warnings.warn(s)


C:\Users\higher\Desktop\to伟鹏的代码_v2\ModelProject\selfmodule\toolmodule\dataprep.py:1146: UserWarning:      PsiTransformer data_timein 计算稳定性(区分正负例)-负例（0） ['account_id']字段多出392个取值, .head(5):
                      old  new
field      value              
account_id 101919658  NaN  1.0
           102197121  NaN  1.0
           102213846  NaN  1.0
           103546965  NaN  1.0
           103747748  NaN  1.0
  warnings.warn(s)


C:\Users\higher\Desktop\to伟鹏的代码_v2\ModelProject\selfmodule\toolmodule\dataprep.py:1335: UserWarning:      PsiTransformer data_timein 计算稳定性(区分正负例) ，2个字段稳定性>=psi_limit（0.1）：
account_id             0.264659
avg__gprs_now_defer    0.125947
dtype: float64
  warnings.warn(s)


C:\Users\higher\Desktop\to伟鹏的代码_v2\ModelProject\selfmodule\toolmodule\dataprep.py:453: UserWarning: Pandas doesn't allow columns to be created via a new attribute name - see https://pandas.pydata.org/pandas-docs/stable/indexing.html#attribute-access
  if self.unique_limit < np.float('inf'):  # 仅针对类别字段， 数值字段unique_limit应为无穷大
                    20220322-17:46:47      data out: (500, 142)
                    20220322-17:46:47      transform轨迹：PsiTransformer_DF(Ncase='0', Pcase='1', warn_mark=' PsiTransformer')
                    20220322-17:46:47      结束时间：2022-03-22 17:46:47 耗时(10s)


20220322-17:46:47  保存Info至：./binaryclassify/eg/traintest~202011~202012/Info~tabcre_train.pkl
20220322-17:46:47  结束时间：2022-03-22 17:46:47
20220322-17:46:47  耗时：232 s

                   ###################################################################### 训练集加工
                    
20220322-17:47:29  开始时间：2022-03-22 17:47:29
20220322-17:47:29  参数设置：
                       stage: create
                       step: train
                       table_in: ml.mid_eg_recent_train_202011
                       Info.model_name: 模型示例
                       Info.iv_limit: 0.05
                       Info.auto_pair2: False
                       Info.r_limit: 0.95

20220322-17:47:29  ------------------------- 读取数据: ml.mid_eg_recent_train_202011 2022-03-22 17:47:29 -------------------------
20220322-17:47:29      src: gp
20220322-17:47:29      condition: None
20220322-17:47:29      col_need(38): ['user_acct_month', 'data_use', 'acct_month', 'phone_no_null', 'user_id', 'account_id', 'innet_months', 'user_status', 'last_stop_date', 'dinner_fee', 'gprs_last_defer', 'gprs_resource', 'gprs_now_rest', 'call_use', 'if_nolimit', 'if_5g_dinner', 'arpu', 'calling_cnt', 'calling_dura', 'calling_diff_cnt', 'calling_diff_dura', 'gprs_flow_5g', 'gprs_flow_busy', 'gprs_now_defer', 'gprs_flow_roam', 'call_dura_roam', 'days_gprs', 'days_call', 'nos_calling', 'nos_calling_diff', 'sms_cnt', 'call_fee_local', 'gprs_flow_video', 'gprs_flow_short', 'gprs_flow_music', 'gprs_flow_commu', 'gprs_flow_game', 'flag_eg']
20220322-17:47:29      col_del: None
20220322-17:47:29      col_char(10): ['user_acct_month', 'data_use', 'acct_month', 'phone_no_null', 'user_id', 'account_id', 'user_status', 'if_nolimit', 'if_5g_dinner', 'flag_eg']
20220322-17:47:29      col_num(27): ['innet_months', 'dinner_fee', 'gprs_last_defer', 'gprs_resource', 'gprs_now_rest', 'call_use', 'arpu', 'calling_cnt', 'calling_dura', 'calling_diff_cnt', 'calling_diff_dura', 'gprs_flow_5g', 'gprs_flow_busy', 'gprs_now_defer', 'gprs_flow_roam', 'call_dura_roam', 'days_gprs', 'days_call', 'nos_calling', 'nos_calling_diff', 'sms_cnt', 'call_fee_local', 'gprs_flow_video', 'gprs_flow_short', 'gprs_flow_music', 'gprs_flow_commu', 'gprs_flow_game']
20220322-17:47:29      col_date(1): ['last_stop_date']
20220322-17:47:29      nrows: None
20220322-17:47:29      if_coltolower: True
20220322-17:47:29      kwargs: {}

20220322-17:47:29      读取
20220322-17:47:29      shape: (11278, 38)

20220322-17:47:29  -------------------------读取完毕: (11278, 38) 2022-03-22 17:47:29 -------------------------

20220322-17:47:29  手动衍生_py7个字段: {'monthsremain_last_stop_date': '最后停机时间：剩余时长', 'days_call_p': '通话天数占比', 'days_call_p_1': '通话天数占比_1', 'days_call_p_2': '通话天数占比_2', 'days_call_p_3': '通话天数占比_3', 'days_call_p_4': '通话天数占比_4', 'greatest_gprs_app': 'app偏好'}
20220322-17:47:29  monthsremain_last_stop_date: last_stop_date - current_date
20220322-17:47:29      将 monthsremain_last_stop_date 字段的 4 个缺失值赋值为: -99999 （非缺失的最小值-101.0）
20220322-17:47:29  days_call_p: days_call / days_month
20220322-17:47:29  days_call_p_1: days_call_p + days_gprs
20220322-17:47:29  days_call_p_2: days_call_p_1 + days_gprs
20220322-17:47:29  days_call_p_3: days_call_p_2 + days_gprs
20220322-17:47:29  days_call_p_4: days_call_p_3 + days_gprs
20220322-17:47:29  greatest_gprs_app: {'gprs_flow_video': 'video', 'gprs_flow_short': 'short', 'gprs_flow_music': 'music', 'gprs_flow_commu': 'commu', 'gprs_flow_game': 'game'}
20220322-17:47:32  数据量: (11278, 45)

20220322-17:47:32  检查数据
20220322-17:47:32  各账期数据量分布：
                       202009  data_timein    499
                       202009  data_train    3255
                       202010  data_timein    499
                       202010  data_train    3255
                       202011  data_timein    500
                       202011  data_train    3270
                       dtype: int64
20220322-17:47:32  各账期数据量不一致
20220322-17:47:32  以nan填充缺少账期的记录
20220322-17:47:33      修改后：
                       202009  data_timein    500
                       202009  data_train    3270
                       202010  data_timein    500
                       202010  data_train    3270
                       202011  data_timein    500
                       202011  data_train    3270
                       dtype: int64)
20220322-17:47:33  
                   diff_limitweiNone,不考察近n月字段各账期取值分布, dis_exam返回None！


20220322-17:47:33  填充数值型&类别型字段缺失值
20220322-17:47:33  日期型字段缺失值情况：
                       last_stop_date    36
                       dtype: int64

20220322-17:47:33  正负例分布：
                       data_timein  202011  0    420
                       data_timein  202011  1    80
                       data_train  202011  0    2180
                       data_train  202011  1    1090
                       dtype: int64

                   ----------------------------------------- 当月 类别型 onthot 
20220322-17:47:33  ['account_id~其他_countlow', 'greatest_gprs_app~commu', 'greatest_gprs_app~video']

                   ----------------------------------------- 当月 数值型&类别型 原始数据 
20220322-17:47:33  (3770, 38)
20220322-17:47:33  筛选衍生字段的 原始/手动衍生_sql 字段

                   ----------------------------------------- 近n月 数值型 近3月均值 
20220322-17:47:33  字段个数：21, 添加字段：None
20220322-17:47:33  (3770, 59)

                   ----------------------------------------- 近n月 数值型 近3月离散系数 
20220322-17:47:33  字段个数：7, 添加字段：None
20220322-17:47:33  (3770, 66)

                   ----------------------------------------- 近n月 数值型 近3月波动性 
20220322-17:47:33  字段个数：9, 添加字段：None
20220322-17:47:33  (3770, 75)

                   ----------------------------------------- 近n月 数值型 近3月成长率 
20220322-17:47:33  字段个数：12, 添加字段：None
20220322-17:47:33  (3770, 87)

                   ----------------------------------------- 近n月 数值型 近3月最大值 
20220322-17:47:33  字段个数：14, 添加字段：None
20220322-17:47:33  (3770, 101)

                   ----------------------------------------- 近n月 数值型 近3月最小值 
20220322-17:47:33  字段个数：19, 添加字段：None
20220322-17:47:33  (3770, 120)

                   ----------------------------------------- 近n月 数值型 近3月标准差 
20220322-17:47:33  字段个数：15, 添加字段：None
20220322-17:47:34  (3770, 135)

                   ----------------------------------------- 近n月 数值型 大于x的月份数 
20220322-17:47:34  ('more0cnt', '近3月大于0的月份数')
20220322-17:47:34  ('moreq25cnt', '近3月大于第一四分位数的月份数')
20220322-17:47:34  (3770, 149)

                   ----------------------------------------- 近n月 类别型 取某值的月份数 
20220322-17:47:34  字段个数：2, 添加字段：None
20220322-17:47:34  (3770, 151)

                   ----------------------------------------- 汇总最终宽表 
20220322-17:47:34  table.shape:(3770, 151)

20220322-17:47:34  保存宽表结果至：./binaryclassify/eg/traintest~202011~202012/train_data~202011.csv

20220322-17:47:35  计算字段之间的相关性系数
20220322-17:47:35  
                       count    9453.0
                       mean    0.163
                       std    0.195
                       min    0.0
                       25%    0.035
                       50%    0.096
                       75%    0.208
                       max    1.0
                       dtype: float64


                   ------------------------------- 计算宽表字段psi ------------------------------------ 
20220322-17:47:35  训练集 data_train
                    
                    20220322-17:47:35  my toolmodule.dataprep.PsiTransformer_DF fit
                    20220322-17:47:35      开始时间：2022-03-22 17:47:35
                    20220322-17:47:35      data in : (3270, 142)
                    20220322-17:47:35      首次从X获取id_X属性 2250514319960
                    20220322-17:47:35      fit轨迹：PsiTransformer_DF(Ncase='0', Pcase='1', warn_mark=' PsiTransformer')
                    20220322-17:47:35      输入数据中包括139个数值型字段，先对其进行mdlp分箱：['innet_months', 'gprs_last_defer', 'gprs_resource', 'gprs_now_rest', 'call_use', 'arpu', 'calling_cnt', 'calling_dura', 'calling_diff_cnt', 'calling_diff_dura', 'gprs_flow_5g', 'gprs_flow_busy', 'gprs_now_defer', 'gprs_flow_roam', 'call_dura_roam', 'days_call_p_4', 'nos_calling', 'nos_calling_diff', 'gprs_flow_video', 'gprs_flow_short', 'gprs_flow_music', 'gprs_flow_commu', 'gprs_flow_game', 'account_id~其他_countlow', 'greatest_gprs_app~commu', 'greatest_gprs_app~video', 'avg__calling_dura', 'avg__gprs_resource', 'avg__call_dura_roam', 'avg__calling_diff_cnt', 'avg__gprs_flow_busy', 'avg__gprs_flow_music', 'avg__gprs_last_defer', 'avg__gprs_now_defer', 'avg__nos_calling', 'avg__gprs_flow_roam', 'avg__calling_diff_dura', 'avg__gprs_now_rest', 'avg__monthsremain_last_stop_date', 'avg__gprs_flow_short', 'avg__gprs_flow_commu', 'avg__call_use', 'avg__gprs_flow_game', 'avg__arpu', 'avg__nos_calling_diff', 'avg__calling_cnt', 'avg__gprs_flow_video', 'sep__gprs_flow_5g', 'sep__gprs_last_defer', 'sep__nos_calling', 'sep__calling_diff_dura', 'sep__gprs_now_rest', 'sep__gprs_flow_commu', 'sep__gprs_flow_video', 'wave__gprs_flow_5g', 'wave__calling_dura', 'wave__gprs_resource', 'wave__gprs_flow_music', 'wave__gprs_last_defer', 'wave__gprs_now_defer', 'wave__gprs_now_rest', 'wave__call_use', 'wave__calling_cnt', 'grow__calling_dura', 'grow__gprs_last_defer', 'grow__gprs_now_defer', 'grow__nos_calling', 'grow__calling_diff_dura', 'grow__gprs_now_rest', 'grow__dinner_fee', 'grow__gprs_flow_commu', 'grow__call_use', 'grow__nos_calling_diff', 'grow__calling_cnt', 'grow__gprs_flow_video', 'max__gprs_flow_5g', 'max__calling_dura', 'max__call_dura_roam', 'max__calling_diff_cnt', 'max__gprs_last_defer', 'max__nos_calling', 'max__gprs_flow_roam', 'max__calling_diff_dura', 'max__gprs_now_rest', 'max__monthsremain_last_stop_date', 'max__call_use', 'max__arpu', 'max__nos_calling_diff', 'max__calling_cnt', 'min__calling_dura', 'min__gprs_resource', 'min__calling_diff_cnt', 'min__gprs_flow_busy', 'min__gprs_flow_music', 'min__gprs_last_defer', 'min__nos_calling', 'min__gprs_flow_roam', 'min__calling_diff_dura', 'min__gprs_now_rest', 'min__gprs_flow_short', 'min__gprs_flow_commu', 'min__call_use', 'min__gprs_flow_game', 'min__days_call_p_4', 'min__arpu', 'min__nos_calling_diff', 'min__calling_cnt', 'min__gprs_flow_video', 'std__calling_dura', 'std__gprs_resource', 'std__call_dura_roam', 'std__calling_diff_cnt', 'std__gprs_flow_busy', 'std__gprs_last_defer', 'std__nos_calling', 'std__calling_diff_dura', 'std__gprs_now_rest', 'std__gprs_flow_short', 'std__gprs_flow_commu', 'std__call_use', 'std__arpu', 'std__nos_calling_diff', 'std__calling_cnt', 'more0cnt__calling_cnt', 'moreq25cnt__gprs_flow_5g', 'moreq25cnt__calling_dura', 'moreq25cnt__gprs_resource', 'moreq25cnt__gprs_flow_busy', 'moreq25cnt__gprs_last_defer', 'moreq25cnt__gprs_now_defer', 'moreq25cnt__nos_calling', 'moreq25cnt__calling_diff_dura', 'moreq25cnt__gprs_flow_short', 'moreq25cnt__arpu', 'moreq25cnt__nos_calling_diff', 'moreq25cnt__calling_cnt', 'moreq25cnt__gprs_flow_video', 'valuecnt__if_nolimit~是', 'valuecnt__if_5g_dinner~是']
                    20220322-17:47:35      ---------------------------Psi: Mdlp_dt_DF start -------------------------------
                                           
                                           20220322-17:47:35  my toolmodule.dataprep.Mdlp_dt_DF fit_transform
                                           20220322-17:47:35      开始时间：2022-03-22 17:47:35
                                           20220322-17:47:35      data in : (3270, 139)
                                               
                                               20220322-17:47:35  my toolmodule.dataprep.Mdlp_dt_DF fit
                                               20220322-17:47:35      开始时间：2022-03-22 17:47:35
                                               20220322-17:47:35      data in : (3270, 139)
                                               20220322-17:47:35      首次从X获取id_X属性 2250491343648
                                               20220322-17:47:35      fit轨迹：Mdlp_dt_DF(if_del=False, )
                                               20220322-17:47:43      提取未离散的1字段名（无有效切点）：['account_id~其他_countlow']
                                               20220322-17:47:43      结束时间：2022-03-22 17:47:43 耗时(8s)
                                               
                                               20220322-17:47:43  my toolmodule.dataprep.Mdlp_dt_DF transform
                                               20220322-17:47:43      开始时间：2022-03-22 17:47:43
                                               20220322-17:47:43      data in : (3270, 139)
                                               20220322-17:47:43      self已带有id_X属性 2250491343648
                                               20220322-17:47:43      首次从X获取id_X_new属性 2250491343648
                                               20220322-17:47:43      未剔除1个字段：['account_id~其他_countlow']
                                               20220322-17:47:45      data out: (3270, 139)
                                               20220322-17:47:45      transform轨迹：Mdlp_dt_DF(if_del=False, )
                                               20220322-17:47:45      结束时间：2022-03-22 17:47:45 耗时(1s)
                                           
                                           20220322-17:47:45      my toolmodule.dataprep.Mdlp_dt_DF fit_transform 结束时间：2022-03-22 17:47:45 耗时(10s)
                    20220322-17:47:45      ---------------------------Psi: Mdlp_dt_DF end -------------------------------
                    20220322-17:47:45      合并离散后的数值字段 与 类别字段：(3270, 142)
                    20220322-17:47:45      data_train（初次） 统计频数（区分正负例）：self.col_pop_PN_old_
                    20220322-17:47:47      不统计频数（不区分正负例）：训练数据经过抽样，非原始比例，如有需要可自行修改
                    20220322-17:47:47      结束时间：2022-03-22 17:47:47 耗时(11s)


20220322-17:47:47  时间内验证集 data_timein
                    
                    20220322-17:47:47  my toolmodule.dataprep.PsiTransformer_DF transform
                    20220322-17:47:47      开始时间：2022-03-22 17:47:47
                    20220322-17:47:47      data in : (500, 150)
                    20220322-17:47:47      self已带有id_X属性 2250514319960
                    20220322-17:47:47      首次从X获取id_X_new属性 2248476946504
                    20220322-17:47:47      data in2: (500, 142)
                    20220322-17:47:47      对139个数值字段进行分箱：['innet_months', 'gprs_last_defer', 'gprs_resource', 'gprs_now_rest', 'call_use', 'arpu', 'calling_cnt', 'calling_dura', 'calling_diff_cnt', 'calling_diff_dura', 'gprs_flow_5g', 'gprs_flow_busy', 'gprs_now_defer', 'gprs_flow_roam', 'call_dura_roam', 'days_call_p_4', 'nos_calling', 'nos_calling_diff', 'gprs_flow_video', 'gprs_flow_short', 'gprs_flow_music', 'gprs_flow_commu', 'gprs_flow_game', 'account_id~其他_countlow', 'greatest_gprs_app~commu', 'greatest_gprs_app~video', 'avg__calling_dura', 'avg__gprs_resource', 'avg__call_dura_roam', 'avg__calling_diff_cnt', 'avg__gprs_flow_busy', 'avg__gprs_flow_music', 'avg__gprs_last_defer', 'avg__gprs_now_defer', 'avg__nos_calling', 'avg__gprs_flow_roam', 'avg__calling_diff_dura', 'avg__gprs_now_rest', 'avg__monthsremain_last_stop_date', 'avg__gprs_flow_short', 'avg__gprs_flow_commu', 'avg__call_use', 'avg__gprs_flow_game', 'avg__arpu', 'avg__nos_calling_diff', 'avg__calling_cnt', 'avg__gprs_flow_video', 'sep__gprs_flow_5g', 'sep__gprs_last_defer', 'sep__nos_calling', 'sep__calling_diff_dura', 'sep__gprs_now_rest', 'sep__gprs_flow_commu', 'sep__gprs_flow_video', 'wave__gprs_flow_5g', 'wave__calling_dura', 'wave__gprs_resource', 'wave__gprs_flow_music', 'wave__gprs_last_defer', 'wave__gprs_now_defer', 'wave__gprs_now_rest', 'wave__call_use', 'wave__calling_cnt', 'grow__calling_dura', 'grow__gprs_last_defer', 'grow__gprs_now_defer', 'grow__nos_calling', 'grow__calling_diff_dura', 'grow__gprs_now_rest', 'grow__dinner_fee', 'grow__gprs_flow_commu', 'grow__call_use', 'grow__nos_calling_diff', 'grow__calling_cnt', 'grow__gprs_flow_video', 'max__gprs_flow_5g', 'max__calling_dura', 'max__call_dura_roam', 'max__calling_diff_cnt', 'max__gprs_last_defer', 'max__nos_calling', 'max__gprs_flow_roam', 'max__calling_diff_dura', 'max__gprs_now_rest', 'max__monthsremain_last_stop_date', 'max__call_use', 'max__arpu', 'max__nos_calling_diff', 'max__calling_cnt', 'min__calling_dura', 'min__gprs_resource', 'min__calling_diff_cnt', 'min__gprs_flow_busy', 'min__gprs_flow_music', 'min__gprs_last_defer', 'min__nos_calling', 'min__gprs_flow_roam', 'min__calling_diff_dura', 'min__gprs_now_rest', 'min__gprs_flow_short', 'min__gprs_flow_commu', 'min__call_use', 'min__gprs_flow_game', 'min__days_call_p_4', 'min__arpu', 'min__nos_calling_diff', 'min__calling_cnt', 'min__gprs_flow_video', 'std__calling_dura', 'std__gprs_resource', 'std__call_dura_roam', 'std__calling_diff_cnt', 'std__gprs_flow_busy', 'std__gprs_last_defer', 'std__nos_calling', 'std__calling_diff_dura', 'std__gprs_now_rest', 'std__gprs_flow_short', 'std__gprs_flow_commu', 'std__call_use', 'std__arpu', 'std__nos_calling_diff', 'std__calling_cnt', 'more0cnt__calling_cnt', 'moreq25cnt__gprs_flow_5g', 'moreq25cnt__calling_dura', 'moreq25cnt__gprs_resource', 'moreq25cnt__gprs_flow_busy', 'moreq25cnt__gprs_last_defer', 'moreq25cnt__gprs_now_defer', 'moreq25cnt__nos_calling', 'moreq25cnt__calling_diff_dura', 'moreq25cnt__gprs_flow_short', 'moreq25cnt__arpu', 'moreq25cnt__nos_calling_diff', 'moreq25cnt__calling_cnt', 'moreq25cnt__gprs_flow_video', 'valuecnt__if_nolimit~是', 'valuecnt__if_5g_dinner~是']
                    20220322-17:47:51      data_timein（初次） 统计频数（不区分正负例）：self.col_pop_all_old_
                    20220322-17:47:52      data_timein 计算稳定度（区分正负例）：self.col_psi_PN_
                    20220322-17:47:57      data out: (500, 142)
                    20220322-17:47:57      transform轨迹：PsiTransformer_DF(Ncase='0', Pcase='1', warn_mark=' PsiTransformer')
                    20220322-17:47:57      结束时间：2022-03-22 17:47:57 耗时(10s)


20220322-17:47:57  保存Info至：./binaryclassify/eg/traintest~202011~202012/Info~tabcre_train.pkl
20220322-17:47:57  结束时间：2022-03-22 17:47:57
20220322-17:47:57  耗时：28 s


C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\series.py:3194: UserWarning: stage取值为create时,r_limit, iv_limit参数无效，将被忽略
  mapped = lib.map_infer(values, f, convert=convert_dtype)


C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\series.py:3194: UserWarning:      PsiTransformer data_timein 计算稳定性(区分正负例)-正例（1） ['account_id']字段多出392个取值, .head(5):
                      old  new
field      value              
account_id 101919658  NaN  1.0
           102197121  NaN  1.0
           102213846  NaN  1.0
           103546965  NaN  1.0
           103747748  NaN  1.0
  mapped = lib.map_infer(values, f, convert=convert_dtype)


C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\series.py:3194: UserWarning:      PsiTransformer data_timein 计算稳定性(区分正负例)-负例（0） ['account_id']字段多出392个取值, .head(5):
                      old  new
field      value              
account_id 101919658  NaN  1.0
           102197121  NaN  1.0
           102213846  NaN  1.0
           103546965  NaN  1.0
           103747748  NaN  1.0
  mapped = lib.map_infer(values, f, convert=convert_dtype)


C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\series.py:3194: UserWarning:      PsiTransformer data_timein 计算稳定性(区分正负例) ，2个字段稳定性>=psi_limit（0.1）：
account_id             0.264659
avg__gprs_now_defer    0.125947
dtype: float64
  mapped = lib.map_infer(values, f, convert=convert_dtype)
                   Out[230]: 20220322-17:48:12  True

                   ###################################################################### 加工测试账期近n月基础数据
                    
20220322-17:48:15  开始时间：2022-03-22 17:48:15
20220322-17:48:15  month: 202012
20220322-17:48:15  参数设置：
                       step: test
                       Info.model_name: 模型示例
                       Info.n_recent: 3
                       drop_midtable: True
                       cover_table_all: True
                       Info.timeout_limit: 1000

                   ------------------------------------- 检查各前置表 --------------------------------------------------- 
20220322-17:48:15  检查 ml.ml_feature_info_yw_user_m
20220322-17:48:16      72 列
20220322-17:48:16      202012账期： 15000行
20220322-17:48:16      202011账期： 10000行
20220322-17:48:16      202010账期： 15000行


20220322-17:48:16  检查 ml.ml_feature_add_yw_user_m
20220322-17:48:17      4 列
20220322-17:48:17      202012账期： 15000行
20220322-17:48:17      202011账期： 10000行
20220322-17:48:17      202010账期： 15000行


20220322-17:48:17  未设置Info.table_day



20220322-17:48:17  检查 ml.ml_target_info_yw_user_m
20220322-17:48:17      7 列
20220322-17:48:17      202012账期： 15000行

20220322-17:48:17      获取目标字段flag_eg类型：integer



                   -------------------- 汇总当期特征与目标：ml.dm_zc_moxing_info_target_202012 -------------------------- 
20220322-17:48:17  查询表： 
                       select concat(table_schema, '.', table_name) full_name
                       from information_schema.tables 
                       where table_schema = 'ml' and table_name='dm_zc_moxing_info_target_202012'
                       表不存在 
20220322-17:48:17  ml.dm_zc_moxing_info_target_202012不存在，将新建
20220322-17:48:17  建表语句： 
                       drop table if exists ml.dm_zc_moxing_info_target_202012;
                       select pg_sleep(10);
                       create table ml.dm_zc_moxing_info_target_202012 as
                       select * from (
                           select a.* 
                           , a2.age_add, a2.sex_add
                           ,b.flag_eg, b.ymonth_flag_eg2, b.ymonth, b.exe_sam, b.flag_eg2
                           from (select * from ml.ml_feature_info_yw_user_m where cast(acct_month as text)='202012') a 
                           left join (select*from ml.ml_feature_add_yw_user_m where cast(acct_month as text)='202012') a2 on a.user_id = a2.user_id
                           left join (select * from ml.ml_target_info_yw_user_m where cast(acct_month as text)='202012') b on a.user_id = b.user_id
                       ) t where 
                           phone_no_null is null and
                           last_stop_date is not null and
                           innet_months >= 3
20220322-17:48:28      sql执行完毕
20220322-17:48:28  统计 ml.dm_zc_moxing_info_target_202012 的行列数
20220322-17:48:28      12655行，79列
20220322-17:48:28  正负例分布： select cast(flag_eg as text) flag_eg, count(1) from ml.dm_zc_moxing_info_target_202012  group by flag_eg
20220322-17:48:28      dis_test_total: {'count': 12655, 'Pcount': 1871, 'prop': 0.148}


                   ------------------------- 测试集-当月账期数据：ml.mid_eg_now_test_202012 ---------------------------- 
20220322-17:48:28  正负例分布： select cast(flag_eg as text) flag_eg, count(1) from ml.dm_zc_moxing_info_target_202012 where user_status='在网-正常' and 
                       phone_no_null is null and
                       last_stop_date is not null and
                       innet_months >= 3 and flag_eg is not null group by flag_eg
20220322-17:48:28      dis_test_model {'count': 12449, 'Pcount': 1832, 'prop': 0.147}

20220322-17:48:28      dis_test_model 较 dis_train_model 正例占比 变动幅度4.25532% (0.147 较 0.141)

20220322-17:48:28  Info.timeout_limit取值为1000，抽取1000用户
20220322-17:48:28  建表语句（202012账期当月数据） 
                       drop table if exists ml.mid_eg_now_test_202012;
                       select pg_sleep(10);
                       create table ml.mid_eg_now_test_202012 as 
                       select *  from ml.dm_zc_moxing_info_target_202012
                       where user_status='在网-正常' and 
                           phone_no_null is null and
                           last_stop_date is not null and
                           innet_months >= 3 and flag_eg is not null
                       order by random() limit 1000
20220322-17:48:38      sql执行完毕
20220322-17:48:38  正负例分布： select cast(flag_eg as text) flag_eg, count(1) from ml.mid_eg_now_test_202012  group by flag_eg
20220322-17:48:39      dis_test_sample {'count': 1000, 'Pcount': 171, 'prop': 0.171}

20220322-17:48:39      dis_test_sample 较 dis_test_model 正例占比 变动幅度16.32653% (0.171 较 0.147)



C:\Program Files\JetBrains\PyCharm 2020.3.3\plugins\python\helpers\pydev\pydevconsole.py:411: UserWarning:     dis_test_sample 较 dis_test_model 正例占比 变动幅度16.32653% (0.171 较 0.147)

  process_exec_queue(interpreter)

                   ------------------------ 合并近n月数据：ml.mid_eg_recent_test_202012  -------------------------------- 
20220322-17:48:39  建表语句： 
                       drop table if exists ml.mid_eg_recent_test_202012;
                       select pg_sleep(10);
                       create table ml.mid_eg_recent_test_202012 as 
                       select user_acct_month, data_use, acct_month, user_id, phone_no_null, phone_no_tm, dinner_id, account_id, innet_date, innet_months, age, sex, user_status, last_stop_date, dinner, dinner_fee, gprs_last_defer, gprs_resource, gprs_now_rest, call_use, if_nolimit, if_5g_dinner, if_5g_term, if_jt, start_level, cred_type, if_cred_multi, arpu, pay_cnt, pay_fee, acct_balance, term_model, term_brand, term_type, sk_type, if_new_term, calling_cnt, calling_dura, called_cnt, called_dura, calling_diff_cnt, calling_diff_dura, gprs_flow, gprs_flow_4g, gprs_flow_5g, gprs_flow_busy, gprs_flow_idle, gprs_now_defer, gprs_flow_roam, call_dura_roam, days_roam, gprs_flow_gat, days_gat, days_gprs, days_call, nos_call, nos_calling, nos_calling_diff, sms_cnt, call_fee_local, call_fee_roam, gprs_income, gprs_fee, call_fee, gprs_flow_video, gprs_flow_short, gprs_flow_music, gprs_flow_commu, gprs_flow_game, flag_eg
                       from (
                           select cast(202012 as text) user_acct_month, cast('data_timeout'  as text) data_use, * from ml.mid_eg_now_test_202012
                       ) t0
                       union all 
                       select user_acct_month, data_use, acct_month, user_id, phone_no_null, phone_no_tm, dinner_id, account_id, innet_date, innet_months, age, sex, user_status, last_stop_date, dinner, dinner_fee, gprs_last_defer, gprs_resource, gprs_now_rest, call_use, if_nolimit, if_5g_dinner, if_5g_term, if_jt, start_level, cred_type, if_cred_multi, arpu, pay_cnt, pay_fee, acct_balance, term_model, term_brand, term_type, sk_type, if_new_term, calling_cnt, calling_dura, called_cnt, called_dura, calling_diff_cnt, calling_diff_dura, gprs_flow, gprs_flow_4g, gprs_flow_5g, gprs_flow_busy, gprs_flow_idle, gprs_now_defer, gprs_flow_roam, call_dura_roam, days_roam, gprs_flow_gat, days_gat, days_gprs, days_call, nos_call, nos_calling, nos_calling_diff, sms_cnt, call_fee_local, call_fee_roam, gprs_income, gprs_fee, call_fee, gprs_flow_video, gprs_flow_short, gprs_flow_music, gprs_flow_commu, gprs_flow_game, flag_eg
                       from (
                           select cast(202012 as text) user_acct_month, cast('data_timeout'  as text) data_use, 
                           b.* 
                           , a2.age_add, a2.sex_add 
                           , cast(NUlL as integer) flag_eg 
                           from ml.mid_eg_now_test_202012 a
                           inner join (select * from ml.ml_feature_info_yw_user_m where cast(acct_month as text)='202011') b on a.user_id = b.user_id
                           left join (select*from ml.ml_feature_add_yw_user_m where cast(acct_month as text)='202011') a2 on a.user_id = a2.user_id
                       ) t1
                       union all
                       select user_acct_month, data_use, acct_month, user_id, phone_no_null, phone_no_tm, dinner_id, account_id, innet_date, innet_months, age, sex, user_status, last_stop_date, dinner, dinner_fee, gprs_last_defer, gprs_resource, gprs_now_rest, call_use, if_nolimit, if_5g_dinner, if_5g_term, if_jt, start_level, cred_type, if_cred_multi, arpu, pay_cnt, pay_fee, acct_balance, term_model, term_brand, term_type, sk_type, if_new_term, calling_cnt, calling_dura, called_cnt, called_dura, calling_diff_cnt, calling_diff_dura, gprs_flow, gprs_flow_4g, gprs_flow_5g, gprs_flow_busy, gprs_flow_idle, gprs_now_defer, gprs_flow_roam, call_dura_roam, days_roam, gprs_flow_gat, days_gat, days_gprs, days_call, nos_call, nos_calling, nos_calling_diff, sms_cnt, call_fee_local, call_fee_roam, gprs_income, gprs_fee, call_fee, gprs_flow_video, gprs_flow_short, gprs_flow_music, gprs_flow_commu, gprs_flow_game, flag_eg
                       from (
                           select cast(202012 as text) user_acct_month, cast('data_timeout'  as text) data_use, 
                           b.* 
                           , a2.age_add, a2.sex_add 
                           , cast(NUlL as integer) flag_eg 
                           from ml.mid_eg_now_test_202012 a
                           inner join (select * from ml.ml_feature_info_yw_user_m where cast(acct_month as text)='202010') b on a.user_id = b.user_id
                           left join (select*from ml.ml_feature_add_yw_user_m where cast(acct_month as text)='202010') a2 on a.user_id = a2.user_id
                       ) t2
20220322-17:48:49      sql执行完毕
20220322-17:48:49  统计ml.mid_eg_recent_test_202012行列数
20220322-17:48:49      1000行，70列

                   --------------------------------- 核验各账期数据量  -------------------------------------------------- 
20220322-17:48:49  sql语句： 
                       select user_acct_month, data_use, acct_month, flag_eg, count(1) 
                       from ml.mid_eg_recent_test_202012 
                       group by user_acct_month, data_use, acct_month, flag_eg 
                       order by user_acct_month, data_use, acct_month, flag_eg

20220322-17:48:49  结果：
                     user_acct_month      data_use  acct_month  flag_eg  count
                   0          202012  data_timeout      202010      NaN   1000
                   1          202012  data_timeout      202011      NaN    657
                   2          202012  data_timeout      202012      0.0    829
                   3          202012  data_timeout      202012      1.0    171


C:\Program Files\JetBrains\PyCharm 2020.3.3\plugins\python\helpers\pydev\pydevconsole.py:908: UserWarning: 下列账期用户量不同，请检查！
                              acct_month  flag_eg  count
user_acct_month data_use                                
202012          data_timeout      202010      0.0   1000
                data_timeout      202011      0.0    657
                data_timeout      202012      1.0   1000

                   -------------------------------- 删除中间表 ----------------------------------------------------- 
20220322-17:48:49  sql语句： drop table if exists ml.mid_eg_model_test_202012
20220322-17:48:49      sql执行完毕
20220322-17:48:49  sql语句： drop table if exists ml.mid_eg_now_test_202012
20220322-17:48:50      sql执行完毕

20220322-17:48:50  返回结果表名：ml.mid_eg_recent_test_202012
20220322-17:48:50  将Info保存至./binaryclassify/eg/traintest~202011~202012/Info~base_test.pkl

20220322-17:48:50  结束时间：2022-03-22 17:48:50
20220322-17:48:50  耗时：34 s
                   ###################################################################### 测试集加工
                    
20220322-17:49:00  开始时间：2022-03-22 17:49:00
20220322-17:49:00  参数设置：
                       step: test
                       stage: create
                       table_in: ml.mid_eg_recent_test_202012
                       Info.model_name: 模型示例
                       Info.iv_limit: 0.05
                       Info.auto_pair2: False
                       Info.r_limit: 0.95

20220322-17:49:00  ------------------------- 读取数据: ml.mid_eg_recent_test_202012 2022-03-22 17:49:00 -------------------------
20220322-17:49:00      src: gp
20220322-17:49:00      condition: None
20220322-17:49:00      col_need(38): ['user_acct_month', 'data_use', 'acct_month', 'phone_no_null', 'user_id', 'account_id', 'innet_months', 'user_status', 'last_stop_date', 'dinner_fee', 'gprs_last_defer', 'gprs_resource', 'gprs_now_rest', 'call_use', 'if_nolimit', 'if_5g_dinner', 'arpu', 'calling_cnt', 'calling_dura', 'calling_diff_cnt', 'calling_diff_dura', 'gprs_flow_5g', 'gprs_flow_busy', 'gprs_now_defer', 'gprs_flow_roam', 'call_dura_roam', 'days_gprs', 'days_call', 'nos_calling', 'nos_calling_diff', 'sms_cnt', 'call_fee_local', 'gprs_flow_video', 'gprs_flow_short', 'gprs_flow_music', 'gprs_flow_commu', 'gprs_flow_game', 'flag_eg']
20220322-17:49:00      col_del: None
20220322-17:49:00      col_char(10): ['user_acct_month', 'data_use', 'acct_month', 'phone_no_null', 'user_id', 'account_id', 'user_status', 'if_nolimit', 'if_5g_dinner', 'flag_eg']
20220322-17:49:00      col_num(27): ['innet_months', 'dinner_fee', 'gprs_last_defer', 'gprs_resource', 'gprs_now_rest', 'call_use', 'arpu', 'calling_cnt', 'calling_dura', 'calling_diff_cnt', 'calling_diff_dura', 'gprs_flow_5g', 'gprs_flow_busy', 'gprs_now_defer', 'gprs_flow_roam', 'call_dura_roam', 'days_gprs', 'days_call', 'nos_calling', 'nos_calling_diff', 'sms_cnt', 'call_fee_local', 'gprs_flow_video', 'gprs_flow_short', 'gprs_flow_music', 'gprs_flow_commu', 'gprs_flow_game']
20220322-17:49:00      col_date(1): ['last_stop_date']
20220322-17:49:00      nrows: None
20220322-17:49:00      if_coltolower: True
20220322-17:49:00      kwargs: {}

20220322-17:49:01      读取
20220322-17:49:01      shape: (2657, 38)

20220322-17:49:01  -------------------------读取完毕: (2657, 38) 2022-03-22 17:49:01 -------------------------

20220322-17:49:01  手动衍生_py7个字段: {'monthsremain_last_stop_date': '最后停机时间：剩余时长', 'days_call_p': '通话天数占比', 'days_call_p_1': '通话天数占比_1', 'days_call_p_2': '通话天数占比_2', 'days_call_p_3': '通话天数占比_3', 'days_call_p_4': '通话天数占比_4', 'greatest_gprs_app': 'app偏好'}
20220322-17:49:01  monthsremain_last_stop_date: last_stop_date - current_date
20220322-17:49:01  days_call_p: days_call / days_month
20220322-17:49:01  days_call_p_1: days_call_p + days_gprs
20220322-17:49:01  days_call_p_2: days_call_p_1 + days_gprs
20220322-17:49:01  days_call_p_3: days_call_p_2 + days_gprs
20220322-17:49:01  days_call_p_4: days_call_p_3 + days_gprs
20220322-17:49:01  greatest_gprs_app: {'gprs_flow_video': 'video', 'gprs_flow_short': 'short', 'gprs_flow_music': 'music', 'gprs_flow_commu': 'commu', 'gprs_flow_game': 'game'}
20220322-17:49:02  数据量: (2657, 45)

20220322-17:49:02  检查数据
20220322-17:49:02  各账期数据量分布：
                       202010  data_timeout    1000
                       202011  data_timeout    657
                       202012  data_timeout    1000
                       dtype: int64
20220322-17:49:02  各账期数据量不一致
20220322-17:49:02  以nan填充缺少账期的记录
20220322-17:49:02      修改后：
                       202010  data_timeout    1000
                       202011  data_timeout    1000
                       202012  data_timeout    1000
                       dtype: int64)
20220322-17:49:02  
                   diff_limitweiNone,不考察近n月字段各账期取值分布, dis_exam返回None！


20220322-17:49:02  填充数值型&类别型字段缺失值
20220322-17:49:02  日期型字段缺失值情况：
                       last_stop_date    343
                       dtype: int64

20220322-17:49:02  正负例分布：
                       data_timeout  202012  0    829
                       data_timeout  202012  1    171
                       dtype: int64

                   ----------------------------------------- 当月 类别型 onthot 
20220322-17:49:02  ['account_id~其他_countlow', 'greatest_gprs_app~commu', 'greatest_gprs_app~video']

                   ----------------------------------------- 当月 数值型&类别型 原始数据 
20220322-17:49:02  (1000, 38)
20220322-17:49:02  筛选衍生字段的 原始/手动衍生_sql 字段

                   ----------------------------------------- 近n月 数值型 近3月均值 
20220322-17:49:02  字段个数：21, 添加字段：None
20220322-17:49:02  (1000, 59)

                   ----------------------------------------- 近n月 数值型 近3月离散系数 
20220322-17:49:02  字段个数：7, 添加字段：None
20220322-17:49:02  (1000, 66)

                   ----------------------------------------- 近n月 数值型 近3月波动性 
20220322-17:49:02  字段个数：9, 添加字段：None
20220322-17:49:02  (1000, 75)

                   ----------------------------------------- 近n月 数值型 近3月成长率 
20220322-17:49:02  字段个数：12, 添加字段：None
20220322-17:49:02  (1000, 87)

                   ----------------------------------------- 近n月 数值型 近3月最大值 
20220322-17:49:02  字段个数：14, 添加字段：None
20220322-17:49:03  (1000, 101)

                   ----------------------------------------- 近n月 数值型 近3月最小值 
20220322-17:49:03  字段个数：19, 添加字段：None
20220322-17:49:03  (1000, 120)

                   ----------------------------------------- 近n月 数值型 近3月标准差 
20220322-17:49:03  字段个数：15, 添加字段：None
20220322-17:49:03  (1000, 135)

                   ----------------------------------------- 近n月 数值型 大于x的月份数 
20220322-17:49:03  ('more0cnt', '近3月大于0的月份数')
20220322-17:49:03  ('moreq25cnt', '近3月大于第一四分位数的月份数')
20220322-17:49:03  (1000, 149)

                   ----------------------------------------- 近n月 类别型 取某值的月份数 
20220322-17:49:03  字段个数：2, 添加字段：None
20220322-17:49:03  (1000, 151)

                   ----------------------------------------- 汇总最终宽表 
20220322-17:49:03  table.shape:(1000, 151)

20220322-17:49:03  保存宽表结果至：./binaryclassify/eg/traintest~202011~202012/test_data~202012.csv

20220322-17:49:03  计算字段之间的相关性系数
20220322-17:49:03  
                       count    9453.0
                       mean    0.182
                       std    0.205
                       min    0.0
                       25%    0.047
                       50%    0.107
                       75%    0.226
                       max    1.0
                       dtype: float64


                   ------------------------------- 计算宽表字段psi ------------------------------------ 
                    
                    20220322-17:49:03  my toolmodule.dataprep.PsiTransformer_DF transform
                    20220322-17:49:03      开始时间：2022-03-22 17:49:03
                    20220322-17:49:03      data in : (1000, 151)
                    20220322-17:49:03      self已带有id_X属性 2250514319960
                    20220322-17:49:03      首次从X获取id_X_new属性 2250538182864
                    20220322-17:49:03      data in2: (1000, 142)
                    20220322-17:49:03      对139个数值字段进行分箱：['innet_months', 'gprs_last_defer', 'gprs_resource', 'gprs_now_rest', 'call_use', 'arpu', 'calling_cnt', 'calling_dura', 'calling_diff_cnt', 'calling_diff_dura', 'gprs_flow_5g', 'gprs_flow_busy', 'gprs_now_defer', 'gprs_flow_roam', 'call_dura_roam', 'days_call_p_4', 'nos_calling', 'nos_calling_diff', 'gprs_flow_video', 'gprs_flow_short', 'gprs_flow_music', 'gprs_flow_commu', 'gprs_flow_game', 'account_id~其他_countlow', 'greatest_gprs_app~commu', 'greatest_gprs_app~video', 'avg__calling_dura', 'avg__gprs_resource', 'avg__call_dura_roam', 'avg__calling_diff_cnt', 'avg__gprs_flow_busy', 'avg__gprs_flow_music', 'avg__gprs_last_defer', 'avg__gprs_now_defer', 'avg__nos_calling', 'avg__gprs_flow_roam', 'avg__calling_diff_dura', 'avg__gprs_now_rest', 'avg__monthsremain_last_stop_date', 'avg__gprs_flow_short', 'avg__gprs_flow_commu', 'avg__call_use', 'avg__gprs_flow_game', 'avg__arpu', 'avg__nos_calling_diff', 'avg__calling_cnt', 'avg__gprs_flow_video', 'sep__gprs_flow_5g', 'sep__gprs_last_defer', 'sep__nos_calling', 'sep__calling_diff_dura', 'sep__gprs_now_rest', 'sep__gprs_flow_commu', 'sep__gprs_flow_video', 'wave__gprs_flow_5g', 'wave__calling_dura', 'wave__gprs_resource', 'wave__gprs_flow_music', 'wave__gprs_last_defer', 'wave__gprs_now_defer', 'wave__gprs_now_rest', 'wave__call_use', 'wave__calling_cnt', 'grow__calling_dura', 'grow__gprs_last_defer', 'grow__gprs_now_defer', 'grow__nos_calling', 'grow__calling_diff_dura', 'grow__gprs_now_rest', 'grow__dinner_fee', 'grow__gprs_flow_commu', 'grow__call_use', 'grow__nos_calling_diff', 'grow__calling_cnt', 'grow__gprs_flow_video', 'max__gprs_flow_5g', 'max__calling_dura', 'max__call_dura_roam', 'max__calling_diff_cnt', 'max__gprs_last_defer', 'max__nos_calling', 'max__gprs_flow_roam', 'max__calling_diff_dura', 'max__gprs_now_rest', 'max__monthsremain_last_stop_date', 'max__call_use', 'max__arpu', 'max__nos_calling_diff', 'max__calling_cnt', 'min__calling_dura', 'min__gprs_resource', 'min__calling_diff_cnt', 'min__gprs_flow_busy', 'min__gprs_flow_music', 'min__gprs_last_defer', 'min__nos_calling', 'min__gprs_flow_roam', 'min__calling_diff_dura', 'min__gprs_now_rest', 'min__gprs_flow_short', 'min__gprs_flow_commu', 'min__call_use', 'min__gprs_flow_game', 'min__days_call_p_4', 'min__arpu', 'min__nos_calling_diff', 'min__calling_cnt', 'min__gprs_flow_video', 'std__calling_dura', 'std__gprs_resource', 'std__call_dura_roam', 'std__calling_diff_cnt', 'std__gprs_flow_busy', 'std__gprs_last_defer', 'std__nos_calling', 'std__calling_diff_dura', 'std__gprs_now_rest', 'std__gprs_flow_short', 'std__gprs_flow_commu', 'std__call_use', 'std__arpu', 'std__nos_calling_diff', 'std__calling_cnt', 'more0cnt__calling_cnt', 'moreq25cnt__gprs_flow_5g', 'moreq25cnt__calling_dura', 'moreq25cnt__gprs_resource', 'moreq25cnt__gprs_flow_busy', 'moreq25cnt__gprs_last_defer', 'moreq25cnt__gprs_now_defer', 'moreq25cnt__nos_calling', 'moreq25cnt__calling_diff_dura', 'moreq25cnt__gprs_flow_short', 'moreq25cnt__arpu', 'moreq25cnt__nos_calling_diff', 'moreq25cnt__calling_cnt', 'moreq25cnt__gprs_flow_video', 'valuecnt__if_nolimit~是', 'valuecnt__if_5g_dinner~是']
                    20220322-17:49:08      timedata_timeout 计算稳定度（不区分正负例）：self.col_psi_all_
                    20220322-17:49:10      data_timeout 计算稳定度（区分正负例）：self.col_psi_PN_
                    20220322-17:49:16      data out: (1000, 142)
                    20220322-17:49:16      transform轨迹：PsiTransformer_DF(Ncase='0', Pcase='1', warn_mark=' PsiTransformer')
                    20220322-17:49:16      结束时间：2022-03-22 17:49:16 耗时(12s)
20220322-17:49:16  保存Psi至：./binaryclassify/eg/traintest~202011~202012/test_Psi~202011~202012.pkl
20220322-17:49:16  保存dis_exam至：./binaryclassify/eg/traintest~202011~202012/test_dis_exam~202012.pkl
20220322-17:49:16  结束时间：2022-03-22 17:49:16
20220322-17:49:16  耗时：15 s


C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\series.py:3194: UserWarning: stage取值为create时,r_limit, iv_limit参数无效，将被忽略
  mapped = lib.map_infer(values, f, convert=convert_dtype)


C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\series.py:3194: UserWarning:      PsiTransformer timedata_timeout 计算稳定性(不区分正负例) ['account_id']字段多出700个取值, .head(5):
                      old  new
field      value              
account_id 101582294  NaN  1.0
           101923773  NaN  1.0
           102159025  NaN  1.0
           102186975  NaN  1.0
           102195262  NaN  1.0
  mapped = lib.map_infer(values, f, convert=convert_dtype)


C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\series.py:3194: UserWarning:      PsiTransformer timedata_timeout 计算稳定性(不区分正负例)，21个字段稳定性>=psi_limit（0.1）：
grow__dinner_fee                    2.319384
days_call_p_4                       0.990906
grow__call_use                      0.635633
grow__gprs_now_rest                 0.510291
wave__gprs_resource                 0.432064
min__gprs_now_rest                  0.415997
std__arpu                           0.343033
max__monthsremain_last_stop_date    0.277001
wave__gprs_now_defer                0.214392
grow__gprs_last_defer               0.165723
min__gprs_last_defer                0.146128
moreq25cnt__gprs_last_defer         0.144649
wave__gprs_now_rest                 0.138502
wave__calling_dura                  0.136839
moreq25cnt__calling_cnt             0.125419
grow__gprs_flow_video               0.124521
sep__gprs_now_rest                  0.124144
wave__gprs_last_defer               0.117207
sep__gprs_last_defer                0.115778
sep__gprs_flow_video                0.106386
moreq25cnt__nos_calling_diff        0.102624
dtype: float64
  mapped = lib.map_infer(values, f, convert=convert_dtype)


C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\series.py:3194: UserWarning:      PsiTransformer data_timeout 计算稳定性(区分正负例)-正例（1） ['account_id']字段多出529个取值, .head(5):
                      old  new
field      value              
account_id 102159025  NaN  1.0
           102186975  NaN  1.0
           102195262  NaN  1.0
           102221205  NaN  1.0
           102225221  NaN  1.0
  mapped = lib.map_infer(values, f, convert=convert_dtype)


C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\series.py:3194: UserWarning:      PsiTransformer data_timeout 计算稳定性(区分正负例)-负例（0） ['account_id']字段多出529个取值, .head(5):
                      old  new
field      value              
account_id 102159025  NaN  1.0
           102186975  NaN  1.0
           102195262  NaN  1.0
           102221205  NaN  1.0
           102225221  NaN  1.0
  mapped = lib.map_infer(values, f, convert=convert_dtype)


C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\series.py:3194: UserWarning:      PsiTransformer data_timeout 计算稳定性(区分正负例) ，32个字段稳定性>=psi_limit（0.1）：
grow__dinner_fee                    2.515802
days_call_p_4                       1.115943
grow__call_use                      0.650831
grow__gprs_now_rest                 0.563127
min__gprs_now_rest                  0.460587
wave__gprs_resource                 0.434657
std__arpu                           0.328371
max__monthsremain_last_stop_date    0.288237
moreq25cnt__calling_cnt             0.271037
wave__gprs_now_defer                0.225385
wave__gprs_flow_music               0.220614
min__gprs_last_defer                0.216695
moreq25cnt__nos_calling             0.204406
wave__gprs_now_rest                 0.197329
moreq25cnt__gprs_last_defer         0.193713
sep__gprs_now_rest                  0.190588
min__arpu                           0.190553
moreq25cnt__nos_calling_diff        0.176487
wave__calling_dura                  0.172625
sep__gprs_flow_commu                0.168089
min__nos_calling                    0.163970
grow__gprs_last_defer               0.148424
wave__gprs_last_defer               0.142473
sep__gprs_last_defer                0.134627
grow__gprs_flow_video               0.133704
sep__gprs_flow_video                0.131683
account_id                          0.128668
sep__nos_calling                    0.118302
min__gprs_resource                  0.115553
std__gprs_now_rest                  0.113814
wave__call_use                      0.113173
min__gprs_flow_busy                 0.101495
dtype: float64
  mapped = lib.map_infer(values, f, convert=convert_dtype)

                   ###################################################################### 创建数据处理流水线、算法序列
                    
20220322-17:49:27  创建数据转换流水线1


C:\Users\higher\Desktop\to伟鹏的代码_v2\ModelProject\selfmodule\toolmodule\dataprep.py:9: UserWarning: Pipeline_DF：verbose参数值被赋予print_indent后默认参数设置为None
  from collections import OrderedDict


C:\Users\higher\Desktop\to伟鹏的代码_v2\ModelProject\selfmodule\toolmodule\dataprep.py:9: UserWarning: FeatureUnion_DF：verbose参数值被赋予print_indent后默认参数设置为None
  from collections import OrderedDict
20220322-17:49:27  创建数据转换流水线2
20220322-17:49:27  创建数据转换流水线3
20220322-17:49:27  创建算法序列

                   ###################################################################### 训练测试过程
                    
20220322-17:49:29  开始时间：2022-03-22 17:49:29
20220322-17:49:29  模型名称：模型示例
20220322-17:49:29  参数设置：
                       Info.model_name: 模型示例
                       Info.trainproc_ratiolist: [1, 2, 10]
                       field_comment: (151, 14)
                       Info.freq_limit: 0.95
                       Info.unique_limit: 5000
                       Info.iv_limit: 0.05
                       Info.r_limit: 0.95
                       Info.random_state: None
20220322-17:49:29  mark: ~202011~202012
20220322-17:49:29  目标字段：flag_eg; 正负例取值：1、0
20220322-17:49:29  field_comment.shape: (151, 14)
20220322-17:49:29      len(col_need): 151
20220322-17:49:30      删除field_comment中into_model取值为‘删除’的2个字段：['phone_no_null', 'last_stop_date']
20220322-17:49:30      len(col_need): 151
20220322-17:49:30      删除Info.col_del中的1个字段：{'user_acct_month'}
20220322-17:49:30      len(col_need): 150

20220322-17:49:30      删除Info.supply_other、col_mark中的4个字段：{'last_stop_date', 'phone_no_null', 'sms_cnt', 'call_fee_local'}
20220322-17:49:30      len(col_need): 146

20220322-17:49:30  ------------------------- 读取数据: ./binaryclassify/eg/traintest~202011~202012/train_data~202011.csv 2022-03-22 17:49:30 -------------------------
20220322-17:49:30      src: file
20220322-17:49:30      condition: None
20220322-17:49:30      col_need(146): ['data_use', 'acct_month', 'user_id', 'account_id', 'innet_months', 'user_status', 'gprs_last_defer', 'gprs_resource', 'gprs_now_rest', 'call_use', 'arpu', 'calling_cnt', 'calling_dura', 'calling_diff_cnt', 'calling_diff_dura', 'gprs_flow_5g', 'gprs_flow_busy', 'gprs_now_defer', 'gprs_flow_roam', 'call_dura_roam', 'days_call_p_4', 'nos_calling', 'nos_calling_diff', 'gprs_flow_video', 'gprs_flow_short', 'gprs_flow_music', 'gprs_flow_commu', 'gprs_flow_game', 'greatest_gprs_app', 'account_id~其他_countlow', 'greatest_gprs_app~commu', 'greatest_gprs_app~video', 'avg__calling_dura', 'avg__gprs_resource', 'avg__call_dura_roam', 'avg__calling_diff_cnt', 'avg__gprs_flow_busy', 'avg__gprs_flow_music', 'avg__gprs_last_defer', 'avg__gprs_now_defer', 'avg__nos_calling', 'avg__gprs_flow_roam', 'avg__calling_diff_dura', 'avg__gprs_now_rest', 'avg__monthsremain_last_stop_date', 'avg__gprs_flow_short', 'avg__gprs_flow_commu', 'avg__call_use', 'avg__gprs_flow_game', 'avg__arpu', 'avg__nos_calling_diff', 'avg__calling_cnt', 'avg__gprs_flow_video', 'sep__gprs_flow_5g', 'sep__gprs_last_defer', 'sep__nos_calling', 'sep__calling_diff_dura', 'sep__gprs_now_rest', 'sep__gprs_flow_commu', 'sep__gprs_flow_video', 'wave__gprs_flow_5g', 'wave__calling_dura', 'wave__gprs_resource', 'wave__gprs_flow_music', 'wave__gprs_last_defer', 'wave__gprs_now_defer', 'wave__gprs_now_rest', 'wave__call_use', 'wave__calling_cnt', 'grow__calling_dura', 'grow__gprs_last_defer', 'grow__gprs_now_defer', 'grow__nos_calling', 'grow__calling_diff_dura', 'grow__gprs_now_rest', 'grow__dinner_fee', 'grow__gprs_flow_commu', 'grow__call_use', 'grow__nos_calling_diff', 'grow__calling_cnt', 'grow__gprs_flow_video', 'max__gprs_flow_5g', 'max__calling_dura', 'max__call_dura_roam', 'max__calling_diff_cnt', 'max__gprs_last_defer', 'max__nos_calling', 'max__gprs_flow_roam', 'max__calling_diff_dura', 'max__gprs_now_rest', 'max__monthsremain_last_stop_date', 'max__call_use', 'max__arpu', 'max__nos_calling_diff', 'max__calling_cnt', 'min__calling_dura', 'min__gprs_resource', 'min__calling_diff_cnt', 'min__gprs_flow_busy', 'min__gprs_flow_music', 'min__gprs_last_defer', 'min__nos_calling', 'min__gprs_flow_roam', 'min__calling_diff_dura', 'min__gprs_now_rest', 'min__gprs_flow_short', 'min__gprs_flow_commu', 'min__call_use', 'min__gprs_flow_game', 'min__days_call_p_4', 'min__arpu', 'min__nos_calling_diff', 'min__calling_cnt', 'min__gprs_flow_video', 'std__calling_dura', 'std__gprs_resource', 'std__call_dura_roam', 'std__calling_diff_cnt', 'std__gprs_flow_busy', 'std__gprs_last_defer', 'std__nos_calling', 'std__calling_diff_dura', 'std__gprs_now_rest', 'std__gprs_flow_short', 'std__gprs_flow_commu', 'std__call_use', 'std__arpu', 'std__nos_calling_diff', 'std__calling_cnt', 'flag_eg', 'more0cnt__calling_cnt', 'moreq25cnt__gprs_flow_5g', 'moreq25cnt__calling_dura', 'moreq25cnt__gprs_resource', 'moreq25cnt__gprs_flow_busy', 'moreq25cnt__gprs_last_defer', 'moreq25cnt__gprs_now_defer', 'moreq25cnt__nos_calling', 'moreq25cnt__calling_diff_dura', 'moreq25cnt__gprs_flow_short', 'moreq25cnt__arpu', 'moreq25cnt__nos_calling_diff', 'moreq25cnt__calling_cnt', 'moreq25cnt__gprs_flow_video', 'valuecnt__if_nolimit~是', 'valuecnt__if_5g_dinner~是']
20220322-17:49:30      col_del: None
20220322-17:49:30      col_char(9): ['user_acct_month', 'data_use', 'acct_month', 'phone_no_null', 'user_id', 'account_id', 'user_status', 'greatest_gprs_app', 'flag_eg']
20220322-17:49:30      col_num(141): ['innet_months', 'gprs_last_defer', 'gprs_resource', 'gprs_now_rest', 'call_use', 'arpu', 'calling_cnt', 'calling_dura', 'calling_diff_cnt', 'calling_diff_dura', 'gprs_flow_5g', 'gprs_flow_busy', 'gprs_now_defer', 'gprs_flow_roam', 'call_dura_roam', 'days_call_p_4', 'nos_calling', 'nos_calling_diff', 'sms_cnt', 'call_fee_local', 'gprs_flow_video', 'gprs_flow_short', 'gprs_flow_music', 'gprs_flow_commu', 'gprs_flow_game', 'account_id~其他_countlow', 'greatest_gprs_app~commu', 'greatest_gprs_app~video', 'avg__calling_dura', 'avg__gprs_resource', 'avg__call_dura_roam', 'avg__calling_diff_cnt', 'avg__gprs_flow_busy', 'avg__gprs_flow_music', 'avg__gprs_last_defer', 'avg__gprs_now_defer', 'avg__nos_calling', 'avg__gprs_flow_roam', 'avg__calling_diff_dura', 'avg__gprs_now_rest', 'avg__monthsremain_last_stop_date', 'avg__gprs_flow_short', 'avg__gprs_flow_commu', 'avg__call_use', 'avg__gprs_flow_game', 'avg__arpu', 'avg__nos_calling_diff', 'avg__calling_cnt', 'avg__gprs_flow_video', 'sep__gprs_flow_5g', 'sep__gprs_last_defer', 'sep__nos_calling', 'sep__calling_diff_dura', 'sep__gprs_now_rest', 'sep__gprs_flow_commu', 'sep__gprs_flow_video', 'wave__gprs_flow_5g', 'wave__calling_dura', 'wave__gprs_resource', 'wave__gprs_flow_music', 'wave__gprs_last_defer', 'wave__gprs_now_defer', 'wave__gprs_now_rest', 'wave__call_use', 'wave__calling_cnt', 'grow__calling_dura', 'grow__gprs_last_defer', 'grow__gprs_now_defer', 'grow__nos_calling', 'grow__calling_diff_dura', 'grow__gprs_now_rest', 'grow__dinner_fee', 'grow__gprs_flow_commu', 'grow__call_use', 'grow__nos_calling_diff', 'grow__calling_cnt', 'grow__gprs_flow_video', 'max__gprs_flow_5g', 'max__calling_dura', 'max__call_dura_roam', 'max__calling_diff_cnt', 'max__gprs_last_defer', 'max__nos_calling', 'max__gprs_flow_roam', 'max__calling_diff_dura', 'max__gprs_now_rest', 'max__monthsremain_last_stop_date', 'max__call_use', 'max__arpu', 'max__nos_calling_diff', 'max__calling_cnt', 'min__calling_dura', 'min__gprs_resource', 'min__calling_diff_cnt', 'min__gprs_flow_busy', 'min__gprs_flow_music', 'min__gprs_last_defer', 'min__nos_calling', 'min__gprs_flow_roam', 'min__calling_diff_dura', 'min__gprs_now_rest', 'min__gprs_flow_short', 'min__gprs_flow_commu', 'min__call_use', 'min__gprs_flow_game', 'min__days_call_p_4', 'min__arpu', 'min__nos_calling_diff', 'min__calling_cnt', 'min__gprs_flow_video', 'std__calling_dura', 'std__gprs_resource', 'std__call_dura_roam', 'std__calling_diff_cnt', 'std__gprs_flow_busy', 'std__gprs_last_defer', 'std__nos_calling', 'std__calling_diff_dura', 'std__gprs_now_rest', 'std__gprs_flow_short', 'std__gprs_flow_commu', 'std__call_use', 'std__arpu', 'std__nos_calling_diff', 'std__calling_cnt', 'more0cnt__calling_cnt', 'moreq25cnt__gprs_flow_5g', 'moreq25cnt__calling_dura', 'moreq25cnt__gprs_resource', 'moreq25cnt__gprs_flow_busy', 'moreq25cnt__gprs_last_defer', 'moreq25cnt__gprs_now_defer', 'moreq25cnt__nos_calling', 'moreq25cnt__calling_diff_dura', 'moreq25cnt__gprs_flow_short', 'moreq25cnt__arpu', 'moreq25cnt__nos_calling_diff', 'moreq25cnt__calling_cnt', 'moreq25cnt__gprs_flow_video', 'valuecnt__if_nolimit~是', 'valuecnt__if_5g_dinner~是']
20220322-17:49:30      col_date: None
20220322-17:49:30      nrows: None
20220322-17:49:30      if_coltolower: False
20220322-17:49:30      kwargs: {}

20220322-17:49:30      读取
20220322-17:49:30  -------------------------读取完毕: (3770, 146) 2022-03-22 17:49:30 -------------------------

20220322-17:49:30  ------------------------- 读取数据: ./binaryclassify/eg/traintest~202011~202012/test_data~202012.csv 2022-03-22 17:49:30 -------------------------
20220322-17:49:30      src: file
20220322-17:49:30      condition: None
20220322-17:49:30      col_need(146): ['data_use', 'acct_month', 'user_id', 'account_id', 'innet_months', 'user_status', 'gprs_last_defer', 'gprs_resource', 'gprs_now_rest', 'call_use', 'arpu', 'calling_cnt', 'calling_dura', 'calling_diff_cnt', 'calling_diff_dura', 'gprs_flow_5g', 'gprs_flow_busy', 'gprs_now_defer', 'gprs_flow_roam', 'call_dura_roam', 'days_call_p_4', 'nos_calling', 'nos_calling_diff', 'gprs_flow_video', 'gprs_flow_short', 'gprs_flow_music', 'gprs_flow_commu', 'gprs_flow_game', 'greatest_gprs_app', 'account_id~其他_countlow', 'greatest_gprs_app~commu', 'greatest_gprs_app~video', 'avg__calling_dura', 'avg__gprs_resource', 'avg__call_dura_roam', 'avg__calling_diff_cnt', 'avg__gprs_flow_busy', 'avg__gprs_flow_music', 'avg__gprs_last_defer', 'avg__gprs_now_defer', 'avg__nos_calling', 'avg__gprs_flow_roam', 'avg__calling_diff_dura', 'avg__gprs_now_rest', 'avg__monthsremain_last_stop_date', 'avg__gprs_flow_short', 'avg__gprs_flow_commu', 'avg__call_use', 'avg__gprs_flow_game', 'avg__arpu', 'avg__nos_calling_diff', 'avg__calling_cnt', 'avg__gprs_flow_video', 'sep__gprs_flow_5g', 'sep__gprs_last_defer', 'sep__nos_calling', 'sep__calling_diff_dura', 'sep__gprs_now_rest', 'sep__gprs_flow_commu', 'sep__gprs_flow_video', 'wave__gprs_flow_5g', 'wave__calling_dura', 'wave__gprs_resource', 'wave__gprs_flow_music', 'wave__gprs_last_defer', 'wave__gprs_now_defer', 'wave__gprs_now_rest', 'wave__call_use', 'wave__calling_cnt', 'grow__calling_dura', 'grow__gprs_last_defer', 'grow__gprs_now_defer', 'grow__nos_calling', 'grow__calling_diff_dura', 'grow__gprs_now_rest', 'grow__dinner_fee', 'grow__gprs_flow_commu', 'grow__call_use', 'grow__nos_calling_diff', 'grow__calling_cnt', 'grow__gprs_flow_video', 'max__gprs_flow_5g', 'max__calling_dura', 'max__call_dura_roam', 'max__calling_diff_cnt', 'max__gprs_last_defer', 'max__nos_calling', 'max__gprs_flow_roam', 'max__calling_diff_dura', 'max__gprs_now_rest', 'max__monthsremain_last_stop_date', 'max__call_use', 'max__arpu', 'max__nos_calling_diff', 'max__calling_cnt', 'min__calling_dura', 'min__gprs_resource', 'min__calling_diff_cnt', 'min__gprs_flow_busy', 'min__gprs_flow_music', 'min__gprs_last_defer', 'min__nos_calling', 'min__gprs_flow_roam', 'min__calling_diff_dura', 'min__gprs_now_rest', 'min__gprs_flow_short', 'min__gprs_flow_commu', 'min__call_use', 'min__gprs_flow_game', 'min__days_call_p_4', 'min__arpu', 'min__nos_calling_diff', 'min__calling_cnt', 'min__gprs_flow_video', 'std__calling_dura', 'std__gprs_resource', 'std__call_dura_roam', 'std__calling_diff_cnt', 'std__gprs_flow_busy', 'std__gprs_last_defer', 'std__nos_calling', 'std__calling_diff_dura', 'std__gprs_now_rest', 'std__gprs_flow_short', 'std__gprs_flow_commu', 'std__call_use', 'std__arpu', 'std__nos_calling_diff', 'std__calling_cnt', 'flag_eg', 'more0cnt__calling_cnt', 'moreq25cnt__gprs_flow_5g', 'moreq25cnt__calling_dura', 'moreq25cnt__gprs_resource', 'moreq25cnt__gprs_flow_busy', 'moreq25cnt__gprs_last_defer', 'moreq25cnt__gprs_now_defer', 'moreq25cnt__nos_calling', 'moreq25cnt__calling_diff_dura', 'moreq25cnt__gprs_flow_short', 'moreq25cnt__arpu', 'moreq25cnt__nos_calling_diff', 'moreq25cnt__calling_cnt', 'moreq25cnt__gprs_flow_video', 'valuecnt__if_nolimit~是', 'valuecnt__if_5g_dinner~是']
20220322-17:49:30      col_del: None
20220322-17:49:30      col_char(9): ['user_acct_month', 'data_use', 'acct_month', 'phone_no_null', 'user_id', 'account_id', 'user_status', 'greatest_gprs_app', 'flag_eg']
20220322-17:49:30      col_num(141): ['innet_months', 'gprs_last_defer', 'gprs_resource', 'gprs_now_rest', 'call_use', 'arpu', 'calling_cnt', 'calling_dura', 'calling_diff_cnt', 'calling_diff_dura', 'gprs_flow_5g', 'gprs_flow_busy', 'gprs_now_defer', 'gprs_flow_roam', 'call_dura_roam', 'days_call_p_4', 'nos_calling', 'nos_calling_diff', 'sms_cnt', 'call_fee_local', 'gprs_flow_video', 'gprs_flow_short', 'gprs_flow_music', 'gprs_flow_commu', 'gprs_flow_game', 'account_id~其他_countlow', 'greatest_gprs_app~commu', 'greatest_gprs_app~video', 'avg__calling_dura', 'avg__gprs_resource', 'avg__call_dura_roam', 'avg__calling_diff_cnt', 'avg__gprs_flow_busy', 'avg__gprs_flow_music', 'avg__gprs_last_defer', 'avg__gprs_now_defer', 'avg__nos_calling', 'avg__gprs_flow_roam', 'avg__calling_diff_dura', 'avg__gprs_now_rest', 'avg__monthsremain_last_stop_date', 'avg__gprs_flow_short', 'avg__gprs_flow_commu', 'avg__call_use', 'avg__gprs_flow_game', 'avg__arpu', 'avg__nos_calling_diff', 'avg__calling_cnt', 'avg__gprs_flow_video', 'sep__gprs_flow_5g', 'sep__gprs_last_defer', 'sep__nos_calling', 'sep__calling_diff_dura', 'sep__gprs_now_rest', 'sep__gprs_flow_commu', 'sep__gprs_flow_video', 'wave__gprs_flow_5g', 'wave__calling_dura', 'wave__gprs_resource', 'wave__gprs_flow_music', 'wave__gprs_last_defer', 'wave__gprs_now_defer', 'wave__gprs_now_rest', 'wave__call_use', 'wave__calling_cnt', 'grow__calling_dura', 'grow__gprs_last_defer', 'grow__gprs_now_defer', 'grow__nos_calling', 'grow__calling_diff_dura', 'grow__gprs_now_rest', 'grow__dinner_fee', 'grow__gprs_flow_commu', 'grow__call_use', 'grow__nos_calling_diff', 'grow__calling_cnt', 'grow__gprs_flow_video', 'max__gprs_flow_5g', 'max__calling_dura', 'max__call_dura_roam', 'max__calling_diff_cnt', 'max__gprs_last_defer', 'max__nos_calling', 'max__gprs_flow_roam', 'max__calling_diff_dura', 'max__gprs_now_rest', 'max__monthsremain_last_stop_date', 'max__call_use', 'max__arpu', 'max__nos_calling_diff', 'max__calling_cnt', 'min__calling_dura', 'min__gprs_resource', 'min__calling_diff_cnt', 'min__gprs_flow_busy', 'min__gprs_flow_music', 'min__gprs_last_defer', 'min__nos_calling', 'min__gprs_flow_roam', 'min__calling_diff_dura', 'min__gprs_now_rest', 'min__gprs_flow_short', 'min__gprs_flow_commu', 'min__call_use', 'min__gprs_flow_game', 'min__days_call_p_4', 'min__arpu', 'min__nos_calling_diff', 'min__calling_cnt', 'min__gprs_flow_video', 'std__calling_dura', 'std__gprs_resource', 'std__call_dura_roam', 'std__calling_diff_cnt', 'std__gprs_flow_busy', 'std__gprs_last_defer', 'std__nos_calling', 'std__calling_diff_dura', 'std__gprs_now_rest', 'std__gprs_flow_short', 'std__gprs_flow_commu', 'std__call_use', 'std__arpu', 'std__nos_calling_diff', 'std__calling_cnt', 'more0cnt__calling_cnt', 'moreq25cnt__gprs_flow_5g', 'moreq25cnt__calling_dura', 'moreq25cnt__gprs_resource', 'moreq25cnt__gprs_flow_busy', 'moreq25cnt__gprs_last_defer', 'moreq25cnt__gprs_now_defer', 'moreq25cnt__nos_calling', 'moreq25cnt__calling_diff_dura', 'moreq25cnt__gprs_flow_short', 'moreq25cnt__arpu', 'moreq25cnt__nos_calling_diff', 'moreq25cnt__calling_cnt', 'moreq25cnt__gprs_flow_video', 'valuecnt__if_nolimit~是', 'valuecnt__if_5g_dinner~是']
20220322-17:49:30      col_date: None
20220322-17:49:30      nrows: None
20220322-17:49:30      if_coltolower: False
20220322-17:49:30      kwargs: {}

20220322-17:49:30      读取
20220322-17:49:30  -------------------------读取完毕: (1000, 146) 2022-03-22 17:49:30 -------------------------

20220322-17:49:30  合并训练、测试数据
20220322-17:49:30  data.shape: (4770, 146)

20220322-17:49:30  数据分布：
                       202011  data_timein  0    420
                       202011  data_timein  1    80
                       202011  data_train  0    2180
                       202011  data_train  1    1090
                       202012  data_timeout  0    829
                       202012  data_timeout  1    171
                       dtype: int64

20220322-17:49:30  数据集整合：
20220322-17:49:30  -------------------------- train --------------------------
20220322-17:49:30  校验账期:                    20220322-17:49:30      通过
20220322-17:49:30  trainproc_ratiolist：[1, 2, 10]
20220322-17:49:30  正负例实际比例最高：1:2.0，将trainproc_ratiolist纠正为:[1, 2]
20220322-17:49:30  随机抽样 1:1
20220322-17:49:30      正例样本：1090
20220322-17:49:30      负例样本：2180
20220322-17:49:30          从负例中随机抽取1090（1090*1）
20220322-17:49:30  随机抽样 1:2
20220322-17:49:30      正例样本：1090
20220322-17:49:30      负例样本：2180
20220322-17:49:30          从负例中随机抽取2180（1090*2）
20220322-17:49:30  -------------------------- timein --------------------------
20220322-17:49:30  校验账期:                    20220322-17:49:30      通过
20220322-17:49:30  -------------------------- timeout --------------------------
20220322-17:49:30  校验账期:                    20220322-17:49:30      通过
20220322-17:49:30  具备data_timeout数据集，以其测试效果评估模型

20220322-17:49:30  遍历不同的抽样比例、数据预处理流水线、算法 进行训练测试:

20220322-17:49:30  ------------------------------------------ 抽样比例：ratio_1_1 ------------------------------------------

20220322-17:49:30  ------------------------- 流水线：pipeline1 -------------------------
20220322-17:49:30  train_X: (2180, 144)
20220322-17:49:59  转换完毕，进入模型(X+Y)：(1000, 129)

20220322-17:49:59  训练测试 LGBMClassifier_DF - boosting_type='gbdt', colsample_bytree=0.9916168768550919, importance_type='split', is_unbalance=False, learning_rate=0.02269504678452342, max_depth=-1, min_child_samples=165, min_child_weight=0.001, min_split_gain=0.0, n_estimators=169, n_jobs=-1, num_leaves=22, reg_alpha=0.36607148130872236, reg_lambda=0.10119960284131346, silent=True, subsample=0.9304256141925331, subsample_for_bin=40000, subsample_freq=0
20220322-17:50:00  data_timeout测试效果：
                        累计人数占比 累计人数 累计人数_1 累计查准率 累计查全率 累计提升度
                                1.0%       10          8      80.0%       4.7%        4.7
                                5.0%       50         28      56.0%      16.4%        3.3
                               10.0%      100         50      50.0%      29.2%        2.9
                               20.0%      200         79      39.5%      46.2%        2.3
                               30.0%      300         96      32.0%      56.1%        1.9
                               40.0%      400        107      26.8%      62.6%        1.6
                               50.0%      500        119      23.8%      69.6%        1.4
                               60.0%      600        128      21.3%      74.9%        1.2
                               70.0%      700        144      20.6%      84.2%        1.2
                               80.0%      800        157      19.6%      91.8%        1.1
                               90.0%      900        164      18.2%      95.9%        1.1
                              100.0%     1000        171      17.1%     100.0%          1

20220322-17:50:00  训练测试 LGBMClassifier_DF - boosting_type='dart', objective='binary', num_leaves=511, learning_rate=0.1, colsample_bytree=0.8, subsample=0.6, subsample_freq=20
20220322-17:50:01  data_timeout测试效果：
                        累计人数占比 累计人数 累计人数_1 累计查准率 累计查全率 累计提升度
                                1.0%       10          6      60.0%       3.5%        3.5
                                5.0%       50         27      54.0%      15.8%        3.2
                               10.0%      100         51      51.0%      29.8%          3
                               20.0%      200         82      41.0%      48.0%        2.4
                               30.0%      300        100      33.3%      58.5%        1.9
                               39.9%      399        114      28.6%      66.7%        1.7
                               50.0%      500        132      26.4%      77.2%        1.5
                               60.0%      600        142      23.7%      83.0%        1.4
                               70.1%      701        152      21.7%      88.9%        1.3
                               80.0%      800        158      19.8%      92.4%        1.2
                               90.0%      900        164      18.2%      95.9%        1.1
                              100.0%     1000        171      17.1%     100.0%          1

20220322-17:50:01  训练测试 XGBClassifier_DF - 默认参数
20220322-17:50:02  data_timeout测试效果：
                        累计人数占比 累计人数 累计人数_1 累计查准率 累计查全率 累计提升度
                                1.0%       10          5      50.0%       2.9%        2.9
                                5.0%       50         24      48.0%      14.0%        2.8
                               10.0%      100         47      47.0%      27.5%        2.7
                               20.0%      200         81      40.5%      47.4%        2.4
                               30.0%      300         96      32.0%      56.1%        1.9
                               40.0%      400        116      29.0%      67.8%        1.7
                               50.0%      500        132      26.4%      77.2%        1.5
                               60.0%      600        139      23.2%      81.3%        1.4
                               70.0%      700        146      20.9%      85.4%        1.2
                               80.0%      800        157      19.6%      91.8%        1.1
                               90.0%      900        163      18.1%      95.3%        1.1
                              100.0%     1000        171      17.1%     100.0%          1

20220322-17:50:02  训练测试 RandomForestClassifier_DF - 默认参数
20220322-17:50:03  data_timeout测试效果：
                        累计人数占比 累计人数 累计人数_1 累计查准率 累计查全率 累计提升度
                                1.0%       10          8      80.0%       4.7%        4.7
                                5.6%       56         35      62.5%      20.5%        3.7
                               10.8%      108         58      53.7%      33.9%        3.1
                               21.1%      211         90      42.7%      52.6%        2.5
                               30.5%      305        108      35.4%      63.2%        2.1
                               41.3%      413        123      29.8%      71.9%        1.7
                               50.0%      500        140      28.0%      81.9%        1.6
                               61.1%      611        149      24.4%      87.1%        1.4
                               70.0%      700        160      22.9%      93.6%        1.3
                               80.1%      801        165      20.6%      96.5%        1.2
                               90.2%      902        169      18.7%      98.8%        1.1
                              100.0%     1000        171      17.1%     100.0%          1

20220322-17:50:03  训练测试 RandomForestClassifier_DF - n_estimators=500, max_features=0.06, max_depth=10, min_samples_split=1000, min_samples_leaf=1000
20220322-17:50:04  data_timeout测试效果：
                        累计人数占比 累计人数 累计人数_1 累计查准率 累计查全率 累计提升度
                              100.0%     1000        171      17.1%     100.0%          1
                              100.0%     1000        171      17.1%     100.0%          1
                              100.0%     1000        171      17.1%     100.0%          1
                              100.0%     1000        171      17.1%     100.0%          1
                              100.0%     1000        171      17.1%     100.0%          1
                              100.0%     1000        171      17.1%     100.0%          1
                              100.0%     1000        171      17.1%     100.0%          1
                              100.0%     1000        171      17.1%     100.0%          1
                              100.0%     1000        171      17.1%     100.0%          1
                              100.0%     1000        171      17.1%     100.0%          1
                              100.0%     1000        171      17.1%     100.0%          1
                              100.0%     1000        171      17.1%     100.0%          1

20220322-17:50:04  训练测试 RandomForestClassifier_DF - n_estimators=100, max_features=0.06, max_depth=10, min_samples_split=1000, min_samples_leaf=1000
20220322-17:50:04  data_timeout测试效果：
                        累计人数占比 累计人数 累计人数_1 累计查准率 累计查全率 累计提升度
                              100.0%     1000        171      17.1%     100.0%          1
                              100.0%     1000        171      17.1%     100.0%          1
                              100.0%     1000        171      17.1%     100.0%          1
                              100.0%     1000        171      17.1%     100.0%          1
                              100.0%     1000        171      17.1%     100.0%          1
                              100.0%     1000        171      17.1%     100.0%          1
                              100.0%     1000        171      17.1%     100.0%          1
                              100.0%     1000        171      17.1%     100.0%          1
                              100.0%     1000        171      17.1%     100.0%          1
                              100.0%     1000        171      17.1%     100.0%          1
                              100.0%     1000        171      17.1%     100.0%          1
                              100.0%     1000        171      17.1%     100.0%          1

20220322-17:50:04  训练测试 LogisticRegression_DF - solver='liblinear'
20220322-17:50:05  data_timeout测试效果：
                        累计人数占比 累计人数 累计人数_1 累计查准率 累计查全率 累计提升度
                                1.0%       10          6      60.0%       3.5%        3.5
                                5.0%       50         22      44.0%      12.9%        2.6
                               10.0%      100         40      40.0%      23.4%        2.3
                               20.0%      200         70      35.0%      40.9%          2
                               30.0%      300         93      31.0%      54.4%        1.8
                               40.0%      400        109      27.3%      63.7%        1.6
                               50.0%      500        120      24.0%      70.2%        1.4
                               60.0%      600        131      21.8%      76.6%        1.3
                               70.1%      701        141      20.1%      82.5%        1.2
                               80.0%      800        151      18.9%      88.3%        1.1
                               90.0%      900        162      18.0%      94.7%        1.1
                              100.0%     1000        171      17.1%     100.0%          1

20220322-17:50:05  ------------------------- 流水线：pipeline2 -------------------------
20220322-17:50:05  train_X: (2180, 144)
20220322-17:50:34  转换完毕，进入模型(X+Y)：(1000, 127)

20220322-17:50:34  训练测试 LGBMClassifier_DF - boosting_type='gbdt', colsample_bytree=0.9916168768550919, importance_type='split', is_unbalance=False, learning_rate=0.02269504678452342, max_depth=-1, min_child_samples=165, min_child_weight=0.001, min_split_gain=0.0, n_estimators=169, n_jobs=-1, num_leaves=22, reg_alpha=0.36607148130872236, reg_lambda=0.10119960284131346, silent=True, subsample=0.9304256141925331, subsample_for_bin=40000, subsample_freq=0
20220322-17:50:35  data_timeout测试效果：
                        累计人数占比 累计人数 累计人数_1 累计查准率 累计查全率 累计提升度
                                1.0%       10          8      80.0%       4.7%        4.7
                                5.0%       50         29      58.0%      17.0%        3.4
                               10.0%      100         48      48.0%      28.1%        2.8
                               20.0%      200         80      40.0%      46.8%        2.3
                               30.0%      300        100      33.3%      58.5%        1.9
                               40.0%      400        113      28.2%      66.1%        1.7
                               50.0%      500        126      25.2%      73.7%        1.5
                               60.0%      600        138      23.0%      80.7%        1.3
                               70.0%      700        149      21.3%      87.1%        1.2
                               80.1%      801        162      20.2%      94.7%        1.2
                               90.0%      900        166      18.4%      97.1%        1.1
                              100.0%     1000        171      17.1%     100.0%          1

20220322-17:50:35  训练测试 LGBMClassifier_DF - boosting_type='dart', objective='binary', num_leaves=511, learning_rate=0.1, colsample_bytree=0.8, subsample=0.6, subsample_freq=20
20220322-17:50:36  data_timeout测试效果：
                        累计人数占比 累计人数 累计人数_1 累计查准率 累计查全率 累计提升度
                                1.0%       10          9      90.0%       5.3%        5.3
                                5.0%       50         31      62.0%      18.1%        3.6
                               10.0%      100         49      49.0%      28.7%        2.9
                               20.0%      200         81      40.5%      47.4%        2.4
                               30.0%      300        104      34.7%      60.8%          2
                               40.0%      400        119      29.8%      69.6%        1.7
                               50.0%      500        140      28.0%      81.9%        1.6
                               60.0%      600        146      24.3%      85.4%        1.4
                               70.0%      700        162      23.1%      94.7%        1.4
                               80.0%      800        166      20.8%      97.1%        1.2
                               90.0%      900        167      18.6%      97.7%        1.1
                              100.0%     1000        171      17.1%     100.0%          1

20220322-17:50:36  训练测试 XGBClassifier_DF - 默认参数
20220322-17:50:37  data_timeout测试效果：
                        累计人数占比 累计人数 累计人数_1 累计查准率 累计查全率 累计提升度
                                1.0%       10          7      70.0%       4.1%        4.1
                                5.0%       50         22      44.0%      12.9%        2.6
                               10.0%      100         49      49.0%      28.7%        2.9
                               20.0%      200         81      40.5%      47.4%        2.4
                               30.0%      300        103      34.3%      60.2%          2
                               40.0%      400        119      29.8%      69.6%        1.7
                               50.0%      500        131      26.2%      76.6%        1.5
                               60.0%      600        146      24.3%      85.4%        1.4
                               70.0%      700        157      22.4%      91.8%        1.3
                               80.0%      800        165      20.6%      96.5%        1.2
                               90.0%      900        168      18.7%      98.2%        1.1
                              100.0%     1000        171      17.1%     100.0%          1

20220322-17:50:37  训练测试 RandomForestClassifier_DF - 默认参数
20220322-17:50:39  data_timeout测试效果：
                        累计人数占比 累计人数 累计人数_1 累计查准率 累计查全率 累计提升度
                                1.0%       10          8      80.0%       4.7%        4.7
                                5.2%       52         31      59.6%      18.1%        3.5
                               10.9%      109         59      54.1%      34.5%        3.2
                               21.7%      217         92      42.4%      53.8%        2.5
                               30.4%      304        117      38.5%      68.4%        2.3
                               40.0%      400        134      33.5%      78.4%          2
                               50.0%      500        142      28.4%      83.0%        1.7
                               61.3%      613        157      25.6%      91.8%        1.5
                               71.7%      717        166      23.2%      97.1%        1.4
                               80.0%      800        170      21.2%      99.4%        1.2
                               90.1%      901        171      19.0%     100.0%        1.1
                              100.0%     1000        171      17.1%     100.0%          1

20220322-17:50:39  训练测试 RandomForestClassifier_DF - n_estimators=500, max_features=0.06, max_depth=10, min_samples_split=1000, min_samples_leaf=1000
20220322-17:50:39  data_timeout测试效果：
                        累计人数占比 累计人数 累计人数_1 累计查准率 累计查全率 累计提升度
                              100.0%     1000        171      17.1%     100.0%          1
                              100.0%     1000        171      17.1%     100.0%          1
                              100.0%     1000        171      17.1%     100.0%          1
                              100.0%     1000        171      17.1%     100.0%          1
                              100.0%     1000        171      17.1%     100.0%          1
                              100.0%     1000        171      17.1%     100.0%          1
                              100.0%     1000        171      17.1%     100.0%          1
                              100.0%     1000        171      17.1%     100.0%          1
                              100.0%     1000        171      17.1%     100.0%          1
                              100.0%     1000        171      17.1%     100.0%          1
                              100.0%     1000        171      17.1%     100.0%          1
                              100.0%     1000        171      17.1%     100.0%          1

20220322-17:50:39  训练测试 RandomForestClassifier_DF - n_estimators=100, max_features=0.06, max_depth=10, min_samples_split=1000, min_samples_leaf=1000
20220322-17:50:40  data_timeout测试效果：
                        累计人数占比 累计人数 累计人数_1 累计查准率 累计查全率 累计提升度
                              100.0%     1000        171      17.1%     100.0%          1
                              100.0%     1000        171      17.1%     100.0%          1
                              100.0%     1000        171      17.1%     100.0%          1
                              100.0%     1000        171      17.1%     100.0%          1
                              100.0%     1000        171      17.1%     100.0%          1
                              100.0%     1000        171      17.1%     100.0%          1
                              100.0%     1000        171      17.1%     100.0%          1
                              100.0%     1000        171      17.1%     100.0%          1
                              100.0%     1000        171      17.1%     100.0%          1
                              100.0%     1000        171      17.1%     100.0%          1
                              100.0%     1000        171      17.1%     100.0%          1
                              100.0%     1000        171      17.1%     100.0%          1

20220322-17:50:40  训练测试 LogisticRegression_DF - solver='liblinear'
20220322-17:50:40  data_timeout测试效果：
                        累计人数占比 累计人数 累计人数_1 累计查准率 累计查全率 累计提升度
                                1.0%       10          4      40.0%       2.3%        2.3
                                5.0%       50         24      48.0%      14.0%        2.8
                               10.0%      100         47      47.0%      27.5%        2.7
                               20.0%      200         74      37.0%      43.3%        2.2
                               30.0%      300         92      30.7%      53.8%        1.8
                               40.0%      400        111      27.8%      64.9%        1.6
                               50.0%      500        127      25.4%      74.3%        1.5
                               60.0%      600        136      22.7%      79.5%        1.3
                               70.0%      700        148      21.1%      86.5%        1.2
                               80.0%      800        155      19.4%      90.6%        1.1
                               90.0%      900        165      18.3%      96.5%        1.1
                              100.0%     1000        171      17.1%     100.0%          1

20220322-17:50:40  ------------------------------------------ 抽样比例：ratio_1_2 ------------------------------------------

20220322-17:50:40  ------------------------- 流水线：pipeline1 -------------------------
20220322-17:50:40  train_X: (3270, 144)
20220322-17:51:12  转换完毕，进入模型(X+Y)：(1000, 137)

20220322-17:51:12  训练测试 LGBMClassifier_DF - boosting_type='gbdt', colsample_bytree=0.9916168768550919, importance_type='split', is_unbalance=False, learning_rate=0.02269504678452342, max_depth=-1, min_child_samples=165, min_child_weight=0.001, min_split_gain=0.0, n_estimators=169, n_jobs=-1, num_leaves=22, reg_alpha=0.36607148130872236, reg_lambda=0.10119960284131346, silent=True, subsample=0.9304256141925331, subsample_for_bin=40000, subsample_freq=0
20220322-17:51:13  data_timeout测试效果：
                        累计人数占比 累计人数 累计人数_1 累计查准率 累计查全率 累计提升度
                                1.0%       10          7      70.0%       4.1%        4.1
                                5.0%       50         29      58.0%      17.0%        3.4
                               10.0%      100         50      50.0%      29.2%        2.9
                               20.0%      200         82      41.0%      48.0%        2.4
                               30.0%      300         93      31.0%      54.4%        1.8
                               40.0%      400        110      27.5%      64.3%        1.6
                               50.0%      500        122      24.4%      71.3%        1.4
                               60.0%      600        134      22.3%      78.4%        1.3
                               70.0%      700        151      21.6%      88.3%        1.3
                               80.0%      800        157      19.6%      91.8%        1.1
                               90.0%      900        163      18.1%      95.3%        1.1
                              100.0%     1000        171      17.1%     100.0%          1

20220322-17:51:13  训练测试 LGBMClassifier_DF - boosting_type='dart', objective='binary', num_leaves=511, learning_rate=0.1, colsample_bytree=0.8, subsample=0.6, subsample_freq=20
20220322-17:51:14  data_timeout测试效果：
                        累计人数占比 累计人数 累计人数_1 累计查准率 累计查全率 累计提升度
                                1.0%       10          8      80.0%       4.7%        4.7
                                5.0%       50         27      54.0%      15.8%        3.2
                               10.0%      100         48      48.0%      28.1%        2.8
                               20.0%      200         78      39.0%      45.6%        2.3
                               30.0%      300         94      31.3%      55.0%        1.8
                               40.0%      400        111      27.8%      64.9%        1.6
                               50.0%      500        127      25.4%      74.3%        1.5
                               60.0%      600        145      24.2%      84.8%        1.4
                               70.0%      700        152      21.7%      88.9%        1.3
                               80.0%      800        160      20.0%      93.6%        1.2
                               90.1%      901        164      18.2%      95.9%        1.1
                              100.0%     1000        171      17.1%     100.0%          1

20220322-17:51:14  训练测试 XGBClassifier_DF - 默认参数
20220322-17:51:16  data_timeout测试效果：
                        累计人数占比 累计人数 累计人数_1 累计查准率 累计查全率 累计提升度
                                1.0%       10          7      70.0%       4.1%        4.1
                                5.0%       50         31      62.0%      18.1%        3.6
                               10.0%      100         49      49.0%      28.7%        2.9
                               20.0%      200         76      38.0%      44.4%        2.2
                               30.0%      300        100      33.3%      58.5%        1.9
                               40.0%      400        116      29.0%      67.8%        1.7
                               50.0%      500        131      26.2%      76.6%        1.5
                               60.0%      600        145      24.2%      84.8%        1.4
                               70.1%      701        152      21.7%      88.9%        1.3
                               80.0%      800        157      19.6%      91.8%        1.1
                               90.0%      900        164      18.2%      95.9%        1.1
                              100.0%     1000        171      17.1%     100.0%          1

20220322-17:51:16  训练测试 RandomForestClassifier_DF - 默认参数
20220322-17:51:16  data_timeout测试效果：
                        累计人数占比 累计人数 累计人数_1 累计查准率 累计查全率 累计提升度
                                1.0%       10          9      90.0%       5.3%        5.3
                                5.4%       54         38      70.4%      22.2%        4.1
                               10.6%      106         58      54.7%      33.9%        3.2
                               20.5%      205         95      46.3%      55.6%        2.7
                               30.2%      302        111      36.8%      64.9%        2.1
                               41.5%      415        132      31.8%      77.2%        1.9
                               50.1%      501        137      27.3%      80.1%        1.6
                               60.4%      604        150      24.8%      87.7%        1.5
                               70.3%      703        160      22.8%      93.6%        1.3
                               80.2%      802        164      20.4%      95.9%        1.2
                               90.0%      900        169      18.8%      98.8%        1.1
                              100.0%     1000        171      17.1%     100.0%          1

20220322-17:51:17  训练测试 RandomForestClassifier_DF - n_estimators=500, max_features=0.06, max_depth=10, min_samples_split=1000, min_samples_leaf=1000
20220322-17:51:18  data_timeout测试效果：
                        累计人数占比 累计人数 累计人数_1 累计查准率 累计查全率 累计提升度
                                4.3%       43         10      23.3%       5.8%        1.4
                                6.1%       61         18      29.5%      10.5%        1.7
                               10.1%      101         33      32.7%      19.3%        1.9
                               20.0%      200         51      25.5%      29.8%        1.5
                               33.8%      338         84      24.9%      49.1%        1.5
                               40.3%      403         96      23.8%      56.1%        1.4
                               50.1%      501        112      22.4%      65.5%        1.3
                               70.0%      700        139      19.9%      81.3%        1.2
                               70.0%      700        139      19.9%      81.3%        1.2
                               80.0%      800        155      19.4%      90.6%        1.1
                              100.0%     1000        171      17.1%     100.0%          1
                              100.0%     1000        171      17.1%     100.0%          1

20220322-17:51:18  训练测试 RandomForestClassifier_DF - n_estimators=100, max_features=0.06, max_depth=10, min_samples_split=1000, min_samples_leaf=1000
20220322-17:51:18  data_timeout测试效果：
                        累计人数占比 累计人数 累计人数_1 累计查准率 累计查全率 累计提升度
                                5.6%       56         17      30.4%       9.9%        1.8
                                5.6%       56         17      30.4%       9.9%        1.8
                               10.0%      100         25      25.0%      14.6%        1.5
                               20.0%      200         46      23.0%      26.9%        1.3
                               30.1%      301         63      20.9%      36.8%        1.2
                               46.2%      462         99      21.4%      57.9%        1.3
                               53.7%      537        112      20.9%      65.5%        1.2
                               60.1%      601        124      20.6%      72.5%        1.2
                               75.2%      752        148      19.7%      86.5%        1.2
                               85.4%      854        161      18.9%      94.2%        1.1
                              100.0%     1000        171      17.1%     100.0%          1
                              100.0%     1000        171      17.1%     100.0%          1

20220322-17:51:18  训练测试 LogisticRegression_DF - solver='liblinear'
20220322-17:51:19  data_timeout测试效果：
                        累计人数占比 累计人数 累计人数_1 累计查准率 累计查全率 累计提升度
                                1.0%       10          6      60.0%       3.5%        3.5
                                5.0%       50         25      50.0%      14.6%        2.9
                               10.0%      100         44      44.0%      25.7%        2.6
                               20.0%      200         74      37.0%      43.3%        2.2
                               30.0%      300         93      31.0%      54.4%        1.8
                               40.0%      400        107      26.8%      62.6%        1.6
                               50.0%      500        122      24.4%      71.3%        1.4
                               60.0%      600        132      22.0%      77.2%        1.3
                               70.0%      700        144      20.6%      84.2%        1.2
                               80.0%      800        153      19.1%      89.5%        1.1
                               90.0%      900        162      18.0%      94.7%        1.1
                              100.0%     1000        171      17.1%     100.0%          1

20220322-17:51:19  ------------------------- 流水线：pipeline2 -------------------------
20220322-17:51:19  train_X: (3270, 144)
20220322-17:51:51  转换完毕，进入模型(X+Y)：(1000, 136)

20220322-17:51:51  训练测试 LGBMClassifier_DF - boosting_type='gbdt', colsample_bytree=0.9916168768550919, importance_type='split', is_unbalance=False, learning_rate=0.02269504678452342, max_depth=-1, min_child_samples=165, min_child_weight=0.001, min_split_gain=0.0, n_estimators=169, n_jobs=-1, num_leaves=22, reg_alpha=0.36607148130872236, reg_lambda=0.10119960284131346, silent=True, subsample=0.9304256141925331, subsample_for_bin=40000, subsample_freq=0
20220322-17:51:52  data_timeout测试效果：
                        累计人数占比 累计人数 累计人数_1 累计查准率 累计查全率 累计提升度
                                1.0%       10          7      70.0%       4.1%        4.1
                                5.0%       50         28      56.0%      16.4%        3.3
                               10.0%      100         51      51.0%      29.8%          3
                               20.0%      200         80      40.0%      46.8%        2.3
                               30.0%      300        103      34.3%      60.2%          2
                               40.0%      400        117      29.2%      68.4%        1.7
                               50.0%      500        131      26.2%      76.6%        1.5
                               60.0%      600        142      23.7%      83.0%        1.4
                               70.0%      700        153      21.9%      89.5%        1.3
                               80.0%      800        161      20.1%      94.2%        1.2
                               90.0%      900        167      18.6%      97.7%        1.1
                              100.0%     1000        171      17.1%     100.0%          1

20220322-17:51:52  训练测试 LGBMClassifier_DF - boosting_type='dart', objective='binary', num_leaves=511, learning_rate=0.1, colsample_bytree=0.8, subsample=0.6, subsample_freq=20
20220322-17:51:53  data_timeout测试效果：
                        累计人数占比 累计人数 累计人数_1 累计查准率 累计查全率 累计提升度
                                1.0%       10          7      70.0%       4.1%        4.1
                                5.0%       50         30      60.0%      17.5%        3.5
                               10.0%      100         52      52.0%      30.4%          3
                               20.0%      200         84      42.0%      49.1%        2.5
                               30.0%      300        108      36.0%      63.2%        2.1
                               40.0%      400        123      30.8%      71.9%        1.8
                               50.0%      500        134      26.8%      78.4%        1.6
                               60.0%      600        151      25.2%      88.3%        1.5
                               70.0%      700        156      22.3%      91.2%        1.3
                               80.0%      800        164      20.5%      95.9%        1.2
                               90.0%      900        168      18.7%      98.2%        1.1
                              100.0%     1000        171      17.1%     100.0%          1

20220322-17:51:53  训练测试 XGBClassifier_DF - 默认参数
20220322-17:51:55  data_timeout测试效果：
                        累计人数占比 累计人数 累计人数_1 累计查准率 累计查全率 累计提升度
                                1.0%       10          8      80.0%       4.7%        4.7
                                5.0%       50         31      62.0%      18.1%        3.6
                               10.0%      100         62      62.0%      36.3%        3.6
                               20.0%      200         93      46.5%      54.4%        2.7
                               30.0%      300        115      38.3%      67.3%        2.2
                               40.0%      400        133      33.2%      77.8%        1.9
                               50.0%      500        139      27.8%      81.3%        1.6
                               60.0%      600        150      25.0%      87.7%        1.5
                               70.0%      700        158      22.6%      92.4%        1.3
                               80.0%      800        162      20.2%      94.7%        1.2
                               90.0%      900        169      18.8%      98.8%        1.1
                              100.0%     1000        171      17.1%     100.0%          1

20220322-17:51:55  训练测试 RandomForestClassifier_DF - 默认参数
20220322-17:51:56  data_timeout测试效果：
                        累计人数占比 累计人数 累计人数_1 累计查准率 累计查全率 累计提升度
                                1.0%       10          9      90.0%       5.3%        5.3
                                5.0%       50         36      72.0%      21.1%        4.2
                               10.0%      100         56      56.0%      32.7%        3.3
                               20.1%      201         97      48.3%      56.7%        2.8
                               31.3%      313        120      38.3%      70.2%        2.2
                               40.0%      400        137      34.2%      80.1%          2
                               52.0%      520        151      29.0%      88.3%        1.7
                               61.0%      610        158      25.9%      92.4%        1.5
                               71.9%      719        166      23.1%      97.1%        1.4
                               80.7%      807        170      21.1%      99.4%        1.2
                               91.0%      910        171      18.8%     100.0%        1.1
                              100.0%     1000        171      17.1%     100.0%          1

20220322-17:51:56  训练测试 RandomForestClassifier_DF - n_estimators=500, max_features=0.06, max_depth=10, min_samples_split=1000, min_samples_leaf=1000
20220322-17:51:58  data_timeout测试效果：
                        累计人数占比 累计人数 累计人数_1 累计查准率 累计查全率 累计提升度
                                1.0%       10          4      40.0%       2.3%        2.3
                                5.0%       50         21      42.0%      12.3%        2.5
                               10.0%      100         31      31.0%      18.1%        1.8
                               20.0%      200         62      31.0%      36.3%        1.8
                               30.0%      300         76      25.3%      44.4%        1.5
                               40.0%      400         98      24.5%      57.3%        1.4
                               50.0%      500        111      22.2%      64.9%        1.3
                               60.0%      600        127      21.2%      74.3%        1.2
                               70.0%      700        140      20.0%      81.9%        1.2
                               80.0%      800        151      18.9%      88.3%        1.1
                               90.1%      901        163      18.1%      95.3%        1.1
                              100.0%     1000        171      17.1%     100.0%          1

20220322-17:51:58  训练测试 RandomForestClassifier_DF - n_estimators=100, max_features=0.06, max_depth=10, min_samples_split=1000, min_samples_leaf=1000
20220322-17:51:58  data_timeout测试效果：
                        累计人数占比 累计人数 累计人数_1 累计查准率 累计查全率 累计提升度
                                1.6%       16         10      62.5%       5.8%        3.7
                                5.0%       50         22      44.0%      12.9%        2.6
                               10.0%      100         33      33.0%      19.3%        1.9
                               20.0%      200         55      27.5%      32.2%        1.6
                               30.1%      301         74      24.6%      43.3%        1.4
                               40.0%      400         96      24.0%      56.1%        1.4
                               50.0%      500        112      22.4%      65.5%        1.3
                               60.0%      600        125      20.8%      73.1%        1.2
                               70.0%      700        142      20.3%      83.0%        1.2
                               80.0%      800        151      18.9%      88.3%        1.1
                               90.0%      900        164      18.2%      95.9%        1.1
                              100.0%     1000        171      17.1%     100.0%          1

20220322-17:51:58  训练测试 LogisticRegression_DF - solver='liblinear'
20220322-17:51:59  data_timeout测试效果：
                        累计人数占比 累计人数 累计人数_1 累计查准率 累计查全率 累计提升度
                                1.0%       10          6      60.0%       3.5%        3.5
                                5.0%       50         29      58.0%      17.0%        3.4
                               10.0%      100         48      48.0%      28.1%        2.8
                               20.0%      200         73      36.5%      42.7%        2.1
                               30.0%      300         93      31.0%      54.4%        1.8
                               40.0%      400        105      26.2%      61.4%        1.5
                               50.0%      500        121      24.2%      70.8%        1.4
                               60.0%      600        134      22.3%      78.4%        1.3
                               70.0%      700        144      20.6%      84.2%        1.2
                               80.0%      800        153      19.1%      89.5%        1.1
                               90.0%      900        164      18.2%      95.9%        1.1
                              100.0%     1000        171      17.1%     100.0%          1

20220322-17:51:59  确定最佳模型
20220322-17:51:59  剔除无效模型 24 个：ratio_1_1 | pipeline1 | LGBMClassifier_DF - boosting_type='gbdt', colsample_bytree=0.9916168768550919, importance_type='split', is_unbalance=False, learning_rate=0.02269504678452342, max_depth=-1, min_child_samples=165, min_child_weight=0.001, min_split_gain=0.0, n_estimators=169, n_jobs=-1, num_leaves=22, reg_alpha=0.36607148130872236, reg_lambda=0.10119960284131346, silent=True, subsample=0.9304256141925331, subsample_for_bin=40000, subsample_freq=0                  [查准率非递减]
                   ratio_1_1 | pipeline1 | LGBMClassifier_DF - boosting_type='dart', objective='binary', num_leaves=511, learning_rate=0.1, colsample_bytree=0.8, subsample=0.6, subsample_freq=20                                                                                                                                                                                                                                                                                                          [查准率非递减]
                   ratio_1_1 | pipeline1 | XGBClassifier_DF - 默认参数                                                                                                                                                                                                                                                                                                                                                                                                                                      [查准率非递减]
                   ratio_1_1 | pipeline1 | RandomForestClassifier_DF - 默认参数                                                                                                                                                                                                                                                                                                                                                                                                                             [查准率非递减]
                   ratio_1_1 | pipeline1 | RandomForestClassifier_DF - n_estimators=500, max_features=0.06, max_depth=10, min_samples_split=1000, min_samples_leaf=1000                                                                                                                                                                                                                                                                                                                             [分数取值集中(唯一值)]
                   ratio_1_1 | pipeline1 | RandomForestClassifier_DF - n_estimators=100, max_features=0.06, max_depth=10, min_samples_split=1000, min_samples_leaf=1000                                                                                                                                                                                                                                                                                                                             [分数取值集中(唯一值)]
                   ratio_1_1 | pipeline2 | LGBMClassifier_DF - boosting_type='gbdt', colsample_bytree=0.9916168768550919, importance_type='split', is_unbalance=False, learning_rate=0.02269504678452342, max_depth=-1, min_child_samples=165, min_child_weight=0.001, min_split_gain=0.0, n_estimators=169, n_jobs=-1, num_leaves=22, reg_alpha=0.36607148130872236, reg_lambda=0.10119960284131346, silent=True, subsample=0.9304256141925331, subsample_for_bin=40000, subsample_freq=0                  [分数区分度弱]
                   ratio_1_1 | pipeline2 | LGBMClassifier_DF - boosting_type='dart', objective='binary', num_leaves=511, learning_rate=0.1, colsample_bytree=0.8, subsample=0.6, subsample_freq=20                                                                                                                                                                                                                                                                                                          [查准率非递减]
                   ratio_1_1 | pipeline2 | XGBClassifier_DF - 默认参数                                                                                                                                                                                                                                                                                                                                                                                                                                      [查准率非递减]
                   ratio_1_1 | pipeline2 | RandomForestClassifier_DF - n_estimators=500, max_features=0.06, max_depth=10, min_samples_split=1000, min_samples_leaf=1000                                                                                                                                                                                                                                                                                                                             [分数取值集中(唯一值)]
                   ratio_1_1 | pipeline2 | RandomForestClassifier_DF - n_estimators=100, max_features=0.06, max_depth=10, min_samples_split=1000, min_samples_leaf=1000                                                                                                                                                                                                                                                                                                                             [分数取值集中(唯一值)]
                   ratio_1_1 | pipeline2 | LogisticRegression_DF - solver='liblinear'                                                                                                                                                                                                                                                                                                                                                                                                                       [查准率非递减]
                   ratio_1_2 | pipeline1 | LGBMClassifier_DF - boosting_type='gbdt', colsample_bytree=0.9916168768550919, importance_type='split', is_unbalance=False, learning_rate=0.02269504678452342, max_depth=-1, min_child_samples=165, min_child_weight=0.001, min_split_gain=0.0, n_estimators=169, n_jobs=-1, num_leaves=22, reg_alpha=0.36607148130872236, reg_lambda=0.10119960284131346, silent=True, subsample=0.9304256141925331, subsample_for_bin=40000, subsample_freq=0                  [查准率非递减]
                   ratio_1_2 | pipeline1 | LGBMClassifier_DF - boosting_type='dart', objective='binary', num_leaves=511, learning_rate=0.1, colsample_bytree=0.8, subsample=0.6, subsample_freq=20                                                                                                                                                                                                                                                                                                          [查准率非递减]
                   ratio_1_2 | pipeline1 | RandomForestClassifier_DF - 默认参数                                                                                                                                                                                                                                                                                                                                                                                                                             [查准率非递减]
                   ratio_1_2 | pipeline1 | RandomForestClassifier_DF - n_estimators=500, max_features=0.06, max_depth=10, min_samples_split=1000, min_samples_leaf=1000                                                                                                                                                                                                                                                                                                                                     [查准率非递减]
                   ratio_1_2 | pipeline1 | RandomForestClassifier_DF - n_estimators=100, max_features=0.06, max_depth=10, min_samples_split=1000, min_samples_leaf=1000                                                                                                                                                                                                                                                                                                                       [查准率非递减, 分数取值集中]
                   ratio_1_2 | pipeline1 | LogisticRegression_DF - solver='liblinear'                                                                                                                                                                                                                                                                                                                                                                                                                       [查准率非递减]
                   ratio_1_2 | pipeline2 | LGBMClassifier_DF - boosting_type='gbdt', colsample_bytree=0.9916168768550919, importance_type='split', is_unbalance=False, learning_rate=0.02269504678452342, max_depth=-1, min_child_samples=165, min_child_weight=0.001, min_split_gain=0.0, n_estimators=169, n_jobs=-1, num_leaves=22, reg_alpha=0.36607148130872236, reg_lambda=0.10119960284131346, silent=True, subsample=0.9304256141925331, subsample_for_bin=40000, subsample_freq=0                  [分数区分度弱]
                   ratio_1_2 | pipeline2 | XGBClassifier_DF - 默认参数                                                                                                                                                                                                                                                                                                                                                                                                                                      [查准率非递减]
                   ratio_1_2 | pipeline2 | RandomForestClassifier_DF - 默认参数                                                                                                                                                                                                                                                                                                                                                                                                                             [查准率非递减]
                   ratio_1_2 | pipeline2 | RandomForestClassifier_DF - n_estimators=500, max_features=0.06, max_depth=10, min_samples_split=1000, min_samples_leaf=1000                                                                                                                                                                                                                                                                                                                                     [查准率非递减]
                   ratio_1_2 | pipeline2 | RandomForestClassifier_DF - n_estimators=100, max_features=0.06, max_depth=10, min_samples_split=1000, min_samples_leaf=1000                                                                                                                                                                                                                                                                                                                       [查准率非递减, 分数区分度弱]
                   ratio_1_2 | pipeline2 | LogisticRegression_DF - solver='liblinear'                                                                                                                                                                                                                                                                                                                                                                                                                       [查准率非递减]
                   Name: if_weak, dtype: object
20220322-17:51:59  最佳模型是：ratio_1_1 | pipeline2 | RandomForestClassifier_DF - 默认参数

20220322-17:51:59  data_train的测试效果：
                        累计人数占比 累计人数 累计人数_1 累计查准率 累计查全率 累计提升度
                                1.5%       33         33     100.0%       3.0%          2
                                6.1%      133        133     100.0%      12.2%          2
                               12.2%      267        267     100.0%      24.5%          2
                               20.5%      447        447     100.0%      41.0%          2
                               31.1%      678        678     100.0%      62.2%          2
                               41.4%      903        903     100.0%      82.8%          2
                               50.0%     1090       1090     100.0%     100.0%          2
                               60.3%     1314       1090      83.0%     100.0%        1.7
                               72.1%     1572       1090      69.3%     100.0%        1.4
                               81.7%     1780       1090      61.2%     100.0%        1.2
                               90.5%     1972       1090      55.3%     100.0%        1.1
                              100.0%     2180       1090      50.0%     100.0%          1

20220322-17:51:59  data_timein的测试效果：
                        累计人数占比 累计人数 累计人数_1 累计查准率 累计查全率 累计提升度
                                1.0%        5          3      60.0%       3.8%        3.8
                                5.2%       26         17      65.4%      21.2%        4.1
                               10.0%       50         29      58.0%      36.2%        3.6
                               21.0%      105         43      41.0%      53.8%        2.6
                               30.4%      152         50      32.9%      62.5%        2.1
                               40.4%      202         56      27.7%      70.0%        1.7
                               51.8%      259         61      23.6%      76.2%        1.5
                               62.0%      310         64      20.6%      80.0%        1.3
                               71.2%      356         67      18.8%      83.8%        1.2
                               81.0%      405         75      18.5%      93.8%        1.2
                               90.0%      450         76      16.9%      95.0%        1.1
                              100.0%      500         80      16.0%     100.0%          1

20220322-17:51:59  data_timeout的测试效果：
                        累计人数占比 累计人数 累计人数_1 累计查准率 累计查全率 累计提升度
                                1.0%       10          8      80.0%       4.7%        4.7
                                5.2%       52         31      59.6%      18.1%        3.5
                               10.9%      109         59      54.1%      34.5%        3.2
                               21.7%      217         92      42.4%      53.8%        2.5
                               30.4%      304        117      38.5%      68.4%        2.3
                               40.0%      400        134      33.5%      78.4%          2
                               50.0%      500        142      28.4%      83.0%        1.7
                               61.3%      613        157      25.6%      91.8%        1.5
                               71.7%      717        166      23.2%      97.1%        1.4
                               80.0%      800        170      21.2%      99.4%        1.2
                               90.1%      901        171      19.0%     100.0%        1.1
                              100.0%     1000        171      17.1%     100.0%          1

20220322-17:51:59  分数稳定度：0.13035

20220322-17:51:59  特征重要性：
                                                  field_name                              comment  importance
                       28                avg__gprs_flow_busy            gprs-忙时-流量：近3月均值    0.037491
                       101               std__gprs_flow_busy          gprs-忙时-流量：近3月标准差    0.035349
                       10                     gprs_flow_busy                       gprs-忙时-流量    0.031550
                       84                min__gprs_flow_busy          gprs-忙时-流量：近3月最小值    0.028643
                       0                        innet_months                             入网时长    0.021565
                       37               avg__gprs_flow_commu            通信类应用流量：近3月均值    0.019590
                       14                      days_call_p_4                       通话天数占比_4    0.019366
                       106              std__gprs_flow_commu          通信类应用流量：近3月标准差    0.019354
                       35   avg__monthsremain_last_stop_date    最后停机时间：剩余时长：近3月均值    0.017650
                       40                          avg__arpu                  当月arpu：近3月均值    0.017209
                       54                wave__gprs_now_rest        当月gprs资源余量：近3月波动性    0.016284
                       76   max__monthsremain_last_stop_date  最后停机时间：剩余时长：近3月最大值    0.016253
                       78                          max__arpu                当月arpu：近3月最大值    0.015733
                       108                         std__arpu                当月arpu：近3月标准差    0.015664
                       2                       gprs_resource                     gprs国内资源总量    0.014402
                       4                                arpu                             当月arpu    0.013807
                       94                          min__arpu                当月arpu：近3月最小值    0.013694
                       25                 avg__gprs_resource          gprs国内资源总量：近3月均值    0.013139
                       49                 wave__calling_dura        当月主叫通话时长：近3月波动性    0.012836
                       73                max__gprs_flow_roam      gprs-国内漫游-流量：近3月最大值    0.012416

20220322-17:51:59  保存训练结果至：./binaryclassify/eg/traintest~202011~202012/train_result~202011~202012.pkl

20220322-17:51:59  最优模型的流水线不是pipeline1,若欲在预测时匹配topn原因需要使用pipeline1，从model_flows挑选一个基于pipeline1的保存至./binaryclassify/eg/traintest~202011~202012/train_model_flows~202011~202012.pkl: ratio_1_1 | pipeline1 | XGBClassifier_DF - 默认参数
20220322-17:52:00  保存模型测试效果集合至：./binaryclassify/eg/traintest~202011~202012/train_pre_results~202011~202012.pkl
20220322-17:52:00  结束时间：2022-03-22 17:52:00
20220322-17:52:00  耗时：{time_cost} s


C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\series.py:3194: UserWarning:     FeaturePrefilter_DF unique_limit(5000)小于X行数(2180), 添加unique_limit_actual：len(X)*0.99=2158
  mapped = lib.map_infer(values, f, convert=convert_dtype)


C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\series.py:3194: UserWarning:     pipeline1 PsiTransformer data_timein 计算稳定性(区分正负例) ，1个字段稳定性>=psi_limit（0.1）：
avg__gprs_now_defer    0.125947
dtype: float64
  mapped = lib.map_infer(values, f, convert=convert_dtype)


C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\series.py:3194: UserWarning:     pipeline1 PsiTransformer timedata_timeout 计算稳定性(不区分正负例)，22个字段稳定性>=psi_limit（0.1）：
grow__dinner_fee                    2.549359
days_call_p_4                       0.990906
grow__call_use                      0.654026
wave__gprs_resource                 0.500152
grow__gprs_now_rest                 0.433590
min__gprs_now_rest                  0.416515
std__arpu                           0.343033
max__monthsremain_last_stop_date    0.277001
wave__gprs_now_defer                0.214392
grow__gprs_last_defer               0.164190
moreq25cnt__calling_diff_dura       0.157131
moreq25cnt__gprs_last_defer         0.144649
min__gprs_last_defer                0.138716
wave__gprs_now_rest                 0.138502
wave__calling_dura                  0.136839
wave__call_use                      0.125712
sep__gprs_now_rest                  0.124144
grow__nos_calling                   0.119457
wave__gprs_last_defer               0.115803
sep__gprs_last_defer                0.114288
sep__gprs_flow_video                0.105009
moreq25cnt__nos_calling_diff        0.102624
dtype: float64
  mapped = lib.map_infer(values, f, convert=convert_dtype)


C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\series.py:3194: UserWarning:     pipeline1 PsiTransformer data_timeout 计算稳定性(区分正负例) ，28个字段稳定性>=psi_limit（0.1）：
grow__dinner_fee                    3.120392
days_call_p_4                       1.162767
grow__call_use                      0.611492
wave__gprs_resource                 0.541403
min__gprs_now_rest                  0.477872
grow__gprs_now_rest                 0.468119
std__arpu                           0.379634
max__monthsremain_last_stop_date    0.324312
wave__gprs_now_defer                0.270491
moreq25cnt__calling_diff_dura       0.250740
min__gprs_last_defer                0.219109
wave__gprs_now_rest                 0.215935
moreq25cnt__gprs_last_defer         0.215534
moreq25cnt__nos_calling             0.204406
sep__gprs_now_rest                  0.196165
wave__gprs_last_defer               0.190947
sep__gprs_last_defer                0.183942
moreq25cnt__nos_calling_diff        0.176487
wave__calling_dura                  0.172625
min__nos_calling                    0.163970
sep__gprs_flow_commu                0.148912
grow__gprs_last_defer               0.143923
grow__nos_calling                   0.142007
wave__call_use                      0.125908
min__gprs_resource                  0.115553
sep__gprs_flow_video                0.107414
std__gprs_now_rest                  0.103832
min__gprs_flow_busy                 0.101495
dtype: float64
  mapped = lib.map_infer(values, f, convert=convert_dtype)


C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\series.py:3194: UserWarning:     FeatureUnion 下列字段重复，仅保留前一列 142列 => 140列：['greatest_gprs_app~video', 'greatest_gprs_app~commu']
  mapped = lib.map_infer(values, f, convert=convert_dtype)


C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\series.py:3194: UserWarning:     pipeline2 PsiTransformer data_timein 计算稳定性(区分正负例) ，1个字段稳定性>=psi_limit（0.1）：
avg__gprs_now_defer    0.125947
dtype: float64
  mapped = lib.map_infer(values, f, convert=convert_dtype)


C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\series.py:3194: UserWarning:     pipeline2 PsiTransformer timedata_timeout 计算稳定性(不区分正负例)，20个字段稳定性>=psi_limit（0.1）：
grow__dinner_fee                    2.549359
days_call_p_4                       0.990906
grow__call_use                      0.654026
wave__gprs_resource                 0.500152
std__arpu                           0.343033
max__monthsremain_last_stop_date    0.277001
wave__gprs_now_defer                0.214392
grow__gprs_last_defer               0.164190
moreq25cnt__calling_diff_dura       0.157131
moreq25cnt__gprs_last_defer         0.144649
min__gprs_last_defer                0.138716
wave__gprs_now_rest                 0.138502
wave__calling_dura                  0.136839
wave__call_use                      0.125712
sep__gprs_now_rest                  0.124144
grow__nos_calling                   0.119457
wave__gprs_last_defer               0.115803
sep__gprs_last_defer                0.114288
sep__gprs_flow_video                0.105009
moreq25cnt__nos_calling_diff        0.102624
dtype: float64
  mapped = lib.map_infer(values, f, convert=convert_dtype)


C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\series.py:3194: UserWarning:     pipeline2 PsiTransformer data_timeout 计算稳定性(区分正负例) ，25个字段稳定性>=psi_limit（0.1）：
grow__dinner_fee                    3.120392
days_call_p_4                       1.162767
grow__call_use                      0.611492
wave__gprs_resource                 0.541403
std__arpu                           0.379634
max__monthsremain_last_stop_date    0.324312
wave__gprs_now_defer                0.270491
moreq25cnt__calling_diff_dura       0.250740
min__gprs_last_defer                0.219109
wave__gprs_now_rest                 0.215935
moreq25cnt__gprs_last_defer         0.215534
moreq25cnt__nos_calling             0.204406
sep__gprs_now_rest                  0.196165
wave__gprs_last_defer               0.190947
sep__gprs_last_defer                0.183942
moreq25cnt__nos_calling_diff        0.176487
wave__calling_dura                  0.172625
min__nos_calling                    0.163970
sep__gprs_flow_commu                0.148912
grow__gprs_last_defer               0.143923
grow__nos_calling                   0.142007
wave__call_use                      0.125908
min__gprs_resource                  0.115553
sep__gprs_flow_video                0.107414
min__gprs_flow_busy                 0.101495
dtype: float64
  mapped = lib.map_infer(values, f, convert=convert_dtype)


C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\series.py:3194: UserWarning:     FeaturePrefilter_DF unique_limit(5000)小于X行数(3270), 添加unique_limit_actual：len(X)*0.99=3237
  mapped = lib.map_infer(values, f, convert=convert_dtype)


C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\series.py:3194: UserWarning:     pipeline1 PsiTransformer timedata_timeout 计算稳定性(不区分正负例)，21个字段稳定性>=psi_limit（0.1）：
grow__dinner_fee                    2.319384
days_call_p_4                       0.990906
grow__call_use                      0.635633
grow__gprs_now_rest                 0.510291
wave__gprs_resource                 0.432064
min__gprs_now_rest                  0.415997
std__arpu                           0.343033
max__monthsremain_last_stop_date    0.277001
wave__gprs_now_defer                0.214392
grow__gprs_last_defer               0.165723
min__gprs_last_defer                0.146128
moreq25cnt__gprs_last_defer         0.144649
wave__gprs_now_rest                 0.138502
wave__calling_dura                  0.136839
moreq25cnt__calling_cnt             0.125419
grow__gprs_flow_video               0.124521
sep__gprs_now_rest                  0.124144
wave__gprs_last_defer               0.117207
sep__gprs_last_defer                0.115778
sep__gprs_flow_video                0.106386
moreq25cnt__nos_calling_diff        0.102624
dtype: float64
  mapped = lib.map_infer(values, f, convert=convert_dtype)


C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\series.py:3194: UserWarning:     pipeline1 PsiTransformer data_timeout 计算稳定性(区分正负例) ，31个字段稳定性>=psi_limit（0.1）：
grow__dinner_fee                    2.515802
days_call_p_4                       1.115943
grow__call_use                      0.650831
grow__gprs_now_rest                 0.563127
min__gprs_now_rest                  0.460587
wave__gprs_resource                 0.434657
std__arpu                           0.328371
max__monthsremain_last_stop_date    0.288237
moreq25cnt__calling_cnt             0.271037
wave__gprs_now_defer                0.225385
wave__gprs_flow_music               0.220614
min__gprs_last_defer                0.216695
moreq25cnt__nos_calling             0.204406
wave__gprs_now_rest                 0.197329
moreq25cnt__gprs_last_defer         0.193713
sep__gprs_now_rest                  0.190588
min__arpu                           0.190553
moreq25cnt__nos_calling_diff        0.176487
wave__calling_dura                  0.172625
sep__gprs_flow_commu                0.168089
min__nos_calling                    0.163970
grow__gprs_last_defer               0.148424
wave__gprs_last_defer               0.142473
sep__gprs_last_defer                0.134627
grow__gprs_flow_video               0.133704
sep__gprs_flow_video                0.131683
sep__nos_calling                    0.118302
min__gprs_resource                  0.115553
std__gprs_now_rest                  0.113814
wave__call_use                      0.113173
min__gprs_flow_busy                 0.101495
dtype: float64
  mapped = lib.map_infer(values, f, convert=convert_dtype)


C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\series.py:3194: UserWarning:     FeatureUnion 下列字段重复，仅保留前一列 141列 => 139列：['greatest_gprs_app~video', 'greatest_gprs_app~commu']
  mapped = lib.map_infer(values, f, convert=convert_dtype)


C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\series.py:3194: UserWarning:     pipeline2 PsiTransformer data_timein 计算稳定性(区分正负例)-正例（1） ['avg__gprs_flow_game']字段多出1个取值, .head(5):
                           old  new
field               value          
avg__gprs_flow_game nan    NaN    1
  mapped = lib.map_infer(values, f, convert=convert_dtype)


C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\series.py:3194: UserWarning:     pipeline2 PsiTransformer data_timein 计算稳定性(区分正负例)-负例（0） ['avg__gprs_flow_game']字段多出1个取值, .head(5):
                           old  new
field               value          
avg__gprs_flow_game nan    NaN    1
  mapped = lib.map_infer(values, f, convert=convert_dtype)


C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\series.py:3194: UserWarning:     pipeline2 PsiTransformer timedata_timeout 计算稳定性(不区分正负例)，20个字段稳定性>=psi_limit（0.1）：
grow__dinner_fee                    2.319384
grow__gprs_now_rest                 1.359223
days_call_p_4                       0.990906
grow__call_use                      0.635633
wave__gprs_resource                 0.432064
std__arpu                           0.343033
max__monthsremain_last_stop_date    0.277001
wave__gprs_now_defer                0.214392
grow__gprs_last_defer               0.165723
min__gprs_last_defer                0.146128
moreq25cnt__gprs_last_defer         0.144649
wave__gprs_now_rest                 0.138502
wave__calling_dura                  0.136839
moreq25cnt__calling_cnt             0.125419
grow__gprs_flow_video               0.124521
sep__gprs_now_rest                  0.124144
wave__gprs_last_defer               0.117207
sep__gprs_last_defer                0.115778
sep__gprs_flow_video                0.106386
moreq25cnt__nos_calling_diff        0.102624
dtype: float64
  mapped = lib.map_infer(values, f, convert=convert_dtype)


C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\series.py:3194: UserWarning:     pipeline2 PsiTransformer data_timeout 计算稳定性(区分正负例)-正例（1） ['avg__gprs_flow_game']字段多出1个取值, .head(5):
                           old  new
field               value          
avg__gprs_flow_game nan    NaN    4
  mapped = lib.map_infer(values, f, convert=convert_dtype)


C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\series.py:3194: UserWarning:     pipeline2 PsiTransformer data_timeout 计算稳定性(区分正负例)-负例（0） ['avg__gprs_flow_game']字段多出1个取值, .head(5):
                           old  new
field               value          
avg__gprs_flow_game nan    NaN    1
  mapped = lib.map_infer(values, f, convert=convert_dtype)


C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\series.py:3194: UserWarning:     pipeline2 PsiTransformer data_timeout 计算稳定性(区分正负例) ，29个字段稳定性>=psi_limit（0.1）：
grow__dinner_fee                    2.515802
grow__gprs_now_rest                 1.246861
days_call_p_4                       1.115943
grow__call_use                      0.650831
wave__gprs_resource                 0.434657
std__arpu                           0.328371
max__monthsremain_last_stop_date    0.288237
moreq25cnt__calling_cnt             0.271037
wave__gprs_now_defer                0.225385
wave__gprs_flow_music               0.220614
min__gprs_last_defer                0.216695
moreq25cnt__nos_calling             0.204406
wave__gprs_now_rest                 0.197329
moreq25cnt__gprs_last_defer         0.193713
sep__gprs_now_rest                  0.190588
min__arpu                           0.190553
moreq25cnt__nos_calling_diff        0.176487
wave__calling_dura                  0.172625
sep__gprs_flow_commu                0.168089
min__nos_calling                    0.163970
grow__gprs_last_defer               0.148424
wave__gprs_last_defer               0.142473
sep__gprs_last_defer                0.134627
grow__gprs_flow_video               0.134482
sep__gprs_flow_video                0.131683
sep__nos_calling                    0.118302
min__gprs_resource                  0.115553
wave__call_use                      0.113173
min__gprs_flow_busy                 0.101495
dtype: float64
  mapped = lib.map_infer(values, f, convert=convert_dtype)


C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\series.py:3194: UserWarning: 分数稳定度：0.13035

  mapped = lib.map_infer(values, f, convert=convert_dtype)
20220322-17:52:55  获取模型的路径等
20220322-17:52:55  
                   加载训练结果：./binaryclassify/eg/traintest~202011~202012/train_result~202011~202012.pkl
20220322-17:52:55  
                   获取pipeline1
20220322-17:52:55  最优模型的流水线不是pipeline1， 加载train_model_flows，从中获取pipeline1
20220322-17:52:55      加载训练结果：./binaryclassify/eg/traintest~202011~202012/train_model_flows~202011~202012.pkl
20220322-17:52:56      从train_model_flows中获取pipeline1
20220322-17:52:56  
                   从流水线中获取WoeTransformer_DF
20220322-17:52:56  从流水线中获取WoeTransformer_DF
20220322-17:52:56  
                   稳定性: psi_PN_data_timeout


C:\Users\higher\Desktop\to伟鹏的代码_v2\ModelProject\selfmodule\binarymodule\privy_report.py:69: UserWarning: iv_psi存在 1 个缺失值:
                        iv  psi               comment dtype_classify field_src
field_name                                                                    
nos_calling_diff  0.082328  NaN  主叫异网对端号码个数         数值型      原始
  warnings.warn(s)
20220322-17:52:56  
                   《建模报告》：分析目标用户群
20220322-17:52:56  user_status='在网-正常' and 
                       phone_no_null is null and
                       last_stop_date is not null and
                       innet_months >= 3
20220322-17:52:56  
                   确定报告字段信息
20220322-17:52:56  入模字段：126个
20220322-17:52:56  
                   《建模报告》：基础字段：30个，入模：22个
20220322-17:52:56             field_name               comment 是否入模
                   0          acct_month                  账期       否
                   1       phone_no_null              手机号码       否
                   2             user_id              手机号id       否
                   3          account_id              帐户编号       是
                   4        innet_months              入网时长       是
                   5         user_status              用户状态       否
                   6      last_stop_date          最后停机时间       否
                   7     gprs_last_defer          流量滚存资源       是
                   8       gprs_resource      gprs国内资源总量       是
                   9       gprs_now_rest      当月gprs资源余量       否
                   10           call_use        语音资源使用量       是
                   11               arpu              当月arpu       是
                   12        calling_cnt          主叫通话次数       是
                   13       calling_dura      当月主叫通话时长       是
                   14   calling_diff_cnt      主叫异网通话次数       是
                   15  calling_diff_dura    主叫异网通话分钟数       是
                   16       gprs_flow_5g           gprs 5g流量       是
                   17     gprs_flow_busy        gprs-忙时-流量       是
                   18     gprs_now_defer    可延递流量资源总量       是
                   19     gprs_flow_roam    gprs-国内漫游-流量       是
                   20     call_dura_roam         省际漫游-时长       是
                   21        nos_calling  主叫通话对端号码个数       是
                   22   nos_calling_diff  主叫异网对端号码个数       是
                   23            sms_cnt  短信-点对点短信-条数       否
                   24     call_fee_local            本地通话费       否
                   25    gprs_flow_video        视频类应用流量       是
                   26    gprs_flow_short       小视频系app流量       是
                   27    gprs_flow_music        音乐类应用流量       是
                   28    gprs_flow_commu        通信类应用流量       是
                   29     gprs_flow_game        游戏类应用流量       是
20220322-17:52:56  
                   《建模报告》：衍生字段：121个，入模：106个
20220322-17:52:56                             field_name                                                    comment 是否入模
                   0                     user_acct_month                                     观察期最后账期               否
                   1                            data_use                                         数据集名称               否
                   2                       days_call_p_4                                     通话天数占比_4               是
                   3                   greatest_gprs_app                                            app偏好               是
                   4            account_id~其他_countlow                  帐户编号：取值是否为其他_countlow               是
                   5             greatest_gprs_app~commu                           app偏好：取值是否为commu               是
                   6             greatest_gprs_app~video                           app偏好：取值是否为video               是
                   7                   avg__calling_dura                        当月主叫通话时长：近3月均值               是
                   8                  avg__gprs_resource                        gprs国内资源总量：近3月均值               是
                   9                 avg__call_dura_roam                           省际漫游-时长：近3月均值               是
                   10              avg__calling_diff_cnt                        主叫异网通话次数：近3月均值               是
                   11                avg__gprs_flow_busy                          gprs-忙时-流量：近3月均值               是
                   12               avg__gprs_flow_music                          音乐类应用流量：近3月均值               是
                   13               avg__gprs_last_defer                            流量滚存资源：近3月均值               是
                   14                avg__gprs_now_defer                      可延递流量资源总量：近3月均值               是
                   15                   avg__nos_calling                    主叫通话对端号码个数：近3月均值               是
                   16                avg__gprs_flow_roam                      gprs-国内漫游-流量：近3月均值               否
                   17             avg__calling_diff_dura                      主叫异网通话分钟数：近3月均值               是
                   18                 avg__gprs_now_rest                        当月gprs资源余量：近3月均值               是
                   19   avg__monthsremain_last_stop_date                  最后停机时间：剩余时长：近3月均值               是
                   20               avg__gprs_flow_short                         小视频系app流量：近3月均值               是
                   21               avg__gprs_flow_commu                          通信类应用流量：近3月均值               是
                   22                      avg__call_use                          语音资源使用量：近3月均值               是
                   23                avg__gprs_flow_game                          游戏类应用流量：近3月均值               是
                   24                          avg__arpu                                当月arpu：近3月均值               是
                   25              avg__nos_calling_diff                    主叫异网对端号码个数：近3月均值               是
                   26                   avg__calling_cnt                            主叫通话次数：近3月均值               是
                   27               avg__gprs_flow_video                          视频类应用流量：近3月均值               是
                   28                  sep__gprs_flow_5g                         gprs 5g流量：近3月离散系数               否
                   29               sep__gprs_last_defer                        流量滚存资源：近3月离散系数               是
                   30                   sep__nos_calling                主叫通话对端号码个数：近3月离散系数               否
                   31             sep__calling_diff_dura                  主叫异网通话分钟数：近3月离散系数               否
                   32                 sep__gprs_now_rest                    当月gprs资源余量：近3月离散系数               是
                   33               sep__gprs_flow_commu                      通信类应用流量：近3月离散系数               是
                   34               sep__gprs_flow_video                      视频类应用流量：近3月离散系数               是
                   35                 wave__gprs_flow_5g                           gprs 5g流量：近3月波动性               是
                   36                 wave__calling_dura                      当月主叫通话时长：近3月波动性               是
                   37                wave__gprs_resource                      gprs国内资源总量：近3月波动性               是
                   38              wave__gprs_flow_music                        音乐类应用流量：近3月波动性               是
                   39              wave__gprs_last_defer                          流量滚存资源：近3月波动性               是
                   40               wave__gprs_now_defer                    可延递流量资源总量：近3月波动性               是
                   41                wave__gprs_now_rest                      当月gprs资源余量：近3月波动性               是
                   42                     wave__call_use                        语音资源使用量：近3月波动性               是
                   43                  wave__calling_cnt                          主叫通话次数：近3月波动性               否
                   44                 grow__calling_dura                      当月主叫通话时长：近3月成长率               是
                   45              grow__gprs_last_defer                          流量滚存资源：近3月成长率               是
                   46               grow__gprs_now_defer                    可延递流量资源总量：近3月成长率               是
                   47                  grow__nos_calling                  主叫通话对端号码个数：近3月成长率               是
                   48            grow__calling_diff_dura                    主叫异网通话分钟数：近3月成长率               是
                   49                grow__gprs_now_rest                      当月gprs资源余量：近3月成长率               否
                   50                   grow__dinner_fee                            套餐月租费：近3月成长率               是
                   51              grow__gprs_flow_commu                        通信类应用流量：近3月成长率               是
                   52                     grow__call_use                        语音资源使用量：近3月成长率               是
                   53             grow__nos_calling_diff                  主叫异网对端号码个数：近3月成长率               是
                   54                  grow__calling_cnt                          主叫通话次数：近3月成长率               是
                   55              grow__gprs_flow_video                        视频类应用流量：近3月成长率               是
                   56                  max__gprs_flow_5g                           gprs 5g流量：近3月最大值               是
                   57                  max__calling_dura                      当月主叫通话时长：近3月最大值               是
                   58                max__call_dura_roam                         省际漫游-时长：近3月最大值               是
                   59              max__calling_diff_cnt                      主叫异网通话次数：近3月最大值               是
                   60               max__gprs_last_defer                          流量滚存资源：近3月最大值               是
                   61                   max__nos_calling                  主叫通话对端号码个数：近3月最大值               是
                   62                max__gprs_flow_roam                    gprs-国内漫游-流量：近3月最大值               是
                   63             max__calling_diff_dura                    主叫异网通话分钟数：近3月最大值               是
                   64                 max__gprs_now_rest                      当月gprs资源余量：近3月最大值               是
                   65   max__monthsremain_last_stop_date                最后停机时间：剩余时长：近3月最大值               是
                   66                      max__call_use                        语音资源使用量：近3月最大值               是
                   67                          max__arpu                              当月arpu：近3月最大值               是
                   68              max__nos_calling_diff                  主叫异网对端号码个数：近3月最大值               是
                   69                   max__calling_cnt                          主叫通话次数：近3月最大值               是
                   70                  min__calling_dura                      当月主叫通话时长：近3月最小值               是
                   71                 min__gprs_resource                      gprs国内资源总量：近3月最小值               是
                   72              min__calling_diff_cnt                      主叫异网通话次数：近3月最小值               是
                   73                min__gprs_flow_busy                        gprs-忙时-流量：近3月最小值               是
                   74               min__gprs_flow_music                        音乐类应用流量：近3月最小值               是
                   75               min__gprs_last_defer                          流量滚存资源：近3月最小值               是
                   76                   min__nos_calling                  主叫通话对端号码个数：近3月最小值               是
                   77                min__gprs_flow_roam                    gprs-国内漫游-流量：近3月最小值               是
                   78             min__calling_diff_dura                    主叫异网通话分钟数：近3月最小值               是
                   79                 min__gprs_now_rest                      当月gprs资源余量：近3月最小值               是
                   80               min__gprs_flow_short                       小视频系app流量：近3月最小值               是
                   81               min__gprs_flow_commu                        通信类应用流量：近3月最小值               是
                   82                      min__call_use                        语音资源使用量：近3月最小值               是
                   83                min__gprs_flow_game                        游戏类应用流量：近3月最小值               否
                   84                 min__days_call_p_4                        通话天数占比_4：近3月最小值               否
                   85                          min__arpu                              当月arpu：近3月最小值               是
                   86              min__nos_calling_diff                  主叫异网对端号码个数：近3月最小值               否
                   87                   min__calling_cnt                          主叫通话次数：近3月最小值               是
                   88               min__gprs_flow_video                        视频类应用流量：近3月最小值               是
                   89                  std__calling_dura                      当月主叫通话时长：近3月标准差               是
                   90                 std__gprs_resource                      gprs国内资源总量：近3月标准差               是
                   91                std__call_dura_roam                         省际漫游-时长：近3月标准差               是
                   92              std__calling_diff_cnt                      主叫异网通话次数：近3月标准差               是
                   93                std__gprs_flow_busy                        gprs-忙时-流量：近3月标准差               是
                   94               std__gprs_last_defer                          流量滚存资源：近3月标准差               是
                   95                   std__nos_calling                  主叫通话对端号码个数：近3月标准差               是
                   96             std__calling_diff_dura                    主叫异网通话分钟数：近3月标准差               是
                   97                 std__gprs_now_rest                      当月gprs资源余量：近3月标准差               否
                   98               std__gprs_flow_short                       小视频系app流量：近3月标准差               是
                   99               std__gprs_flow_commu                        通信类应用流量：近3月标准差               是
                   100                     std__call_use                        语音资源使用量：近3月标准差               是
                   101                         std__arpu                              当月arpu：近3月标准差               是
                   102             std__nos_calling_diff                  主叫异网对端号码个数：近3月标准差               是
                   103                  std__calling_cnt                          主叫通话次数：近3月标准差               是
                   104                           flag_eg                                           预测目标               否
                   105             more0cnt__calling_cnt                   主叫通话次数：近3月大于0的月份数               否
                   106          moreq25cnt__gprs_flow_5g         gprs 5g流量：近3月大于第一四分位数的月份数               是
                   107          moreq25cnt__calling_dura    当月主叫通话时长：近3月大于第一四分位数的月份数               是
                   108         moreq25cnt__gprs_resource    gprs国内资源总量：近3月大于第一四分位数的月份数               是
                   109        moreq25cnt__gprs_flow_busy      gprs-忙时-流量：近3月大于第一四分位数的月份数               是
                   110       moreq25cnt__gprs_last_defer        流量滚存资源：近3月大于第一四分位数的月份数               是
                   111        moreq25cnt__gprs_now_defer  可延递流量资源总量：近3月大于第一四分位数的月份数               否
                   112           moreq25cnt__nos_calling  主叫通话对端号码个数：近3月大于第一四分位数的月份数......       是
                   113     moreq25cnt__calling_diff_dura  主叫异网通话分钟数：近3月大于第一四分位数的月份数               是
                   114       moreq25cnt__gprs_flow_short     小视频系app流量：近3月大于第一四分位数的月份数               是
                   115                  moreq25cnt__arpu            当月arpu：近3月大于第一四分位数的月份数               是
                   116      moreq25cnt__nos_calling_diff  主叫异网对端号码个数：近3月大于第一四分位数的月份数......       是
                   117           moreq25cnt__calling_cnt        主叫通话次数：近3月大于第一四分位数的月份数               是
                   118       moreq25cnt__gprs_flow_video      视频类应用流量：近3月大于第一四分位数的月份数               是
                   119           valuecnt__if_nolimit~是      是否不限量套餐到达用户：近3月取值为是的月份数               是
                   120         valuecnt__if_5g_dinner~是                  是否5g套餐：近3月取值为是的月份数               是
20220322-17:52:56  
                   《建模报告》：时间窗口设计
20220322-17:52:56  训练	202009	202010	202011	202012
                   验证
                   测试	202010	202011	202012	202101
20220322-17:52:56  
                   《建模报告》：训练集、验证集、测试集
20220322-17:52:56  训练集	2180	1090	50.00%
                   验证集	500	80	16.00%
                   测试集	1000	171	17.10%
20220322-17:52:56  对此模型采取的抽样比例为1：1。
20220322-17:52:56  
                   《建模报告》：效果评估
20220322-17:52:56  -------------------------------------- data_train ----------------------------------------
20220322-17:52:56   累计人数占比 累计人数 累计人数_1 累计查准率 累计查全率 累计提升度     F1
                            1.5%       33         33     100.0%       3.0%          2  0.058
                            6.1%      133        133     100.0%      12.2%          2  0.217
                           12.2%      267        267     100.0%      24.5%          2  0.394
                           20.5%      447        447     100.0%      41.0%          2  0.582
                           31.1%      678        678     100.0%      62.2%          2  0.767
                           41.4%      903        903     100.0%      82.8%          2  0.906
                           50.0%     1090       1090     100.0%     100.0%          2  1.000
                           60.3%     1314       1090      83.0%     100.0%        1.7  0.907
                           72.1%     1572       1090      69.3%     100.0%        1.4  0.819
                           81.7%     1780       1090      61.2%     100.0%        1.2  0.759
                           90.5%     1972       1090      55.3%     100.0%        1.1  0.712
                          100.0%     2180       1090      50.0%     100.0%          1  0.667
20220322-17:52:56  -------------------------------------- data_timein ----------------------------------------
20220322-17:52:56   累计人数占比 累计人数 累计人数_1 累计查准率 累计查全率 累计提升度     F1
                            1.0%        5          3      60.0%       3.8%        3.8  0.071
                            5.2%       26         17      65.4%      21.2%        4.1  0.320
                           10.0%       50         29      58.0%      36.2%        3.6  0.446
                           21.0%      105         43      41.0%      53.8%        2.6  0.465
                           30.4%      152         50      32.9%      62.5%        2.1  0.431
                           40.4%      202         56      27.7%      70.0%        1.7  0.397
                           51.8%      259         61      23.6%      76.2%        1.5  0.360
                           62.0%      310         64      20.6%      80.0%        1.3  0.328
                           71.2%      356         67      18.8%      83.8%        1.2  0.307
                           81.0%      405         75      18.5%      93.8%        1.2  0.309
                           90.0%      450         76      16.9%      95.0%        1.1  0.287
                          100.0%      500         80      16.0%     100.0%          1  0.276
20220322-17:52:56  -------------------------------------- data_timeout ----------------------------------------
20220322-17:52:56   累计人数占比 累计人数 累计人数_1 累计查准率 累计查全率 累计提升度     F1
                            1.0%       10          8      80.0%       4.7%        4.7  0.089
                            5.2%       52         31      59.6%      18.1%        3.5  0.278
                           10.9%      109         59      54.1%      34.5%        3.2  0.421
                           21.7%      217         92      42.4%      53.8%        2.5  0.474
                           30.4%      304        117      38.5%      68.4%        2.3  0.493
                           40.0%      400        134      33.5%      78.4%          2  0.469
                           50.0%      500        142      28.4%      83.0%        1.7  0.423
                           61.3%      613        157      25.6%      91.8%        1.5  0.400
                           71.7%      717        166      23.2%      97.1%        1.4  0.375
                           80.0%      800        170      21.2%      99.4%        1.2  0.349
                           90.1%      901        171      19.0%     100.0%        1.1  0.319
                          100.0%     1000        171      17.1%     100.0%          1  0.292
20220322-17:52:56  
                   《建模报告》：排行前20的重要特征可视化
20220322-17:52:56                             field_name                              comment  importance
                   73                max__gprs_flow_roam      gprs-国内漫游-流量：近3月最大值    0.012416
                   49                 wave__calling_dura        当月主叫通话时长：近3月波动性    0.012836
                   25                 avg__gprs_resource          gprs国内资源总量：近3月均值    0.013139
                   94                          min__arpu                当月arpu：近3月最小值    0.013694
                   4                                arpu                             当月arpu    0.013807
                   2                       gprs_resource                     gprs国内资源总量    0.014402
                   108                         std__arpu                当月arpu：近3月标准差    0.015664
                   78                          max__arpu                当月arpu：近3月最大值    0.015733
                   76   max__monthsremain_last_stop_date  最后停机时间：剩余时长：近3月最大值    0.016253
                   54                wave__gprs_now_rest        当月gprs资源余量：近3月波动性    0.016284
                   40                          avg__arpu                  当月arpu：近3月均值    0.017209
                   35   avg__monthsremain_last_stop_date    最后停机时间：剩余时长：近3月均值    0.017650
                   106              std__gprs_flow_commu          通信类应用流量：近3月标准差    0.019354
                   14                      days_call_p_4                       通话天数占比_4    0.019366
                   37               avg__gprs_flow_commu            通信类应用流量：近3月均值    0.019590
                   0                        innet_months                             入网时长    0.021565
                   84                min__gprs_flow_busy          gprs-忙时-流量：近3月最小值    0.028643
                   10                     gprs_flow_busy                       gprs-忙时-流量    0.031550
                   101               std__gprs_flow_busy          gprs-忙时-流量：近3月标准差    0.035349
                   28                avg__gprs_flow_busy            gprs-忙时-流量：近3月均值    0.037491
20220322-17:52:57  初始tab:
                   col_0                                                1      0    All      prop
                   (avg__gprs_flow_busy, gprs-忙时-流量：近3月均值)                              
                   (-inf, 85308.667969]                              80.0  600.0  680.0  0.117647
                   (85308.667969, 1786311.8125]                      23.0  140.0  163.0  0.141104
                   (1786311.8125, inf]                               68.0   89.0  157.0  0.433121

20220322-17:52:57  未设置bin_thred， 将其赋值为10.0
20220322-17:52:57  未设置prop_thred， 将其赋值为0.01

20220322-17:52:57  --------------------------- 合并样本量<10.0的组别 -------------------------------
20220322-17:52:57  输入：
                   col_0                                                1      0    All      prop
                   (avg__gprs_flow_busy, gprs-忙时-流量：近3月均值)                              
                   (-inf, 85308.667969]                              80.0  600.0  680.0  0.117647
                   (85308.667969, 1786311.8125]                      23.0  140.0  163.0  0.141104
                   (1786311.8125, inf]                               68.0   89.0  157.0  0.433121

20220322-17:52:57  不再合并
20220322-17:52:57  ---------------------- 合并prop差距<0.01的相邻组别 -----------------------------
20220322-17:52:57  输入：
                   col_0                                                1      0    All      prop  prop_sub
                   (avg__gprs_flow_busy, gprs-忙时-流量：近3月均值)                                        
                   (-inf, 85308.667969]                              80.0  600.0  680.0  0.117647       NaN
                   (85308.667969, 1786311.8125]                      23.0  140.0  163.0  0.141104  0.023457
                   (1786311.8125, inf]                               68.0   89.0  157.0  0.433121  0.292017

20220322-17:52:57  不再合并
20220322-17:52:57  ------------------------------- 合并prop弯折过大的组别 ----------------------------------
20220322-17:52:57  tab的行数（3）<=3，不再合并


Traceback (most recent call last):
  File "C:\Users\higher\Anaconda3\lib\site-packages\IPython\core\interactiveshell.py", line 2961, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-240-92f651af97b3>", line 22, in <module>
    prop_lim = (xj[Info.Pcase] / xj.All).describe()[['min', 'max']].to_list()
  File "C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\generic.py", line 4376, in __getattr__
    return object.__getattribute__(self, name)
AttributeError: 'Series' object has no attribute 'to_list'
20220322-17:53:20  获取模型的路径等
20220322-17:53:20  
                   加载训练结果：./binaryclassify/eg/traintest~202011~202012/train_result~202011~202012.pkl
20220322-17:53:21  
                   获取pipeline1
20220322-17:53:21  最优模型的流水线不是pipeline1， 加载train_model_flows，从中获取pipeline1
20220322-17:53:21      加载训练结果：./binaryclassify/eg/traintest~202011~202012/train_model_flows~202011~202012.pkl
20220322-17:53:21      从train_model_flows中获取pipeline1
20220322-17:53:21  
                   从流水线中获取WoeTransformer_DF
20220322-17:53:21  从流水线中获取WoeTransformer_DF
20220322-17:53:21  
                   稳定性: psi_PN_data_timeout


C:\Users\higher\Desktop\to伟鹏的代码_v2\ModelProject\selfmodule\binarymodule\privy_report.py:69: UserWarning: iv_psi存在 1 个缺失值:
                        iv  psi               comment dtype_classify field_src
field_name                                                                    
nos_calling_diff  0.082328  NaN  主叫异网对端号码个数         数值型      原始
  warnings.warn(s)
20220322-17:53:21  
                   《建模报告》：分析目标用户群
20220322-17:53:21  user_status='在网-正常' and 
                       phone_no_null is null and
                       last_stop_date is not null and
                       innet_months >= 3
20220322-17:53:21  
                   确定报告字段信息
20220322-17:53:21  入模字段：126个
20220322-17:53:21  
                   《建模报告》：基础字段：30个，入模：22个
20220322-17:53:21             field_name               comment 是否入模
                   0          acct_month                  账期       否
                   1       phone_no_null              手机号码       否
                   2             user_id              手机号id       否
                   3          account_id              帐户编号       是
                   4        innet_months              入网时长       是
                   5         user_status              用户状态       否
                   6      last_stop_date          最后停机时间       否
                   7     gprs_last_defer          流量滚存资源       是
                   8       gprs_resource      gprs国内资源总量       是
                   9       gprs_now_rest      当月gprs资源余量       否
                   10           call_use        语音资源使用量       是
                   11               arpu              当月arpu       是
                   12        calling_cnt          主叫通话次数       是
                   13       calling_dura      当月主叫通话时长       是
                   14   calling_diff_cnt      主叫异网通话次数       是
                   15  calling_diff_dura    主叫异网通话分钟数       是
                   16       gprs_flow_5g           gprs 5g流量       是
                   17     gprs_flow_busy        gprs-忙时-流量       是
                   18     gprs_now_defer    可延递流量资源总量       是
                   19     gprs_flow_roam    gprs-国内漫游-流量       是
                   20     call_dura_roam         省际漫游-时长       是
                   21        nos_calling  主叫通话对端号码个数       是
                   22   nos_calling_diff  主叫异网对端号码个数       是
                   23            sms_cnt  短信-点对点短信-条数       否
                   24     call_fee_local            本地通话费       否
                   25    gprs_flow_video        视频类应用流量       是
                   26    gprs_flow_short       小视频系app流量       是
                   27    gprs_flow_music        音乐类应用流量       是
                   28    gprs_flow_commu        通信类应用流量       是
                   29     gprs_flow_game        游戏类应用流量       是
20220322-17:53:21  
                   《建模报告》：衍生字段：121个，入模：106个
20220322-17:53:21                             field_name                                                    comment 是否入模
                   0                     user_acct_month                                     观察期最后账期               否
                   1                            data_use                                         数据集名称               否
                   2                       days_call_p_4                                     通话天数占比_4               是
                   3                   greatest_gprs_app                                            app偏好               是
                   4            account_id~其他_countlow                  帐户编号：取值是否为其他_countlow               是
                   5             greatest_gprs_app~commu                           app偏好：取值是否为commu               是
                   6             greatest_gprs_app~video                           app偏好：取值是否为video               是
                   7                   avg__calling_dura                        当月主叫通话时长：近3月均值               是
                   8                  avg__gprs_resource                        gprs国内资源总量：近3月均值               是
                   9                 avg__call_dura_roam                           省际漫游-时长：近3月均值               是
                   10              avg__calling_diff_cnt                        主叫异网通话次数：近3月均值               是
                   11                avg__gprs_flow_busy                          gprs-忙时-流量：近3月均值               是
                   12               avg__gprs_flow_music                          音乐类应用流量：近3月均值               是
                   13               avg__gprs_last_defer                            流量滚存资源：近3月均值               是
                   14                avg__gprs_now_defer                      可延递流量资源总量：近3月均值               是
                   15                   avg__nos_calling                    主叫通话对端号码个数：近3月均值               是
                   16                avg__gprs_flow_roam                      gprs-国内漫游-流量：近3月均值               否
                   17             avg__calling_diff_dura                      主叫异网通话分钟数：近3月均值               是
                   18                 avg__gprs_now_rest                        当月gprs资源余量：近3月均值               是
                   19   avg__monthsremain_last_stop_date                  最后停机时间：剩余时长：近3月均值               是
                   20               avg__gprs_flow_short                         小视频系app流量：近3月均值               是
                   21               avg__gprs_flow_commu                          通信类应用流量：近3月均值               是
                   22                      avg__call_use                          语音资源使用量：近3月均值               是
                   23                avg__gprs_flow_game                          游戏类应用流量：近3月均值               是
                   24                          avg__arpu                                当月arpu：近3月均值               是
                   25              avg__nos_calling_diff                    主叫异网对端号码个数：近3月均值               是
                   26                   avg__calling_cnt                            主叫通话次数：近3月均值               是
                   27               avg__gprs_flow_video                          视频类应用流量：近3月均值               是
                   28                  sep__gprs_flow_5g                         gprs 5g流量：近3月离散系数               否
                   29               sep__gprs_last_defer                        流量滚存资源：近3月离散系数               是
                   30                   sep__nos_calling                主叫通话对端号码个数：近3月离散系数               否
                   31             sep__calling_diff_dura                  主叫异网通话分钟数：近3月离散系数               否
                   32                 sep__gprs_now_rest                    当月gprs资源余量：近3月离散系数               是
                   33               sep__gprs_flow_commu                      通信类应用流量：近3月离散系数               是
                   34               sep__gprs_flow_video                      视频类应用流量：近3月离散系数               是
                   35                 wave__gprs_flow_5g                           gprs 5g流量：近3月波动性               是
                   36                 wave__calling_dura                      当月主叫通话时长：近3月波动性               是
                   37                wave__gprs_resource                      gprs国内资源总量：近3月波动性               是
                   38              wave__gprs_flow_music                        音乐类应用流量：近3月波动性               是
                   39              wave__gprs_last_defer                          流量滚存资源：近3月波动性               是
                   40               wave__gprs_now_defer                    可延递流量资源总量：近3月波动性               是
                   41                wave__gprs_now_rest                      当月gprs资源余量：近3月波动性               是
                   42                     wave__call_use                        语音资源使用量：近3月波动性               是
                   43                  wave__calling_cnt                          主叫通话次数：近3月波动性               否
                   44                 grow__calling_dura                      当月主叫通话时长：近3月成长率               是
                   45              grow__gprs_last_defer                          流量滚存资源：近3月成长率               是
                   46               grow__gprs_now_defer                    可延递流量资源总量：近3月成长率               是
                   47                  grow__nos_calling                  主叫通话对端号码个数：近3月成长率               是
                   48            grow__calling_diff_dura                    主叫异网通话分钟数：近3月成长率               是
                   49                grow__gprs_now_rest                      当月gprs资源余量：近3月成长率               否
                   50                   grow__dinner_fee                            套餐月租费：近3月成长率               是
                   51              grow__gprs_flow_commu                        通信类应用流量：近3月成长率               是
                   52                     grow__call_use                        语音资源使用量：近3月成长率               是
                   53             grow__nos_calling_diff                  主叫异网对端号码个数：近3月成长率               是
                   54                  grow__calling_cnt                          主叫通话次数：近3月成长率               是
                   55              grow__gprs_flow_video                        视频类应用流量：近3月成长率               是
                   56                  max__gprs_flow_5g                           gprs 5g流量：近3月最大值               是
                   57                  max__calling_dura                      当月主叫通话时长：近3月最大值               是
                   58                max__call_dura_roam                         省际漫游-时长：近3月最大值               是
                   59              max__calling_diff_cnt                      主叫异网通话次数：近3月最大值               是
                   60               max__gprs_last_defer                          流量滚存资源：近3月最大值               是
                   61                   max__nos_calling                  主叫通话对端号码个数：近3月最大值               是
                   62                max__gprs_flow_roam                    gprs-国内漫游-流量：近3月最大值               是
                   63             max__calling_diff_dura                    主叫异网通话分钟数：近3月最大值               是
                   64                 max__gprs_now_rest                      当月gprs资源余量：近3月最大值               是
                   65   max__monthsremain_last_stop_date                最后停机时间：剩余时长：近3月最大值               是
                   66                      max__call_use                        语音资源使用量：近3月最大值               是
                   67                          max__arpu                              当月arpu：近3月最大值               是
                   68              max__nos_calling_diff                  主叫异网对端号码个数：近3月最大值               是
                   69                   max__calling_cnt                          主叫通话次数：近3月最大值               是
                   70                  min__calling_dura                      当月主叫通话时长：近3月最小值               是
                   71                 min__gprs_resource                      gprs国内资源总量：近3月最小值               是
                   72              min__calling_diff_cnt                      主叫异网通话次数：近3月最小值               是
                   73                min__gprs_flow_busy                        gprs-忙时-流量：近3月最小值               是
                   74               min__gprs_flow_music                        音乐类应用流量：近3月最小值               是
                   75               min__gprs_last_defer                          流量滚存资源：近3月最小值               是
                   76                   min__nos_calling                  主叫通话对端号码个数：近3月最小值               是
                   77                min__gprs_flow_roam                    gprs-国内漫游-流量：近3月最小值               是
                   78             min__calling_diff_dura                    主叫异网通话分钟数：近3月最小值               是
                   79                 min__gprs_now_rest                      当月gprs资源余量：近3月最小值               是
                   80               min__gprs_flow_short                       小视频系app流量：近3月最小值               是
                   81               min__gprs_flow_commu                        通信类应用流量：近3月最小值               是
                   82                      min__call_use                        语音资源使用量：近3月最小值               是
                   83                min__gprs_flow_game                        游戏类应用流量：近3月最小值               否
                   84                 min__days_call_p_4                        通话天数占比_4：近3月最小值               否
                   85                          min__arpu                              当月arpu：近3月最小值               是
                   86              min__nos_calling_diff                  主叫异网对端号码个数：近3月最小值               否
                   87                   min__calling_cnt                          主叫通话次数：近3月最小值               是
                   88               min__gprs_flow_video                        视频类应用流量：近3月最小值               是
                   89                  std__calling_dura                      当月主叫通话时长：近3月标准差               是
                   90                 std__gprs_resource                      gprs国内资源总量：近3月标准差               是
                   91                std__call_dura_roam                         省际漫游-时长：近3月标准差               是
                   92              std__calling_diff_cnt                      主叫异网通话次数：近3月标准差               是
                   93                std__gprs_flow_busy                        gprs-忙时-流量：近3月标准差               是
                   94               std__gprs_last_defer                          流量滚存资源：近3月标准差               是
                   95                   std__nos_calling                  主叫通话对端号码个数：近3月标准差               是
                   96             std__calling_diff_dura                    主叫异网通话分钟数：近3月标准差               是
                   97                 std__gprs_now_rest                      当月gprs资源余量：近3月标准差               否
                   98               std__gprs_flow_short                       小视频系app流量：近3月标准差               是
                   99               std__gprs_flow_commu                        通信类应用流量：近3月标准差               是
                   100                     std__call_use                        语音资源使用量：近3月标准差               是
                   101                         std__arpu                              当月arpu：近3月标准差               是
                   102             std__nos_calling_diff                  主叫异网对端号码个数：近3月标准差               是
                   103                  std__calling_cnt                          主叫通话次数：近3月标准差               是
                   104                           flag_eg                                           预测目标               否
                   105             more0cnt__calling_cnt                   主叫通话次数：近3月大于0的月份数               否
                   106          moreq25cnt__gprs_flow_5g         gprs 5g流量：近3月大于第一四分位数的月份数               是
                   107          moreq25cnt__calling_dura    当月主叫通话时长：近3月大于第一四分位数的月份数               是
                   108         moreq25cnt__gprs_resource    gprs国内资源总量：近3月大于第一四分位数的月份数               是
                   109        moreq25cnt__gprs_flow_busy      gprs-忙时-流量：近3月大于第一四分位数的月份数               是
                   110       moreq25cnt__gprs_last_defer        流量滚存资源：近3月大于第一四分位数的月份数               是
                   111        moreq25cnt__gprs_now_defer  可延递流量资源总量：近3月大于第一四分位数的月份数               否
                   112           moreq25cnt__nos_calling  主叫通话对端号码个数：近3月大于第一四分位数的月份数......       是
                   113     moreq25cnt__calling_diff_dura  主叫异网通话分钟数：近3月大于第一四分位数的月份数               是
                   114       moreq25cnt__gprs_flow_short     小视频系app流量：近3月大于第一四分位数的月份数               是
                   115                  moreq25cnt__arpu            当月arpu：近3月大于第一四分位数的月份数               是
                   116      moreq25cnt__nos_calling_diff  主叫异网对端号码个数：近3月大于第一四分位数的月份数......       是
                   117           moreq25cnt__calling_cnt        主叫通话次数：近3月大于第一四分位数的月份数               是
                   118       moreq25cnt__gprs_flow_video      视频类应用流量：近3月大于第一四分位数的月份数               是
                   119           valuecnt__if_nolimit~是      是否不限量套餐到达用户：近3月取值为是的月份数               是
                   120         valuecnt__if_5g_dinner~是                  是否5g套餐：近3月取值为是的月份数               是
20220322-17:53:21  
                   《建模报告》：时间窗口设计
20220322-17:53:21  训练	202009	202010	202011	202012
                   验证
                   测试	202010	202011	202012	202101
20220322-17:53:21  
                   《建模报告》：训练集、验证集、测试集
20220322-17:53:21  训练集	2180	1090	50.00%
                   验证集	500	80	16.00%
                   测试集	1000	171	17.10%
20220322-17:53:21  对此模型采取的抽样比例为1：1。
20220322-17:53:21  
                   《建模报告》：效果评估
20220322-17:53:21  -------------------------------------- data_train ----------------------------------------
20220322-17:53:21   累计人数占比 累计人数 累计人数_1 累计查准率 累计查全率 累计提升度     F1
                            1.5%       33         33     100.0%       3.0%          2  0.058
                            6.1%      133        133     100.0%      12.2%          2  0.217
                           12.2%      267        267     100.0%      24.5%          2  0.394
                           20.5%      447        447     100.0%      41.0%          2  0.582
                           31.1%      678        678     100.0%      62.2%          2  0.767
                           41.4%      903        903     100.0%      82.8%          2  0.906
                           50.0%     1090       1090     100.0%     100.0%          2  1.000
                           60.3%     1314       1090      83.0%     100.0%        1.7  0.907
                           72.1%     1572       1090      69.3%     100.0%        1.4  0.819
                           81.7%     1780       1090      61.2%     100.0%        1.2  0.759
                           90.5%     1972       1090      55.3%     100.0%        1.1  0.712
                          100.0%     2180       1090      50.0%     100.0%          1  0.667
20220322-17:53:21  -------------------------------------- data_timein ----------------------------------------
20220322-17:53:21   累计人数占比 累计人数 累计人数_1 累计查准率 累计查全率 累计提升度     F1
                            1.0%        5          3      60.0%       3.8%        3.8  0.071
                            5.2%       26         17      65.4%      21.2%        4.1  0.320
                           10.0%       50         29      58.0%      36.2%        3.6  0.446
                           21.0%      105         43      41.0%      53.8%        2.6  0.465
                           30.4%      152         50      32.9%      62.5%        2.1  0.431
                           40.4%      202         56      27.7%      70.0%        1.7  0.397
                           51.8%      259         61      23.6%      76.2%        1.5  0.360
                           62.0%      310         64      20.6%      80.0%        1.3  0.328
                           71.2%      356         67      18.8%      83.8%        1.2  0.307
                           81.0%      405         75      18.5%      93.8%        1.2  0.309
                           90.0%      450         76      16.9%      95.0%        1.1  0.287
                          100.0%      500         80      16.0%     100.0%          1  0.276
20220322-17:53:21  -------------------------------------- data_timeout ----------------------------------------
20220322-17:53:21   累计人数占比 累计人数 累计人数_1 累计查准率 累计查全率 累计提升度     F1
                            1.0%       10          8      80.0%       4.7%        4.7  0.089
                            5.2%       52         31      59.6%      18.1%        3.5  0.278
                           10.9%      109         59      54.1%      34.5%        3.2  0.421
                           21.7%      217         92      42.4%      53.8%        2.5  0.474
                           30.4%      304        117      38.5%      68.4%        2.3  0.493
                           40.0%      400        134      33.5%      78.4%          2  0.469
                           50.0%      500        142      28.4%      83.0%        1.7  0.423
                           61.3%      613        157      25.6%      91.8%        1.5  0.400
                           71.7%      717        166      23.2%      97.1%        1.4  0.375
                           80.0%      800        170      21.2%      99.4%        1.2  0.349
                           90.1%      901        171      19.0%     100.0%        1.1  0.319
                          100.0%     1000        171      17.1%     100.0%          1  0.292
20220322-17:53:21  
                   《建模报告》：排行前20的重要特征可视化
20220322-17:53:21                             field_name                              comment  importance
                   73                max__gprs_flow_roam      gprs-国内漫游-流量：近3月最大值    0.012416
                   49                 wave__calling_dura        当月主叫通话时长：近3月波动性    0.012836
                   25                 avg__gprs_resource          gprs国内资源总量：近3月均值    0.013139
                   94                          min__arpu                当月arpu：近3月最小值    0.013694
                   4                                arpu                             当月arpu    0.013807
                   2                       gprs_resource                     gprs国内资源总量    0.014402
                   108                         std__arpu                当月arpu：近3月标准差    0.015664
                   78                          max__arpu                当月arpu：近3月最大值    0.015733
                   76   max__monthsremain_last_stop_date  最后停机时间：剩余时长：近3月最大值    0.016253
                   54                wave__gprs_now_rest        当月gprs资源余量：近3月波动性    0.016284
                   40                          avg__arpu                  当月arpu：近3月均值    0.017209
                   35   avg__monthsremain_last_stop_date    最后停机时间：剩余时长：近3月均值    0.017650
                   106              std__gprs_flow_commu          通信类应用流量：近3月标准差    0.019354
                   14                      days_call_p_4                       通话天数占比_4    0.019366
                   37               avg__gprs_flow_commu            通信类应用流量：近3月均值    0.019590
                   0                        innet_months                             入网时长    0.021565
                   84                min__gprs_flow_busy          gprs-忙时-流量：近3月最小值    0.028643
                   10                     gprs_flow_busy                       gprs-忙时-流量    0.031550
                   101               std__gprs_flow_busy          gprs-忙时-流量：近3月标准差    0.035349
                   28                avg__gprs_flow_busy            gprs-忙时-流量：近3月均值    0.037491
20220322-17:53:22  初始tab:
                   col_0                                                1      0    All      prop
                   (avg__gprs_flow_busy, gprs-忙时-流量：近3月均值)                              
                   (-inf, 85308.667969]                              80.0  600.0  680.0  0.117647
                   (85308.667969, 1786311.8125]                      23.0  140.0  163.0  0.141104
                   (1786311.8125, inf]                               68.0   89.0  157.0  0.433121

20220322-17:53:22  未设置bin_thred， 将其赋值为10.0
20220322-17:53:22  未设置prop_thred， 将其赋值为0.01

20220322-17:53:22  --------------------------- 合并样本量<10.0的组别 -------------------------------
20220322-17:53:22  输入：
                   col_0                                                1      0    All      prop
                   (avg__gprs_flow_busy, gprs-忙时-流量：近3月均值)                              
                   (-inf, 85308.667969]                              80.0  600.0  680.0  0.117647
                   (85308.667969, 1786311.8125]                      23.0  140.0  163.0  0.141104
                   (1786311.8125, inf]                               68.0   89.0  157.0  0.433121

20220322-17:53:22  不再合并
20220322-17:53:22  ---------------------- 合并prop差距<0.01的相邻组别 -----------------------------
20220322-17:53:22  输入：
                   col_0                                                1      0    All      prop  prop_sub
                   (avg__gprs_flow_busy, gprs-忙时-流量：近3月均值)                                        
                   (-inf, 85308.667969]                              80.0  600.0  680.0  0.117647       NaN
                   (85308.667969, 1786311.8125]                      23.0  140.0  163.0  0.141104  0.023457
                   (1786311.8125, inf]                               68.0   89.0  157.0  0.433121  0.292017

20220322-17:53:22  不再合并
20220322-17:53:22  ------------------------------- 合并prop弯折过大的组别 ----------------------------------
20220322-17:53:22  tab的行数（3）<=3，不再合并


Traceback (most recent call last):
  File "C:\Users\higher\Anaconda3\lib\site-packages\IPython\core\interactiveshell.py", line 2961, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-242-92f651af97b3>", line 22, in <module>
    prop_lim = (xj[Info.Pcase] / xj.All).describe()[['min', 'max']].to_list()
  File "C:\Users\higher\Anaconda3\lib\site-packages\pandas\core\generic.py", line 4376, in __getattr__
    return object.__getattribute__(self, name)
AttributeError: 'Series' object has no attribute 'to_list'
