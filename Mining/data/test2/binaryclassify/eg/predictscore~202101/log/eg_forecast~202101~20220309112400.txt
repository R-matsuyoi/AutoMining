20220309-11:24:00  加载训练结果：./binaryclassify/eg/traintest~202011~202012/train_result~202011~202012.pkl
20220309-11:24:00  从训练结果中获取Info,并加入预测所需信息

20220309-11:24:00  condition中涉及日数据，接下来的预测过程不得不暂时忽略日数据条件
20220309-11:24:00  务必通知清单输出人员在输出清单时补充这些条件
20220309-11:24:00  确认忽略日数据条件，不会造成数据量的异常突增
20220309-11:24:00  检查剔除前后的逻辑确保可通过在清单输出时补充日数据条件以得到预期用户范围的清单

20220309-11:24:00  --- table_day从ml.ml_feature_info_yw_user_day,  acct_day, 1, 15修改为np.nan
20220309-11:24:00  --- 剔除condition_base中的日数据条件
                   原始：
                   
                       phone_no_null is null and
                       dayvalue_phone_no_null is null and
                       last_stop_date is not null and
                       innet_months >= 3
                   剔除后：
                   phone_no_null is null and
                    last_stop_date is not null and
                    innet_months >= 3

20220309-11:24:00  --- 剔除condition中的日数据条件
                   原始：
                   dayvalue_user_status='在网-正常' and 
                       phone_no_null is null and
                       dayvalue_phone_no_null is null and
                       last_stop_date is not null and
                       innet_months >= 3
                   剔除后：
                   phone_no_null is null and
                    last_stop_date is not null and
                    innet_months >= 3


                   ###################################################################### 加工预测账期近n月基础数据
                    
20220309-11:24:00  开始时间：2022-03-09 11:24:00
20220309-11:24:00  month: 202101
20220309-11:24:00  参数设置：
                       step: predict
                       Info.model_name: 模型示例
                       Info.n_recent: 3
                       drop_midtable: True
                       cover_table_all: True

                   ------------------------------------- 检查各前置表 --------------------------------------------------- 
20220309-11:24:00  检查 ml.ml_feature_info_yw_user_m
20220309-11:24:00      72 列
20220309-11:24:00      202101账期： 18000行
20220309-11:24:00      202012账期： 15000行
20220309-11:24:00      202011账期： 10000行


20220309-11:24:00  检查 ml.ml_feature_add_yw_user_m
20220309-11:24:00      4 列
20220309-11:24:00      202101账期： 18000行
20220309-11:24:00      202012账期： 15000行
20220309-11:24:00      202011账期： 10000行


20220309-11:24:00  未设置Info.table_day



20220309-11:24:00  预测集无需Info.table_y




                   -------------------- 汇总当期特征与目标：ml.dm_zc_moxing_info_add_202101 -------------------------- 
20220309-11:24:00  查询表： 
                       select concat(table_schema, '.', table_name) full_name
                       from information_schema.tables 
                       where table_schema = 'ml' and table_name='dm_zc_moxing_info_add_202101'
                       存在1个表 
20220309-11:24:00  ml.dm_zc_moxing_info_add_202101已存在，将重建覆盖
20220309-11:24:00  建表语句： 
                       drop table if exists ml.dm_zc_moxing_info_add_202101;
                       select pg_sleep(10);
                       create table ml.dm_zc_moxing_info_add_202101 as
                       select * from (
                           select a.* 
                           , a2.age_add, a2.sex_add
                           
                           from (select * from ml.ml_feature_info_yw_user_m where cast(acct_month as text)='202101') a 
                           left join (select*from ml.ml_feature_add_yw_user_m where cast(acct_month as text)='202101') a2 on a.user_id = a2.user_id
                           
                       ) t where phone_no_null is null and
                        last_stop_date is not null and
                        innet_months >= 3