
                   ###################################################################### 转换、检查、纠正基础数据字典（Info.field_base） 

20220309-11:07:44  field_base: 96行
20220309-11:07:44  删除25个available“不可用”字段：['dev_channel_name', 'age', 'sex', 'stop_times', 'resent_stop_date', 'is_real_name', 'is_grp_member', 'pack_hd_num', 'point', 'star', 'basic_credit', 'quota', 'owe_flag', 'owe_charge', 'owe_times', 'owe_charge_acct', 'payment_fee', 'balance', 'is_qw_wifi', 'is_xygj', 'is_znms', 'is_tykj', 'is_jty', 'self_scs_cnt', 'self_com_cnt']
20220309-11:07:44  field_base: 71行

20220309-11:07:44  删除3个基于“不可用”字段加工的手动衍生_py字段：
                                          field_name                          formula
                   18  monthsaready_resent_stop_date  current_date - resent_stop_date
                   62                         arpu_p                     arpu/balance
                   63                      balance_p            balance/prod_spec_fee
20220309-11:07:44  field_base: 68行

                   ###################################################################### 加工训练账期近n月基础数据
                    
20220309-11:07:44  开始时间：2022-03-09 11:07:44
20220309-11:07:44  month: 202109
20220309-11:07:44  参数设置：
                       step: train
                       Info.model_name: 流失预警模型_宽带
                       Info.n_recent: 3
                       drop_midtable: True
                       cover_table_all: True
                       Info.Pcase_limit: 10000
                       Info.traintable_ratio: 3
                       Info.Pcumsum_limit: nan
                       Info.timein_count: 50000

                   ------------------------------------- 检查各前置表 --------------------------------------------------- 
20220309-11:07:44  检查 ml.dm_zc_kd_moxing_info_m


Traceback (most recent call last):
  File "D:\installdir_xj\Anaconda3\lib\site-packages\pandas\io\sql.py", line 1586, in execute
    cur.execute(*args, **kwargs)
20220309-11:07:44  psycopg2.errors.UndefinedTable: 错误:  关系 "ml.dm_zc_kd_moxing_info_m" 不存在
                   LINE 1: ...ast(acct_month as text) acct_month, count(1) from ml.dm_zc_k...
                                                                                ^
20220309-11:07:44  
                   The above exception was the direct cause of the following exception:


Traceback (most recent call last):
  File "<ipython-input-3-f34e9a31e7d4>", line 29, in <module>
    base_train[model_name], Info = privy_basedatafun('train', Info, cover_table_all=Info.cover_table_all_train)
  File "D:\STUDY\Python\PycharmProjects\ModelProject\selfmodule\tablemodule\tablefun.py", line 447, in privy_basedatafun
    mlist_x = get_month_count(Info.table_x, Info.col_month, end=month)
  File "D:\STUDY\Python\PycharmProjects\ModelProject\selfmodule\toolmodule\datatrans.py", line 282, in get_month_count
    mlist = my_sql_fun(sql_mlist, method='read', index_col=col_month).sort_values(by=col_month)
  File "D:\STUDY\Python\PycharmProjects\ModelProject\selfmodule\toolmodule\datatrans.py", line 146, in my_sql_fun
    data_res = pd.read_sql(sql, conn1, index_col=index_col, **kwargs)
  File "D:\installdir_xj\Anaconda3\lib\site-packages\pandas\io\sql.py", line 412, in read_sql
    chunksize=chunksize,
  File "D:\installdir_xj\Anaconda3\lib\site-packages\pandas\io\sql.py", line 1633, in read_query
    cursor = self.execute(*args)
  File "D:\installdir_xj\Anaconda3\lib\site-packages\pandas\io\sql.py", line 1598, in execute
    raise ex from exc
pandas.io.sql.DatabaseError: Execution failed on sql 'select cast(acct_month as text) acct_month, count(1) from ml.dm_zc_kd_moxing_info_m where cast(acct_month as text) <= '202109' group by acct_month': 错误:  关系 "ml.dm_zc_kd_moxing_info_m" 不存在
LINE 1: ...ast(acct_month as text) acct_month, count(1) from ml.dm_zc_k...
                                                             ^

