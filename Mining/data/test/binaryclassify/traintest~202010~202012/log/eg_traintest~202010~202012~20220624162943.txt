
                   ###################################################################### 加工训练账期近n月基础数据
                    
20220624-16:29:43  开始时间：2022-06-24 16:29:43
20220624-16:29:43  ---- month: 202010
20220624-16:29:43  ---- 参数设置：
                       ---- step: train
                       ---- Info.model_name: 模型示例
                       ---- Info.n_recent: 3
                       ---- Info.Pcase_limit: 1000
                       ---- Info.traintable_ratio: 2
                       ---- Info.Pcumsum_limit: 2
                       ---- Info.timein_count: 500

                   ------------------------------------- 检查各前置表 --------------------------------------------------- 
20220624-16:29:43  检查 kehujingyingbudb.ml_xy_eg_m
20220624-16:29:43      78 列
20220624-16:29:43      202010账期： 15000行
20220624-16:29:43      202009账期： 18000行
20220624-16:29:43      202008账期： 10000行


20220624-16:29:43  正负例分布：select cast(flag_eg as text) flag_eg, count(1) from kehujingyingbudb.ml_xy_eg_m  group by flag_eg
20220624-16:29:43      dis_train_total: {'count': 68000, 'Pcount': 8036, 'prop': 0.118}



20220624-16:29:43  ---- 建表语句（限定202010账期当月目标用户）：
                       drop table if exists kehujingyingbudb.mid_eg_model_train_202010;
                       select pg_sleep(5);
                       create  table kehujingyingbudb.mid_eg_model_train_202010 as 
                       select acct_month, user_id, flag_eg ,row_number() over(order by acct_month desc, random()) rnself 
                       from kehujingyingbudb.ml_xy_eg_m
                       where acct_month>=202008 and acct_month<=202010 and user_status='在网-正常' and 
                           phone_no_null is null and
                           last_stop_date is not null and
                           innet_months >= 3 
                        and flag_eg is not null;
20220624-16:29:48      sql执行完毕
20220624-16:29:49  统计kehujingyingbudb.mid_eg_model_train_202010行列数
20220624-16:29:49      行数：{'202009': 15048, '202010': 12449}
                       列数：4


20220624-16:29:49  ---- 建表语句（划分训练/验证数据集）：
                       drop table if exists kehujingyingbudb.mid_eg_user_train_202010;
                       create  table kehujingyingbudb.mid_eg_user_train_202010 as 
                       (select acct_month user_acct_month, 'data_timein' data_use, * from kehujingyingbudb.mid_eg_model_train_202010 where rnself <= 500)
                       union all
                       (select acct_month user_acct_month, 'data_train'  data_use, * from kehujingyingbudb.mid_eg_model_train_202010 where rnself > 500 and flag_eg=1 order by rnself limit 1000)
                       union all
                       (select acct_month user_acct_month, 'data_train'  data_use, * from kehujingyingbudb.mid_eg_model_train_202010 where rnself > 500 and flag_eg=0 order by rnself limit 2000) ;
20220624-16:29:49      sql执行完毕
20220624-16:29:49  正负例分布：select cast(flag_eg as text) flag_eg, count(1) from kehujingyingbudb.mid_eg_user_train_202010  group by flag_eg
20220624-16:29:49      dis_train_sample {'count': 3500, 'Pcount': 1078, 'prop': 0.308}



20220624-16:29:49  ---- 关联近n月数据：
                       drop table if exists kehujingyingbudb.mid_eg_recent_train_202010;
                       create  table kehujingyingbudb.mid_eg_recent_train_202010 as
                       select user_acct_month, data_use, acct_month, phone_no_null, phone_no_tm, user_id, dinner_id, account_id, innet_date, innet_months, age, sex, age_add, sex_add, user_status, last_stop_date, dinner, dinner_fee, gprs_last_defer, gprs_resource, gprs_now_rest, call_use, if_nolimit, if_5g_dinner, if_5g_term, if_jt, start_level, cred_type, if_cred_multi, arpu, pay_cnt, pay_fee, acct_balance, term_model, term_brand, term_type, sk_type, if_new_term, calling_cnt, calling_dura, called_cnt, called_dura, calling_diff_cnt, calling_diff_dura, gprs_flow, gprs_flow_4g, gprs_flow_5g, gprs_flow_busy, gprs_flow_idle, gprs_now_defer, gprs_flow_roam, call_dura_roam, days_roam, gprs_flow_gat, days_gat, days_gprs, days_call, nos_call, nos_calling, nos_calling_diff, sms_cnt, call_fee_local, call_fee_roam, gprs_income, gprs_fee, call_fee, gprs_flow_video, gprs_flow_short, gprs_flow_music, gprs_flow_commu, gprs_flow_game, dayvalue_calling_dura, dayvalue_gprs_flow, dayvalue_user_status, dayvalue_phone_no_null, flag_eg, score_flag_eg, score_flag_eg2 
                       from (
                       select a.user_acct_month, a.data_use, b.*
                       from (select * from kehujingyingbudb.mid_eg_user_train_202010 where data_use='data_timein') a
                       inner join (select * from kehujingyingbudb.ml_xy_eg_m where acct_month>=202008 and acct_month<=202010) b on a.user_id = b.user_id
                       union all 
                       select a.user_acct_month, a.data_use, b.*
                       from (select * from kehujingyingbudb.mid_eg_user_train_202010 where data_use='data_train' and acct_month=202008) a
                       inner join (select * from kehujingyingbudb.ml_xy_eg_m where acct_month>=202006 and acct_month<=202008) b on a.user_id = b.user_id
                       union all
                       select a.user_acct_month, a.data_use, b.*
                       from (select * from kehujingyingbudb.mid_eg_user_train_202010 where data_use='data_train' and acct_month=202009) a
                       inner join (select * from kehujingyingbudb.ml_xy_eg_m where acct_month>=202007 and acct_month<=202009) b on a.user_id = b.user_id
                       union all
                       select a.user_acct_month, a.data_use, b.*
                       from (select * from kehujingyingbudb.mid_eg_user_train_202010 where data_use='data_train' and acct_month=202010) a
                       inner join (select * from kehujingyingbudb.ml_xy_eg_m where acct_month>=202008 and acct_month<=202010) b on a.user_id = b.user_id
                       ) t;
20220624-16:29:49      sql执行完毕
20220624-16:29:49  统计kehujingyingbudb.mid_eg_recent_train_202010行列数
20220624-16:29:49      9310行，78列

                   --------------------------------- 核验各账期数据量  ---------------------------------------------- 
20220624-16:29:49  sql语句：
                       select user_acct_month, data_use, acct_month, flag_eg, count(1) 
                       from kehujingyingbudb.mid_eg_recent_train_202010 
                       group by user_acct_month, data_use, acct_month, flag_eg 
                       order by user_acct_month, data_use, acct_month, flag_eg

20220624-16:29:49  结果：
                      user_acct_month     data_use  acct_month  flag_eg  count
                   0           202010  data_timein      202008      NaN    339
                   1           202010  data_timein      202009      0.0    422
                   2           202010  data_timein      202009      1.0     78
                   3           202010  data_timein      202010      0.0    422
                   4           202010  data_timein      202010      1.0     78
                   5           202010   data_train      202008      NaN   1971
                   6           202010   data_train      202009      0.0   2000
                   7           202010   data_train      202009      1.0   1000
                   8           202010   data_train      202010      0.0   2000
                   9           202010   data_train      202010      1.0   1000


D:\工作\模型脚本\ModelProject\selfmodule\tablemodule\tablefun.py:900: UserWarning: 下列账期用户量不同，请检查！
                             acct_month  flag_eg  count
user_acct_month data_use                               
202010          data_timein      202008      0.0    339
                data_timein      202009      1.0    500
                data_timein      202010      1.0    500
                data_train       202008      0.0   1971
                data_train       202009      1.0   3000
                data_train       202010      1.0   3000
  warnings.warn(w); time.sleep(seconds)
20220624-16:29:52  
                   ---- 删除中间表
20220624-16:29:52  drop table if exists kehujingyingbudb.mid_eg_model_train_202010;
20220624-16:29:52      sql执行完毕
20220624-16:29:52  drop table if exists kehujingyingbudb.mid_eg_user_train_202010;
20220624-16:29:52      sql执行完毕

20220624-16:29:52  ---- 返回结果表名：kehujingyingbudb.mid_eg_recent_train_202010
20220624-16:29:52  ---- 将Info保存至./binaryclassify/eg/traintest~202010~202012/Info~base_train.pkl

20220624-16:29:52  结束时间：2022-06-24 16:29:52
20220624-16:29:52  耗时：9 s

                   ###################################################################### 探索模型宽表
                    
20220624-16:54:47  开始时间：2022-06-24 16:54:47
20220624-16:54:47  参数设置：
                       Info.model_name: 模型示例
                       Info.iv_limit: 0.05
                       stage: explore
                       table_in: kehujingyingbudb.mid_eg_recent_train_202010
                       Info.r_limit: 0.95
                       Info.auto_pair2: False
                       step: train

20220624-16:54:47  field_base: 92行

20220624-16:54:47  删除7个available_notzd“不可用”字段：['cred_type', 'called_dura', 'days_roam', 'dayvalue_calling_dura', 'dayvalue_gprs_flow', 'dayvalue_user_status', 'dayvalue_phone_no_null']
20220624-16:54:47  field_base: 85行

20220624-16:54:47  删除1个基于“不可用”字段加工的手动衍生_py字段：
                        field_name                 formula
                   54  days_roam_p  days_roam / days_month
20220624-16:54:47  field_base: 84行
20220624-16:54:47  ------------------------- 读取数据: kehujingyingbudb.mid_eg_recent_train_202010 2022-06-24 16:54:47 -------------------------
20220624-16:54:47      src: gp
20220624-16:54:47      condition: data_use='data_train'
20220624-16:54:47      col_need(71): ['user_acct_month', 'data_use', 'acct_month', 'user_id', 'innet_months', 'age', 'age_add', 'dinner_fee', 'gprs_last_defer', 'gprs_resource', 'gprs_now_rest', 'call_use', 'arpu', 'pay_cnt', 'pay_fee', 'acct_balance', 'calling_cnt', 'calling_dura', 'called_cnt', 'calling_diff_cnt', 'calling_diff_dura', 'gprs_flow', 'gprs_flow_4g', 'gprs_flow_5g', 'gprs_flow_busy', 'gprs_flow_idle', 'gprs_now_defer', 'gprs_flow_roam', 'call_dura_roam', 'gprs_flow_gat', 'days_gat', 'days_gprs', 'days_call', 'nos_call', 'nos_calling', 'nos_calling_diff', 'sms_cnt', 'call_fee_local', 'call_fee_roam', 'gprs_income', 'gprs_fee', 'call_fee', 'gprs_flow_video', 'gprs_flow_short', 'gprs_flow_music', 'gprs_flow_commu', 'gprs_flow_game', 'score_flag_eg', 'score_flag_eg2', 'innet_date', 'last_stop_date', 'phone_no_null', 'phone_no_tm', 'dinner_id', 'account_id', 'sex', 'sex_add', 'user_status', 'dinner', 'if_nolimit', 'if_5g_dinner', 'if_5g_term', 'if_jt', 'start_level', 'if_cred_multi', 'term_model', 'term_brand', 'term_type', 'sk_type', 'if_new_term', 'flag_eg']
20220624-16:54:47      col_del: None
20220624-16:54:47      col_char(22): ['acct_month', 'phone_no_null', 'phone_no_tm', 'user_id', 'dinner_id', 'account_id', 'sex', 'sex_add', 'user_status', 'dinner', 'if_nolimit', 'if_5g_dinner', 'if_5g_term', 'if_jt', 'start_level', 'if_cred_multi', 'term_model', 'term_brand', 'term_type', 'sk_type', 'if_new_term', 'flag_eg']
20220624-16:54:47      col_num(45): ['innet_months', 'age', 'age_add', 'dinner_fee', 'gprs_last_defer', 'gprs_resource', 'gprs_now_rest', 'call_use', 'arpu', 'pay_cnt', 'pay_fee', 'acct_balance', 'calling_cnt', 'calling_dura', 'called_cnt', 'calling_diff_cnt', 'calling_diff_dura', 'gprs_flow', 'gprs_flow_4g', 'gprs_flow_5g', 'gprs_flow_busy', 'gprs_flow_idle', 'gprs_now_defer', 'gprs_flow_roam', 'call_dura_roam', 'gprs_flow_gat', 'days_gat', 'days_gprs', 'days_call', 'nos_call', 'nos_calling', 'nos_calling_diff', 'sms_cnt', 'call_fee_local', 'call_fee_roam', 'gprs_income', 'gprs_fee', 'call_fee', 'gprs_flow_video', 'gprs_flow_short', 'gprs_flow_music', 'gprs_flow_commu', 'gprs_flow_game', 'score_flag_eg', 'score_flag_eg2']
20220624-16:54:47      col_date(2): ['innet_date', 'last_stop_date']
20220624-16:54:47      nrows: None
20220624-16:54:47      if_coltolower: True
20220624-16:54:47      kwargs: {}

20220624-16:54:47      读取
20220624-16:54:50      shape: (7971, 71)

20220624-16:54:50  将score_flag_eg2字段类型(object): .astype(float)
20220624-16:54:50  -------------------------读取完毕: (7971, 71) 2022-06-24 16:54:50 -------------------------

20220624-16:54:50  手动衍生_py12个字段: {'monthsaready_last_stop_date': '最后停机时间：已发生时长', 'monthsremain_last_stop_date': '最后停机时间：剩余时长', 'days_gprs_p': '上网天数占比', 'days_call_p': '通话天数占比', 'days_call_p_1': '通话天数占比_1', 'days_call_p_2': '通话天数占比_2', 'days_call_p_3': '通话天数占比_3', 'days_call_p_4': '通话天数占比_4', 'greatest_gprs_app': 'app偏好', 'paste_dinner_innet_months': '主套餐、入网时长：交叉', 'ago_score_flag_eg': '模型示例的分数(历史)', 'ago_score_flag_eg2': '模型示例2的分数(历史)'}
20220624-16:54:50  monthsaready_last_stop_date: current_date - last_stop_date
20220624-16:54:51  monthsremain_last_stop_date: last_stop_date - current_date
20220624-16:54:51  days_gprs_p: days_gprs / days_month
20220624-16:54:51  days_call_p: days_call / days_month
20220624-16:54:51  days_call_p_1: days_call_p + days_gprs
20220624-16:54:51  days_call_p_2: days_call_p_1 + days_gprs
20220624-16:54:51  days_call_p_3: days_call_p_2 + days_gprs
20220624-16:54:51  days_call_p_4: days_call_p_3 + days_gprs
20220624-16:54:51  greatest_gprs_app: {'gprs_flow_video': 'video', 'gprs_flow_short': 'short', 'gprs_flow_music': 'music', 'gprs_flow_commu': 'commu', 'gprs_flow_game': 'game'}
20220624-16:54:52  paste_dinner_innet_months: (dinner, innet_months)
20220624-16:54:55  ago_score_flag_eg: {'notago_tovalue': 1}
20220624-16:54:55  ago_score_flag_eg2: {'notago_tovalue': 1}


Traceback (most recent call last):
  File "D:\Python for Windows\lib\site-packages\IPython\core\interactiveshell.py", line 3296, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-7-53c27ac8365d>", line 2, in <module>
    exp, Info = tab_explore_create(base_train[model_name], Info, 'explore', src)
  File "D:\工作\模型脚本\ModelProject\selfmodule\tablemodule\tablefun.py", line 1866, in tab_explore_create
    data_recent, col_need_ad = manual_fun(data_recent, Info, field_manual)
  File "D:\工作\模型脚本\ModelProject\selfmodule\tablemodule\tablefun.py", line 1281, in manual_fun
    na_inf_examine(data_recent[field_manual.field_name])
  File "D:\工作\模型脚本\ModelProject\selfmodule\toolmodule\dataprep.py", line 142, in na_inf_examine
    raise Exception(s)
Exception: 数据存在缺失值或±inf，请检查！

缺失值：
ago_score_flag_eg2    4971
dtype: int64
                   Out[10]: 20220624-16:55:48  'gp'
  File "<ipython-input-11-61b84ed09a03>", line 1
    if_condition=False)
                      ^
SyntaxError: invalid syntax

20220624-16:56:11  开始时间：2022-06-24 16:56:11
20220624-16:56:20  参数设置：
                       Info.model_name: 模型示例
                       Info.iv_limit: 0.05
                       stage: explore
                       table_in: kehujingyingbudb.mid_eg_recent_train_202010
                       Info.r_limit: 0.95
                       Info.auto_pair2: False
                       step: train

20220624-16:56:43  field_base: 92行

20220624-16:56:51  删除7个available_notzd“不可用”字段：['cred_type', 'called_dura', 'days_roam', 'dayvalue_calling_dura', 'dayvalue_gprs_flow', 'dayvalue_user_status', 'dayvalue_phone_no_null']
20220624-16:56:51  field_base: 85行

20220624-16:56:51  删除1个基于“不可用”字段加工的手动衍生_py字段：
                        field_name                 formula
                   54  days_roam_p  days_roam / days_month
20220624-16:56:51  field_base: 84行


D:\工作\模型脚本\ModelProject\selfmodule\toolmodule\dataprep.py:9: UserWarning: Pipeline_DF：verbose参数值被赋予print_indent后默认参数设置为None
  import time


D:\工作\模型脚本\ModelProject\selfmodule\toolmodule\dataprep.py:9: UserWarning: FeatureUnion_DF：verbose参数值被赋予print_indent后默认参数设置为None
  import time
20220624-16:57:23  ------------------------- 读取数据: kehujingyingbudb.mid_eg_recent_train_202010 2022-06-24 16:57:23 -------------------------
20220624-16:57:23      src: gp
20220624-16:57:23      condition: data_use='data_train'
20220624-16:57:23      col_need(71): ['user_acct_month', 'data_use', 'acct_month', 'user_id', 'innet_months', 'age', 'age_add', 'dinner_fee', 'gprs_last_defer', 'gprs_resource', 'gprs_now_rest', 'call_use', 'arpu', 'pay_cnt', 'pay_fee', 'acct_balance', 'calling_cnt', 'calling_dura', 'called_cnt', 'calling_diff_cnt', 'calling_diff_dura', 'gprs_flow', 'gprs_flow_4g', 'gprs_flow_5g', 'gprs_flow_busy', 'gprs_flow_idle', 'gprs_now_defer', 'gprs_flow_roam', 'call_dura_roam', 'gprs_flow_gat', 'days_gat', 'days_gprs', 'days_call', 'nos_call', 'nos_calling', 'nos_calling_diff', 'sms_cnt', 'call_fee_local', 'call_fee_roam', 'gprs_income', 'gprs_fee', 'call_fee', 'gprs_flow_video', 'gprs_flow_short', 'gprs_flow_music', 'gprs_flow_commu', 'gprs_flow_game', 'score_flag_eg', 'score_flag_eg2', 'innet_date', 'last_stop_date', 'phone_no_null', 'phone_no_tm', 'dinner_id', 'account_id', 'sex', 'sex_add', 'user_status', 'dinner', 'if_nolimit', 'if_5g_dinner', 'if_5g_term', 'if_jt', 'start_level', 'if_cred_multi', 'term_model', 'term_brand', 'term_type', 'sk_type', 'if_new_term', 'flag_eg']
20220624-16:57:23      col_del: None
20220624-16:57:23      col_char(22): ['acct_month', 'phone_no_null', 'phone_no_tm', 'user_id', 'dinner_id', 'account_id', 'sex', 'sex_add', 'user_status', 'dinner', 'if_nolimit', 'if_5g_dinner', 'if_5g_term', 'if_jt', 'start_level', 'if_cred_multi', 'term_model', 'term_brand', 'term_type', 'sk_type', 'if_new_term', 'flag_eg']
20220624-16:57:23      col_num(45): ['innet_months', 'age', 'age_add', 'dinner_fee', 'gprs_last_defer', 'gprs_resource', 'gprs_now_rest', 'call_use', 'arpu', 'pay_cnt', 'pay_fee', 'acct_balance', 'calling_cnt', 'calling_dura', 'called_cnt', 'calling_diff_cnt', 'calling_diff_dura', 'gprs_flow', 'gprs_flow_4g', 'gprs_flow_5g', 'gprs_flow_busy', 'gprs_flow_idle', 'gprs_now_defer', 'gprs_flow_roam', 'call_dura_roam', 'gprs_flow_gat', 'days_gat', 'days_gprs', 'days_call', 'nos_call', 'nos_calling', 'nos_calling_diff', 'sms_cnt', 'call_fee_local', 'call_fee_roam', 'gprs_income', 'gprs_fee', 'call_fee', 'gprs_flow_video', 'gprs_flow_short', 'gprs_flow_music', 'gprs_flow_commu', 'gprs_flow_game', 'score_flag_eg', 'score_flag_eg2']
20220624-16:57:23      col_date(2): ['innet_date', 'last_stop_date']
20220624-16:57:23      nrows: None
20220624-16:57:23      if_coltolower: True
20220624-16:57:23      kwargs: {}

20220624-16:57:23      读取
20220624-16:57:25      shape: (7971, 71)

20220624-16:57:26  将score_flag_eg2字段类型(object): .astype(float)
20220624-16:57:26  -------------------------读取完毕: (7971, 71) 2022-06-24 16:57:26 -------------------------

20220624-16:58:11  手动衍生_py12个字段: {'monthsaready_last_stop_date': '最后停机时间：已发生时长', 'monthsremain_last_stop_date': '最后停机时间：剩余时长', 'days_gprs_p': '上网天数占比', 'days_call_p': '通话天数占比', 'days_call_p_1': '通话天数占比_1', 'days_call_p_2': '通话天数占比_2', 'days_call_p_3': '通话天数占比_3', 'days_call_p_4': '通话天数占比_4', 'greatest_gprs_app': 'app偏好', 'paste_dinner_innet_months': '主套餐、入网时长：交叉', 'ago_score_flag_eg': '模型示例的分数(历史)', 'ago_score_flag_eg2': '模型示例2的分数(历史)'}
20220624-16:58:11  monthsaready_last_stop_date: current_date - last_stop_date
20220624-16:58:12  monthsremain_last_stop_date: last_stop_date - current_date
20220624-16:58:12  days_gprs_p: days_gprs / days_month
20220624-16:58:12  days_call_p: days_call / days_month
20220624-16:58:12  days_call_p_1: days_call_p + days_gprs
20220624-16:58:12  days_call_p_2: days_call_p_1 + days_gprs
20220624-16:58:12  days_call_p_3: days_call_p_2 + days_gprs
20220624-16:58:12  days_call_p_4: days_call_p_3 + days_gprs
20220624-16:58:12  greatest_gprs_app: {'gprs_flow_video': 'video', 'gprs_flow_short': 'short', 'gprs_flow_music': 'music', 'gprs_flow_commu': 'commu', 'gprs_flow_game': 'game'}
20220624-16:58:13  paste_dinner_innet_months: (dinner, innet_months)


D:\工作\模型脚本\ModelProject\selfmodule\tablemodule\tablefun.py:1020: UserWarning: opera_pair_fun paste时存在非类别型字段，请确认: ['innet_months']
  warnings.warn(s); time.sleep(seconds)
20220624-16:58:16  ago_score_flag_eg: {'notago_tovalue': 1}
20220624-16:58:16  ago_score_flag_eg2: {'notago_tovalue': 1}


Traceback (most recent call last):
  File "D:\Python for Windows\lib\site-packages\IPython\core\interactiveshell.py", line 3296, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-34-a429f7d6797b>", line 1, in <module>
    data_recent, col_need_ad = manual_fun(data_recent, Info, field_manual)
  File "D:\工作\模型脚本\ModelProject\selfmodule\tablemodule\tablefun.py", line 1281, in manual_fun
    na_inf_examine(data_recent[field_manual.field_name])
  File "D:\工作\模型脚本\ModelProject\selfmodule\toolmodule\dataprep.py", line 142, in na_inf_examine
    raise Exception(s)
Exception: 数据存在缺失值或±inf，请检查！

缺失值：
ago_score_flag_eg2    4971
dtype: int64
                   Out[35]: 20220624-16:58:24  
                        user_acct_month    data_use acct_month      user_id  innet_months  age  age_add  dinner_fee  gprs_last_defer  gprs_resource  gprs_now_rest  call_use    arpu  pay_cnt  \
                   0             202010  data_train     202008  17913749331            77   31       31         8.0               10       10506250     20991957.0       3.0   18.00        0   
                   1             202010  data_train     202008  10998654690            88   50       50         5.0                0       10485770            0.0       NaN   61.28        0   
                   2             202010  data_train     202008  24060405935           259   57       57        38.0             3072        6291466     16755651.0      30.0   47.69        0   
                   3             202010  data_train     202008  82892945600           127   35       35       120.0                0       29360138     11014088.0     628.0  121.90        0   
                   4             202010  data_train     202008  24579425832           191   44       44        18.0              100       10690570     15668322.0       NaN   30.66        0   
                   ...              ...         ...        ...          ...           ...  ...      ...         ...              ...            ...            ...       ...     ...      ...   
                   7966          202010  data_train     202010  39936971433            54   20       20         9.0                0             10            0.0       0.0    9.00        0   
                   7967          202010  data_train     202010  16450943065           217   49       49         8.0                0             10            0.0       0.0    9.15        0   
                   7968          202010  data_train     202010  23777067604            57   25       25        38.0              300         614410     11098008.0       2.0   38.00        0   
                   7969          202010  data_train     202010  77210214384           183   43       43        18.0              100         204810     10690194.0       NaN   18.49        0   
                   7970          202010  data_train     202010  38527880538           201   67       67        18.0              100         204810     10690445.0       NaN   18.00        0   
                   
                         pay_fee  ...   sex_add  user_status                            dinner  if_nolimit  if_5g_dinner  if_5g_term  if_jt  start_level  if_cred_multi      term_model  term_brand  \
                   0         0.0  ...        女    在网-正常   神州行畅听卡4G飞享套餐升级版8档          否            否          否     否         一星              1       OPPO R11s        欧珀   
                   1         0.0  ...        女    在网-正常                 神州行5元卡[策划]          否            否          否     否         一星              2       ART-AL00x        华为   
                   2         0.0  ...        男    在网-正常                  全球通4G基本策划          否            否          是     是         三星              2  iPhone 7 A1660        苹果   
                   3         0.0  ...        男    在网-正常     神州行5元卡集团任我用套餐-120          是            否          是     是         银卡              1        ELS-AN00        华为   
                   4         0.0  ...  性别不详    在网-正常       神州行B4G飞享套餐升级版18档          否            否          否     否         二星              1          PBAT00        欧珀   
                   ...       ...  ...       ...          ...                               ...         ...           ...         ...    ...          ...            ...             ...         ...   
                   7966      0.0  ...  性别不详    在网-正常            神州行畅听卡4G基本策划          否            否          否     否         一星              1          PCHM10        欧珀   
                   7967      0.0  ...        女    在网-正常                 神州行B4G基本策划          否            否          否     是         二星              1        ELE-AL00        华为   
                   7968      0.0  ...        男    在网-正常            动感地带和4G套餐38套餐          否            否          否     否         一星              1        BKL-AL20        华为   
                   7969      0.0  ...        男    在网-正常      动感地带4G飞享套餐升级版18档          否            否          否     否         三星              1        LYA-AL00        华为   
                   7970      0.0  ...        女    在网-正常  神州行畅听卡4G飞享套餐升级版18档          否            否          否     否         三星              2        ELE-AL00        华为   
                   
                         term_type   sk_type  if_new_term  flag_eg  
                   0        4G手机      None           否     None  
                   1        4G手机  本网双卡           否     None  
                   2        4G手机  异网双卡           否     None  
                   3        4G手机  异网双卡           否     None  
                   4        4G手机  其他双卡           否     None  
                   ...         ...       ...          ...      ...  
                   7966     4G手机      None           否        0  
                   7967     4G手机  异网双卡           否        0  
                   7968     4G手机  异网双卡           否        0  
                   7969     4G手机  本网双卡           否        0  
                   7970     4G手机      None           否        0  
                   
                   [7971 rows x 71 columns]


Traceback (most recent call last):
  File "D:\Python for Windows\lib\site-packages\IPython\core\interactiveshell.py", line 3213, in run_ast_nodes
    code = compiler(mod, cell_name, "exec")
  File "D:\Python for Windows\lib\codeop.py", line 133, in __call__
    codeob = compile(source, filename, symbol, self.flags, 1)
  File "<ipython-input-37-857126134ead>", line 2
SyntaxError: 'return' outside function
                   Out[38]: 
                                        field_name                   comment dtype_db dtype_classify    field_src   table available available_notzd available_zd  \
                   14  monthsaready_last_stop_date  最后停机时间：已发生时长  numeric         数值型  手动衍生_py  python       NaN             NaN          NaN   
                   15  monthsremain_last_stop_date    最后停机时间：剩余时长  numeric         数值型  手动衍生_py  python       NaN             NaN          NaN   
                   60                  days_gprs_p              上网天数占比  numeric         数值型  手动衍生_py  python       NaN             NaN          NaN   
                   62                  days_call_p              通话天数占比  numeric         数值型  手动衍生_py  python       NaN             NaN          NaN   
                   63                days_call_p_1            通话天数占比_1  numeric         数值型  手动衍生_py  python       NaN             NaN          NaN   
                   64                days_call_p_2            通话天数占比_2  numeric         数值型  手动衍生_py  python       NaN             NaN          NaN   
                   65                days_call_p_3            通话天数占比_3  numeric         数值型  手动衍生_py  python       NaN             NaN          NaN   
                   66                days_call_p_4            通话天数占比_4  numeric         数值型  手动衍生_py  python       NaN             NaN          NaN   
                   81            greatest_gprs_app                   app偏好     text         类别型  手动衍生_py  python       NaN             NaN          NaN   
                   82    paste_dinner_innet_months    主套餐、入网时长：交叉  numeric         类别型  手动衍生_py  python       NaN             NaN          NaN   
                   91            ago_score_flag_eg      模型示例的分数(历史)  numeric         数值型  手动衍生_py  python       NaN             NaN          NaN   
                   93           ago_score_flag_eg2     模型示例2的分数(历史)  numeric         数值型  手动衍生_py  python       NaN             NaN          NaN   
                   
                                                                 formula remark must_remain into_model is_cause  
                   14                      current_date - last_stop_date    NaN         NaN        NaN      NaN  
                   15                      last_stop_date - current_date    NaN         NaN        NaN      NaN  
                   60                             days_gprs / days_month    NaN         NaN        NaN      NaN  
                   62                             days_call / days_month    NaN         NaN        NaN      NaN  
                   63                            days_call_p + days_gprs    NaN         NaN        NaN      NaN  
                   64                          days_call_p_1 + days_gprs    NaN         NaN        NaN      NaN  
                   65                          days_call_p_2 + days_gprs    NaN         NaN        NaN      NaN  
                   66                          days_call_p_3 + days_gprs    NaN          是        NaN      NaN  
                   81  {'gprs_flow_video': 'video', 'gprs_flow_short'...    NaN          是        NaN      NaN  
                   82                             (dinner, innet_months)    NaN         NaN        NaN      NaN  
                   91                              {'notago_tovalue': 1}    NaN         NaN        NaN      NaN  
                   93                              {'notago_tovalue': 1}    NaN         NaN        NaN      NaN  


Traceback (most recent call last):
  File "D:\Python for Windows\lib\site-packages\IPython\core\interactiveshell.py", line 3213, in run_ast_nodes
    code = compiler(mod, cell_name, "exec")
  File "D:\Python for Windows\lib\codeop.py", line 133, in __call__
    codeob = compile(source, filename, symbol, self.flags, 1)
  File "<ipython-input-39-43f8aaad2deb>", line 2
SyntaxError: 'return' outside function
                   Out[40]: 20220624-16:59:19  12


Traceback (most recent call last):
  File "D:\Python for Windows\lib\site-packages\IPython\core\interactiveshell.py", line 3213, in run_ast_nodes
    code = compiler(mod, cell_name, "exec")
  File "D:\Python for Windows\lib\codeop.py", line 133, in __call__
    codeob = compile(source, filename, symbol, self.flags, 1)
  File "<ipython-input-41-43f8aaad2deb>", line 2
SyntaxError: 'return' outside function
20220624-16:59:47  手动衍生_py12个字段: {'monthsaready_last_stop_date': '最后停机时间：已发生时长', 'monthsremain_last_stop_date': '最后停机时间：剩余时长', 'days_gprs_p': '上网天数占比', 'days_call_p': '通话天数占比', 'days_call_p_1': '通话天数占比_1', 'days_call_p_2': '通话天数占比_2', 'days_call_p_3': '通话天数占比_3', 'days_call_p_4': '通话天数占比_4', 'greatest_gprs_app': 'app偏好', 'paste_dinner_innet_months': '主套餐、入网时长：交叉', 'ago_score_flag_eg': '模型示例的分数(历史)', 'ago_score_flag_eg2': '模型示例2的分数(历史)'}
20220624-16:59:47  monthsaready_last_stop_date: current_date - last_stop_date
20220624-16:59:47  monthsremain_last_stop_date: last_stop_date - current_date
20220624-16:59:47  days_gprs_p: days_gprs / days_month
20220624-16:59:47  days_call_p: days_call / days_month
20220624-16:59:47  days_call_p_1: days_call_p + days_gprs
20220624-16:59:47  days_call_p_2: days_call_p_1 + days_gprs
20220624-16:59:47  days_call_p_3: days_call_p_2 + days_gprs
20220624-16:59:47  days_call_p_4: days_call_p_3 + days_gprs
20220624-16:59:47  greatest_gprs_app: {'gprs_flow_video': 'video', 'gprs_flow_short': 'short', 'gprs_flow_music': 'music', 'gprs_flow_commu': 'commu', 'gprs_flow_game': 'game'}
20220624-16:59:49  paste_dinner_innet_months: (dinner, innet_months)


D:\工作\模型脚本\ModelProject\selfmodule\tablemodule\tablefun.py:1020: UserWarning: opera_pair_fun paste时存在非类别型字段，请确认: ['innet_months']
  warnings.warn(s); time.sleep(seconds)
20220624-16:59:52  ago_score_flag_eg: {'notago_tovalue': 1}
20220624-16:59:52  ago_score_flag_eg2: {'notago_tovalue': 1}


Traceback (most recent call last):
  File "D:\Python for Windows\lib\site-packages\IPython\core\interactiveshell.py", line 3296, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-42-a429f7d6797b>", line 1, in <module>
    data_recent, col_need_ad = manual_fun(data_recent, Info, field_manual)
  File "D:\工作\模型脚本\ModelProject\selfmodule\tablemodule\tablefun.py", line 1281, in manual_fun
    na_inf_examine(data_recent[field_manual.field_name])
  File "D:\工作\模型脚本\ModelProject\selfmodule\toolmodule\dataprep.py", line 142, in na_inf_examine
    raise Exception(s)
Exception: 数据存在缺失值或±inf，请检查！

缺失值：
ago_score_flag_eg2    4971
dtype: int64
20220624-17:00:09  手动衍生_py12个字段: {'monthsaready_last_stop_date': '最后停机时间：已发生时长', 'monthsremain_last_stop_date': '最后停机时间：剩余时长', 'days_gprs_p': '上网天数占比', 'days_call_p': '通话天数占比', 'days_call_p_1': '通话天数占比_1', 'days_call_p_2': '通话天数占比_2', 'days_call_p_3': '通话天数占比_3', 'days_call_p_4': '通话天数占比_4', 'greatest_gprs_app': 'app偏好', 'paste_dinner_innet_months': '主套餐、入网时长：交叉', 'ago_score_flag_eg': '模型示例的分数(历史)', 'ago_score_flag_eg2': '模型示例2的分数(历史)'}
                   Out[45]: 
                                        field_name                   comment dtype_db dtype_classify    field_src   table available available_notzd available_zd  \
                   14  monthsaready_last_stop_date  最后停机时间：已发生时长  numeric         数值型  手动衍生_py  python       NaN             NaN          NaN   
                   15  monthsremain_last_stop_date    最后停机时间：剩余时长  numeric         数值型  手动衍生_py  python       NaN             NaN          NaN   
                   60                  days_gprs_p              上网天数占比  numeric         数值型  手动衍生_py  python       NaN             NaN          NaN   
                   62                  days_call_p              通话天数占比  numeric         数值型  手动衍生_py  python       NaN             NaN          NaN   
                   63                days_call_p_1            通话天数占比_1  numeric         数值型  手动衍生_py  python       NaN             NaN          NaN   
                   64                days_call_p_2            通话天数占比_2  numeric         数值型  手动衍生_py  python       NaN             NaN          NaN   
                   65                days_call_p_3            通话天数占比_3  numeric         数值型  手动衍生_py  python       NaN             NaN          NaN   
                   66                days_call_p_4            通话天数占比_4  numeric         数值型  手动衍生_py  python       NaN             NaN          NaN   
                   81            greatest_gprs_app                   app偏好     text         类别型  手动衍生_py  python       NaN             NaN          NaN   
                   82    paste_dinner_innet_months    主套餐、入网时长：交叉  numeric         类别型  手动衍生_py  python       NaN             NaN          NaN   
                   91            ago_score_flag_eg      模型示例的分数(历史)  numeric         数值型  手动衍生_py  python       NaN             NaN          NaN   
                   93           ago_score_flag_eg2     模型示例2的分数(历史)  numeric         数值型  手动衍生_py  python       NaN             NaN          NaN   
                   
                                                                 formula remark must_remain into_model is_cause  
                   14                      current_date - last_stop_date    NaN         NaN        NaN      NaN  
                   15                      last_stop_date - current_date    NaN         NaN        NaN      NaN  
                   60                             days_gprs / days_month    NaN         NaN        NaN      NaN  
                   62                             days_call / days_month    NaN         NaN        NaN      NaN  
                   63                            days_call_p + days_gprs    NaN         NaN        NaN      NaN  
                   64                          days_call_p_1 + days_gprs    NaN         NaN        NaN      NaN  
                   65                          days_call_p_2 + days_gprs    NaN         NaN        NaN      NaN  
                   66                          days_call_p_3 + days_gprs    NaN          是        NaN      NaN  
                   81  {'gprs_flow_video': 'video', 'gprs_flow_short'...    NaN          是        NaN      NaN  
                   82                             (dinner, innet_months)    NaN         NaN        NaN      NaN  
                   91                              {'notago_tovalue': 1}    NaN         NaN        NaN      NaN  
                   93                              {'notago_tovalue': 1}    NaN         NaN        NaN      NaN  
                   Out[46]: 20220624-17:00:31  range(0, 12)
                   Out[47]: 20220624-17:01:16  
                                        field_name                                            formula
                   14  monthsaready_last_stop_date                      current_date - last_stop_date
                   15  monthsremain_last_stop_date                      last_stop_date - current_date
                   60                  days_gprs_p                             days_gprs / days_month
                   62                  days_call_p                             days_call / days_month
                   63                days_call_p_1                            days_call_p + days_gprs
                   64                days_call_p_2                          days_call_p_1 + days_gprs
                   65                days_call_p_3                          days_call_p_2 + days_gprs
                   66                days_call_p_4                          days_call_p_3 + days_gprs
                   81            greatest_gprs_app  {'gprs_flow_video': 'video', 'gprs_flow_short'...
                   82    paste_dinner_innet_months                             (dinner, innet_months)
                   91            ago_score_flag_eg                              {'notago_tovalue': 1}
                   93           ago_score_flag_eg2                              {'notago_tovalue': 1}
                   Out[49]: 20220624-17:01:58  
                   field_name       ago_score_flag_eg2
                   formula       {'notago_tovalue': 1}
                   Name: 93, dtype: object
20220624-17:02:05  ago_score_flag_eg2: {'notago_tovalue': 1}
                   Out[57]: 20220624-17:02:32  ['score_flag_eg2']


Traceback (most recent call last):
  File "D:\Python for Windows\lib\site-packages\IPython\core\interactiveshell.py", line 3296, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-59-cb2e8efc2acb>", line 1, in <module>
    na_inf_examine(data_recent[field_manual.field_name])
  File "D:\Python for Windows\lib\site-packages\pandas\core\frame.py", line 3464, in __getitem__
    indexer = self.loc._get_listlike_indexer(key, axis=1)[1]
  File "D:\Python for Windows\lib\site-packages\pandas\core\indexing.py", line 1314, in _get_listlike_indexer
    self._validate_read_indexer(keyarr, indexer, axis)
  File "D:\Python for Windows\lib\site-packages\pandas\core\indexing.py", line 1377, in _validate_read_indexer
    raise KeyError(f"{not_found} not in index")
KeyError: "['monthsaready_last_stop_date', 'monthsremain_last_stop_date', 'days_gprs_p', 'days_call_p', 'days_call_p_1', 'days_call_p_2', 'days_call_p_3', 'days_call_p_4', 'greatest_gprs_app', 'paste_dinner_innet_months', 'ago_score_flag_eg'] not in index"
20220624-17:03:07  monthsaready_last_stop_date: current_date - last_stop_date


Traceback (most recent call last):
  File "D:\Python for Windows\lib\site-packages\pandas\core\indexes\base.py", line 3361, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas\_libs\index.pyx", line 76, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 108, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\hashtable_class_helper.pxi", line 5198, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\_libs\hashtable_class_helper.pxi", line 5206, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'current_date'
20220624-17:03:07  
                   The above exception was the direct cause of the following exception:


Traceback (most recent call last):
  File "D:\Python for Windows\lib\site-packages\IPython\core\interactiveshell.py", line 3296, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-60-475ca1e92206>", line 28, in <module>
    data_recent[field_name_i] = np.round((data_recent[d1] - data_recent[d2]).apply(lambda x: x.days) / 30)
  File "D:\Python for Windows\lib\site-packages\pandas\core\frame.py", line 3458, in __getitem__
    indexer = self.columns.get_loc(key)
  File "D:\Python for Windows\lib\site-packages\pandas\core\indexes\base.py", line 3363, in get_loc
    raise KeyError(key) from err
KeyError: 'current_date'
20220624-17:03:18  手动衍生_py12个字段: {'monthsaready_last_stop_date': '最后停机时间：已发生时长', 'monthsremain_last_stop_date': '最后停机时间：剩余时长', 'days_gprs_p': '上网天数占比', 'days_call_p': '通话天数占比', 'days_call_p_1': '通话天数占比_1', 'days_call_p_2': '通话天数占比_2', 'days_call_p_3': '通话天数占比_3', 'days_call_p_4': '通话天数占比_4', 'greatest_gprs_app': 'app偏好', 'paste_dinner_innet_months': '主套餐、入网时长：交叉', 'ago_score_flag_eg': '模型示例的分数(历史)', 'ago_score_flag_eg2': '模型示例2的分数(历史)'}
20220624-17:03:18  monthsaready_last_stop_date: current_date - last_stop_date
20220624-17:03:18  monthsremain_last_stop_date: last_stop_date - current_date
20220624-17:03:19  days_gprs_p: days_gprs / days_month
20220624-17:03:19  days_call_p: days_call / days_month
20220624-17:03:19  days_call_p_1: days_call_p + days_gprs
20220624-17:03:19  days_call_p_2: days_call_p_1 + days_gprs
20220624-17:03:19  days_call_p_3: days_call_p_2 + days_gprs
20220624-17:03:19  days_call_p_4: days_call_p_3 + days_gprs
20220624-17:03:19  greatest_gprs_app: {'gprs_flow_video': 'video', 'gprs_flow_short': 'short', 'gprs_flow_music': 'music', 'gprs_flow_commu': 'commu', 'gprs_flow_game': 'game'}
20220624-17:03:20  paste_dinner_innet_months: (dinner, innet_months)


D:\工作\模型脚本\ModelProject\selfmodule\tablemodule\tablefun.py:1020: UserWarning: opera_pair_fun paste时存在非类别型字段，请确认: ['innet_months']
  warnings.warn(s); time.sleep(seconds)
20220624-17:03:23  ago_score_flag_eg: {'notago_tovalue': 1}
20220624-17:03:23  ago_score_flag_eg2: {'notago_tovalue': 1}


Traceback (most recent call last):
  File "D:\Python for Windows\lib\site-packages\IPython\core\interactiveshell.py", line 3296, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-62-af7e0f58fe76>", line 3, in <module>
    na_inf_examine(data_recent[field_manual.field_name])
  File "D:\工作\模型脚本\ModelProject\selfmodule\toolmodule\dataprep.py", line 142, in na_inf_examine
    raise Exception(s)
Exception: 数据存在缺失值或±inf，请检查！

缺失值：
ago_score_flag_eg2    4971
dtype: int64


Traceback (most recent call last):
  File "D:\Python for Windows\lib\site-packages\IPython\core\interactiveshell.py", line 3296, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-64-cb2e8efc2acb>", line 1, in <module>
    na_inf_examine(data_recent[field_manual.field_name])
  File "D:\工作\模型脚本\ModelProject\selfmodule\toolmodule\dataprep.py", line 142, in na_inf_examine
    raise Exception(s)
Exception: 数据存在缺失值或±inf，请检查！

缺失值：
ago_score_flag_eg2    4971
dtype: int64
                   Out[65]: 20220624-17:03:51  
                         monthsaready_last_stop_date  monthsremain_last_stop_date  days_gprs_p  days_call_p  days_call_p_1  days_call_p_2  days_call_p_3  days_call_p_4 greatest_gprs_app  \
                   0                            -1.0                          1.0     0.838710     0.290323      26.290323      52.290323      78.290323     104.290323             video   
                   1                            -3.0                          3.0     0.967742     0.741935      30.741935      60.741935      90.741935     120.741935             video   
                   2                            -3.0                          3.0     0.870968     0.387097      27.387097      54.387097      81.387097     108.387097             video   
                   3                            88.0                        -88.0     0.967742     0.935484      30.935484      60.935484      90.935484     120.935484             music   
                   4                            10.0                        -10.0     0.967742     0.096774      30.096774      60.096774      90.096774     120.096774             video   
                   ...                           ...                          ...          ...          ...            ...            ...            ...            ...               ...   
                   7966                          2.0                         -2.0     1.000000     0.161290      31.161290      62.161290      93.161290     124.161290             video   
                   7967                         90.0                        -90.0     1.000000     0.548387      31.548387      62.548387      93.548387     124.548387             video   
                   7968                         12.0                        -12.0     1.000000     0.516129      31.516129      62.516129      93.516129     124.516129             video   
                   7969                         46.0                        -46.0     1.000000     0.548387      31.548387      62.548387      93.548387     124.548387             video   
                   7970                         83.0                        -83.0     0.935484     0.870968      29.870968      58.870968      87.870968     116.870968             video   
                   
                                    paste_dinner_innet_months  ago_score_flag_eg  ago_score_flag_eg2  
                   0       神州行畅听卡4G飞享套餐升级版8档_77             59.339                 NaN  
                   1                     神州行5元卡[策划]_88             71.432                 NaN  
                   2                     全球通4G基本策划_259             22.289                 NaN  
                   3        神州行5元卡集团任我用套餐-120_127             66.879                 NaN  
                   4          神州行B4G飞享套餐升级版18档_191             20.676                 NaN  
                   ...                                    ...                ...                 ...  
                   7966             神州行畅听卡4G基本策划_54              1.000                 1.0  
                   7967                 神州行B4G基本策划_217              1.000                 1.0  
                   7968             动感地带和4G套餐38套餐_57              1.000                 1.0  
                   7969      动感地带4G飞享套餐升级版18档_183              1.000                 1.0  
                   7970  神州行畅听卡4G飞享套餐升级版18档_201              1.000                 1.0  
                   
                   [7971 rows x 12 columns]
                   Out[66]: 20220624-17:06:03  
                         monthsaready_last_stop_date  monthsremain_last_stop_date  days_gprs_p  days_call_p  days_call_p_1  days_call_p_2  days_call_p_3  days_call_p_4 greatest_gprs_app  \
                   0                            -1.0                          1.0     0.838710     0.290323      26.290323      52.290323      78.290323     104.290323             video   
                   1                            -3.0                          3.0     0.967742     0.741935      30.741935      60.741935      90.741935     120.741935             video   
                   2                            -3.0                          3.0     0.870968     0.387097      27.387097      54.387097      81.387097     108.387097             video   
                   3                            88.0                        -88.0     0.967742     0.935484      30.935484      60.935484      90.935484     120.935484             music   
                   4                            10.0                        -10.0     0.967742     0.096774      30.096774      60.096774      90.096774     120.096774             video   
                   ...                           ...                          ...          ...          ...            ...            ...            ...            ...               ...   
                   7966                          2.0                         -2.0     1.000000     0.161290      31.161290      62.161290      93.161290     124.161290             video   
                   7967                         90.0                        -90.0     1.000000     0.548387      31.548387      62.548387      93.548387     124.548387             video   
                   7968                         12.0                        -12.0     1.000000     0.516129      31.516129      62.516129      93.516129     124.516129             video   
                   7969                         46.0                        -46.0     1.000000     0.548387      31.548387      62.548387      93.548387     124.548387             video   
                   7970                         83.0                        -83.0     0.935484     0.870968      29.870968      58.870968      87.870968     116.870968             video   
                   
                                    paste_dinner_innet_months  ago_score_flag_eg  ago_score_flag_eg2  
                   0       神州行畅听卡4G飞享套餐升级版8档_77             59.339                 NaN  
                   1                     神州行5元卡[策划]_88             71.432                 NaN  
                   2                     全球通4G基本策划_259             22.289                 NaN  
                   3        神州行5元卡集团任我用套餐-120_127             66.879                 NaN  
                   4          神州行B4G飞享套餐升级版18档_191             20.676                 NaN  
                   ...                                    ...                ...                 ...  
                   7966             神州行畅听卡4G基本策划_54              1.000                 1.0  
                   7967                 神州行B4G基本策划_217              1.000                 1.0  
                   7968             动感地带和4G套餐38套餐_57              1.000                 1.0  
                   7969      动感地带4G飞享套餐升级版18档_183              1.000                 1.0  
                   7970  神州行畅听卡4G飞享套餐升级版18档_201              1.000                 1.0  
                   
                   [7971 rows x 12 columns]
                   Out[67]: 20220624-17:06:30  'score_flag_eg2'
                   Out[68]: 20220624-17:06:44  
                   {'ago_score_flag_eg2': ['score_flag_eg2'],
                    'monthsaready_last_stop_date': ['last_stop_date'],
                    'monthsremain_last_stop_date': ['last_stop_date'],
                    'days_gprs_p': ['days_gprs'],
                    'days_call_p': ['days_call'],
                    'days_call_p_1': ['days_call_p', 'days_gprs'],
                    'days_call_p_2': ['days_call_p_1', 'days_gprs'],
                    'days_call_p_3': ['days_call_p_2', 'days_gprs'],
                    'days_call_p_4': ['days_call_p_3', 'days_gprs'],
                    'greatest_gprs_app': ['gprs_flow_video',
                     'gprs_flow_short',
                     'gprs_flow_music',
                     'gprs_flow_commu',
                     'gprs_flow_game'],
                    'paste_dinner_innet_months': ['dinner', 'innet_months'],
                    'ago_score_flag_eg': ['score_flag_eg']}
                   Out[69]: 20220624-17:07:08  11
                   Out[70]: 20220624-17:07:23  'score_flag_eg2'
                   Out[71]: 20220624-17:07:31  '202010'
                   Out[72]: 20220624-17:07:44  
                   4971    1.0
                   4972    1.0
                   4973    1.0
                   4974    1.0
                   4975    1.0
                          ... 
                   7966    1.0
                   7967    1.0
                   7968    1.0
                   7969    1.0
                   7970    1.0
                   Name: ago_score_flag_eg2, Length: 3000, dtype: float64
                   Out[73]: 20220624-17:07:57  "{'notago_tovalue': 1}"
                   Out[74]: 20220624-17:08:03  1
                   Out[75]: 20220624-17:08:45  
                   0      NaN
                   1      NaN
                   2      NaN
                   3      NaN
                   4      NaN
                           ..
                   7966   NaN
                   7967   NaN
                   7968   NaN
                   7969   NaN
                   7970   NaN
                   Name: score_flag_eg2, Length: 7971, dtype: float64
                   Out[76]: 20220624-17:08:52  'score_flag_eg2'
                   Out[77]: 20220624-17:09:01  
                        user_acct_month    data_use acct_month      user_id  innet_months  age  age_add  dinner_fee  gprs_last_defer  gprs_resource  gprs_now_rest  call_use    arpu  pay_cnt  \
                   0             202010  data_train     202008  17913749331            77   31       31         8.0               10       10506250     20991957.0       3.0   18.00        0   
                   1             202010  data_train     202008  10998654690            88   50       50         5.0                0       10485770            0.0       NaN   61.28        0   
                   2             202010  data_train     202008  24060405935           259   57       57        38.0             3072        6291466     16755651.0      30.0   47.69        0   
                   3             202010  data_train     202008  82892945600           127   35       35       120.0                0       29360138     11014088.0     628.0  121.90        0   
                   4             202010  data_train     202008  24579425832           191   44       44        18.0              100       10690570     15668322.0       NaN   30.66        0   
                   ...              ...         ...        ...          ...           ...  ...      ...         ...              ...            ...            ...       ...     ...      ...   
                   7966          202010  data_train     202010  39936971433            54   20       20         9.0                0             10            0.0       0.0    9.00        0   
                   7967          202010  data_train     202010  16450943065           217   49       49         8.0                0             10            0.0       0.0    9.15        0   
                   7968          202010  data_train     202010  23777067604            57   25       25        38.0              300         614410     11098008.0       2.0   38.00        0   
                   7969          202010  data_train     202010  77210214384           183   43       43        18.0              100         204810     10690194.0       NaN   18.49        0   
                   7970          202010  data_train     202010  38527880538           201   67       67        18.0              100         204810     10690445.0       NaN   18.00        0   
                   
                         pay_fee  ...   sk_type  if_new_term  flag_eg  ago_score_flag_eg2  monthsaready_last_stop_date  monthsremain_last_stop_date  days_gprs_p  days_call_p  days_call_p_1  \
                   0         0.0  ...      None           否     None                 NaN                         -1.0                          1.0     0.838710     0.290323      26.290323   
                   1         0.0  ...  本网双卡           否     None                 NaN                         -3.0                          3.0     0.967742     0.741935      30.741935   
                   2         0.0  ...  异网双卡           否     None                 NaN                         -3.0                          3.0     0.870968     0.387097      27.387097   
                   3         0.0  ...  异网双卡           否     None                 NaN                         88.0                        -88.0     0.967742     0.935484      30.935484   
                   4         0.0  ...  其他双卡           否     None                 NaN                         10.0                        -10.0     0.967742     0.096774      30.096774   
                   ...       ...  ...       ...          ...      ...                 ...                          ...                          ...          ...          ...            ...   
                   7966      0.0  ...      None           否        0                 1.0                          2.0                         -2.0     1.000000     0.161290      31.161290   
                   7967      0.0  ...  异网双卡           否        0                 1.0                         90.0                        -90.0     1.000000     0.548387      31.548387   
                   7968      0.0  ...  异网双卡           否        0                 1.0                         12.0                        -12.0     1.000000     0.516129      31.516129   
                   7969      0.0  ...  本网双卡           否        0                 1.0                         46.0                        -46.0     1.000000     0.548387      31.548387   
                   7970      0.0  ...      None           否        0                 1.0                         83.0                        -83.0     0.935484     0.870968      29.870968   
                   
                         days_call_p_2  days_call_p_3  days_call_p_4  greatest_gprs_app             paste_dinner_innet_months  ago_score_flag_eg  
                   0         52.290323      78.290323     104.290323              video    神州行畅听卡4G飞享套餐升级版8档_77             59.339  
                   1         60.741935      90.741935     120.741935              video                  神州行5元卡[策划]_88             71.432  
                   2         54.387097      81.387097     108.387097              video                  全球通4G基本策划_259             22.289  
                   3         60.935484      90.935484     120.935484              music     神州行5元卡集团任我用套餐-120_127             66.879  
                   4         60.096774      90.096774     120.096774              video       神州行B4G飞享套餐升级版18档_191             20.676  
                   ...             ...            ...            ...                ...                                   ...                ...  
                   7966      62.161290      93.161290     124.161290              video             神州行畅听卡4G基本策划_54              1.000  
                   7967      62.548387      93.548387     124.548387              video                 神州行B4G基本策划_217              1.000  
                   7968      62.516129      93.516129     124.516129              video             动感地带和4G套餐38套餐_57              1.000  
                   7969      62.548387      93.548387     124.548387              video      动感地带4G飞享套餐升级版18档_183              1.000  
                   7970      58.870968      87.870968     116.870968              video  神州行畅听卡4G飞享套餐升级版18档_201              1.000  
                   
                   [7971 rows x 83 columns]
                   Out[78]: 20220624-17:11:06  
                   Index(['user_acct_month', 'data_use', 'acct_month', 'user_id', 'innet_months', 'age', 'age_add', 'dinner_fee', 'gprs_last_defer', 'gprs_resource', 'gprs_now_rest', 'call_use',
                          'arpu', 'pay_cnt', 'pay_fee', 'acct_balance', 'calling_cnt', 'calling_dura', 'called_cnt', 'calling_diff_cnt', 'calling_diff_dura', 'gprs_flow', 'gprs_flow_4g',
                          'gprs_flow_5g', 'gprs_flow_busy', 'gprs_flow_idle', 'gprs_now_defer', 'gprs_flow_roam', 'call_dura_roam', 'gprs_flow_gat', 'days_gat', 'days_gprs', 'days_call', 'nos_call',
                          'nos_calling', 'nos_calling_diff', 'sms_cnt', 'call_fee_local', 'call_fee_roam', 'gprs_income', 'gprs_fee', 'call_fee', 'gprs_flow_video', 'gprs_flow_short',
                          'gprs_flow_music', 'gprs_flow_commu', 'gprs_flow_game', 'score_flag_eg', 'score_flag_eg2', 'innet_date', 'last_stop_date', 'phone_no_null', 'phone_no_tm', 'dinner_id',
                          'account_id', 'sex', 'sex_add', 'user_status', 'dinner', 'if_nolimit', 'if_5g_dinner', 'if_5g_term', 'if_jt', 'start_level', 'if_cred_multi', 'term_model', 'term_brand',
                          'term_type', 'sk_type', 'if_new_term', 'flag_eg', 'ago_score_flag_eg2', 'monthsaready_last_stop_date', 'monthsremain_last_stop_date', 'days_gprs_p', 'days_call_p',
                          'days_call_p_1', 'days_call_p_2', 'days_call_p_3', 'days_call_p_4', 'greatest_gprs_app', 'paste_dinner_innet_months', 'ago_score_flag_eg'],
                         dtype='object')
                   Out[79]: 20220624-17:12:07  
                   0       NaN
                   1       NaN
                   2       NaN
                   3       NaN
                   4       NaN
                          ... 
                   7966    1.0
                   7967    1.0
                   7968    1.0
                   7969    1.0
                   7970    1.0
                   Name: ago_score_flag_eg2, Length: 7971, dtype: float64
                   Out[80]: 20220624-17:12:14  'ago_score_flag_eg2'
                   Out[81]: 20220624-17:12:34  
                   0      NaN
                   1      NaN
                   2      NaN
                   3      NaN
                   4      NaN
                           ..
                   7966   NaN
                   7967   NaN
                   7968   NaN
                   7969   NaN
                   7970   NaN
                   Name: score_flag_eg2, Length: 7971, dtype: float64
                   Out[82]: 20220624-17:12:55  
                   0       NaN
                   1       NaN
                   2       NaN
                   3       NaN
                   4       NaN
                          ... 
                   7966    1.0
                   7967    1.0
                   7968    1.0
                   7969    1.0
                   7970    1.0
                   Name: ago_score_flag_eg2, Length: 7971, dtype: float64
                   Out[83]: 20220624-17:13:18  
                        user_acct_month    data_use acct_month      user_id  innet_months  age  age_add  dinner_fee  gprs_last_defer  gprs_resource  gprs_now_rest  call_use    arpu  pay_cnt  \
                   0             202010  data_train     202008  17913749331            77   31       31         8.0               10       10506250     20991957.0       3.0   18.00        0   
                   1             202010  data_train     202008  10998654690            88   50       50         5.0                0       10485770            0.0       NaN   61.28        0   
                   2             202010  data_train     202008  24060405935           259   57       57        38.0             3072        6291466     16755651.0      30.0   47.69        0   
                   3             202010  data_train     202008  82892945600           127   35       35       120.0                0       29360138     11014088.0     628.0  121.90        0   
                   4             202010  data_train     202008  24579425832           191   44       44        18.0              100       10690570     15668322.0       NaN   30.66        0   
                   ...              ...         ...        ...          ...           ...  ...      ...         ...              ...            ...            ...       ...     ...      ...   
                   7966          202010  data_train     202010  39936971433            54   20       20         9.0                0             10            0.0       0.0    9.00        0   
                   7967          202010  data_train     202010  16450943065           217   49       49         8.0                0             10            0.0       0.0    9.15        0   
                   7968          202010  data_train     202010  23777067604            57   25       25        38.0              300         614410     11098008.0       2.0   38.00        0   
                   7969          202010  data_train     202010  77210214384           183   43       43        18.0              100         204810     10690194.0       NaN   18.49        0   
                   7970          202010  data_train     202010  38527880538           201   67       67        18.0              100         204810     10690445.0       NaN   18.00        0   
                   
                         pay_fee  ...   sk_type  if_new_term  flag_eg  ago_score_flag_eg2  monthsaready_last_stop_date  monthsremain_last_stop_date  days_gprs_p  days_call_p  days_call_p_1  \
                   0         0.0  ...      None           否     None                 NaN                         -1.0                          1.0     0.838710     0.290323      26.290323   
                   1         0.0  ...  本网双卡           否     None                 NaN                         -3.0                          3.0     0.967742     0.741935      30.741935   
                   2         0.0  ...  异网双卡           否     None                 NaN                         -3.0                          3.0     0.870968     0.387097      27.387097   
                   3         0.0  ...  异网双卡           否     None                 NaN                         88.0                        -88.0     0.967742     0.935484      30.935484   
                   4         0.0  ...  其他双卡           否     None                 NaN                         10.0                        -10.0     0.967742     0.096774      30.096774   
                   ...       ...  ...       ...          ...      ...                 ...                          ...                          ...          ...          ...            ...   
                   7966      0.0  ...      None           否        0                 1.0                          2.0                         -2.0     1.000000     0.161290      31.161290   
                   7967      0.0  ...  异网双卡           否        0                 1.0                         90.0                        -90.0     1.000000     0.548387      31.548387   
                   7968      0.0  ...  异网双卡           否        0                 1.0                         12.0                        -12.0     1.000000     0.516129      31.516129   
                   7969      0.0  ...  本网双卡           否        0                 1.0                         46.0                        -46.0     1.000000     0.548387      31.548387   
                   7970      0.0  ...      None           否        0                 1.0                         83.0                        -83.0     0.935484     0.870968      29.870968   
                   
                         days_call_p_2  days_call_p_3  days_call_p_4  greatest_gprs_app             paste_dinner_innet_months  ago_score_flag_eg  
                   0         52.290323      78.290323     104.290323              video    神州行畅听卡4G飞享套餐升级版8档_77             59.339  
                   1         60.741935      90.741935     120.741935              video                  神州行5元卡[策划]_88             71.432  
                   2         54.387097      81.387097     108.387097              video                  全球通4G基本策划_259             22.289  
                   3         60.935484      90.935484     120.935484              music     神州行5元卡集团任我用套餐-120_127             66.879  
                   4         60.096774      90.096774     120.096774              video       神州行B4G飞享套餐升级版18档_191             20.676  
                   ...             ...            ...            ...                ...                                   ...                ...  
                   7966      62.161290      93.161290     124.161290              video             神州行畅听卡4G基本策划_54              1.000  
                   7967      62.548387      93.548387     124.548387              video                 神州行B4G基本策划_217              1.000  
                   7968      62.516129      93.516129     124.516129              video             动感地带和4G套餐38套餐_57              1.000  
                   7969      62.548387      93.548387     124.548387              video      动感地带4G飞享套餐升级版18档_183              1.000  
                   7970      58.870968      87.870968     116.870968              video  神州行畅听卡4G飞享套餐升级版18档_201              1.000  
                   
                   [7971 rows x 83 columns]
                   Out[84]: 20220624-17:13:26  'score_flag_eg2'
                   Out[85]: 20220624-17:13:32  
                   0      NaN
                   1      NaN
                   2      NaN
                   3      NaN
                   4      NaN
                           ..
                   7966   NaN
                   7967   NaN
                   7968   NaN
                   7969   NaN
                   7970   NaN
                   Name: score_flag_eg2, Length: 7971, dtype: float64
                   Out[86]: 20220624-17:13:49  
                   0       NaN
                   1       NaN
                   2       NaN
                   3       NaN
                   4       NaN
                          ... 
                   7966    1.0
                   7967    1.0
                   7968    1.0
                   7969    1.0
                   7970    1.0
                   Name: ago_score_flag_eg2, Length: 7971, dtype: float64
                   Out[87]: 20220624-17:16:27  'kehujingyingbudb.mid_eg_recent_train_202010'
20220624-17:21:22  ------------------------- 读取数据: kehujingyingbudb.mid_eg_recent_train_202010 2022-06-24 17:21:22 -------------------------
20220624-17:21:22      src: gp
20220624-17:21:22      condition: data_use='data_train'
20220624-17:21:22      col_need(71): ['user_acct_month', 'data_use', 'acct_month', 'user_id', 'innet_months', 'age', 'age_add', 'dinner_fee', 'gprs_last_defer', 'gprs_resource', 'gprs_now_rest', 'call_use', 'arpu', 'pay_cnt', 'pay_fee', 'acct_balance', 'calling_cnt', 'calling_dura', 'called_cnt', 'calling_diff_cnt', 'calling_diff_dura', 'gprs_flow', 'gprs_flow_4g', 'gprs_flow_5g', 'gprs_flow_busy', 'gprs_flow_idle', 'gprs_now_defer', 'gprs_flow_roam', 'call_dura_roam', 'gprs_flow_gat', 'days_gat', 'days_gprs', 'days_call', 'nos_call', 'nos_calling', 'nos_calling_diff', 'sms_cnt', 'call_fee_local', 'call_fee_roam', 'gprs_income', 'gprs_fee', 'call_fee', 'gprs_flow_video', 'gprs_flow_short', 'gprs_flow_music', 'gprs_flow_commu', 'gprs_flow_game', 'score_flag_eg', 'score_flag_eg2', 'innet_date', 'last_stop_date', 'phone_no_null', 'phone_no_tm', 'dinner_id', 'account_id', 'sex', 'sex_add', 'user_status', 'dinner', 'if_nolimit', 'if_5g_dinner', 'if_5g_term', 'if_jt', 'start_level', 'if_cred_multi', 'term_model', 'term_brand', 'term_type', 'sk_type', 'if_new_term', 'flag_eg']
20220624-17:21:22      col_del: None
20220624-17:21:22      col_char(22): ['acct_month', 'phone_no_null', 'phone_no_tm', 'user_id', 'dinner_id', 'account_id', 'sex', 'sex_add', 'user_status', 'dinner', 'if_nolimit', 'if_5g_dinner', 'if_5g_term', 'if_jt', 'start_level', 'if_cred_multi', 'term_model', 'term_brand', 'term_type', 'sk_type', 'if_new_term', 'flag_eg']
20220624-17:21:22      col_num(45): ['innet_months', 'age', 'age_add', 'dinner_fee', 'gprs_last_defer', 'gprs_resource', 'gprs_now_rest', 'call_use', 'arpu', 'pay_cnt', 'pay_fee', 'acct_balance', 'calling_cnt', 'calling_dura', 'called_cnt', 'calling_diff_cnt', 'calling_diff_dura', 'gprs_flow', 'gprs_flow_4g', 'gprs_flow_5g', 'gprs_flow_busy', 'gprs_flow_idle', 'gprs_now_defer', 'gprs_flow_roam', 'call_dura_roam', 'gprs_flow_gat', 'days_gat', 'days_gprs', 'days_call', 'nos_call', 'nos_calling', 'nos_calling_diff', 'sms_cnt', 'call_fee_local', 'call_fee_roam', 'gprs_income', 'gprs_fee', 'call_fee', 'gprs_flow_video', 'gprs_flow_short', 'gprs_flow_music', 'gprs_flow_commu', 'gprs_flow_game', 'score_flag_eg', 'score_flag_eg2']
20220624-17:21:22      col_date(2): ['innet_date', 'last_stop_date']
20220624-17:21:22      nrows: None
20220624-17:21:22      if_coltolower: True
20220624-17:21:22      kwargs: {}

20220624-17:21:22      读取
20220624-17:21:25      shape: (7971, 71)

20220624-17:21:25  将score_flag_eg2字段类型(object): .astype(float)
20220624-17:21:25  -------------------------读取完毕: (7971, 71) 2022-06-24 17:21:25 -------------------------

                   Out[91]: 20220624-17:21:41  []
                   Out[92]: 20220624-17:21:48  
                   Empty DataFrame
                   Columns: []
                   Index: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, ...]
                   
                   [7971 rows x 0 columns]
                   Out[95]: 
                                        field_name                   comment dtype_db dtype_classify    field_src   table available available_notzd available_zd  \
                   14  monthsaready_last_stop_date  最后停机时间：已发生时长  numeric         数值型  手动衍生_py  python       NaN             NaN          NaN   
                   15  monthsremain_last_stop_date    最后停机时间：剩余时长  numeric         数值型  手动衍生_py  python       NaN             NaN          NaN   
                   60                  days_gprs_p              上网天数占比  numeric         数值型  手动衍生_py  python       NaN             NaN          NaN   
                   62                  days_call_p              通话天数占比  numeric         数值型  手动衍生_py  python       NaN             NaN          NaN   
                   63                days_call_p_1            通话天数占比_1  numeric         数值型  手动衍生_py  python       NaN             NaN          NaN   
                   64                days_call_p_2            通话天数占比_2  numeric         数值型  手动衍生_py  python       NaN             NaN          NaN   
                   65                days_call_p_3            通话天数占比_3  numeric         数值型  手动衍生_py  python       NaN             NaN          NaN   
                   66                days_call_p_4            通话天数占比_4  numeric         数值型  手动衍生_py  python       NaN             NaN          NaN   
                   81            greatest_gprs_app                   app偏好     text         类别型  手动衍生_py  python       NaN             NaN          NaN   
                   82    paste_dinner_innet_months    主套餐、入网时长：交叉  numeric         类别型  手动衍生_py  python       NaN             NaN          NaN   
                   91            ago_score_flag_eg      模型示例的分数(历史)  numeric         数值型  手动衍生_py  python       NaN             NaN          NaN   
                   93           ago_score_flag_eg2     模型示例2的分数(历史)  numeric         数值型  手动衍生_py  python       NaN             NaN          NaN   
                   
                                                                 formula remark must_remain into_model is_cause  
                   14                      current_date - last_stop_date    NaN         NaN        NaN      NaN  
                   15                      last_stop_date - current_date    NaN         NaN        NaN      NaN  
                   60                             days_gprs / days_month    NaN         NaN        NaN      NaN  
                   62                             days_call / days_month    NaN         NaN        NaN      NaN  
                   63                            days_call_p + days_gprs    NaN         NaN        NaN      NaN  
                   64                          days_call_p_1 + days_gprs    NaN         NaN        NaN      NaN  
                   65                          days_call_p_2 + days_gprs    NaN         NaN        NaN      NaN  
                   66                          days_call_p_3 + days_gprs    NaN          是        NaN      NaN  
                   81  {'gprs_flow_video': 'video', 'gprs_flow_short'...    NaN          是        NaN      NaN  
                   82                             (dinner, innet_months)    NaN         NaN        NaN      NaN  
                   91                              {'notago_tovalue': 1}    NaN         NaN        NaN      NaN  
                   93                              {'notago_tovalue': 1}    NaN         NaN        NaN      NaN  


Traceback (most recent call last):
  File "D:\Python for Windows\lib\site-packages\IPython\core\interactiveshell.py", line 3213, in run_ast_nodes
    code = compiler(mod, cell_name, "exec")
  File "D:\Python for Windows\lib\codeop.py", line 133, in __call__
    codeob = compile(source, filename, symbol, self.flags, 1)
  File "<ipython-input-96-f4fca13b18f7>", line 2
SyntaxError: 'return' outside function
20220624-17:23:57  手动衍生_py12个字段: {'monthsaready_last_stop_date': '最后停机时间：已发生时长', 'monthsremain_last_stop_date': '最后停机时间：剩余时长', 'days_gprs_p': '上网天数占比', 'days_call_p': '通话天数占比', 'days_call_p_1': '通话天数占比_1', 'days_call_p_2': '通话天数占比_2', 'days_call_p_3': '通话天数占比_3', 'days_call_p_4': '通话天数占比_4', 'greatest_gprs_app': 'app偏好', 'paste_dinner_innet_months': '主套餐、入网时长：交叉', 'ago_score_flag_eg': '模型示例的分数(历史)', 'ago_score_flag_eg2': '模型示例2的分数(历史)'}
20220624-17:23:57  monthsaready_last_stop_date: current_date - last_stop_date
20220624-17:23:57  monthsremain_last_stop_date: last_stop_date - current_date
20220624-17:23:57  days_gprs_p: days_gprs / days_month
20220624-17:23:57  days_call_p: days_call / days_month
20220624-17:23:57  days_call_p_1: days_call_p + days_gprs
20220624-17:23:57  days_call_p_2: days_call_p_1 + days_gprs
20220624-17:23:57  days_call_p_3: days_call_p_2 + days_gprs
20220624-17:23:57  days_call_p_4: days_call_p_3 + days_gprs
20220624-17:23:57  greatest_gprs_app: {'gprs_flow_video': 'video', 'gprs_flow_short': 'short', 'gprs_flow_music': 'music', 'gprs_flow_commu': 'commu', 'gprs_flow_game': 'game'}
20220624-17:24:02  paste_dinner_innet_months: (dinner, innet_months)


D:\工作\模型脚本\ModelProject\selfmodule\tablemodule\tablefun.py:1020: UserWarning: opera_pair_fun paste时存在非类别型字段，请确认: ['innet_months']
  warnings.warn(s); time.sleep(seconds)
20220624-17:24:05  ago_score_flag_eg: {'notago_tovalue': 1}
20220624-17:24:05  ago_score_flag_eg2: {'notago_tovalue': 1}


Traceback (most recent call last):
  File "D:\Python for Windows\lib\site-packages\IPython\core\interactiveshell.py", line 3296, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-99-cb2e8efc2acb>", line 1, in <module>
    na_inf_examine(data_recent[field_manual.field_name])
  File "D:\工作\模型脚本\ModelProject\selfmodule\toolmodule\dataprep.py", line 142, in na_inf_examine
    raise Exception(s)
Exception: 数据存在缺失值或±inf，请检查！

缺失值：
ago_score_flag_eg2    4971
dtype: int64
                   Out[100]: 20220624-17:25:06  
                   0       NaN
                   1       NaN
                   2       NaN
                   3       NaN
                   4       NaN
                          ... 
                   7966    1.0
                   7967    1.0
                   7968    1.0
                   7969    1.0
                   7970    1.0
                   Name: ago_score_flag_eg2, Length: 7971, dtype: float64
20220624-17:26:22  ------------------------- 读取数据: kehujingyingbudb.mid_eg_recent_train_202010 2022-06-24 17:26:22 -------------------------
20220624-17:26:22      src: gp
20220624-17:26:22      condition: data_use='data_train'
20220624-17:26:22      col_need(71): ['user_acct_month', 'data_use', 'acct_month', 'user_id', 'innet_months', 'age', 'age_add', 'dinner_fee', 'gprs_last_defer', 'gprs_resource', 'gprs_now_rest', 'call_use', 'arpu', 'pay_cnt', 'pay_fee', 'acct_balance', 'calling_cnt', 'calling_dura', 'called_cnt', 'calling_diff_cnt', 'calling_diff_dura', 'gprs_flow', 'gprs_flow_4g', 'gprs_flow_5g', 'gprs_flow_busy', 'gprs_flow_idle', 'gprs_now_defer', 'gprs_flow_roam', 'call_dura_roam', 'gprs_flow_gat', 'days_gat', 'days_gprs', 'days_call', 'nos_call', 'nos_calling', 'nos_calling_diff', 'sms_cnt', 'call_fee_local', 'call_fee_roam', 'gprs_income', 'gprs_fee', 'call_fee', 'gprs_flow_video', 'gprs_flow_short', 'gprs_flow_music', 'gprs_flow_commu', 'gprs_flow_game', 'score_flag_eg', 'score_flag_eg2', 'innet_date', 'last_stop_date', 'phone_no_null', 'phone_no_tm', 'dinner_id', 'account_id', 'sex', 'sex_add', 'user_status', 'dinner', 'if_nolimit', 'if_5g_dinner', 'if_5g_term', 'if_jt', 'start_level', 'if_cred_multi', 'term_model', 'term_brand', 'term_type', 'sk_type', 'if_new_term', 'flag_eg']
20220624-17:26:22      col_del: None
20220624-17:26:22      col_char(22): ['acct_month', 'phone_no_null', 'phone_no_tm', 'user_id', 'dinner_id', 'account_id', 'sex', 'sex_add', 'user_status', 'dinner', 'if_nolimit', 'if_5g_dinner', 'if_5g_term', 'if_jt', 'start_level', 'if_cred_multi', 'term_model', 'term_brand', 'term_type', 'sk_type', 'if_new_term', 'flag_eg']
20220624-17:26:22      col_num(45): ['innet_months', 'age', 'age_add', 'dinner_fee', 'gprs_last_defer', 'gprs_resource', 'gprs_now_rest', 'call_use', 'arpu', 'pay_cnt', 'pay_fee', 'acct_balance', 'calling_cnt', 'calling_dura', 'called_cnt', 'calling_diff_cnt', 'calling_diff_dura', 'gprs_flow', 'gprs_flow_4g', 'gprs_flow_5g', 'gprs_flow_busy', 'gprs_flow_idle', 'gprs_now_defer', 'gprs_flow_roam', 'call_dura_roam', 'gprs_flow_gat', 'days_gat', 'days_gprs', 'days_call', 'nos_call', 'nos_calling', 'nos_calling_diff', 'sms_cnt', 'call_fee_local', 'call_fee_roam', 'gprs_income', 'gprs_fee', 'call_fee', 'gprs_flow_video', 'gprs_flow_short', 'gprs_flow_music', 'gprs_flow_commu', 'gprs_flow_game', 'score_flag_eg', 'score_flag_eg2']
20220624-17:26:22      col_date(2): ['innet_date', 'last_stop_date']
20220624-17:26:22      nrows: None
20220624-17:26:22      if_coltolower: True
20220624-17:26:22      kwargs: {}

20220624-17:26:22      读取
20220624-17:26:29      shape: (7971, 71)

20220624-17:26:29  将score_flag_eg2字段类型(object): .astype(float)
20220624-17:26:29  -------------------------读取完毕: (7971, 71) 2022-06-24 17:26:29 -------------------------

20220624-17:26:47  手动衍生_py12个字段: {'monthsaready_last_stop_date': '最后停机时间：已发生时长', 'monthsremain_last_stop_date': '最后停机时间：剩余时长', 'days_gprs_p': '上网天数占比', 'days_call_p': '通话天数占比', 'days_call_p_1': '通话天数占比_1', 'days_call_p_2': '通话天数占比_2', 'days_call_p_3': '通话天数占比_3', 'days_call_p_4': '通话天数占比_4', 'greatest_gprs_app': 'app偏好', 'paste_dinner_innet_months': '主套餐、入网时长：交叉', 'ago_score_flag_eg': '模型示例的分数(历史)', 'ago_score_flag_eg2': '模型示例2的分数(历史)'}
20220624-17:26:56  ago_score_flag_eg2: {'notago_tovalue': 1}
                   Out[108]: 20220624-17:26:59  'ago_score_flag_eg2'
                   Out[109]: 20220624-17:27:02  "{'notago_tovalue': 1}"
                   Out[111]: 20220624-17:27:15  'score_flag_eg2'
                   Out[112]: 20220624-17:27:23  'acct_month'
                   Out[114]: 20220624-17:27:31  
                   0      NaN
                   1      NaN
                   2      NaN
                   3      NaN
                   4      NaN
                           ..
                   7966   NaN
                   7967   NaN
                   7968   NaN
                   7969   NaN
                   7970   NaN
                   Name: score_flag_eg2, Length: 7971, dtype: float64
                   Out[115]: 20220624-17:28:10  "{'notago_tovalue': 1}"
                   Out[116]: 20220624-17:28:26  1
                   Out[117]: 20220624-17:30:51  {}
                   Out[118]: 20220624-17:31:03  
                   0      NaN
                   1      NaN
                   2      NaN
                   3      NaN
                   4      NaN
                           ..
                   7966   NaN
                   7967   NaN
                   7968   NaN
                   7969   NaN
                   7970   NaN
                   Name: score_flag_eg2, Length: 7971, dtype: float64
                   Out[119]: 20220624-17:31:36  "{'notago_tovalue': 1}"
                   Out[120]: 20220624-17:31:43  {'notago_tovalue': 1}
                   Out[121]: 20220624-17:34:20  True
                   Out[123]: 20220624-17:34:25  '202010'
                   Out[125]: 20220624-17:35:07  
                   0      NaN
                   1      NaN
                   2      NaN
                   3      NaN
                   4      NaN
                           ..
                   7966   NaN
                   7967   NaN
                   7968   NaN
                   7969   NaN
                   7970   NaN
                   Name: ago_score_flag_eg2, Length: 7971, dtype: float64
                   Out[127]: 20220624-17:35:15  
                   0       NaN
                   1       NaN
                   2       NaN
                   3       NaN
                   4       NaN
                          ... 
                   7966    1.0
                   7967    1.0
                   7968    1.0
                   7969    1.0
                   7970    1.0
                   Name: ago_score_flag_eg2, Length: 7971, dtype: float64
