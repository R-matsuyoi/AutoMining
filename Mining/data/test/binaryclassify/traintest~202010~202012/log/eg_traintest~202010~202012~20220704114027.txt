
                   ###################################################################### 加工训练账期近n月基础数据
                    
                   ###################################################################### 测试集加工
                    
20220704-11:40:50  开始时间：2022-07-04 11:40:50
20220704-11:40:50  参数设置：
                       stage: create
                       Info.model_name: 模型示例
                       step: test
                       table_in: kehujingyingbudb.mid_eg_recent_test_202012
                       Info.r_limit: 0.95
                       Info.auto_pair2: False
                       Info.iv_limit: 0.05

20220704-11:40:53  ------------------------- 读取数据: kehujingyingbudb.mid_eg_recent_test_202012 2022-07-04 11:40:53 -------------------------
20220704-11:40:53      src: gp
20220704-11:40:53      condition: None
20220704-11:40:53      col_need(40): ['user_acct_month', 'data_use', 'acct_month', 'phone_no_null', 'user_id', 'account_id', 'innet_months', 'sex_add', 'user_status', 'last_stop_date', 'dinner_fee', 'gprs_last_defer', 'gprs_resource', 'gprs_now_rest', 'call_use', 'if_nolimit', 'if_5g_dinner', 'arpu', 'calling_cnt', 'calling_dura', 'calling_diff_cnt', 'calling_diff_dura', 'gprs_flow_4g', 'gprs_flow_5g', 'gprs_now_defer', 'gprs_flow_roam', 'call_dura_roam', 'days_gprs', 'days_call', 'nos_calling', 'nos_calling_diff', 'sms_cnt', 'call_fee_local', 'gprs_flow_video', 'gprs_flow_short', 'gprs_flow_music', 'gprs_flow_commu', 'gprs_flow_game', 'dayvalue_gprs_flow', 'flag_eg']
20220704-11:40:53      col_del: None
20220704-11:40:53      col_char(11): ['user_acct_month', 'data_use', 'acct_month', 'phone_no_null', 'user_id', 'account_id', 'sex_add', 'user_status', 'if_nolimit', 'if_5g_dinner', 'flag_eg']
20220704-11:40:53      col_num(28): ['innet_months', 'dinner_fee', 'gprs_last_defer', 'gprs_resource', 'gprs_now_rest', 'call_use', 'arpu', 'calling_cnt', 'calling_dura', 'calling_diff_cnt', 'calling_diff_dura', 'gprs_flow_4g', 'gprs_flow_5g', 'gprs_now_defer', 'gprs_flow_roam', 'call_dura_roam', 'days_gprs', 'days_call', 'nos_calling', 'nos_calling_diff', 'sms_cnt', 'call_fee_local', 'gprs_flow_video', 'gprs_flow_short', 'gprs_flow_music', 'gprs_flow_commu', 'gprs_flow_game', 'dayvalue_gprs_flow']
20220704-11:40:53      col_date(1): ['last_stop_date']
20220704-11:40:53      nrows: None
20220704-11:40:53      if_coltolower: True
20220704-11:40:53      kwargs: {}

20220704-11:40:53      读取
20220704-11:40:54      shape: (2654, 40)

20220704-11:40:54  -------------------------读取完毕: (2654, 40) 2022-07-04 11:40:54 -------------------------

20220704-11:40:54  手动衍生_py7个字段: {'monthsremain_last_stop_date': '最后停机时间：剩余时长', 'days_call_p': '通话天数占比', 'days_call_p_1': '通话天数占比_1', 'days_call_p_2': '通话天数占比_2', 'days_call_p_3': '通话天数占比_3', 'days_call_p_4': '通话天数占比_4', 'greatest_gprs_app': 'app偏好'}
20220704-11:40:54  monthsremain_last_stop_date: last_stop_date - current_date
20220704-11:40:54  days_call_p: days_call / days_month
20220704-11:40:54  days_call_p_1: days_call_p + days_gprs
20220704-11:40:54  days_call_p_2: days_call_p_1 + days_gprs
20220704-11:40:54  days_call_p_3: days_call_p_2 + days_gprs
20220704-11:40:54  days_call_p_4: days_call_p_3 + days_gprs
20220704-11:40:54  greatest_gprs_app: {'gprs_flow_video': 'video', 'gprs_flow_short': 'short', 'gprs_flow_music': 'music', 'gprs_flow_commu': 'commu', 'gprs_flow_game': 'game'}
20220704-11:40:55  数据量: (2654, 47)

20220704-11:40:55  检查数据
20220704-11:40:55  各账期数据量分布：
                       202010  data_timeout    1000
                       202011  data_timeout    654
                       202012  data_timeout    1000
                       dtype: int64
20220704-11:40:55  各账期数据量不一致
20220704-11:40:55  以nan填充缺少账期的记录
20220704-11:40:55      修改后：
                       202010  data_timeout    1000
                       202011  data_timeout    1000
                       202012  data_timeout    1000
                       dtype: int64)
20220704-11:40:55  
                   diff_limitweiNone,不考察近n月字段各账期取值分布, dis_exam返回None！


20220704-11:40:55  填充数值型&类别型字段缺失值
20220704-11:40:55  日期型字段缺失值情况：
                       last_stop_date    346
                       dtype: int64

20220704-11:40:55  正负例分布：
                       data_timeout  202012  0    846
                       data_timeout  202012  1    154
                       dtype: int64

                   ----------------------------------------- 当月 类别型 onthot 
20220704-11:40:55  ['sex_add~女', 'sex_add~男']

                   ----------------------------------------- 当月 数值型&类别型 原始数据 
20220704-11:40:55  (1000, 36)
20220704-11:40:55  筛选衍生字段的 原始/手动衍生_sql 字段

                   ----------------------------------------- 近n月 数值型 近3月均值 
20220704-11:40:55  字段个数：22, 添加字段：None
20220704-11:40:55  (1000, 58)

                   ----------------------------------------- 近n月 数值型 近3月离散系数 
20220704-11:40:55  字段个数：10, 添加字段：None
20220704-11:40:55  (1000, 68)

                   ----------------------------------------- 近n月 数值型 近3月波动性 
20220704-11:40:55  字段个数：12, 添加字段：None
20220704-11:40:55  (1000, 80)

                   ----------------------------------------- 近n月 数值型 近3月成长率 
20220704-11:40:55  字段个数：14, 添加字段：None
20220704-11:40:55  (1000, 94)

                   ----------------------------------------- 近n月 数值型 近3月最大值 
20220704-11:40:55  字段个数：17, 添加字段：None
20220704-11:40:55  (1000, 111)

                   ----------------------------------------- 近n月 数值型 近3月最小值 
20220704-11:40:55  字段个数：21, 添加字段：None
20220704-11:40:55  (1000, 132)

                   ----------------------------------------- 近n月 数值型 近3月标准差 
20220704-11:40:55  字段个数：14, 添加字段：None
20220704-11:40:55  (1000, 146)

                   ----------------------------------------- 近n月 数值型 大于x的月份数 
20220704-11:40:55  ('more0cnt', '近3月大于0的月份数')
20220704-11:40:55  ('moreq25cnt', '近3月大于第一四分位数的月份数')
20220704-11:40:55  (1000, 165)

                   ----------------------------------------- 近n月 类别型 取某值的月份数 
20220704-11:40:55  字段个数：2, 添加字段：None
20220704-11:40:55  (1000, 167)

                   ----------------------------------------- 汇总最终宽表 
20220704-11:40:55  table.shape:(1000, 167)

20220704-11:40:55  保存宽表结果至：./binaryclassify/eg/traintest~202010~202012/test_data~202012.csv

20220704-11:40:55  计算字段之间的相关性系数
20220704-11:40:55  
                       count    11476.0
                       mean    0.157
                       std    0.183
                       min    0.0
                       25%    0.039
                       50%    0.092
                       75%    0.197
                       max    1.0
                       dtype: float64


                   ------------------------------- 计算宽表字段psi ------------------------------------ 
                    
                    20220704-11:40:55  my toolmodule.dataprep.PsiTransformer_DF transform
                    20220704-11:40:55      开始时间：2022-07-04 11:40:55
                    20220704-11:40:55      data in : (1000, 167)
                    20220704-11:40:55      self已带有id_X属性 2466191260808
                    20220704-11:40:55      首次从X获取id_X_new属性 2435921360152
                    20220704-11:40:55      data in2: (1000, 157)
                    20220704-11:40:55      对154个数值字段进行分箱：['innet_months', 'monthsremain_last_stop_date', 'gprs_last_defer', 'gprs_now_rest', 'call_use', 'arpu', 'calling_cnt', 'calling_dura', 'calling_diff_dura', 'gprs_flow_4g', 'gprs_flow_5g', 'gprs_flow_roam', 'call_dura_roam', 'days_call_p_4', 'nos_calling', 'nos_calling_diff', 'gprs_flow_video', 'gprs_flow_short', 'gprs_flow_music', 'gprs_flow_commu', 'gprs_flow_game', 'sex_add~女', 'sex_add~男', 'avg__gprs_flow_roam', 'avg__monthsremain_last_stop_date', 'avg__gprs_last_defer', 'avg__gprs_resource', 'avg__calling_diff_dura', 'avg__gprs_flow_video', 'avg__gprs_flow_5g', 'avg__nos_calling', 'avg__nos_calling_diff', 'avg__arpu', 'avg__calling_cnt', 'avg__gprs_flow_commu', 'avg__gprs_now_defer', 'avg__call_use', 'avg__gprs_flow_4g', 'avg__gprs_now_rest', 'avg__gprs_flow_music', 'avg__calling_diff_cnt', 'avg__gprs_flow_game', 'avg__call_dura_roam', 'avg__gprs_flow_short', 'avg__calling_dura', 'sep__gprs_resource', 'sep__calling_diff_dura', 'sep__gprs_flow_5g', 'sep__nos_calling', 'sep__nos_calling_diff', 'sep__gprs_flow_commu', 'sep__gprs_now_rest', 'sep__calling_diff_cnt', 'sep__gprs_flow_short', 'sep__calling_dura', 'wave__monthsremain_last_stop_date', 'wave__gprs_last_defer', 'wave__gprs_flow_video', 'wave__calling_cnt', 'wave__gprs_flow_commu', 'wave__gprs_now_defer', 'wave__call_use', 'wave__gprs_now_rest', 'wave__gprs_flow_music', 'wave__calling_diff_cnt', 'wave__gprs_flow_short', 'wave__calling_dura', 'grow__gprs_flow_roam', 'grow__gprs_last_defer', 'grow__gprs_resource', 'grow__calling_diff_dura', 'grow__gprs_flow_video', 'grow__dinner_fee', 'grow__gprs_flow_5g', 'grow__nos_calling', 'grow__nos_calling_diff', 'grow__calling_cnt', 'grow__call_use', 'grow__gprs_now_rest', 'grow__gprs_flow_music', 'grow__calling_diff_cnt', 'max__gprs_flow_roam', 'max__monthsremain_last_stop_date', 'max__gprs_last_defer', 'max__gprs_resource', 'max__calling_diff_dura', 'max__dinner_fee', 'max__nos_calling', 'max__nos_calling_diff', 'max__arpu', 'max__calling_cnt', 'max__gprs_flow_commu', 'max__call_use', 'max__gprs_now_rest', 'max__gprs_flow_music', 'max__calling_diff_cnt', 'max__call_dura_roam', 'max__calling_dura', 'min__gprs_flow_roam', 'min__gprs_last_defer', 'min__gprs_resource', 'min__calling_diff_dura', 'min__gprs_flow_video', 'min__gprs_flow_5g', 'min__nos_calling', 'min__nos_calling_diff', 'min__arpu', 'min__calling_cnt', 'min__gprs_flow_commu', 'min__gprs_now_defer', 'min__call_use', 'min__gprs_flow_4g', 'min__gprs_now_rest', 'min__gprs_flow_music', 'min__calling_diff_cnt', 'min__gprs_flow_game', 'min__call_dura_roam', 'min__gprs_flow_short', 'min__calling_dura', 'std__gprs_last_defer', 'std__gprs_resource', 'std__calling_diff_dura', 'std__gprs_flow_video', 'std__nos_calling', 'std__nos_calling_diff', 'std__calling_cnt', 'std__gprs_flow_commu', 'std__call_use', 'std__gprs_flow_4g', 'std__gprs_now_rest', 'std__calling_diff_cnt', 'std__call_dura_roam', 'std__calling_dura', 'more0cnt__monthsremain_last_stop_date', 'more0cnt__nos_calling', 'more0cnt__calling_dura', 'moreq25cnt__gprs_last_defer', 'moreq25cnt__gprs_resource', 'moreq25cnt__gprs_flow_video', 'moreq25cnt__gprs_flow_5g', 'moreq25cnt__nos_calling', 'moreq25cnt__nos_calling_diff', 'moreq25cnt__arpu', 'moreq25cnt__calling_cnt', 'moreq25cnt__gprs_flow_commu', 'moreq25cnt__call_use', 'moreq25cnt__gprs_flow_4g', 'moreq25cnt__gprs_flow_music', 'moreq25cnt__calling_diff_cnt', 'moreq25cnt__gprs_flow_game', 'moreq25cnt__gprs_flow_short', 'moreq25cnt__calling_dura', 'valuecnt__if_nolimit~是', 'valuecnt__if_5g_dinner~是']
                    20220704-11:40:56      timedata_timeout 计算稳定度（不区分正负例）：self.col_psi_all_
                    20220704-11:41:04      data_timeout 计算稳定度（区分正负例）：self.col_psi_PN_
                    20220704-11:41:17      data out: (1000, 157)
                    20220704-11:41:17      transform轨迹：PsiTransformer_DF(Ncase='0', Pcase='1', bins=None, col_ignore=None, fit_pop_all=False, precision=6, , psi_limit=0.1, trans_na_error=True, warn_mark=' PsiTransformer')
                    20220704-11:41:17      结束时间：2022-07-04 11:41:17 耗时(21s)
20220704-11:41:17  保存Psi至：./binaryclassify/eg/traintest~202010~202012/test_Psi~202010~202012.pkl
20220704-11:41:17  保存dis_exam至：./binaryclassify/eg/traintest~202010~202012/test_dis_exam~202012.pkl
20220704-11:41:17  结束时间：2022-07-04 11:41:17
20220704-11:41:17  耗时：26 s


D:\Python for Windows\lib\site-packages\pandas\core\apply.py:1101: UserWarning: stage取值为create时,r_limit, iv_limit参数无效，将被忽略
  convert=self.convert_dtype,


D:\Python for Windows\lib\site-packages\pandas\core\apply.py:1101: UserWarning:      PsiTransformer timedata_timeout 计算稳定性(不区分正负例) ['account_id']字段多出720个取值, .head(5):
                      old  new
field      value              
account_id 102196712  NaN  1.0
           102197121  NaN  1.0
           102223930  NaN  1.0
           102300686  NaN  1.0
           103604981  NaN  1.0
  convert=self.convert_dtype,


D:\Python for Windows\lib\site-packages\pandas\core\apply.py:1101: UserWarning:      PsiTransformer timedata_timeout 计算稳定性(不区分正负例)，40个字段稳定性>=psi_limit（0.1）：
max__monthsremain_last_stop_date         1.153147
avg__monthsremain_last_stop_date         0.708150
grow__gprs_resource                      0.504271
more0cnt__monthsremain_last_stop_date    0.489939
grow__calling_cnt                        0.474356
wave__gprs_flow_video                    0.459372
min__gprs_now_rest                       0.439512
sep__gprs_resource                       0.436254
sep__gprs_now_rest                       0.362695
wave__monthsremain_last_stop_date        0.351832
moreq25cnt__arpu                         0.349840
wave__gprs_now_rest                      0.322201
grow__gprs_now_rest                      0.305131
min__gprs_now_defer                      0.250272
moreq25cnt__gprs_flow_4g                 0.229578
moreq25cnt__calling_dura                 0.229498
sep__gprs_flow_commu                     0.216219
wave__gprs_now_defer                     0.210678
wave__gprs_flow_music                    0.209202
wave__calling_dura                       0.202171
more0cnt__nos_calling                    0.197366
wave__calling_cnt                        0.192988
min__arpu                                0.191410
grow__gprs_last_defer                    0.189959
wave__gprs_flow_commu                    0.186252
sep__nos_calling_diff                    0.180037
min__calling_dura                        0.178387
wave__gprs_flow_short                    0.176631
moreq25cnt__calling_diff_cnt             0.176247
moreq25cnt__calling_cnt                  0.175646
sep__gprs_flow_short                     0.167248
grow__nos_calling_diff                   0.156279
min__calling_cnt                         0.155631
moreq25cnt__call_use                     0.144666
min__gprs_last_defer                     0.144252
moreq25cnt__gprs_last_defer              0.137042
moreq25cnt__gprs_flow_music              0.133987
moreq25cnt__nos_calling                  0.127532
min__calling_diff_dura                   0.114422
min__calling_diff_cnt                    0.110715
dtype: float64
  convert=self.convert_dtype,


D:\Python for Windows\lib\site-packages\pandas\core\apply.py:1101: UserWarning:      PsiTransformer data_timeout 计算稳定性(区分正负例)-正例（1） ['account_id']字段多出547个取值, .head(5):
                      old  new
field      value              
account_id 102197121  NaN  1.0
           102223930  NaN  1.0
           102300686  NaN  1.0
           103676343  NaN  1.0
           103720758  NaN  1.0
  convert=self.convert_dtype,


D:\Python for Windows\lib\site-packages\pandas\core\apply.py:1101: UserWarning:      PsiTransformer data_timeout 计算稳定性(区分正负例)-负例（0） ['account_id']字段多出547个取值, .head(5):
                      old  new
field      value              
account_id 102197121  NaN  1.0
           102223930  NaN  1.0
           102300686  NaN  1.0
           103676343  NaN  1.0
           103720758  NaN  1.0
  convert=self.convert_dtype,


D:\Python for Windows\lib\site-packages\pandas\core\apply.py:1101: UserWarning:      PsiTransformer data_timeout 计算稳定性(区分正负例) ，52个字段稳定性>=psi_limit（0.1）：
max__monthsremain_last_stop_date         1.001304
grow__calling_cnt                        0.792366
avg__monthsremain_last_stop_date         0.770429
sep__gprs_resource                       0.522291
grow__gprs_resource                      0.517305
min__gprs_now_rest                       0.472076
wave__gprs_flow_video                    0.463506
moreq25cnt__gprs_flow_4g                 0.433917
sep__gprs_flow_commu                     0.428960
more0cnt__monthsremain_last_stop_date    0.427802
wave__monthsremain_last_stop_date        0.419017
moreq25cnt__calling_dura                 0.403642
moreq25cnt__arpu                         0.401877
moreq25cnt__calling_cnt                  0.393855
min__calling_dura                        0.381505
min__calling_cnt                         0.374147
sep__gprs_now_rest                       0.368272
wave__gprs_flow_music                    0.352088
wave__gprs_now_rest                      0.339916
moreq25cnt__calling_diff_cnt             0.336224
more0cnt__nos_calling                    0.331887
min__calling_diff_cnt                    0.322031
sep__nos_calling_diff                    0.321767
moreq25cnt__nos_calling                  0.317305
wave__gprs_flow_commu                    0.316552
grow__gprs_now_rest                      0.305491
min__arpu                                0.268376
grow__gprs_last_defer                    0.267970
min__nos_calling                         0.267509
min__gprs_now_defer                      0.262001
min__gprs_resource                       0.258861
moreq25cnt__nos_calling_diff             0.251359
wave__gprs_now_defer                     0.232770
wave__calling_dura                       0.230065
grow__nos_calling_diff                   0.226753
wave__gprs_flow_short                    0.221312
min__calling_diff_dura                   0.215420
sep__gprs_flow_short                     0.213431
min__nos_calling_diff                    0.209368
wave__calling_cnt                        0.207441
moreq25cnt__gprs_flow_music              0.201679
moreq25cnt__call_use                     0.198730
wave__call_use                           0.179388
min__gprs_flow_4g                        0.177949
min__call_use                            0.164605
min__gprs_last_defer                     0.151450
moreq25cnt__gprs_last_defer              0.148284
account_id                               0.147555
wave__calling_diff_cnt                   0.144374
max__nos_calling_diff                    0.110085
std__nos_calling_diff                    0.107205
wave__gprs_last_defer                    0.100002
dtype: float64
  convert=self.convert_dtype,

                   ###################################################################### 创建数据处理流水线、算法序列
                    
20220704-11:41:17  创建数据转换流水线1


D:\工作\模型脚本\ModelProject\selfmodule\toolmodule\dataprep.py:9: UserWarning: Pipeline_DF：verbose参数值被赋予print_indent后默认参数设置为None
  import time


D:\工作\模型脚本\ModelProject\selfmodule\toolmodule\dataprep.py:9: UserWarning: FeatureUnion_DF：verbose参数值被赋予print_indent后默认参数设置为None
  import time
20220704-11:41:17  创建数据转换流水线2
20220704-11:41:17  创建数据转换流水线3
20220704-11:41:17  创建算法序列

                   ###################################################################### 训练测试过程
                    
20220704-11:43:11  开始时间：2022-07-04 11:43:11
20220704-11:43:15  模型名称：模型示例
20220704-11:43:15  参数设置：
                       Info.model_name: 模型示例
                       Info.trainproc_ratiolist: [1, 2, 10]
                       field_comment: (167, 16)
                       Info.freq_limit: 0.95
                       Info.unique_limit: 5000
                       Info.iv_limit: 0.05
                       Info.r_limit: 0.95
                       Info.random_state: None
20220704-11:43:15  mark: ~202010~202012
20220704-11:43:15  目标字段：flag_eg; 正负例取值：1、0
20220704-11:43:24  field_comment.shape: (167, 16)
20220704-11:43:24      len(col_need): 167
20220704-11:43:24      删除field_comment中into_model取值为‘删除’的3个字段：['phone_no_null', 'last_stop_date', 'flag_eg']
20220704-11:43:24      len(col_need): 167
20220704-11:43:24      删除Info.col_del中的1个字段：{'user_acct_month'}
20220704-11:43:24      len(col_need): 166

20220704-11:43:28      删除Info.supply_other、col_mark中的5个字段：{'phone_no_null', 'call_fee_local', 'sms_cnt', 'dayvalue_gprs_flow', 'last_stop_date'}
20220704-11:43:28      len(col_need): 161



Traceback (most recent call last):
  File "D:\Python for Windows\lib\site-packages\IPython\core\interactiveshell.py", line 3296, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-17-5986d6160d29>", line 1, in <module>
    condition = Info.condition if if_condition else None
NameError: name 'if_condition' is not defined


Traceback (most recent call last):
  File "D:\Python for Windows\lib\site-packages\IPython\core\interactiveshell.py", line 3296, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-19-6ee2e55aeb53>", line 1, in <module>
    condition = Info.condition if if_condition else None
NameError: name 'if_condition' is not defined
20220704-11:44:23  ------------------------- 读取数据: ./binaryclassify/eg/traintest~202010~202012/train_data~202010.csv 2022-07-04 11:44:23 -------------------------
20220704-11:44:23      src: file
20220704-11:44:23      condition: None
20220704-11:44:23      col_need(161): ['data_use', 'acct_month', 'user_id', 'account_id', 'innet_months', 'user_status', 'monthsremain_last_stop_date', 'gprs_last_defer', 'gprs_now_rest', 'call_use', 'arpu', 'calling_cnt', 'calling_dura', 'calling_diff_dura', 'gprs_flow_4g', 'gprs_flow_5g', 'gprs_flow_roam', 'call_dura_roam', 'days_call_p_4', 'nos_calling', 'nos_calling_diff', 'gprs_flow_video', 'gprs_flow_short', 'gprs_flow_music', 'gprs_flow_commu', 'gprs_flow_game', 'greatest_gprs_app', 'sex_add~女', 'sex_add~男', 'avg__gprs_flow_roam', 'avg__monthsremain_last_stop_date', 'avg__gprs_last_defer', 'avg__gprs_resource', 'avg__calling_diff_dura', 'avg__gprs_flow_video', 'avg__gprs_flow_5g', 'avg__nos_calling', 'avg__nos_calling_diff', 'avg__arpu', 'avg__calling_cnt', 'avg__gprs_flow_commu', 'avg__gprs_now_defer', 'avg__call_use', 'avg__gprs_flow_4g', 'avg__gprs_now_rest', 'avg__gprs_flow_music', 'avg__calling_diff_cnt', 'avg__gprs_flow_game', 'avg__call_dura_roam', 'avg__gprs_flow_short', 'avg__calling_dura', 'sep__gprs_resource', 'sep__calling_diff_dura', 'sep__gprs_flow_5g', 'sep__nos_calling', 'sep__nos_calling_diff', 'sep__gprs_flow_commu', 'sep__gprs_now_rest', 'sep__calling_diff_cnt', 'sep__gprs_flow_short', 'sep__calling_dura', 'wave__monthsremain_last_stop_date', 'wave__gprs_last_defer', 'wave__gprs_flow_video', 'wave__calling_cnt', 'wave__gprs_flow_commu', 'wave__gprs_now_defer', 'wave__call_use', 'wave__gprs_now_rest', 'wave__gprs_flow_music', 'wave__calling_diff_cnt', 'wave__gprs_flow_short', 'wave__calling_dura', 'grow__gprs_flow_roam', 'grow__gprs_last_defer', 'grow__gprs_resource', 'grow__calling_diff_dura', 'grow__gprs_flow_video', 'grow__dinner_fee', 'grow__gprs_flow_5g', 'grow__nos_calling', 'grow__nos_calling_diff', 'grow__calling_cnt', 'grow__call_use', 'grow__gprs_now_rest', 'grow__gprs_flow_music', 'grow__calling_diff_cnt', 'max__gprs_flow_roam', 'max__monthsremain_last_stop_date', 'max__gprs_last_defer', 'max__gprs_resource', 'max__calling_diff_dura', 'max__dinner_fee', 'max__nos_calling', 'max__nos_calling_diff', 'max__arpu', 'max__calling_cnt', 'max__gprs_flow_commu', 'max__call_use', 'max__gprs_now_rest', 'max__gprs_flow_music', 'max__calling_diff_cnt', 'max__call_dura_roam', 'max__calling_dura', 'min__gprs_flow_roam', 'min__gprs_last_defer', 'min__gprs_resource', 'min__calling_diff_dura', 'min__gprs_flow_video', 'min__gprs_flow_5g', 'min__nos_calling', 'min__nos_calling_diff', 'min__arpu', 'min__calling_cnt', 'min__gprs_flow_commu', 'min__gprs_now_defer', 'min__call_use', 'min__gprs_flow_4g', 'min__gprs_now_rest', 'min__gprs_flow_music', 'min__calling_diff_cnt', 'min__gprs_flow_game', 'min__call_dura_roam', 'min__gprs_flow_short', 'min__calling_dura', 'std__gprs_last_defer', 'std__gprs_resource', 'std__calling_diff_dura', 'std__gprs_flow_video', 'std__nos_calling', 'std__nos_calling_diff', 'std__calling_cnt', 'std__gprs_flow_commu', 'std__call_use', 'std__gprs_flow_4g', 'std__gprs_now_rest', 'std__calling_diff_cnt', 'std__call_dura_roam', 'std__calling_dura', 'more0cnt__monthsremain_last_stop_date', 'more0cnt__nos_calling', 'more0cnt__calling_dura', 'moreq25cnt__gprs_last_defer', 'moreq25cnt__gprs_resource', 'moreq25cnt__gprs_flow_video', 'moreq25cnt__gprs_flow_5g', 'moreq25cnt__nos_calling', 'moreq25cnt__nos_calling_diff', 'moreq25cnt__arpu', 'moreq25cnt__calling_cnt', 'moreq25cnt__gprs_flow_commu', 'moreq25cnt__call_use', 'moreq25cnt__gprs_flow_4g', 'moreq25cnt__gprs_flow_music', 'moreq25cnt__calling_diff_cnt', 'moreq25cnt__gprs_flow_game', 'moreq25cnt__gprs_flow_short', 'moreq25cnt__calling_dura', 'valuecnt__if_nolimit~是', 'valuecnt__if_5g_dinner~是', 'flag_eg']
20220704-11:44:23      col_del: None
20220704-11:44:23      col_char(9): ['user_acct_month', 'data_use', 'acct_month', 'phone_no_null', 'user_id', 'account_id', 'user_status', 'greatest_gprs_app', 'flag_eg']
20220704-11:44:23      col_num(157): ['innet_months', 'monthsremain_last_stop_date', 'gprs_last_defer', 'gprs_now_rest', 'call_use', 'arpu', 'calling_cnt', 'calling_dura', 'calling_diff_dura', 'gprs_flow_4g', 'gprs_flow_5g', 'gprs_flow_roam', 'call_dura_roam', 'days_call_p_4', 'nos_calling', 'nos_calling_diff', 'sms_cnt', 'call_fee_local', 'gprs_flow_video', 'gprs_flow_short', 'gprs_flow_music', 'gprs_flow_commu', 'gprs_flow_game', 'dayvalue_gprs_flow', 'sex_add~女', 'sex_add~男', 'avg__gprs_flow_roam', 'avg__monthsremain_last_stop_date', 'avg__gprs_last_defer', 'avg__gprs_resource', 'avg__calling_diff_dura', 'avg__gprs_flow_video', 'avg__gprs_flow_5g', 'avg__nos_calling', 'avg__nos_calling_diff', 'avg__arpu', 'avg__calling_cnt', 'avg__gprs_flow_commu', 'avg__gprs_now_defer', 'avg__call_use', 'avg__gprs_flow_4g', 'avg__gprs_now_rest', 'avg__gprs_flow_music', 'avg__calling_diff_cnt', 'avg__gprs_flow_game', 'avg__call_dura_roam', 'avg__gprs_flow_short', 'avg__calling_dura', 'sep__gprs_resource', 'sep__calling_diff_dura', 'sep__gprs_flow_5g', 'sep__nos_calling', 'sep__nos_calling_diff', 'sep__gprs_flow_commu', 'sep__gprs_now_rest', 'sep__calling_diff_cnt', 'sep__gprs_flow_short', 'sep__calling_dura', 'wave__monthsremain_last_stop_date', 'wave__gprs_last_defer', 'wave__gprs_flow_video', 'wave__calling_cnt', 'wave__gprs_flow_commu', 'wave__gprs_now_defer', 'wave__call_use', 'wave__gprs_now_rest', 'wave__gprs_flow_music', 'wave__calling_diff_cnt', 'wave__gprs_flow_short', 'wave__calling_dura', 'grow__gprs_flow_roam', 'grow__gprs_last_defer', 'grow__gprs_resource', 'grow__calling_diff_dura', 'grow__gprs_flow_video', 'grow__dinner_fee', 'grow__gprs_flow_5g', 'grow__nos_calling', 'grow__nos_calling_diff', 'grow__calling_cnt', 'grow__call_use', 'grow__gprs_now_rest', 'grow__gprs_flow_music', 'grow__calling_diff_cnt', 'max__gprs_flow_roam', 'max__monthsremain_last_stop_date', 'max__gprs_last_defer', 'max__gprs_resource', 'max__calling_diff_dura', 'max__dinner_fee', 'max__nos_calling', 'max__nos_calling_diff', 'max__arpu', 'max__calling_cnt', 'max__gprs_flow_commu', 'max__call_use', 'max__gprs_now_rest', 'max__gprs_flow_music', 'max__calling_diff_cnt', 'max__call_dura_roam', 'max__calling_dura', 'min__gprs_flow_roam', 'min__gprs_last_defer', 'min__gprs_resource', 'min__calling_diff_dura', 'min__gprs_flow_video', 'min__gprs_flow_5g', 'min__nos_calling', 'min__nos_calling_diff', 'min__arpu', 'min__calling_cnt', 'min__gprs_flow_commu', 'min__gprs_now_defer', 'min__call_use', 'min__gprs_flow_4g', 'min__gprs_now_rest', 'min__gprs_flow_music', 'min__calling_diff_cnt', 'min__gprs_flow_game', 'min__call_dura_roam', 'min__gprs_flow_short', 'min__calling_dura', 'std__gprs_last_defer', 'std__gprs_resource', 'std__calling_diff_dura', 'std__gprs_flow_video', 'std__nos_calling', 'std__nos_calling_diff', 'std__calling_cnt', 'std__gprs_flow_commu', 'std__call_use', 'std__gprs_flow_4g', 'std__gprs_now_rest', 'std__calling_diff_cnt', 'std__call_dura_roam', 'std__calling_dura', 'more0cnt__monthsremain_last_stop_date', 'more0cnt__nos_calling', 'more0cnt__calling_dura', 'moreq25cnt__gprs_last_defer', 'moreq25cnt__gprs_resource', 'moreq25cnt__gprs_flow_video', 'moreq25cnt__gprs_flow_5g', 'moreq25cnt__nos_calling', 'moreq25cnt__nos_calling_diff', 'moreq25cnt__arpu', 'moreq25cnt__calling_cnt', 'moreq25cnt__gprs_flow_commu', 'moreq25cnt__call_use', 'moreq25cnt__gprs_flow_4g', 'moreq25cnt__gprs_flow_music', 'moreq25cnt__calling_diff_cnt', 'moreq25cnt__gprs_flow_game', 'moreq25cnt__gprs_flow_short', 'moreq25cnt__calling_dura', 'valuecnt__if_nolimit~是', 'valuecnt__if_5g_dinner~是']
20220704-11:44:23      col_date: None
20220704-11:44:23      nrows: None
20220704-11:44:23      if_coltolower: False
20220704-11:44:23      kwargs: {}

20220704-11:44:23      读取
20220704-11:44:23  -------------------------读取完毕: (3500, 161) 2022-07-04 11:44:23 -------------------------

20220704-11:44:29  ------------------------- 读取数据: ./binaryclassify/eg/traintest~202010~202012/test_data~202012.csv 2022-07-04 11:44:29 -------------------------
20220704-11:44:29      src: file
20220704-11:44:29      condition: None
20220704-11:44:29      col_need(161): ['data_use', 'acct_month', 'user_id', 'account_id', 'innet_months', 'user_status', 'monthsremain_last_stop_date', 'gprs_last_defer', 'gprs_now_rest', 'call_use', 'arpu', 'calling_cnt', 'calling_dura', 'calling_diff_dura', 'gprs_flow_4g', 'gprs_flow_5g', 'gprs_flow_roam', 'call_dura_roam', 'days_call_p_4', 'nos_calling', 'nos_calling_diff', 'gprs_flow_video', 'gprs_flow_short', 'gprs_flow_music', 'gprs_flow_commu', 'gprs_flow_game', 'greatest_gprs_app', 'sex_add~女', 'sex_add~男', 'avg__gprs_flow_roam', 'avg__monthsremain_last_stop_date', 'avg__gprs_last_defer', 'avg__gprs_resource', 'avg__calling_diff_dura', 'avg__gprs_flow_video', 'avg__gprs_flow_5g', 'avg__nos_calling', 'avg__nos_calling_diff', 'avg__arpu', 'avg__calling_cnt', 'avg__gprs_flow_commu', 'avg__gprs_now_defer', 'avg__call_use', 'avg__gprs_flow_4g', 'avg__gprs_now_rest', 'avg__gprs_flow_music', 'avg__calling_diff_cnt', 'avg__gprs_flow_game', 'avg__call_dura_roam', 'avg__gprs_flow_short', 'avg__calling_dura', 'sep__gprs_resource', 'sep__calling_diff_dura', 'sep__gprs_flow_5g', 'sep__nos_calling', 'sep__nos_calling_diff', 'sep__gprs_flow_commu', 'sep__gprs_now_rest', 'sep__calling_diff_cnt', 'sep__gprs_flow_short', 'sep__calling_dura', 'wave__monthsremain_last_stop_date', 'wave__gprs_last_defer', 'wave__gprs_flow_video', 'wave__calling_cnt', 'wave__gprs_flow_commu', 'wave__gprs_now_defer', 'wave__call_use', 'wave__gprs_now_rest', 'wave__gprs_flow_music', 'wave__calling_diff_cnt', 'wave__gprs_flow_short', 'wave__calling_dura', 'grow__gprs_flow_roam', 'grow__gprs_last_defer', 'grow__gprs_resource', 'grow__calling_diff_dura', 'grow__gprs_flow_video', 'grow__dinner_fee', 'grow__gprs_flow_5g', 'grow__nos_calling', 'grow__nos_calling_diff', 'grow__calling_cnt', 'grow__call_use', 'grow__gprs_now_rest', 'grow__gprs_flow_music', 'grow__calling_diff_cnt', 'max__gprs_flow_roam', 'max__monthsremain_last_stop_date', 'max__gprs_last_defer', 'max__gprs_resource', 'max__calling_diff_dura', 'max__dinner_fee', 'max__nos_calling', 'max__nos_calling_diff', 'max__arpu', 'max__calling_cnt', 'max__gprs_flow_commu', 'max__call_use', 'max__gprs_now_rest', 'max__gprs_flow_music', 'max__calling_diff_cnt', 'max__call_dura_roam', 'max__calling_dura', 'min__gprs_flow_roam', 'min__gprs_last_defer', 'min__gprs_resource', 'min__calling_diff_dura', 'min__gprs_flow_video', 'min__gprs_flow_5g', 'min__nos_calling', 'min__nos_calling_diff', 'min__arpu', 'min__calling_cnt', 'min__gprs_flow_commu', 'min__gprs_now_defer', 'min__call_use', 'min__gprs_flow_4g', 'min__gprs_now_rest', 'min__gprs_flow_music', 'min__calling_diff_cnt', 'min__gprs_flow_game', 'min__call_dura_roam', 'min__gprs_flow_short', 'min__calling_dura', 'std__gprs_last_defer', 'std__gprs_resource', 'std__calling_diff_dura', 'std__gprs_flow_video', 'std__nos_calling', 'std__nos_calling_diff', 'std__calling_cnt', 'std__gprs_flow_commu', 'std__call_use', 'std__gprs_flow_4g', 'std__gprs_now_rest', 'std__calling_diff_cnt', 'std__call_dura_roam', 'std__calling_dura', 'more0cnt__monthsremain_last_stop_date', 'more0cnt__nos_calling', 'more0cnt__calling_dura', 'moreq25cnt__gprs_last_defer', 'moreq25cnt__gprs_resource', 'moreq25cnt__gprs_flow_video', 'moreq25cnt__gprs_flow_5g', 'moreq25cnt__nos_calling', 'moreq25cnt__nos_calling_diff', 'moreq25cnt__arpu', 'moreq25cnt__calling_cnt', 'moreq25cnt__gprs_flow_commu', 'moreq25cnt__call_use', 'moreq25cnt__gprs_flow_4g', 'moreq25cnt__gprs_flow_music', 'moreq25cnt__calling_diff_cnt', 'moreq25cnt__gprs_flow_game', 'moreq25cnt__gprs_flow_short', 'moreq25cnt__calling_dura', 'valuecnt__if_nolimit~是', 'valuecnt__if_5g_dinner~是', 'flag_eg']
20220704-11:44:29      col_del: None
20220704-11:44:29      col_char(9): ['user_acct_month', 'data_use', 'acct_month', 'phone_no_null', 'user_id', 'account_id', 'user_status', 'greatest_gprs_app', 'flag_eg']
20220704-11:44:29      col_num(157): ['innet_months', 'monthsremain_last_stop_date', 'gprs_last_defer', 'gprs_now_rest', 'call_use', 'arpu', 'calling_cnt', 'calling_dura', 'calling_diff_dura', 'gprs_flow_4g', 'gprs_flow_5g', 'gprs_flow_roam', 'call_dura_roam', 'days_call_p_4', 'nos_calling', 'nos_calling_diff', 'sms_cnt', 'call_fee_local', 'gprs_flow_video', 'gprs_flow_short', 'gprs_flow_music', 'gprs_flow_commu', 'gprs_flow_game', 'dayvalue_gprs_flow', 'sex_add~女', 'sex_add~男', 'avg__gprs_flow_roam', 'avg__monthsremain_last_stop_date', 'avg__gprs_last_defer', 'avg__gprs_resource', 'avg__calling_diff_dura', 'avg__gprs_flow_video', 'avg__gprs_flow_5g', 'avg__nos_calling', 'avg__nos_calling_diff', 'avg__arpu', 'avg__calling_cnt', 'avg__gprs_flow_commu', 'avg__gprs_now_defer', 'avg__call_use', 'avg__gprs_flow_4g', 'avg__gprs_now_rest', 'avg__gprs_flow_music', 'avg__calling_diff_cnt', 'avg__gprs_flow_game', 'avg__call_dura_roam', 'avg__gprs_flow_short', 'avg__calling_dura', 'sep__gprs_resource', 'sep__calling_diff_dura', 'sep__gprs_flow_5g', 'sep__nos_calling', 'sep__nos_calling_diff', 'sep__gprs_flow_commu', 'sep__gprs_now_rest', 'sep__calling_diff_cnt', 'sep__gprs_flow_short', 'sep__calling_dura', 'wave__monthsremain_last_stop_date', 'wave__gprs_last_defer', 'wave__gprs_flow_video', 'wave__calling_cnt', 'wave__gprs_flow_commu', 'wave__gprs_now_defer', 'wave__call_use', 'wave__gprs_now_rest', 'wave__gprs_flow_music', 'wave__calling_diff_cnt', 'wave__gprs_flow_short', 'wave__calling_dura', 'grow__gprs_flow_roam', 'grow__gprs_last_defer', 'grow__gprs_resource', 'grow__calling_diff_dura', 'grow__gprs_flow_video', 'grow__dinner_fee', 'grow__gprs_flow_5g', 'grow__nos_calling', 'grow__nos_calling_diff', 'grow__calling_cnt', 'grow__call_use', 'grow__gprs_now_rest', 'grow__gprs_flow_music', 'grow__calling_diff_cnt', 'max__gprs_flow_roam', 'max__monthsremain_last_stop_date', 'max__gprs_last_defer', 'max__gprs_resource', 'max__calling_diff_dura', 'max__dinner_fee', 'max__nos_calling', 'max__nos_calling_diff', 'max__arpu', 'max__calling_cnt', 'max__gprs_flow_commu', 'max__call_use', 'max__gprs_now_rest', 'max__gprs_flow_music', 'max__calling_diff_cnt', 'max__call_dura_roam', 'max__calling_dura', 'min__gprs_flow_roam', 'min__gprs_last_defer', 'min__gprs_resource', 'min__calling_diff_dura', 'min__gprs_flow_video', 'min__gprs_flow_5g', 'min__nos_calling', 'min__nos_calling_diff', 'min__arpu', 'min__calling_cnt', 'min__gprs_flow_commu', 'min__gprs_now_defer', 'min__call_use', 'min__gprs_flow_4g', 'min__gprs_now_rest', 'min__gprs_flow_music', 'min__calling_diff_cnt', 'min__gprs_flow_game', 'min__call_dura_roam', 'min__gprs_flow_short', 'min__calling_dura', 'std__gprs_last_defer', 'std__gprs_resource', 'std__calling_diff_dura', 'std__gprs_flow_video', 'std__nos_calling', 'std__nos_calling_diff', 'std__calling_cnt', 'std__gprs_flow_commu', 'std__call_use', 'std__gprs_flow_4g', 'std__gprs_now_rest', 'std__calling_diff_cnt', 'std__call_dura_roam', 'std__calling_dura', 'more0cnt__monthsremain_last_stop_date', 'more0cnt__nos_calling', 'more0cnt__calling_dura', 'moreq25cnt__gprs_last_defer', 'moreq25cnt__gprs_resource', 'moreq25cnt__gprs_flow_video', 'moreq25cnt__gprs_flow_5g', 'moreq25cnt__nos_calling', 'moreq25cnt__nos_calling_diff', 'moreq25cnt__arpu', 'moreq25cnt__calling_cnt', 'moreq25cnt__gprs_flow_commu', 'moreq25cnt__call_use', 'moreq25cnt__gprs_flow_4g', 'moreq25cnt__gprs_flow_music', 'moreq25cnt__calling_diff_cnt', 'moreq25cnt__gprs_flow_game', 'moreq25cnt__gprs_flow_short', 'moreq25cnt__calling_dura', 'valuecnt__if_nolimit~是', 'valuecnt__if_5g_dinner~是']
20220704-11:44:29      col_date: None
20220704-11:44:29      nrows: None
20220704-11:44:29      if_coltolower: False
20220704-11:44:29      kwargs: {}

20220704-11:44:29      读取
20220704-11:44:29  -------------------------读取完毕: (1000, 161) 2022-07-04 11:44:29 -------------------------

20220704-11:44:29  合并训练、测试数据
20220704-11:44:33  data.shape: (4500, 161)

20220704-11:44:33  数据分布：
                       202010  data_timein  0    423
                       202010  data_timein  1    77
                       202010  data_train  0    2000
                       202010  data_train  1    1000
                       202012  data_timeout  0    846
                       202012  data_timeout  1    154
                       dtype: int64

20220704-11:44:39  数据集整合：
20220704-11:45:00  -------------------------- timeout --------------------------
20220704-11:45:14  校验账期:                    20220704-11:45:14      通过


D:\Program Files\PyCharm 2021.2.2\plugins\python\helpers\pydev\pydevconsole.py:5: UserWarning: Pandas doesn't allow columns to be created via a new attribute name - see https://pandas.pydata.org/pandas-docs/stable/indexing.html#attribute-access
  from _pydev_comm.pydev_rpc import make_rpc_client, start_rpc_server, start_rpc_server_and_make_client
                   Out[28]: 20220704-11:45:19  False
20220704-11:45:35  具备data_timeout数据集，以其测试效果评估模型

20220704-11:45:44  遍历不同的抽样比例、数据预处理流水线、算法 进行训练测试:



Traceback (most recent call last):
  File "D:\Python for Windows\lib\site-packages\IPython\core\interactiveshell.py", line 3296, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-38-30280edaf09b>", line 4, in <module>
    for ratio in data_set['data_train'].keys():  # --------- 遍历不同的抽样比例
KeyError: 'data_train'
20220704-11:50:41  ------------------------- 流水线：pipeline1 -------------------------
20220704-11:50:41  ------------------------- 流水线：pipeline2 -------------------------


Traceback (most recent call last):
  File "D:\Python for Windows\lib\site-packages\IPython\core\interactiveshell.py", line 3296, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-40-81c5a59f43aa>", line 1, in <module>
    for ratio in data_set['data_train'].keys():  # --------- 遍历不同的抽样比例
KeyError: 'data_train'
                   Out[42]: 20220704-11:51:33  
                   OrderedDict([('data_timeout',
                                          data_use acct_month      user_id      account_id  innet_months user_status  monthsremain_last_stop_date  gprs_last_defer  gprs_now_rest  call_use   arpu  calling_cnt  \
                                 0    data_timeout     202012  42092446959         1821502         178.0   在网-正常                         -2.0              0.0            9.0       0.0  22.20         10.0   
                                 1    data_timeout     202012  75564763855        46300388         176.0   在网-正常                         -2.0              0.0           10.0       0.0  15.20          5.0   
                                 2    data_timeout     202012  25441922073         1384695         212.0   在网-正常                        -23.0             40.0        81920.0       0.0  11.45          0.0   
                                 3    data_timeout     202012  33515009301  30100000000000          91.0   在网-正常                        -27.0              0.0        29824.0       0.0  17.39         45.0   
                                 4    data_timeout     202012  32908638670       108114620         161.0   在网-正常                        -63.0              0.0    104857600.0       5.0  88.11          2.0   
                                 ..            ...        ...          ...             ...           ...         ...                          ...              ...            ...       ...    ...          ...   
                                 995  data_timeout     202012  14242892282        58894224         144.0   在网-正常                         -4.0           1024.0     12582357.0       0.0  40.00          0.0   
                                 996  data_timeout     202012  31752733091         5452307         210.0   在网-正常                        -33.0           2280.0      3667993.0      46.0  33.00        118.0   
                                 997  data_timeout     202012  20205488482         1424176         216.0   在网-正常                        -18.0              0.0           10.0       3.0   8.00          2.0   
                                 998  data_timeout     202012  35526210401         2753306         160.0   在网-正常                        -22.0            100.0     10690530.0       0.0  21.57          6.0   
                                 999  data_timeout     202012  29890366873         4620441         210.0   在网-正常                        -13.0              0.0            5.0       0.0   8.00          0.0   
                                 
                                      calling_dura  calling_diff_dura  gprs_flow_4g  ...  moreq25cnt__nos_calling  moreq25cnt__nos_calling_diff  moreq25cnt__arpu  moreq25cnt__calling_cnt  \
                                 0            37.0               33.0           0.0  ...                      2.0                           2.0               2.0                      2.0   
                                 1            25.0               22.0           0.0  ...                      2.0                           3.0               3.0                      2.0   
                                 2             0.0                0.0       20242.0  ...                      0.0                           0.0               2.0                      0.0   
                                 3            78.0               65.0       87709.0  ...                      2.0                           2.0               2.0                      2.0   
                                 4             5.0                4.0         305.0  ...                      2.0                           2.0               2.0                      2.0   
                                 ..            ...                ...           ...  ...                      ...                           ...               ...                      ...   
                                 995           0.0                0.0       12146.0  ...                      1.0                           0.0               3.0                      1.0   
                                 996         253.0               40.0     7383882.0  ...                      2.0                           2.0               2.0                      2.0   
                                 997           3.0                1.0           0.0  ...                      3.0                           3.0               0.0                      3.0   
                                 998          18.0                2.0       18594.0  ...                      2.0                           2.0               2.0                      2.0   
                                 999           0.0                0.0        5814.0  ...                      0.0                           0.0               0.0                      0.0   
                                 
                                      moreq25cnt__gprs_flow_commu  moreq25cnt__call_use  moreq25cnt__gprs_flow_4g  moreq25cnt__gprs_flow_music  moreq25cnt__calling_diff_cnt  moreq25cnt__gprs_flow_game  \
                                 0                            0.0                   0.0                       0.0                          0.0                           2.0                         0.0   
                                 1                            0.0                   0.0                       0.0                          0.0                           3.0                         0.0   
                                 2                            2.0                   0.0                       3.0                          0.0                           0.0                         0.0   
                                 3                            0.0                   0.0                       2.0                          0.0                           2.0                         0.0   
                                 4                            0.0                   2.0                       0.0                          0.0                           2.0                         0.0   
                                 ..                           ...                   ...                       ...                          ...                           ...                         ...   
                                 995                          1.0                   1.0                       3.0                          0.0                           0.0                         0.0   
                                 996                          2.0                   2.0                       2.0                          2.0                           2.0                         0.0   
                                 997                          0.0                   3.0                       0.0                          0.0                           3.0                         0.0   
                                 998                          0.0                   0.0                       2.0                          0.0                           2.0                         0.0   
                                 999                          0.0                   0.0                       2.0                          0.0                           0.0                         0.0   
                                 
                                      moreq25cnt__gprs_flow_short moreq25cnt__calling_dura  valuecnt__if_nolimit~是  valuecnt__if_5g_dinner~是  flag_eg  
                                 0                            0.0                      2.0                      0.0                        0.0        0  
                                 1                            0.0                      2.0                      0.0                        0.0        0  
                                 2                            0.0                      0.0                      0.0                        0.0        0  
                                 3                            0.0                      2.0                      0.0                        0.0        0  
                                 4                            0.0                      2.0                      0.0                        0.0        0  
                                 ..                           ...                      ...                      ...                        ...      ...  
                                 995                          0.0                      1.0                      0.0                        0.0        0  
                                 996                          2.0                      2.0                      0.0                        0.0        0  
                                 997                          0.0                      3.0                      0.0                        0.0        0  
                                 998                          0.0                      2.0                      0.0                        0.0        0  
                                 999                          0.0                      0.0                      0.0                        0.0        0  
                                 
                                 [1000 rows x 161 columns])])


Traceback (most recent call last):
  File "D:\Python for Windows\lib\site-packages\IPython\core\interactiveshell.py", line 3296, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-43-81c5a59f43aa>", line 1, in <module>
    for ratio in data_set['data_train'].keys():  # --------- 遍历不同的抽样比例
KeyError: 'data_train'
20220704-11:52:32  开始时间：2022-07-04 11:52:32
20220704-11:52:43  模型名称：模型示例
20220704-11:52:43  参数设置：
                       Info.model_name: 模型示例
                       Info.trainproc_ratiolist: [1, 2, 10]
                       field_comment: (167, 16)
                       Info.freq_limit: 0.95
                       Info.unique_limit: 5000
                       Info.iv_limit: 0.05
                       Info.r_limit: 0.95
                       Info.random_state: None
20220704-11:52:43  mark: ~202010~202012
20220704-11:52:43  目标字段：flag_eg; 正负例取值：1、0
20220704-11:52:43  field_comment.shape: (167, 16)
20220704-11:52:43      len(col_need): 167
20220704-11:52:43      删除field_comment中into_model取值为‘删除’的3个字段：['phone_no_null', 'last_stop_date', 'flag_eg']
20220704-11:52:43      len(col_need): 167
20220704-11:52:43      删除Info.col_del中的1个字段：{'user_acct_month'}
20220704-11:52:43      len(col_need): 166

20220704-11:52:43      删除Info.supply_other、col_mark中的5个字段：{'phone_no_null', 'call_fee_local', 'sms_cnt', 'dayvalue_gprs_flow', 'last_stop_date'}
20220704-11:52:43      len(col_need): 161

20220704-11:52:43  ------------------------- 读取数据: ./binaryclassify/eg/traintest~202010~202012/train_data~202010.csv 2022-07-04 11:52:43 -------------------------
20220704-11:52:43      src: file
20220704-11:52:43      condition: None
20220704-11:52:43      col_need(161): ['data_use', 'acct_month', 'user_id', 'account_id', 'innet_months', 'user_status', 'monthsremain_last_stop_date', 'gprs_last_defer', 'gprs_now_rest', 'call_use', 'arpu', 'calling_cnt', 'calling_dura', 'calling_diff_dura', 'gprs_flow_4g', 'gprs_flow_5g', 'gprs_flow_roam', 'call_dura_roam', 'days_call_p_4', 'nos_calling', 'nos_calling_diff', 'gprs_flow_video', 'gprs_flow_short', 'gprs_flow_music', 'gprs_flow_commu', 'gprs_flow_game', 'greatest_gprs_app', 'sex_add~女', 'sex_add~男', 'avg__gprs_flow_roam', 'avg__monthsremain_last_stop_date', 'avg__gprs_last_defer', 'avg__gprs_resource', 'avg__calling_diff_dura', 'avg__gprs_flow_video', 'avg__gprs_flow_5g', 'avg__nos_calling', 'avg__nos_calling_diff', 'avg__arpu', 'avg__calling_cnt', 'avg__gprs_flow_commu', 'avg__gprs_now_defer', 'avg__call_use', 'avg__gprs_flow_4g', 'avg__gprs_now_rest', 'avg__gprs_flow_music', 'avg__calling_diff_cnt', 'avg__gprs_flow_game', 'avg__call_dura_roam', 'avg__gprs_flow_short', 'avg__calling_dura', 'sep__gprs_resource', 'sep__calling_diff_dura', 'sep__gprs_flow_5g', 'sep__nos_calling', 'sep__nos_calling_diff', 'sep__gprs_flow_commu', 'sep__gprs_now_rest', 'sep__calling_diff_cnt', 'sep__gprs_flow_short', 'sep__calling_dura', 'wave__monthsremain_last_stop_date', 'wave__gprs_last_defer', 'wave__gprs_flow_video', 'wave__calling_cnt', 'wave__gprs_flow_commu', 'wave__gprs_now_defer', 'wave__call_use', 'wave__gprs_now_rest', 'wave__gprs_flow_music', 'wave__calling_diff_cnt', 'wave__gprs_flow_short', 'wave__calling_dura', 'grow__gprs_flow_roam', 'grow__gprs_last_defer', 'grow__gprs_resource', 'grow__calling_diff_dura', 'grow__gprs_flow_video', 'grow__dinner_fee', 'grow__gprs_flow_5g', 'grow__nos_calling', 'grow__nos_calling_diff', 'grow__calling_cnt', 'grow__call_use', 'grow__gprs_now_rest', 'grow__gprs_flow_music', 'grow__calling_diff_cnt', 'max__gprs_flow_roam', 'max__monthsremain_last_stop_date', 'max__gprs_last_defer', 'max__gprs_resource', 'max__calling_diff_dura', 'max__dinner_fee', 'max__nos_calling', 'max__nos_calling_diff', 'max__arpu', 'max__calling_cnt', 'max__gprs_flow_commu', 'max__call_use', 'max__gprs_now_rest', 'max__gprs_flow_music', 'max__calling_diff_cnt', 'max__call_dura_roam', 'max__calling_dura', 'min__gprs_flow_roam', 'min__gprs_last_defer', 'min__gprs_resource', 'min__calling_diff_dura', 'min__gprs_flow_video', 'min__gprs_flow_5g', 'min__nos_calling', 'min__nos_calling_diff', 'min__arpu', 'min__calling_cnt', 'min__gprs_flow_commu', 'min__gprs_now_defer', 'min__call_use', 'min__gprs_flow_4g', 'min__gprs_now_rest', 'min__gprs_flow_music', 'min__calling_diff_cnt', 'min__gprs_flow_game', 'min__call_dura_roam', 'min__gprs_flow_short', 'min__calling_dura', 'std__gprs_last_defer', 'std__gprs_resource', 'std__calling_diff_dura', 'std__gprs_flow_video', 'std__nos_calling', 'std__nos_calling_diff', 'std__calling_cnt', 'std__gprs_flow_commu', 'std__call_use', 'std__gprs_flow_4g', 'std__gprs_now_rest', 'std__calling_diff_cnt', 'std__call_dura_roam', 'std__calling_dura', 'more0cnt__monthsremain_last_stop_date', 'more0cnt__nos_calling', 'more0cnt__calling_dura', 'moreq25cnt__gprs_last_defer', 'moreq25cnt__gprs_resource', 'moreq25cnt__gprs_flow_video', 'moreq25cnt__gprs_flow_5g', 'moreq25cnt__nos_calling', 'moreq25cnt__nos_calling_diff', 'moreq25cnt__arpu', 'moreq25cnt__calling_cnt', 'moreq25cnt__gprs_flow_commu', 'moreq25cnt__call_use', 'moreq25cnt__gprs_flow_4g', 'moreq25cnt__gprs_flow_music', 'moreq25cnt__calling_diff_cnt', 'moreq25cnt__gprs_flow_game', 'moreq25cnt__gprs_flow_short', 'moreq25cnt__calling_dura', 'valuecnt__if_nolimit~是', 'valuecnt__if_5g_dinner~是', 'flag_eg']
20220704-11:52:43      col_del: None
20220704-11:52:43      col_char(9): ['user_acct_month', 'data_use', 'acct_month', 'phone_no_null', 'user_id', 'account_id', 'user_status', 'greatest_gprs_app', 'flag_eg']
20220704-11:52:43      col_num(157): ['innet_months', 'monthsremain_last_stop_date', 'gprs_last_defer', 'gprs_now_rest', 'call_use', 'arpu', 'calling_cnt', 'calling_dura', 'calling_diff_dura', 'gprs_flow_4g', 'gprs_flow_5g', 'gprs_flow_roam', 'call_dura_roam', 'days_call_p_4', 'nos_calling', 'nos_calling_diff', 'sms_cnt', 'call_fee_local', 'gprs_flow_video', 'gprs_flow_short', 'gprs_flow_music', 'gprs_flow_commu', 'gprs_flow_game', 'dayvalue_gprs_flow', 'sex_add~女', 'sex_add~男', 'avg__gprs_flow_roam', 'avg__monthsremain_last_stop_date', 'avg__gprs_last_defer', 'avg__gprs_resource', 'avg__calling_diff_dura', 'avg__gprs_flow_video', 'avg__gprs_flow_5g', 'avg__nos_calling', 'avg__nos_calling_diff', 'avg__arpu', 'avg__calling_cnt', 'avg__gprs_flow_commu', 'avg__gprs_now_defer', 'avg__call_use', 'avg__gprs_flow_4g', 'avg__gprs_now_rest', 'avg__gprs_flow_music', 'avg__calling_diff_cnt', 'avg__gprs_flow_game', 'avg__call_dura_roam', 'avg__gprs_flow_short', 'avg__calling_dura', 'sep__gprs_resource', 'sep__calling_diff_dura', 'sep__gprs_flow_5g', 'sep__nos_calling', 'sep__nos_calling_diff', 'sep__gprs_flow_commu', 'sep__gprs_now_rest', 'sep__calling_diff_cnt', 'sep__gprs_flow_short', 'sep__calling_dura', 'wave__monthsremain_last_stop_date', 'wave__gprs_last_defer', 'wave__gprs_flow_video', 'wave__calling_cnt', 'wave__gprs_flow_commu', 'wave__gprs_now_defer', 'wave__call_use', 'wave__gprs_now_rest', 'wave__gprs_flow_music', 'wave__calling_diff_cnt', 'wave__gprs_flow_short', 'wave__calling_dura', 'grow__gprs_flow_roam', 'grow__gprs_last_defer', 'grow__gprs_resource', 'grow__calling_diff_dura', 'grow__gprs_flow_video', 'grow__dinner_fee', 'grow__gprs_flow_5g', 'grow__nos_calling', 'grow__nos_calling_diff', 'grow__calling_cnt', 'grow__call_use', 'grow__gprs_now_rest', 'grow__gprs_flow_music', 'grow__calling_diff_cnt', 'max__gprs_flow_roam', 'max__monthsremain_last_stop_date', 'max__gprs_last_defer', 'max__gprs_resource', 'max__calling_diff_dura', 'max__dinner_fee', 'max__nos_calling', 'max__nos_calling_diff', 'max__arpu', 'max__calling_cnt', 'max__gprs_flow_commu', 'max__call_use', 'max__gprs_now_rest', 'max__gprs_flow_music', 'max__calling_diff_cnt', 'max__call_dura_roam', 'max__calling_dura', 'min__gprs_flow_roam', 'min__gprs_last_defer', 'min__gprs_resource', 'min__calling_diff_dura', 'min__gprs_flow_video', 'min__gprs_flow_5g', 'min__nos_calling', 'min__nos_calling_diff', 'min__arpu', 'min__calling_cnt', 'min__gprs_flow_commu', 'min__gprs_now_defer', 'min__call_use', 'min__gprs_flow_4g', 'min__gprs_now_rest', 'min__gprs_flow_music', 'min__calling_diff_cnt', 'min__gprs_flow_game', 'min__call_dura_roam', 'min__gprs_flow_short', 'min__calling_dura', 'std__gprs_last_defer', 'std__gprs_resource', 'std__calling_diff_dura', 'std__gprs_flow_video', 'std__nos_calling', 'std__nos_calling_diff', 'std__calling_cnt', 'std__gprs_flow_commu', 'std__call_use', 'std__gprs_flow_4g', 'std__gprs_now_rest', 'std__calling_diff_cnt', 'std__call_dura_roam', 'std__calling_dura', 'more0cnt__monthsremain_last_stop_date', 'more0cnt__nos_calling', 'more0cnt__calling_dura', 'moreq25cnt__gprs_last_defer', 'moreq25cnt__gprs_resource', 'moreq25cnt__gprs_flow_video', 'moreq25cnt__gprs_flow_5g', 'moreq25cnt__nos_calling', 'moreq25cnt__nos_calling_diff', 'moreq25cnt__arpu', 'moreq25cnt__calling_cnt', 'moreq25cnt__gprs_flow_commu', 'moreq25cnt__call_use', 'moreq25cnt__gprs_flow_4g', 'moreq25cnt__gprs_flow_music', 'moreq25cnt__calling_diff_cnt', 'moreq25cnt__gprs_flow_game', 'moreq25cnt__gprs_flow_short', 'moreq25cnt__calling_dura', 'valuecnt__if_nolimit~是', 'valuecnt__if_5g_dinner~是']
20220704-11:52:43      col_date: None
20220704-11:52:43      nrows: None
20220704-11:52:43      if_coltolower: False
20220704-11:52:43      kwargs: {}

20220704-11:52:43      读取
20220704-11:52:44  -------------------------读取完毕: (3500, 161) 2022-07-04 11:52:44 -------------------------

20220704-11:52:51  ------------------------- 读取数据: ./binaryclassify/eg/traintest~202010~202012/test_data~202012.csv 2022-07-04 11:52:51 -------------------------
20220704-11:52:51      src: file
20220704-11:52:51      condition: None
20220704-11:52:51      col_need(161): ['data_use', 'acct_month', 'user_id', 'account_id', 'innet_months', 'user_status', 'monthsremain_last_stop_date', 'gprs_last_defer', 'gprs_now_rest', 'call_use', 'arpu', 'calling_cnt', 'calling_dura', 'calling_diff_dura', 'gprs_flow_4g', 'gprs_flow_5g', 'gprs_flow_roam', 'call_dura_roam', 'days_call_p_4', 'nos_calling', 'nos_calling_diff', 'gprs_flow_video', 'gprs_flow_short', 'gprs_flow_music', 'gprs_flow_commu', 'gprs_flow_game', 'greatest_gprs_app', 'sex_add~女', 'sex_add~男', 'avg__gprs_flow_roam', 'avg__monthsremain_last_stop_date', 'avg__gprs_last_defer', 'avg__gprs_resource', 'avg__calling_diff_dura', 'avg__gprs_flow_video', 'avg__gprs_flow_5g', 'avg__nos_calling', 'avg__nos_calling_diff', 'avg__arpu', 'avg__calling_cnt', 'avg__gprs_flow_commu', 'avg__gprs_now_defer', 'avg__call_use', 'avg__gprs_flow_4g', 'avg__gprs_now_rest', 'avg__gprs_flow_music', 'avg__calling_diff_cnt', 'avg__gprs_flow_game', 'avg__call_dura_roam', 'avg__gprs_flow_short', 'avg__calling_dura', 'sep__gprs_resource', 'sep__calling_diff_dura', 'sep__gprs_flow_5g', 'sep__nos_calling', 'sep__nos_calling_diff', 'sep__gprs_flow_commu', 'sep__gprs_now_rest', 'sep__calling_diff_cnt', 'sep__gprs_flow_short', 'sep__calling_dura', 'wave__monthsremain_last_stop_date', 'wave__gprs_last_defer', 'wave__gprs_flow_video', 'wave__calling_cnt', 'wave__gprs_flow_commu', 'wave__gprs_now_defer', 'wave__call_use', 'wave__gprs_now_rest', 'wave__gprs_flow_music', 'wave__calling_diff_cnt', 'wave__gprs_flow_short', 'wave__calling_dura', 'grow__gprs_flow_roam', 'grow__gprs_last_defer', 'grow__gprs_resource', 'grow__calling_diff_dura', 'grow__gprs_flow_video', 'grow__dinner_fee', 'grow__gprs_flow_5g', 'grow__nos_calling', 'grow__nos_calling_diff', 'grow__calling_cnt', 'grow__call_use', 'grow__gprs_now_rest', 'grow__gprs_flow_music', 'grow__calling_diff_cnt', 'max__gprs_flow_roam', 'max__monthsremain_last_stop_date', 'max__gprs_last_defer', 'max__gprs_resource', 'max__calling_diff_dura', 'max__dinner_fee', 'max__nos_calling', 'max__nos_calling_diff', 'max__arpu', 'max__calling_cnt', 'max__gprs_flow_commu', 'max__call_use', 'max__gprs_now_rest', 'max__gprs_flow_music', 'max__calling_diff_cnt', 'max__call_dura_roam', 'max__calling_dura', 'min__gprs_flow_roam', 'min__gprs_last_defer', 'min__gprs_resource', 'min__calling_diff_dura', 'min__gprs_flow_video', 'min__gprs_flow_5g', 'min__nos_calling', 'min__nos_calling_diff', 'min__arpu', 'min__calling_cnt', 'min__gprs_flow_commu', 'min__gprs_now_defer', 'min__call_use', 'min__gprs_flow_4g', 'min__gprs_now_rest', 'min__gprs_flow_music', 'min__calling_diff_cnt', 'min__gprs_flow_game', 'min__call_dura_roam', 'min__gprs_flow_short', 'min__calling_dura', 'std__gprs_last_defer', 'std__gprs_resource', 'std__calling_diff_dura', 'std__gprs_flow_video', 'std__nos_calling', 'std__nos_calling_diff', 'std__calling_cnt', 'std__gprs_flow_commu', 'std__call_use', 'std__gprs_flow_4g', 'std__gprs_now_rest', 'std__calling_diff_cnt', 'std__call_dura_roam', 'std__calling_dura', 'more0cnt__monthsremain_last_stop_date', 'more0cnt__nos_calling', 'more0cnt__calling_dura', 'moreq25cnt__gprs_last_defer', 'moreq25cnt__gprs_resource', 'moreq25cnt__gprs_flow_video', 'moreq25cnt__gprs_flow_5g', 'moreq25cnt__nos_calling', 'moreq25cnt__nos_calling_diff', 'moreq25cnt__arpu', 'moreq25cnt__calling_cnt', 'moreq25cnt__gprs_flow_commu', 'moreq25cnt__call_use', 'moreq25cnt__gprs_flow_4g', 'moreq25cnt__gprs_flow_music', 'moreq25cnt__calling_diff_cnt', 'moreq25cnt__gprs_flow_game', 'moreq25cnt__gprs_flow_short', 'moreq25cnt__calling_dura', 'valuecnt__if_nolimit~是', 'valuecnt__if_5g_dinner~是', 'flag_eg']
20220704-11:52:51      col_del: None
20220704-11:52:51      col_char(9): ['user_acct_month', 'data_use', 'acct_month', 'phone_no_null', 'user_id', 'account_id', 'user_status', 'greatest_gprs_app', 'flag_eg']
20220704-11:52:51      col_num(157): ['innet_months', 'monthsremain_last_stop_date', 'gprs_last_defer', 'gprs_now_rest', 'call_use', 'arpu', 'calling_cnt', 'calling_dura', 'calling_diff_dura', 'gprs_flow_4g', 'gprs_flow_5g', 'gprs_flow_roam', 'call_dura_roam', 'days_call_p_4', 'nos_calling', 'nos_calling_diff', 'sms_cnt', 'call_fee_local', 'gprs_flow_video', 'gprs_flow_short', 'gprs_flow_music', 'gprs_flow_commu', 'gprs_flow_game', 'dayvalue_gprs_flow', 'sex_add~女', 'sex_add~男', 'avg__gprs_flow_roam', 'avg__monthsremain_last_stop_date', 'avg__gprs_last_defer', 'avg__gprs_resource', 'avg__calling_diff_dura', 'avg__gprs_flow_video', 'avg__gprs_flow_5g', 'avg__nos_calling', 'avg__nos_calling_diff', 'avg__arpu', 'avg__calling_cnt', 'avg__gprs_flow_commu', 'avg__gprs_now_defer', 'avg__call_use', 'avg__gprs_flow_4g', 'avg__gprs_now_rest', 'avg__gprs_flow_music', 'avg__calling_diff_cnt', 'avg__gprs_flow_game', 'avg__call_dura_roam', 'avg__gprs_flow_short', 'avg__calling_dura', 'sep__gprs_resource', 'sep__calling_diff_dura', 'sep__gprs_flow_5g', 'sep__nos_calling', 'sep__nos_calling_diff', 'sep__gprs_flow_commu', 'sep__gprs_now_rest', 'sep__calling_diff_cnt', 'sep__gprs_flow_short', 'sep__calling_dura', 'wave__monthsremain_last_stop_date', 'wave__gprs_last_defer', 'wave__gprs_flow_video', 'wave__calling_cnt', 'wave__gprs_flow_commu', 'wave__gprs_now_defer', 'wave__call_use', 'wave__gprs_now_rest', 'wave__gprs_flow_music', 'wave__calling_diff_cnt', 'wave__gprs_flow_short', 'wave__calling_dura', 'grow__gprs_flow_roam', 'grow__gprs_last_defer', 'grow__gprs_resource', 'grow__calling_diff_dura', 'grow__gprs_flow_video', 'grow__dinner_fee', 'grow__gprs_flow_5g', 'grow__nos_calling', 'grow__nos_calling_diff', 'grow__calling_cnt', 'grow__call_use', 'grow__gprs_now_rest', 'grow__gprs_flow_music', 'grow__calling_diff_cnt', 'max__gprs_flow_roam', 'max__monthsremain_last_stop_date', 'max__gprs_last_defer', 'max__gprs_resource', 'max__calling_diff_dura', 'max__dinner_fee', 'max__nos_calling', 'max__nos_calling_diff', 'max__arpu', 'max__calling_cnt', 'max__gprs_flow_commu', 'max__call_use', 'max__gprs_now_rest', 'max__gprs_flow_music', 'max__calling_diff_cnt', 'max__call_dura_roam', 'max__calling_dura', 'min__gprs_flow_roam', 'min__gprs_last_defer', 'min__gprs_resource', 'min__calling_diff_dura', 'min__gprs_flow_video', 'min__gprs_flow_5g', 'min__nos_calling', 'min__nos_calling_diff', 'min__arpu', 'min__calling_cnt', 'min__gprs_flow_commu', 'min__gprs_now_defer', 'min__call_use', 'min__gprs_flow_4g', 'min__gprs_now_rest', 'min__gprs_flow_music', 'min__calling_diff_cnt', 'min__gprs_flow_game', 'min__call_dura_roam', 'min__gprs_flow_short', 'min__calling_dura', 'std__gprs_last_defer', 'std__gprs_resource', 'std__calling_diff_dura', 'std__gprs_flow_video', 'std__nos_calling', 'std__nos_calling_diff', 'std__calling_cnt', 'std__gprs_flow_commu', 'std__call_use', 'std__gprs_flow_4g', 'std__gprs_now_rest', 'std__calling_diff_cnt', 'std__call_dura_roam', 'std__calling_dura', 'more0cnt__monthsremain_last_stop_date', 'more0cnt__nos_calling', 'more0cnt__calling_dura', 'moreq25cnt__gprs_last_defer', 'moreq25cnt__gprs_resource', 'moreq25cnt__gprs_flow_video', 'moreq25cnt__gprs_flow_5g', 'moreq25cnt__nos_calling', 'moreq25cnt__nos_calling_diff', 'moreq25cnt__arpu', 'moreq25cnt__calling_cnt', 'moreq25cnt__gprs_flow_commu', 'moreq25cnt__call_use', 'moreq25cnt__gprs_flow_4g', 'moreq25cnt__gprs_flow_music', 'moreq25cnt__calling_diff_cnt', 'moreq25cnt__gprs_flow_game', 'moreq25cnt__gprs_flow_short', 'moreq25cnt__calling_dura', 'valuecnt__if_nolimit~是', 'valuecnt__if_5g_dinner~是']
20220704-11:52:51      col_date: None
20220704-11:52:51      nrows: None
20220704-11:52:51      if_coltolower: False
20220704-11:52:51      kwargs: {}

20220704-11:52:51      读取
20220704-11:52:51  -------------------------读取完毕: (1000, 161) 2022-07-04 11:52:51 -------------------------

20220704-11:52:51  合并训练、测试数据
20220704-11:52:51  data.shape: (4500, 161)

20220704-11:52:51  数据分布：
                       202010  data_timein  0    423
                       202010  data_timein  1    77
                       202010  data_train  0    2000
                       202010  data_train  1    1000
                       202012  data_timeout  0    846
                       202012  data_timeout  1    154
                       dtype: int64

20220704-11:52:51  数据集整合：
20220704-11:53:23  -------------------------- train --------------------------
20220704-11:53:29  校验账期:                    20220704-11:53:29      通过


D:\Program Files\PyCharm 2021.2.2\plugins\python\helpers\pydev\pydevconsole.py:9: UserWarning: Pandas doesn't allow columns to be created via a new attribute name - see https://pandas.pydata.org/pandas-docs/stable/indexing.html#attribute-access
  
20220704-11:53:29  trainproc_ratiolist：[1, 2, 10]
20220704-11:53:29  正负例实际比例最高：1:2.0，将trainproc_ratiolist纠正为:[1, 2]


Traceback (most recent call last):
  File "D:\Python for Windows\lib\site-packages\IPython\core\interactiveshell.py", line 3296, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-49-fb01980419c2>", line 30, in <module>
    train_sample_set[key] = train_sample(d, Info, ratio, Info.random_state)
NameError: name 'train_sample' is not defined


Traceback (most recent call last):
  File "D:\Python for Windows\lib\site-packages\IPython\core\interactiveshell.py", line 3296, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-54-47221a8b1604>", line 2, in <module>
    train_sample_set[key] = train_sample(d, Info, ratio, Info.random_state)
NameError: name 'train_sample' is not defined
20220704-11:54:37  随机抽样 1:2
20220704-11:54:37      正例样本：1000
20220704-11:54:37      负例样本：2000
20220704-11:54:37          从负例中随机抽取2000（1000*2）


D:\Program Files\PyCharm 2021.2.2\plugins\python\helpers\pydev\pydevconsole.py:9: UserWarning: 请确定模型评估数据集名称, data_set.keys():['data_train']
  

20220704-11:54:57  遍历不同的抽样比例、数据预处理流水线、算法 进行训练测试:

                   Out[61]: 20220704-11:55:12  
                   OrderedDict([('data_train',
                                 OrderedDict([('ratio_1_2',
                                                       data_use acct_month      user_id      account_id  innet_months user_status  monthsremain_last_stop_date  gprs_last_defer  gprs_now_rest  call_use   arpu  calling_cnt  \
                                               501   data_train     202010  23883026199         6536083         161.0   在网-正常                        -70.0            300.0     11100167.0       0.0  18.00          0.0   
                                               503   data_train     202010  24498499740        63527749         256.0   在网-正常                         -7.0              0.0            0.0     151.0  73.00        108.0   
                                               506   data_train     202010  20066574592        53196251         115.0   在网-正常                        -22.0              0.0            0.0      50.0  82.59         26.0   
                                               513   data_train     202010  78528839233  30100000000000          32.0   在网-正常                         -5.0            500.0    116367360.0      40.0  40.52          3.0   
                                               515   data_train     202010  81615377856        40307873         165.0   在网-正常                        -26.0             10.0     10506216.0       0.0   8.00          0.0   
                                               ...          ...        ...          ...             ...           ...         ...                          ...              ...            ...       ...    ...          ...   
                                               2527  data_train     202010  10346152250       102196712         185.0   在网-正常                        -15.0           6144.0    127926282.0       1.0  90.05          1.0   
                                               2274  data_train     202010  22624300339  30100000000000          26.0   在网-正常                         -7.0              0.0    115650570.0      51.0  39.00         29.0   
                                               3078  data_train     202010  22246782591         3641108         212.0   在网-正常                        -95.0             30.0        61440.0       0.0   5.00          0.0   
                                               2017  data_train     202010  25020569942         1790911         145.0   在网-正常                         -7.0            100.0     10690570.0      14.0  32.00          6.0   
                                               3451  data_train     202010  75552952674        43513580         174.0   在网-正常                          0.0           1024.0     12582919.0     191.0  61.40        245.0   
                                               
                                                     calling_dura  calling_diff_dura  gprs_flow_4g  ...  moreq25cnt__nos_calling  moreq25cnt__nos_calling_diff  moreq25cnt__arpu  moreq25cnt__calling_cnt  \
                                               501            0.0                0.0           0.0  ...                      0.0                           0.0               3.0                      0.0   
                                               503          557.0               44.0    22961644.0  ...                      3.0                           3.0               3.0                      3.0   
                                               506           71.0               12.0    13445897.0  ...                      3.0                           3.0               3.0                      3.0   
                                               513           48.0                0.0       69846.0  ...                      3.0                           2.0               3.0                      3.0   
                                               515            0.0                0.0        5382.0  ...                      0.0                           0.0               0.0                      0.0   
                                               ...            ...                ...           ...  ...                      ...                           ...               ...                      ...   
                                               2527           1.0                0.0       34607.0  ...                      2.0                           1.0               3.0                      1.0   
                                               2274          51.0                7.0         106.0  ...                      3.0                           3.0               3.0                      3.0   
                                               3078           0.0                0.0           0.0  ...                      0.0                           0.0               0.0                      0.0   
                                               2017          14.0               10.0           0.0  ...                      3.0                           3.0               3.0                      3.0   
                                               3451         682.0               90.0      458089.0  ...                      3.0                           3.0               3.0                      3.0   
                                               
                                                     moreq25cnt__gprs_flow_commu  moreq25cnt__call_use  moreq25cnt__gprs_flow_4g  moreq25cnt__gprs_flow_music  moreq25cnt__calling_diff_cnt  moreq25cnt__gprs_flow_game  \
                                               501                           0.0                   1.0                       0.0                          0.0                           0.0                         0.0   
                                               503                           3.0                   3.0                       3.0                          2.0                           3.0                         0.0   
                                               506                           0.0                   3.0                       3.0                          0.0                           3.0                         0.0   
                                               513                           0.0                   3.0                       3.0                          0.0                           1.0                         0.0   
                                               515                           0.0                   0.0                       2.0                          0.0                           0.0                         0.0   
                                               ...                           ...                   ...                       ...                          ...                           ...                         ...   
                                               2527                          0.0                   3.0                       3.0                          0.0                           1.0                         0.0   
                                               2274                          0.0                   3.0                       0.0                          0.0                           3.0                         0.0   
                                               3078                          0.0                   0.0                       0.0                          0.0                           0.0                         0.0   
                                               2017                          0.0                   3.0                       1.0                          0.0                           3.0                         0.0   
                                               3451                          1.0                   3.0                       3.0                          0.0                           3.0                         0.0   
                                               
                                                     moreq25cnt__gprs_flow_short moreq25cnt__calling_dura  valuecnt__if_nolimit~是  valuecnt__if_5g_dinner~是  flag_eg  
                                               501                           0.0                      0.0                      0.0                        0.0        1  
                                               503                           0.0                      3.0                      3.0                        0.0        1  
                                               506                           0.0                      3.0                      2.0                        1.0        1  
                                               513                           0.0                      3.0                      0.0                        0.0        1  
                                               515                           0.0                      0.0                      0.0                        0.0        1  
                                               ...                           ...                      ...                      ...                        ...      ...  
                                               2527                          0.0                      1.0                      0.0                        0.0        0  
                                               2274                          0.0                      3.0                      0.0                        0.0        0  
                                               3078                          0.0                      0.0                      0.0                        0.0        0  
                                               2017                          0.0                      3.0                      0.0                        0.0        0  
                                               3451                          0.0                      3.0                      0.0                        0.0        0  
                                               
                                               [3000 rows x 161 columns])]))])
20220704-11:55:30  ------------------------------------------ 抽样比例：ratio_1_2 ------------------------------------------

20220704-11:55:34  ------------------------- 流水线：pipeline1 -------------------------
20220704-11:55:34  ------------------------- 流水线：pipeline2 -------------------------
20220704-11:55:38  train_X: (3000, 159)


D:\工作\模型脚本\ModelProject\selfmodule\toolmodule\dataprep.py:483: UserWarning:     FeaturePrefilter_DF unique_limit(5000)小于X行数(3000), 添加unique_limit_actual：len(X)*0.99=2970
  warnings.warn(s); time.sleep(seconds)


D:\工作\模型脚本\ModelProject\selfmodule\toolmodule\dataprep.py:995: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead.  To get a de-fragmented frame, use `newframe = frame.copy()`
  X_woe[i] = X[i].map(self.col_tabl_[i].woe)


Traceback (most recent call last):
  File "D:\Python for Windows\lib\site-packages\IPython\core\interactiveshell.py", line 3205, in run_ast_nodes
    async_wrapper_code = compiler(mod, cell_name, 'exec')
  File "D:\Python for Windows\lib\codeop.py", line 133, in __call__
    codeob = compile(source, filename, symbol, self.flags, 1)
  File "<ipython-input-77-84a0e00e8027>", line 11
SyntaxError: 'continue' not properly in loop


Traceback (most recent call last):
  File "D:\Python for Windows\lib\site-packages\IPython\core\interactiveshell.py", line 3296, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-114-9eeec0529639>", line 1, in <module>
    Series((pre_r.分数 == '').values)
  File "D:\Python for Windows\lib\site-packages\pandas\core\generic.py", line 5487, in __getattr__
    return object.__getattribute__(self, name)
AttributeError: 'DataFrame' object has no attribute '分数'


Traceback (most recent call last):
  File "D:\Python for Windows\lib\site-packages\IPython\core\interactiveshell.py", line 3296, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-115-9bc52e68c6b4>", line 1, in <module>
    pre_r.分数 == ''
  File "D:\Python for Windows\lib\site-packages\pandas\core\generic.py", line 5487, in __getattr__
    return object.__getattribute__(self, name)
AttributeError: 'DataFrame' object has no attribute '分数'


Traceback (most recent call last):
  File "D:\Python for Windows\lib\site-packages\IPython\core\interactiveshell.py", line 3296, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-120-00e4d34d92f1>", line 1, in <module>
    eries((pre_r.分数 == '').values).idxmax()
NameError: name 'eries' is not defined


Traceback (most recent call last):
  File "D:\Python for Windows\lib\site-packages\IPython\core\interactiveshell.py", line 3296, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-125-43ebc71570da>", line 1, in <module>
    data.keys()
NameError: name 'data' is not defined


Traceback (most recent call last):
  File "D:\Python for Windows\lib\site-packages\IPython\core\interactiveshell.py", line 3296, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-130-79770692e191>", line 3, in <module>
    d = data.loc[data['data_use'] == data_name]
NameError: name 'data' is not defined


D:\Program Files\PyCharm 2021.2.2\plugins\python\helpers\pydev\pydevconsole.py:22: UserWarning: Pandas doesn't allow columns to be created via a new attribute name - see https://pandas.pydata.org/pandas-docs/stable/indexing.html#attribute-access
  from _pydev_bundle import fix_getpass


Traceback (most recent call last):
  File "D:\Python for Windows\lib\site-packages\IPython\core\interactiveshell.py", line 3296, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-143-2bde301f5df0>", line 50, in <module>
    gc.collect()
NameError: name 'gc' is not defined


Traceback (most recent call last):
  File "D:\Python for Windows\lib\site-packages\IPython\core\interactiveshell.py", line 3296, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-151-771c9159da5f>", line 1, in <module>
    models.keys().keys()
AttributeError: 'KeysView' object has no attribute 'keys'


Traceback (most recent call last):
  File "D:\Python for Windows\lib\site-packages\IPython\core\interactiveshell.py", line 3296, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-152-ef775d3a9b3c>", line 1, in <module>
    model_flows
NameError: name 'model_flows' is not defined


Traceback (most recent call last):
  File "D:\Python for Windows\lib\site-packages\IPython\core\interactiveshell.py", line 3296, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-153-a2842bacc75a>", line 1, in <module>
    model_flows, _ = model_cycle(data_set, pipelines, models, Info, field_comment, col_pre, skip, False)
NameError: name 'model_cycle' is not defined


D:\工作\模型脚本\ModelProject\selfmodule\toolmodule\dataprep.py:483: UserWarning:     FeaturePrefilter_DF unique_limit(5000)小于X行数(2000), 添加unique_limit_actual：len(X)*0.99=1980
  warnings.warn(s); time.sleep(seconds)


D:\工作\模型脚本\ModelProject\selfmodule\toolmodule\dataprep.py:995: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead.  To get a de-fragmented frame, use `newframe = frame.copy()`
  X_woe[i] = X[i].map(self.col_tabl_[i].woe)


D:\工作\模型脚本\ModelProject\selfmodule\toolmodule\dataprep.py:344: UserWarning: Pandas doesn't allow columns to be created via a new attribute name - see https://pandas.pydata.org/pandas-docs/stable/indexing.html#attribute-access
  if isinstance(x, DataFrame):


D:\工作\模型脚本\ModelProject\selfmodule\toolmodule\dataprep.py:342: UserWarning: Pandas doesn't allow columns to be created via a new attribute name - see https://pandas.pydata.org/pandas-docs/stable/indexing.html#attribute-access
  idx[0] = (indent + Series(idx[0]).astype(str)).values


D:\工作\模型脚本\ModelProject\selfmodule\toolmodule\dataprep.py:453: UserWarning: Pandas doesn't allow columns to be created via a new attribute name - see https://pandas.pydata.org/pandas-docs/stable/indexing.html#attribute-access
  if hasattr(self, 'print_indent'):


D:\工作\模型脚本\ModelProject\selfmodule\toolmodule\dataprep.py:455: UserWarning: Pandas doesn't allow columns to be created via a new attribute name - see https://pandas.pydata.org/pandas-docs/stable/indexing.html#attribute-access
  else:


D:\工作\模型脚本\ModelProject\selfmodule\toolmodule\dataprep.py:1051: UserWarning: Pandas doesn't allow columns to be created via a new attribute name - see https://pandas.pydata.org/pandas-docs/stable/indexing.html#attribute-access
  X_copy.y_carrier = y_carrier


D:\工作\模型脚本\ModelProject\selfmodule\toolmodule\dataprep.py:1356: UserWarning:     pipeline1 PsiTransformer data_timein 计算稳定性(区分正负例) ，2个字段稳定性>=psi_limit（0.1）：
gprs_flow_game    0.124106
max__call_use     0.100704
dtype: float64
  warnings.warn(s); time.sleep(seconds)


D:\工作\模型脚本\ModelProject\selfmodule\toolmodule\dataprep.py:1322: UserWarning:     pipeline1 PsiTransformer timedata_timeout 计算稳定性(不区分正负例)，28个字段稳定性>=psi_limit（0.1）：
max__monthsremain_last_stop_date         1.153147
avg__monthsremain_last_stop_date         0.796246
grow__gprs_resource                      0.504271
more0cnt__monthsremain_last_stop_date    0.489939
min__gprs_now_rest                       0.445216
sep__gprs_resource                       0.436227
wave__monthsremain_last_stop_date        0.351832
moreq25cnt__arpu                         0.349840
grow__gprs_now_rest                      0.279717
min__gprs_now_defer                      0.250272
moreq25cnt__gprs_flow_4g                 0.229578
wave__gprs_now_defer                     0.210678
wave__gprs_flow_video                    0.196379
wave__gprs_flow_music                    0.193906
sep__gprs_flow_commu                     0.190730
wave__calling_cnt                        0.190178
wave__gprs_flow_commu                    0.186252
wave__gprs_flow_short                    0.176905
moreq25cnt__calling_diff_cnt             0.176247
wave__calling_dura                       0.161267
min__calling_cnt                         0.155631
min__gprs_last_defer                     0.140473
moreq25cnt__gprs_last_defer              0.137042
wave__gprs_now_rest                      0.128105
moreq25cnt__nos_calling                  0.127532
min__calling_diff_cnt                    0.111167
sep__gprs_now_rest                       0.108587
min__arpu                                0.101832
dtype: float64
  warnings.warn(s); time.sleep(seconds)


D:\工作\模型脚本\ModelProject\selfmodule\toolmodule\dataprep.py:1356: UserWarning:     pipeline1 PsiTransformer data_timeout 计算稳定性(区分正负例) ，40个字段稳定性>=psi_limit（0.1）：
max__monthsremain_last_stop_date         1.001304
avg__monthsremain_last_stop_date         0.745715
grow__gprs_resource                      0.532255
sep__gprs_resource                       0.523499
min__gprs_now_rest                       0.479588
moreq25cnt__gprs_flow_4g                 0.433917
more0cnt__monthsremain_last_stop_date    0.427802
wave__monthsremain_last_stop_date        0.419017
moreq25cnt__arpu                         0.401877
min__calling_cnt                         0.374147
wave__gprs_flow_music                    0.347729
sep__gprs_flow_commu                     0.340718
moreq25cnt__calling_diff_cnt             0.336224
grow__gprs_now_rest                      0.335494
moreq25cnt__nos_calling                  0.317305
wave__gprs_flow_commu                    0.316552
min__nos_calling                         0.267509
moreq25cnt__nos_calling_diff             0.251359
min__calling_diff_cnt                    0.249624
min__gprs_resource                       0.243204
min__calling_dura                        0.227433
wave__calling_cnt                        0.222436
min__gprs_now_defer                      0.218448
wave__gprs_flow_short                    0.210312
wave__gprs_flow_video                    0.210274
min__nos_calling_diff                    0.209368
min__call_use                            0.209029
wave__gprs_now_defer                     0.189497
wave__calling_dura                       0.176647
min__calling_diff_dura                   0.174783
min__arpu                                0.153372
wave__gprs_now_rest                      0.149410
wave__calling_diff_cnt                   0.144374
min__gprs_last_defer                     0.119938
moreq25cnt__gprs_last_defer              0.117903
sep__gprs_now_rest                       0.115566
min__gprs_flow_4g                        0.114703
std__nos_calling_diff                    0.107205
std__gprs_flow_commu                     0.101765
std__gprs_flow_4g                        0.101290
dtype: float64
  warnings.warn(s); time.sleep(seconds)


D:\Python for Windows\lib\site-packages\xgboost\sklearn.py:1224: UserWarning: The use of label encoder in XGBClassifier is deprecated and will be removed in a future release. To remove this warning, do the following: 1) Pass option use_label_encoder=False when constructing XGBClassifier object; and 2) Encode your labels (y) as integers starting with 0, i.e. 0, 1, 2, ..., [num_class - 1].
  warnings.warn(label_encoder_deprecation_msg, UserWarning)


D:\工作\模型脚本\ModelProject\selfmodule\toolmodule\dataprep.py:483: UserWarning:     FeaturePrefilter_DF unique_limit(5000)小于X行数(2000), 添加unique_limit_actual：len(X)*0.99=1980
  warnings.warn(s); time.sleep(seconds)


D:\工作\模型脚本\ModelProject\selfmodule\toolmodule\dataprep.py:995: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead.  To get a de-fragmented frame, use `newframe = frame.copy()`
  X_woe[i] = X[i].map(self.col_tabl_[i].woe)


D:\工作\模型脚本\ModelProject\selfmodule\toolmodule\dataprep.py:344: UserWarning: Pandas doesn't allow columns to be created via a new attribute name - see https://pandas.pydata.org/pandas-docs/stable/indexing.html#attribute-access
  if isinstance(x, DataFrame):


D:\工作\模型脚本\ModelProject\selfmodule\toolmodule\dataprep.py:342: UserWarning: Pandas doesn't allow columns to be created via a new attribute name - see https://pandas.pydata.org/pandas-docs/stable/indexing.html#attribute-access
  idx[0] = (indent + Series(idx[0]).astype(str)).values


D:\工作\模型脚本\ModelProject\selfmodule\toolmodule\dataprep.py:453: UserWarning: Pandas doesn't allow columns to be created via a new attribute name - see https://pandas.pydata.org/pandas-docs/stable/indexing.html#attribute-access
  if hasattr(self, 'print_indent'):


D:\工作\模型脚本\ModelProject\selfmodule\toolmodule\dataprep.py:453: UserWarning: Pandas doesn't allow columns to be created via a new attribute name - see https://pandas.pydata.org/pandas-docs/stable/indexing.html#attribute-access
  if hasattr(self, 'print_indent'):


D:\工作\模型脚本\ModelProject\selfmodule\toolmodule\dataprep.py:455: UserWarning: Pandas doesn't allow columns to be created via a new attribute name - see https://pandas.pydata.org/pandas-docs/stable/indexing.html#attribute-access
  else:


D:\工作\模型脚本\ModelProject\selfmodule\toolmodule\dataprep.py:344: UserWarning: Pandas doesn't allow columns to be created via a new attribute name - see https://pandas.pydata.org/pandas-docs/stable/indexing.html#attribute-access
  if isinstance(x, DataFrame):


D:\工作\模型脚本\ModelProject\selfmodule\toolmodule\dataprep.py:342: UserWarning: Pandas doesn't allow columns to be created via a new attribute name - see https://pandas.pydata.org/pandas-docs/stable/indexing.html#attribute-access
  idx[0] = (indent + Series(idx[0]).astype(str)).values


D:\工作\模型脚本\ModelProject\selfmodule\toolmodule\dataprep.py:1051: UserWarning: Pandas doesn't allow columns to be created via a new attribute name - see https://pandas.pydata.org/pandas-docs/stable/indexing.html#attribute-access
  X_copy.y_carrier = y_carrier


D:\工作\模型脚本\ModelProject\selfmodule\toolmodule\dataprep.py:1356: UserWarning:     pipeline2 PsiTransformer data_timein 计算稳定性(区分正负例) ，2个字段稳定性>=psi_limit（0.1）：
gprs_flow_game    0.124106
max__call_use     0.100704
dtype: float64
  warnings.warn(s); time.sleep(seconds)


D:\工作\模型脚本\ModelProject\selfmodule\toolmodule\dataprep.py:453: UserWarning: Pandas doesn't allow columns to be created via a new attribute name - see https://pandas.pydata.org/pandas-docs/stable/indexing.html#attribute-access
  if hasattr(self, 'print_indent'):


D:\工作\模型脚本\ModelProject\selfmodule\toolmodule\dataprep.py:455: UserWarning: Pandas doesn't allow columns to be created via a new attribute name - see https://pandas.pydata.org/pandas-docs/stable/indexing.html#attribute-access
  else:


D:\工作\模型脚本\ModelProject\selfmodule\toolmodule\dataprep.py:344: UserWarning: Pandas doesn't allow columns to be created via a new attribute name - see https://pandas.pydata.org/pandas-docs/stable/indexing.html#attribute-access
  if isinstance(x, DataFrame):


D:\工作\模型脚本\ModelProject\selfmodule\toolmodule\dataprep.py:342: UserWarning: Pandas doesn't allow columns to be created via a new attribute name - see https://pandas.pydata.org/pandas-docs/stable/indexing.html#attribute-access
  idx[0] = (indent + Series(idx[0]).astype(str)).values


D:\工作\模型脚本\ModelProject\selfmodule\toolmodule\dataprep.py:1051: UserWarning: Pandas doesn't allow columns to be created via a new attribute name - see https://pandas.pydata.org/pandas-docs/stable/indexing.html#attribute-access
  X_copy.y_carrier = y_carrier


D:\工作\模型脚本\ModelProject\selfmodule\toolmodule\dataprep.py:1322: UserWarning:     pipeline2 PsiTransformer timedata_timeout 计算稳定性(不区分正负例)，27个字段稳定性>=psi_limit（0.1）：
max__monthsremain_last_stop_date         1.153147
avg__monthsremain_last_stop_date         0.796246
grow__gprs_resource                      0.504271
more0cnt__monthsremain_last_stop_date    0.489939
sep__gprs_resource                       0.436227
wave__monthsremain_last_stop_date        0.351832
moreq25cnt__arpu                         0.349840
grow__gprs_now_rest                      0.279717
min__gprs_now_defer                      0.250272
moreq25cnt__gprs_flow_4g                 0.229578
wave__gprs_now_defer                     0.210678
wave__gprs_flow_video                    0.196379
wave__gprs_flow_music                    0.193906
sep__gprs_flow_commu                     0.190730
wave__calling_cnt                        0.190178
wave__gprs_flow_commu                    0.186252
wave__gprs_flow_short                    0.176905
moreq25cnt__calling_diff_cnt             0.176247
wave__calling_dura                       0.161267
min__calling_cnt                         0.155631
min__gprs_last_defer                     0.140473
moreq25cnt__gprs_last_defer              0.137042
wave__gprs_now_rest                      0.128105
moreq25cnt__nos_calling                  0.127532
min__calling_diff_cnt                    0.111167
sep__gprs_now_rest                       0.108587
min__arpu                                0.103426
dtype: float64
  warnings.warn(s); time.sleep(seconds)


D:\工作\模型脚本\ModelProject\selfmodule\toolmodule\dataprep.py:1356: UserWarning:     pipeline2 PsiTransformer data_timeout 计算稳定性(区分正负例) ，40个字段稳定性>=psi_limit（0.1）：
max__monthsremain_last_stop_date         1.001304
avg__monthsremain_last_stop_date         0.745715
grow__gprs_resource                      0.532255
sep__gprs_resource                       0.523499
moreq25cnt__gprs_flow_4g                 0.433917
more0cnt__monthsremain_last_stop_date    0.427802
wave__monthsremain_last_stop_date        0.419017
moreq25cnt__arpu                         0.401877
min__calling_cnt                         0.374147
wave__gprs_flow_music                    0.347729
sep__gprs_flow_commu                     0.340718
moreq25cnt__calling_diff_cnt             0.336224
grow__gprs_now_rest                      0.335494
moreq25cnt__nos_calling                  0.317305
wave__gprs_flow_commu                    0.316552
min__nos_calling                         0.267509
moreq25cnt__nos_calling_diff             0.251359
min__calling_diff_cnt                    0.249624
min__gprs_resource                       0.243204
min__calling_dura                        0.227433
wave__calling_cnt                        0.222436
min__gprs_now_defer                      0.218448
wave__gprs_flow_short                    0.210312
wave__gprs_flow_video                    0.210274
min__nos_calling_diff                    0.209368
min__call_use                            0.209029
wave__gprs_now_defer                     0.189497
wave__calling_dura                       0.176647
min__calling_diff_dura                   0.174783
min__arpu                                0.153372
wave__gprs_now_rest                      0.149410
wave__calling_diff_cnt                   0.144374
min__gprs_last_defer                     0.119938
moreq25cnt__gprs_last_defer              0.117903
min__gprs_now_rest                       0.117550
sep__gprs_now_rest                       0.115566
min__gprs_flow_4g                        0.114703
std__nos_calling_diff                    0.107205
std__gprs_flow_commu                     0.101765
std__gprs_flow_4g                        0.101290
dtype: float64
  warnings.warn(s); time.sleep(seconds)


D:\Python for Windows\lib\site-packages\xgboost\sklearn.py:1224: UserWarning: The use of label encoder in XGBClassifier is deprecated and will be removed in a future release. To remove this warning, do the following: 1) Pass option use_label_encoder=False when constructing XGBClassifier object; and 2) Encode your labels (y) as integers starting with 0, i.e. 0, 1, 2, ..., [num_class - 1].
  warnings.warn(label_encoder_deprecation_msg, UserWarning)


D:\工作\模型脚本\ModelProject\selfmodule\toolmodule\dataprep.py:483: UserWarning:     FeaturePrefilter_DF unique_limit(5000)小于X行数(3000), 添加unique_limit_actual：len(X)*0.99=2970
  warnings.warn(s); time.sleep(seconds)


D:\工作\模型脚本\ModelProject\selfmodule\toolmodule\dataprep.py:995: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead.  To get a de-fragmented frame, use `newframe = frame.copy()`
  X_woe[i] = X[i].map(self.col_tabl_[i].woe)


D:\工作\模型脚本\ModelProject\selfmodule\toolmodule\dataprep.py:344: UserWarning: Pandas doesn't allow columns to be created via a new attribute name - see https://pandas.pydata.org/pandas-docs/stable/indexing.html#attribute-access
  if isinstance(x, DataFrame):


D:\工作\模型脚本\ModelProject\selfmodule\toolmodule\dataprep.py:342: UserWarning: Pandas doesn't allow columns to be created via a new attribute name - see https://pandas.pydata.org/pandas-docs/stable/indexing.html#attribute-access
  idx[0] = (indent + Series(idx[0]).astype(str)).values


D:\工作\模型脚本\ModelProject\selfmodule\toolmodule\dataprep.py:453: UserWarning: Pandas doesn't allow columns to be created via a new attribute name - see https://pandas.pydata.org/pandas-docs/stable/indexing.html#attribute-access
  if hasattr(self, 'print_indent'):


D:\工作\模型脚本\ModelProject\selfmodule\toolmodule\dataprep.py:455: UserWarning: Pandas doesn't allow columns to be created via a new attribute name - see https://pandas.pydata.org/pandas-docs/stable/indexing.html#attribute-access
  else:


D:\工作\模型脚本\ModelProject\selfmodule\toolmodule\dataprep.py:1051: UserWarning: Pandas doesn't allow columns to be created via a new attribute name - see https://pandas.pydata.org/pandas-docs/stable/indexing.html#attribute-access
  X_copy.y_carrier = y_carrier


D:\工作\模型脚本\ModelProject\selfmodule\toolmodule\dataprep.py:1356: UserWarning:     pipeline1 PsiTransformer data_timein 计算稳定性(区分正负例) ，2个字段稳定性>=psi_limit（0.1）：
gprs_flow_game    0.124106
max__call_use     0.100704
dtype: float64
  warnings.warn(s); time.sleep(seconds)


D:\工作\模型脚本\ModelProject\selfmodule\toolmodule\dataprep.py:1322: UserWarning:     pipeline1 PsiTransformer timedata_timeout 计算稳定性(不区分正负例)，39个字段稳定性>=psi_limit（0.1）：
max__monthsremain_last_stop_date         1.153147
avg__monthsremain_last_stop_date         0.708150
grow__gprs_resource                      0.504271
more0cnt__monthsremain_last_stop_date    0.489939
grow__calling_cnt                        0.474356
wave__gprs_flow_video                    0.459372
min__gprs_now_rest                       0.439512
sep__gprs_resource                       0.436254
sep__gprs_now_rest                       0.362695
wave__monthsremain_last_stop_date        0.351832
moreq25cnt__arpu                         0.349840
wave__gprs_now_rest                      0.322201
grow__gprs_now_rest                      0.305131
min__gprs_now_defer                      0.250272
moreq25cnt__gprs_flow_4g                 0.229578
moreq25cnt__calling_dura                 0.229498
sep__gprs_flow_commu                     0.216219
wave__gprs_now_defer                     0.210678
wave__gprs_flow_music                    0.209202
wave__calling_dura                       0.202171
more0cnt__nos_calling                    0.197366
wave__calling_cnt                        0.192988
min__arpu                                0.191410
grow__gprs_last_defer                    0.189959
wave__gprs_flow_commu                    0.186252
sep__nos_calling_diff                    0.180037
min__calling_dura                        0.178387
wave__gprs_flow_short                    0.176631
moreq25cnt__calling_diff_cnt             0.176247
moreq25cnt__calling_cnt                  0.175646
sep__gprs_flow_short                     0.167248
min__calling_cnt                         0.155631
moreq25cnt__call_use                     0.144666
min__gprs_last_defer                     0.144252
moreq25cnt__gprs_last_defer              0.137042
moreq25cnt__gprs_flow_music              0.133987
moreq25cnt__nos_calling                  0.127532
min__calling_diff_dura                   0.114422
min__calling_diff_cnt                    0.110715
dtype: float64
  warnings.warn(s); time.sleep(seconds)


D:\工作\模型脚本\ModelProject\selfmodule\toolmodule\dataprep.py:1356: UserWarning:     pipeline1 PsiTransformer data_timeout 计算稳定性(区分正负例) ，50个字段稳定性>=psi_limit（0.1）：
max__monthsremain_last_stop_date         1.001304
grow__calling_cnt                        0.792366
avg__monthsremain_last_stop_date         0.770429
sep__gprs_resource                       0.522291
grow__gprs_resource                      0.517305
min__gprs_now_rest                       0.472076
wave__gprs_flow_video                    0.463506
moreq25cnt__gprs_flow_4g                 0.433917
sep__gprs_flow_commu                     0.428960
more0cnt__monthsremain_last_stop_date    0.427802
wave__monthsremain_last_stop_date        0.419017
moreq25cnt__calling_dura                 0.403642
moreq25cnt__arpu                         0.401877
moreq25cnt__calling_cnt                  0.393855
min__calling_dura                        0.381505
min__calling_cnt                         0.374147
sep__gprs_now_rest                       0.368272
wave__gprs_flow_music                    0.352088
wave__gprs_now_rest                      0.339916
moreq25cnt__calling_diff_cnt             0.336224
more0cnt__nos_calling                    0.331887
min__calling_diff_cnt                    0.322031
sep__nos_calling_diff                    0.321767
moreq25cnt__nos_calling                  0.317305
wave__gprs_flow_commu                    0.316552
grow__gprs_now_rest                      0.305491
min__arpu                                0.268376
grow__gprs_last_defer                    0.267970
min__nos_calling                         0.267509
min__gprs_now_defer                      0.262001
min__gprs_resource                       0.258861
moreq25cnt__nos_calling_diff             0.251359
wave__gprs_now_defer                     0.232770
wave__calling_dura                       0.230065
wave__gprs_flow_short                    0.221312
min__calling_diff_dura                   0.215420
sep__gprs_flow_short                     0.213431
min__nos_calling_diff                    0.209368
wave__calling_cnt                        0.207441
moreq25cnt__gprs_flow_music              0.201679
moreq25cnt__call_use                     0.198730
wave__call_use                           0.179388
min__gprs_flow_4g                        0.177949
min__call_use                            0.164605
min__gprs_last_defer                     0.151450
moreq25cnt__gprs_last_defer              0.148284
wave__calling_diff_cnt                   0.144374
max__nos_calling_diff                    0.110085
std__nos_calling_diff                    0.107205
wave__gprs_last_defer                    0.100002
dtype: float64
  warnings.warn(s); time.sleep(seconds)


D:\Python for Windows\lib\site-packages\xgboost\sklearn.py:1224: UserWarning: The use of label encoder in XGBClassifier is deprecated and will be removed in a future release. To remove this warning, do the following: 1) Pass option use_label_encoder=False when constructing XGBClassifier object; and 2) Encode your labels (y) as integers starting with 0, i.e. 0, 1, 2, ..., [num_class - 1].
  warnings.warn(label_encoder_deprecation_msg, UserWarning)


D:\工作\模型脚本\ModelProject\selfmodule\toolmodule\dataprep.py:483: UserWarning:     FeaturePrefilter_DF unique_limit(5000)小于X行数(3000), 添加unique_limit_actual：len(X)*0.99=2970
  warnings.warn(s); time.sleep(seconds)


D:\工作\模型脚本\ModelProject\selfmodule\toolmodule\dataprep.py:995: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead.  To get a de-fragmented frame, use `newframe = frame.copy()`
  X_woe[i] = X[i].map(self.col_tabl_[i].woe)


D:\工作\模型脚本\ModelProject\selfmodule\toolmodule\dataprep.py:344: UserWarning: Pandas doesn't allow columns to be created via a new attribute name - see https://pandas.pydata.org/pandas-docs/stable/indexing.html#attribute-access
  if isinstance(x, DataFrame):


D:\工作\模型脚本\ModelProject\selfmodule\toolmodule\dataprep.py:342: UserWarning: Pandas doesn't allow columns to be created via a new attribute name - see https://pandas.pydata.org/pandas-docs/stable/indexing.html#attribute-access
  idx[0] = (indent + Series(idx[0]).astype(str)).values


D:\工作\模型脚本\ModelProject\selfmodule\toolmodule\dataprep.py:453: UserWarning: Pandas doesn't allow columns to be created via a new attribute name - see https://pandas.pydata.org/pandas-docs/stable/indexing.html#attribute-access
  if hasattr(self, 'print_indent'):


D:\工作\模型脚本\ModelProject\selfmodule\toolmodule\dataprep.py:453: UserWarning: Pandas doesn't allow columns to be created via a new attribute name - see https://pandas.pydata.org/pandas-docs/stable/indexing.html#attribute-access
  if hasattr(self, 'print_indent'):


D:\工作\模型脚本\ModelProject\selfmodule\toolmodule\dataprep.py:455: UserWarning: Pandas doesn't allow columns to be created via a new attribute name - see https://pandas.pydata.org/pandas-docs/stable/indexing.html#attribute-access
  else:


D:\工作\模型脚本\ModelProject\selfmodule\toolmodule\dataprep.py:344: UserWarning: Pandas doesn't allow columns to be created via a new attribute name - see https://pandas.pydata.org/pandas-docs/stable/indexing.html#attribute-access
  if isinstance(x, DataFrame):


D:\工作\模型脚本\ModelProject\selfmodule\toolmodule\dataprep.py:342: UserWarning: Pandas doesn't allow columns to be created via a new attribute name - see https://pandas.pydata.org/pandas-docs/stable/indexing.html#attribute-access
  idx[0] = (indent + Series(idx[0]).astype(str)).values


D:\工作\模型脚本\ModelProject\selfmodule\toolmodule\dataprep.py:1051: UserWarning: Pandas doesn't allow columns to be created via a new attribute name - see https://pandas.pydata.org/pandas-docs/stable/indexing.html#attribute-access
  X_copy.y_carrier = y_carrier


D:\工作\模型脚本\ModelProject\selfmodule\toolmodule\dataprep.py:1356: UserWarning:     pipeline2 PsiTransformer data_timein 计算稳定性(区分正负例) ，2个字段稳定性>=psi_limit（0.1）：
gprs_flow_game    0.124106
max__call_use     0.100704
dtype: float64
  warnings.warn(s); time.sleep(seconds)


D:\工作\模型脚本\ModelProject\selfmodule\toolmodule\dataprep.py:453: UserWarning: Pandas doesn't allow columns to be created via a new attribute name - see https://pandas.pydata.org/pandas-docs/stable/indexing.html#attribute-access
  if hasattr(self, 'print_indent'):


D:\工作\模型脚本\ModelProject\selfmodule\toolmodule\dataprep.py:455: UserWarning: Pandas doesn't allow columns to be created via a new attribute name - see https://pandas.pydata.org/pandas-docs/stable/indexing.html#attribute-access
  else:


D:\工作\模型脚本\ModelProject\selfmodule\toolmodule\dataprep.py:344: UserWarning: Pandas doesn't allow columns to be created via a new attribute name - see https://pandas.pydata.org/pandas-docs/stable/indexing.html#attribute-access
  if isinstance(x, DataFrame):


D:\工作\模型脚本\ModelProject\selfmodule\toolmodule\dataprep.py:342: UserWarning: Pandas doesn't allow columns to be created via a new attribute name - see https://pandas.pydata.org/pandas-docs/stable/indexing.html#attribute-access
  idx[0] = (indent + Series(idx[0]).astype(str)).values


D:\工作\模型脚本\ModelProject\selfmodule\toolmodule\dataprep.py:1051: UserWarning: Pandas doesn't allow columns to be created via a new attribute name - see https://pandas.pydata.org/pandas-docs/stable/indexing.html#attribute-access
  X_copy.y_carrier = y_carrier


D:\工作\模型脚本\ModelProject\selfmodule\toolmodule\dataprep.py:1322: UserWarning:     pipeline2 PsiTransformer timedata_timeout 计算稳定性(不区分正负例)，38个字段稳定性>=psi_limit（0.1）：
max__monthsremain_last_stop_date         1.153147
avg__monthsremain_last_stop_date         0.708150
grow__gprs_resource                      0.504271
more0cnt__monthsremain_last_stop_date    0.489939
grow__calling_cnt                        0.474356
wave__gprs_flow_video                    0.459372
sep__gprs_resource                       0.436254
wave__monthsremain_last_stop_date        0.351832
moreq25cnt__arpu                         0.349840
wave__gprs_now_rest                      0.322201
grow__gprs_now_rest                      0.305131
min__gprs_now_defer                      0.250272
moreq25cnt__gprs_flow_4g                 0.229578
moreq25cnt__calling_dura                 0.229498
sep__gprs_flow_commu                     0.216219
wave__gprs_now_defer                     0.210678
wave__gprs_flow_music                    0.209202
wave__calling_dura                       0.202171
more0cnt__nos_calling                    0.197366
wave__calling_cnt                        0.192988
min__arpu                                0.191410
grow__gprs_last_defer                    0.189959
wave__gprs_flow_commu                    0.186252
sep__nos_calling_diff                    0.180037
min__calling_dura                        0.178387
wave__gprs_flow_short                    0.176631
moreq25cnt__calling_diff_cnt             0.176247
moreq25cnt__calling_cnt                  0.175646
sep__gprs_flow_short                     0.167248
min__calling_cnt                         0.155631
moreq25cnt__call_use                     0.144666
min__gprs_last_defer                     0.144252
moreq25cnt__gprs_last_defer              0.137042
moreq25cnt__gprs_flow_music              0.133987
moreq25cnt__nos_calling                  0.127532
min__calling_diff_dura                   0.114422
min__calling_diff_cnt                    0.110715
sep__gprs_now_rest                       0.108587
dtype: float64
  warnings.warn(s); time.sleep(seconds)


D:\工作\模型脚本\ModelProject\selfmodule\toolmodule\dataprep.py:1356: UserWarning:     pipeline2 PsiTransformer data_timeout 计算稳定性(区分正负例) ，51个字段稳定性>=psi_limit（0.1）：
max__monthsremain_last_stop_date         1.001304
grow__calling_cnt                        0.792366
avg__monthsremain_last_stop_date         0.770429
sep__gprs_resource                       0.522291
grow__gprs_resource                      0.517305
wave__gprs_flow_video                    0.463506
moreq25cnt__gprs_flow_4g                 0.433917
sep__gprs_flow_commu                     0.428960
more0cnt__monthsremain_last_stop_date    0.427802
wave__monthsremain_last_stop_date        0.419017
moreq25cnt__calling_dura                 0.403642
moreq25cnt__arpu                         0.401877
moreq25cnt__calling_cnt                  0.393855
min__calling_dura                        0.381505
min__calling_cnt                         0.374147
wave__gprs_flow_music                    0.352088
wave__gprs_now_rest                      0.339916
moreq25cnt__calling_diff_cnt             0.336224
more0cnt__nos_calling                    0.331887
min__calling_diff_cnt                    0.322031
sep__nos_calling_diff                    0.321767
moreq25cnt__nos_calling                  0.317305
wave__gprs_flow_commu                    0.316552
grow__gprs_now_rest                      0.305491
min__arpu                                0.268376
grow__gprs_last_defer                    0.267970
min__nos_calling                         0.267509
min__gprs_now_defer                      0.262001
min__gprs_resource                       0.258861
moreq25cnt__nos_calling_diff             0.251359
wave__gprs_now_defer                     0.232770
wave__calling_dura                       0.230065
wave__gprs_flow_short                    0.221312
min__calling_diff_dura                   0.215420
sep__gprs_flow_short                     0.213431
min__nos_calling_diff                    0.209368
wave__calling_cnt                        0.207441
moreq25cnt__gprs_flow_music              0.201679
moreq25cnt__call_use                     0.198730
wave__call_use                           0.179388
min__gprs_flow_4g                        0.177949
min__call_use                            0.164605
min__gprs_last_defer                     0.151450
moreq25cnt__gprs_last_defer              0.148284
std__gprs_now_rest                       0.145550
wave__calling_diff_cnt                   0.144374
sep__gprs_now_rest                       0.123281
min__gprs_now_rest                       0.116123
max__nos_calling_diff                    0.110085
std__nos_calling_diff                    0.107205
wave__gprs_last_defer                    0.100002
dtype: float64
  warnings.warn(s); time.sleep(seconds)


D:\Python for Windows\lib\site-packages\xgboost\sklearn.py:1224: UserWarning: The use of label encoder in XGBClassifier is deprecated and will be removed in a future release. To remove this warning, do the following: 1) Pass option use_label_encoder=False when constructing XGBClassifier object; and 2) Encode your labels (y) as integers starting with 0, i.e. 0, 1, 2, ..., [num_class - 1].
  warnings.warn(label_encoder_deprecation_msg, UserWarning)


Traceback (most recent call last):
  File "D:\Python for Windows\lib\site-packages\IPython\core\interactiveshell.py", line 3296, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-156-e9f545c04e64>", line 1, in <module>
    train_res[model_name]
KeyError: '模型示例'
