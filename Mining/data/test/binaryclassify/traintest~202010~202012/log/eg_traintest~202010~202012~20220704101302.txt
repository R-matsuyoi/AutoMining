                   Out[11]: 20220704-10:14:02  'kehujingyingbudb.mid_eg_recent_test_202012'
20220704-10:14:17  开始时间：2022-07-04 10:14:17
20220704-10:14:17  参数设置：
                       Info.r_limit: 0.95
                       stage: create
                       step: test
                       Info.iv_limit: 0.05
                       Info.auto_pair2: False
                       Info.model_name: 模型示例
                       table_in: kehujingyingbudb.mid_eg_recent_test_202012

20220704-10:14:20  ------------------------- 读取数据: kehujingyingbudb.mid_eg_recent_test_202012 2022-07-04 10:14:20 -------------------------
20220704-10:14:20      src: gp
20220704-10:14:20      condition: None
20220704-10:14:20      col_need(40): ['user_acct_month', 'data_use', 'acct_month', 'phone_no_null', 'user_id', 'account_id', 'innet_months', 'sex_add', 'user_status', 'last_stop_date', 'dinner_fee', 'gprs_last_defer', 'gprs_resource', 'gprs_now_rest', 'call_use', 'if_nolimit', 'if_5g_dinner', 'arpu', 'calling_cnt', 'calling_dura', 'calling_diff_cnt', 'calling_diff_dura', 'gprs_flow_4g', 'gprs_flow_5g', 'gprs_now_defer', 'gprs_flow_roam', 'call_dura_roam', 'days_gprs', 'days_call', 'nos_calling', 'nos_calling_diff', 'sms_cnt', 'call_fee_local', 'gprs_flow_video', 'gprs_flow_short', 'gprs_flow_music', 'gprs_flow_commu', 'gprs_flow_game', 'dayvalue_gprs_flow', 'flag_eg']
20220704-10:14:20      col_del: None
20220704-10:14:20      col_char(11): ['user_acct_month', 'data_use', 'acct_month', 'phone_no_null', 'user_id', 'account_id', 'sex_add', 'user_status', 'if_nolimit', 'if_5g_dinner', 'flag_eg']
20220704-10:14:20      col_num(28): ['innet_months', 'dinner_fee', 'gprs_last_defer', 'gprs_resource', 'gprs_now_rest', 'call_use', 'arpu', 'calling_cnt', 'calling_dura', 'calling_diff_cnt', 'calling_diff_dura', 'gprs_flow_4g', 'gprs_flow_5g', 'gprs_now_defer', 'gprs_flow_roam', 'call_dura_roam', 'days_gprs', 'days_call', 'nos_calling', 'nos_calling_diff', 'sms_cnt', 'call_fee_local', 'gprs_flow_video', 'gprs_flow_short', 'gprs_flow_music', 'gprs_flow_commu', 'gprs_flow_game', 'dayvalue_gprs_flow']
20220704-10:14:20      col_date(1): ['last_stop_date']
20220704-10:14:20      nrows: None
20220704-10:14:20      if_coltolower: True
20220704-10:14:20      kwargs: {}

20220704-10:14:20      读取
20220704-10:14:21      shape: (2654, 40)

20220704-10:14:21  -------------------------读取完毕: (2654, 40) 2022-07-04 10:14:21 -------------------------

20220704-10:14:21  手动衍生_py7个字段: {'monthsremain_last_stop_date': '最后停机时间：剩余时长', 'days_call_p': '通话天数占比', 'days_call_p_1': '通话天数占比_1', 'days_call_p_2': '通话天数占比_2', 'days_call_p_3': '通话天数占比_3', 'days_call_p_4': '通话天数占比_4', 'greatest_gprs_app': 'app偏好'}
20220704-10:14:21  monthsremain_last_stop_date: last_stop_date - current_date
20220704-10:14:21  days_call_p: days_call / days_month
20220704-10:14:21  days_call_p_1: days_call_p + days_gprs
20220704-10:14:21  days_call_p_2: days_call_p_1 + days_gprs
20220704-10:14:21  days_call_p_3: days_call_p_2 + days_gprs
20220704-10:14:21  days_call_p_4: days_call_p_3 + days_gprs
20220704-10:14:21  greatest_gprs_app: {'gprs_flow_video': 'video', 'gprs_flow_short': 'short', 'gprs_flow_music': 'music', 'gprs_flow_commu': 'commu', 'gprs_flow_game': 'game'}
20220704-10:14:22  数据量: (2654, 47)

20220704-10:14:22  检查数据
20220704-10:14:22  各账期数据量分布：
                       202010  data_timeout    1000
                       202011  data_timeout    654
                       202012  data_timeout    1000
                       dtype: int64
20220704-10:14:22  各账期数据量不一致
20220704-10:14:22  以nan填充缺少账期的记录
20220704-10:14:22      修改后：
                       202010  data_timeout    1000
                       202011  data_timeout    1000
                       202012  data_timeout    1000
                       dtype: int64)
20220704-10:14:22  
                   diff_limitweiNone,不考察近n月字段各账期取值分布, dis_exam返回None！


20220704-10:14:22  填充数值型&类别型字段缺失值
20220704-10:14:22  日期型字段缺失值情况：
                       last_stop_date    346
                       dtype: int64

20220704-10:14:22  正负例分布：
                       data_timeout  202012  0    846
                       data_timeout  202012  1    154
                       dtype: int64

                   ----------------------------------------- 当月 类别型 onthot 
20220704-10:14:22  ['sex_add~女', 'sex_add~男']

                   ----------------------------------------- 当月 数值型&类别型 原始数据 
20220704-10:14:22  (1000, 36)
20220704-10:14:22  筛选衍生字段的 原始/手动衍生_sql 字段

                   ----------------------------------------- 近n月 数值型 近3月均值 
20220704-10:14:22  字段个数：22, 添加字段：None
20220704-10:14:22  (1000, 58)

                   ----------------------------------------- 近n月 数值型 近3月离散系数 
20220704-10:14:22  字段个数：10, 添加字段：None
20220704-10:14:22  (1000, 68)

                   ----------------------------------------- 近n月 数值型 近3月波动性 
20220704-10:14:22  字段个数：12, 添加字段：None
20220704-10:14:22  (1000, 80)

                   ----------------------------------------- 近n月 数值型 近3月成长率 
20220704-10:14:22  字段个数：14, 添加字段：None
20220704-10:14:22  (1000, 94)

                   ----------------------------------------- 近n月 数值型 近3月最大值 
20220704-10:14:22  字段个数：17, 添加字段：None
20220704-10:14:22  (1000, 111)

                   ----------------------------------------- 近n月 数值型 近3月最小值 
20220704-10:14:22  字段个数：21, 添加字段：None
20220704-10:14:22  (1000, 132)

                   ----------------------------------------- 近n月 数值型 近3月标准差 
20220704-10:14:22  字段个数：14, 添加字段：None
20220704-10:14:22  (1000, 146)

                   ----------------------------------------- 近n月 数值型 大于x的月份数 
20220704-10:14:22  ('more0cnt', '近3月大于0的月份数')
20220704-10:14:22  ('moreq25cnt', '近3月大于第一四分位数的月份数')
20220704-10:14:22  (1000, 165)

                   ----------------------------------------- 近n月 类别型 取某值的月份数 
20220704-10:14:22  字段个数：2, 添加字段：None
20220704-10:14:22  (1000, 167)

                   ----------------------------------------- 汇总最终宽表 
20220704-10:14:22  table.shape:(1000, 167)

20220704-10:14:22  保存宽表结果至：./binaryclassify/eg/traintest~202010~202012/test_data~202012.csv

20220704-10:14:22  计算字段之间的相关性系数
20220704-10:14:22  
                       count    11476.0
                       mean    0.157
                       std    0.183
                       min    0.0
                       25%    0.039
                       50%    0.092
                       75%    0.197
                       max    1.0
                       dtype: float64


                   ------------------------------- 计算宽表字段psi ------------------------------------ 
                    
                    20220704-10:14:22  my toolmodule.dataprep.PsiTransformer_DF transform
                    20220704-10:14:22      开始时间：2022-07-04 10:14:22
                    20220704-10:14:22      data in : (1000, 167)
                    20220704-10:14:22      self已带有id_X属性 2466191260808
                    20220704-10:14:22      首次从X获取id_X_new属性 1835834754552
                    20220704-10:14:22      data in2: (1000, 157)
                    20220704-10:14:22      对154个数值字段进行分箱：['innet_months', 'monthsremain_last_stop_date', 'gprs_last_defer', 'gprs_now_rest', 'call_use', 'arpu', 'calling_cnt', 'calling_dura', 'calling_diff_dura', 'gprs_flow_4g', 'gprs_flow_5g', 'gprs_flow_roam', 'call_dura_roam', 'days_call_p_4', 'nos_calling', 'nos_calling_diff', 'gprs_flow_video', 'gprs_flow_short', 'gprs_flow_music', 'gprs_flow_commu', 'gprs_flow_game', 'sex_add~女', 'sex_add~男', 'avg__gprs_flow_roam', 'avg__monthsremain_last_stop_date', 'avg__gprs_last_defer', 'avg__gprs_resource', 'avg__calling_diff_dura', 'avg__gprs_flow_video', 'avg__gprs_flow_5g', 'avg__nos_calling', 'avg__nos_calling_diff', 'avg__arpu', 'avg__calling_cnt', 'avg__gprs_flow_commu', 'avg__gprs_now_defer', 'avg__call_use', 'avg__gprs_flow_4g', 'avg__gprs_now_rest', 'avg__gprs_flow_music', 'avg__calling_diff_cnt', 'avg__gprs_flow_game', 'avg__call_dura_roam', 'avg__gprs_flow_short', 'avg__calling_dura', 'sep__gprs_resource', 'sep__calling_diff_dura', 'sep__gprs_flow_5g', 'sep__nos_calling', 'sep__nos_calling_diff', 'sep__gprs_flow_commu', 'sep__gprs_now_rest', 'sep__calling_diff_cnt', 'sep__gprs_flow_short', 'sep__calling_dura', 'wave__monthsremain_last_stop_date', 'wave__gprs_last_defer', 'wave__gprs_flow_video', 'wave__calling_cnt', 'wave__gprs_flow_commu', 'wave__gprs_now_defer', 'wave__call_use', 'wave__gprs_now_rest', 'wave__gprs_flow_music', 'wave__calling_diff_cnt', 'wave__gprs_flow_short', 'wave__calling_dura', 'grow__gprs_flow_roam', 'grow__gprs_last_defer', 'grow__gprs_resource', 'grow__calling_diff_dura', 'grow__gprs_flow_video', 'grow__dinner_fee', 'grow__gprs_flow_5g', 'grow__nos_calling', 'grow__nos_calling_diff', 'grow__calling_cnt', 'grow__call_use', 'grow__gprs_now_rest', 'grow__gprs_flow_music', 'grow__calling_diff_cnt', 'max__gprs_flow_roam', 'max__monthsremain_last_stop_date', 'max__gprs_last_defer', 'max__gprs_resource', 'max__calling_diff_dura', 'max__dinner_fee', 'max__nos_calling', 'max__nos_calling_diff', 'max__arpu', 'max__calling_cnt', 'max__gprs_flow_commu', 'max__call_use', 'max__gprs_now_rest', 'max__gprs_flow_music', 'max__calling_diff_cnt', 'max__call_dura_roam', 'max__calling_dura', 'min__gprs_flow_roam', 'min__gprs_last_defer', 'min__gprs_resource', 'min__calling_diff_dura', 'min__gprs_flow_video', 'min__gprs_flow_5g', 'min__nos_calling', 'min__nos_calling_diff', 'min__arpu', 'min__calling_cnt', 'min__gprs_flow_commu', 'min__gprs_now_defer', 'min__call_use', 'min__gprs_flow_4g', 'min__gprs_now_rest', 'min__gprs_flow_music', 'min__calling_diff_cnt', 'min__gprs_flow_game', 'min__call_dura_roam', 'min__gprs_flow_short', 'min__calling_dura', 'std__gprs_last_defer', 'std__gprs_resource', 'std__calling_diff_dura', 'std__gprs_flow_video', 'std__nos_calling', 'std__nos_calling_diff', 'std__calling_cnt', 'std__gprs_flow_commu', 'std__call_use', 'std__gprs_flow_4g', 'std__gprs_now_rest', 'std__calling_diff_cnt', 'std__call_dura_roam', 'std__calling_dura', 'more0cnt__monthsremain_last_stop_date', 'more0cnt__nos_calling', 'more0cnt__calling_dura', 'moreq25cnt__gprs_last_defer', 'moreq25cnt__gprs_resource', 'moreq25cnt__gprs_flow_video', 'moreq25cnt__gprs_flow_5g', 'moreq25cnt__nos_calling', 'moreq25cnt__nos_calling_diff', 'moreq25cnt__arpu', 'moreq25cnt__calling_cnt', 'moreq25cnt__gprs_flow_commu', 'moreq25cnt__call_use', 'moreq25cnt__gprs_flow_4g', 'moreq25cnt__gprs_flow_music', 'moreq25cnt__calling_diff_cnt', 'moreq25cnt__gprs_flow_game', 'moreq25cnt__gprs_flow_short', 'moreq25cnt__calling_dura', 'valuecnt__if_nolimit~是', 'valuecnt__if_5g_dinner~是']
                    20220704-10:14:23      timedata_timeout 计算稳定度（不区分正负例）：self.col_psi_all_
                    20220704-10:14:30      data_timeout 计算稳定度（区分正负例）：self.col_psi_PN_
                    20220704-10:14:44      data out: (1000, 157)
                    20220704-10:14:44      transform轨迹：PsiTransformer_DF(Ncase='0', Pcase='1', bins=None, col_ignore=None, fit_pop_all=False, precision=6, , psi_limit=0.1, trans_na_error=True, warn_mark=' PsiTransformer')
                    20220704-10:14:44      结束时间：2022-07-04 10:14:44 耗时(21s)
20220704-10:14:44  保存Psi至：./binaryclassify/eg/traintest~202010~202012/test_Psi~202010~202012.pkl
20220704-10:14:44  保存dis_exam至：./binaryclassify/eg/traintest~202010~202012/test_dis_exam~202012.pkl
20220704-10:14:44  结束时间：2022-07-04 10:14:44
20220704-10:14:44  耗时：26 s


D:\Python for Windows\lib\site-packages\pandas\core\apply.py:1101: UserWarning: stage取值为create时,r_limit, iv_limit参数无效，将被忽略
  convert=self.convert_dtype,


D:\Python for Windows\lib\site-packages\pandas\core\apply.py:1101: UserWarning:      PsiTransformer timedata_timeout 计算稳定性(不区分正负例) ['account_id']字段多出720个取值, .head(5):
                      old  new
field      value              
account_id 102196712  NaN  1.0
           102197121  NaN  1.0
           102223930  NaN  1.0
           102300686  NaN  1.0
           103604981  NaN  1.0
  convert=self.convert_dtype,


D:\Python for Windows\lib\site-packages\pandas\core\apply.py:1101: UserWarning:      PsiTransformer timedata_timeout 计算稳定性(不区分正负例)，40个字段稳定性>=psi_limit（0.1）：
max__monthsremain_last_stop_date         1.153147
avg__monthsremain_last_stop_date         0.708150
grow__gprs_resource                      0.504271
more0cnt__monthsremain_last_stop_date    0.489939
grow__calling_cnt                        0.474356
wave__gprs_flow_video                    0.459372
min__gprs_now_rest                       0.439512
sep__gprs_resource                       0.436254
sep__gprs_now_rest                       0.362695
wave__monthsremain_last_stop_date        0.351832
moreq25cnt__arpu                         0.349840
wave__gprs_now_rest                      0.322201
grow__gprs_now_rest                      0.305131
min__gprs_now_defer                      0.250272
moreq25cnt__gprs_flow_4g                 0.229578
moreq25cnt__calling_dura                 0.229498
sep__gprs_flow_commu                     0.216219
wave__gprs_now_defer                     0.210678
wave__gprs_flow_music                    0.209202
wave__calling_dura                       0.202171
more0cnt__nos_calling                    0.197366
wave__calling_cnt                        0.192988
min__arpu                                0.191410
grow__gprs_last_defer                    0.189959
wave__gprs_flow_commu                    0.186252
sep__nos_calling_diff                    0.180037
min__calling_dura                        0.178387
wave__gprs_flow_short                    0.176631
moreq25cnt__calling_diff_cnt             0.176247
moreq25cnt__calling_cnt                  0.175646
sep__gprs_flow_short                     0.167248
grow__nos_calling_diff                   0.156279
min__calling_cnt                         0.155631
moreq25cnt__call_use                     0.144666
min__gprs_last_defer                     0.144252
moreq25cnt__gprs_last_defer              0.137042
moreq25cnt__gprs_flow_music              0.133987
moreq25cnt__nos_calling                  0.127532
min__calling_diff_dura                   0.114422
min__calling_diff_cnt                    0.110715
dtype: float64
  convert=self.convert_dtype,


D:\Python for Windows\lib\site-packages\pandas\core\apply.py:1101: UserWarning:      PsiTransformer data_timeout 计算稳定性(区分正负例)-正例（1） ['account_id']字段多出547个取值, .head(5):
                      old  new
field      value              
account_id 102197121  NaN  1.0
           102223930  NaN  1.0
           102300686  NaN  1.0
           103676343  NaN  1.0
           103720758  NaN  1.0
  convert=self.convert_dtype,


D:\Python for Windows\lib\site-packages\pandas\core\apply.py:1101: UserWarning:      PsiTransformer data_timeout 计算稳定性(区分正负例)-负例（0） ['account_id']字段多出547个取值, .head(5):
                      old  new
field      value              
account_id 102197121  NaN  1.0
           102223930  NaN  1.0
           102300686  NaN  1.0
           103676343  NaN  1.0
           103720758  NaN  1.0
  convert=self.convert_dtype,


D:\Python for Windows\lib\site-packages\pandas\core\apply.py:1101: UserWarning:      PsiTransformer data_timeout 计算稳定性(区分正负例) ，52个字段稳定性>=psi_limit（0.1）：
max__monthsremain_last_stop_date         1.001304
grow__calling_cnt                        0.792366
avg__monthsremain_last_stop_date         0.770429
sep__gprs_resource                       0.522291
grow__gprs_resource                      0.517305
min__gprs_now_rest                       0.472076
wave__gprs_flow_video                    0.463506
moreq25cnt__gprs_flow_4g                 0.433917
sep__gprs_flow_commu                     0.428960
more0cnt__monthsremain_last_stop_date    0.427802
wave__monthsremain_last_stop_date        0.419017
moreq25cnt__calling_dura                 0.403642
moreq25cnt__arpu                         0.401877
moreq25cnt__calling_cnt                  0.393855
min__calling_dura                        0.381505
min__calling_cnt                         0.374147
sep__gprs_now_rest                       0.368272
wave__gprs_flow_music                    0.352088
wave__gprs_now_rest                      0.339916
moreq25cnt__calling_diff_cnt             0.336224
more0cnt__nos_calling                    0.331887
min__calling_diff_cnt                    0.322031
sep__nos_calling_diff                    0.321767
moreq25cnt__nos_calling                  0.317305
wave__gprs_flow_commu                    0.316552
grow__gprs_now_rest                      0.305491
min__arpu                                0.268376
grow__gprs_last_defer                    0.267970
min__nos_calling                         0.267509
min__gprs_now_defer                      0.262001
min__gprs_resource                       0.258861
moreq25cnt__nos_calling_diff             0.251359
wave__gprs_now_defer                     0.232770
wave__calling_dura                       0.230065
grow__nos_calling_diff                   0.226753
wave__gprs_flow_short                    0.221312
min__calling_diff_dura                   0.215420
sep__gprs_flow_short                     0.213431
min__nos_calling_diff                    0.209368
wave__calling_cnt                        0.207441
moreq25cnt__gprs_flow_music              0.201679
moreq25cnt__call_use                     0.198730
wave__call_use                           0.179388
min__gprs_flow_4g                        0.177949
min__call_use                            0.164605
min__gprs_last_defer                     0.151450
moreq25cnt__gprs_last_defer              0.148284
account_id                               0.147555
wave__calling_diff_cnt                   0.144374
max__nos_calling_diff                    0.110085
std__nos_calling_diff                    0.107205
wave__gprs_last_defer                    0.100002
dtype: float64
  convert=self.convert_dtype,
                   Out[13]: 20220704-10:16:36  
                   (            user_acct_month      data_use acct_month phone_no_null      user_id      account_id  innet_months user_status last_stop_date  monthsremain_last_stop_date  \
                    42092446959          202012  data_timeout     202012       unknown  42092446959         1821502         178.0   在网-正常     2020-09-19                         -2.0   
                    75564763855          202012  data_timeout     202012       unknown  75564763855        46300388         176.0   在网-正常     2020-10-03                         -2.0   
                    25441922073          202012  data_timeout     202012       unknown  25441922073         1384695         212.0   在网-正常     2018-12-31                        -23.0   
                    33515009301          202012  data_timeout     202012       unknown  33515009301  30100000000000          91.0   在网-正常     2018-09-16                        -27.0   
                    32908638670          202012  data_timeout     202012       unknown  32908638670       108114620         161.0   在网-正常     2015-09-19                        -63.0   
                    ...                     ...           ...        ...           ...          ...             ...           ...         ...            ...                          ...   
                    14242892282          202012  data_timeout     202012       unknown  14242892282        58894224         144.0   在网-正常     2020-08-09                         -4.0   
                    31752733091          202012  data_timeout     202012       unknown  31752733091         5452307         210.0   在网-正常     2018-03-09                        -33.0   
                    20205488482          202012  data_timeout     202012       unknown  20205488482         1424176         216.0   在网-正常     2019-06-03                        -18.0   
                    35526210401          202012  data_timeout     202012       unknown  35526210401         2753306         160.0   在网-正常     2019-02-06                        -22.0   
                    29890366873          202012  data_timeout     202012       unknown  29890366873         4620441         210.0   在网-正常     2019-11-04                        -13.0   
                    
                                 gprs_last_defer  gprs_now_rest  call_use   arpu  calling_cnt  ...  moreq25cnt__nos_calling  moreq25cnt__nos_calling_diff  moreq25cnt__arpu  moreq25cnt__calling_cnt  \
                    42092446959              0.0            9.0       0.0  22.20         10.0  ...                        2                             2                 2                        2   
                    75564763855              0.0           10.0       0.0  15.20          5.0  ...                        2                             3                 3                        2   
                    25441922073             40.0        81920.0       0.0  11.45          0.0  ...                        0                             0                 2                        0   
                    33515009301              0.0        29824.0       0.0  17.39         45.0  ...                        2                             2                 2                        2   
                    32908638670              0.0    104857600.0       5.0  88.11          2.0  ...                        2                             2                 2                        2   
                    ...                      ...            ...       ...    ...          ...  ...                      ...                           ...               ...                      ...   
                    14242892282           1024.0     12582357.0       0.0  40.00          0.0  ...                        1                             0                 3                        1   
                    31752733091           2280.0      3667993.0      46.0  33.00        118.0  ...                        2                             2                 2                        2   
                    20205488482              0.0           10.0       3.0   8.00          2.0  ...                        3                             3                 0                        3   
                    35526210401            100.0     10690530.0       0.0  21.57          6.0  ...                        2                             2                 2                        2   
                    29890366873              0.0            5.0       0.0   8.00          0.0  ...                        0                             0                 0                        0   
                    
                                 moreq25cnt__gprs_flow_commu  moreq25cnt__call_use  moreq25cnt__gprs_flow_4g  moreq25cnt__gprs_flow_music  moreq25cnt__calling_diff_cnt  moreq25cnt__gprs_flow_game  \
                    42092446959                            0                     0                         0                            0                             2                           0   
                    75564763855                            0                     0                         0                            0                             3                           0   
                    25441922073                            2                     0                         3                            0                             0                           0   
                    33515009301                            0                     0                         2                            0                             2                           0   
                    32908638670                            0                     2                         0                            0                             2                           0   
                    ...                                  ...                   ...                       ...                          ...                           ...                         ...   
                    14242892282                            1                     1                         3                            0                             0                           0   
                    31752733091                            2                     2                         2                            2                             2                           0   
                    20205488482                            0                     3                         0                            0                             3                           0   
                    35526210401                            0                     0                         2                            0                             2                           0   
                    29890366873                            0                     0                         2                            0                             0                           0   
                    
                                 moreq25cnt__gprs_flow_short  moreq25cnt__calling_dura  valuecnt__if_nolimit~是  valuecnt__if_5g_dinner~是  flag_eg  
                    42092446959                            0                         2                        0                          0        0  
                    75564763855                            0                         2                        0                          0        0  
                    25441922073                            0                         0                        0                          0        0  
                    33515009301                            0                         2                        0                          0        0  
                    32908638670                            0                         2                        0                          0        0  
                    ...                                  ...                       ...                      ...                        ...      ...  
                    14242892282                            0                         1                        0                          0        0  
                    31752733091                            2                         2                        0                          0        0  
                    20205488482                            0                         3                        0                          0        0  
                    35526210401                            0                         2                        0                          0        0  
                    29890366873                            0                         0                        0                          0        0  
                    
                    [1000 rows x 167 columns],
                    Infotuple(model_name='模型示例', month_train=202010, month_test=202012, Pcase_limit=1000, traintable_ratio=2, Pcumsum_limit=2, timein_count=500, timeout_limit=1000, trainproc_ratiolist=[1, 2, 10], iv_limit=0.05, r_limit=0.95, marketlevel=1, short_name='eg', table_XY='kehujingyingbudb.ml_xy_eg_m', s_field_base='s_yw_fake', condition_base='\n    phone_no_null is null and\n    last_stop_date is not null and\n    innet_months >= 3 and\n    dayvalue_gprs_flow>0\n    ', condition_add="user_status='在网-正常'", available_add='available_notzd', col_month='acct_month', col_id='user_id', col_target='flag_eg', Pcase='1', Ncase='0', target_lag=1, col_stratified=nan, col_out=['acct_month'], dict_sortscore={'sms_cnt': True, 'call_fee_local': False}, score_targetnull='Ncase', field_base=                     field_name                                                                    comment dtype_db dtype_classify     field_src  \
                    0                    acct_month                                               账期                           bigint         数值型          原始   
                    1                 phone_no_null                                           手机号码                          numeric         类别型          原始   
                    2                   phone_no_tm                                         模糊手机号                             text         类别型          原始   
                    3                       user_id                                           手机号id                             text         类别型          原始   
                    4                     dinner_id                                       主套餐策划id                             text         类别型          原始   
                    5                    account_id                                           帐户编号                          numeric         类别型          原始   
                    6                    innet_date                                           入网日期                             text         日期型          原始   
                    7                  innet_months                                           入网时长                           bigint         数值型          原始   
                    8                           age                                               年龄                           bigint         数值型          原始   
                    9                           sex                                               性别                             text         类别型          原始   
                    10                      age_add                               table_a_add测试字段1                          integer         数值型  手动衍生_sql   
                    11                      sex_add                               table_a_add测试字段2                             text         类别型  手动衍生_sql   
                    12                  user_status                                           用户状态                             text         类别型          原始   
                    13               last_stop_date                                       最后停机时间                             text         日期型          原始   
                    14  monthsaready_last_stop_date                           最后停机时间：已发生时长                          numeric         数值型   手动衍生_py   
                    15  monthsremain_last_stop_date                             最后停机时间：剩余时长                          numeric         数值型   手动衍生_py   
                    16                       dinner                                             主套餐                             text         类别型          原始   
                    17                   dinner_fee                                         套餐月租费                          numeric         数值型          原始   
                    18              gprs_last_defer                                       流量滚存资源                           bigint         数值型          原始   
                    19                gprs_resource                                   gprs国内资源总量                           bigint         数值型          原始   
                    20                gprs_now_rest                                   当月gprs资源余量                          numeric         数值型          原始   
                    21                     call_use                                     语音资源使用量                          numeric         数值型          原始   
                    22                   if_nolimit                             是否不限量套餐到达用户                             text         类别型          原始   
                    23                 if_5g_dinner                                         是否5g套餐                             text         类别型          原始   
                    24                   if_5g_term                                     是否5g终端客户                             text         类别型          原始   
                    25                        if_jt                                       是否集团成员                             text         类别型          原始   
                    26                  start_level                                       客户星级标识                             text         类别型          原始   
                    27                    cred_type                                       机主证件类型                             text         类别型          原始   
                    28                if_cred_multi                                        一证n号标识                           bigint         类别型          原始   
                    29                         arpu                                           当月arpu                          numeric         数值型          原始   
                    30                      pay_cnt                                         自充值次数                           bigint         数值型          原始   
                    31                      pay_fee                                         自充值额度                          numeric         数值型          原始   
                    32                 acct_balance                                           账户余额                          numeric         数值型          原始   
                    33                   term_model                                       终端品牌类型                             text         类别型          原始   
                    34                   term_brand                                           终端品牌                             text         类别型          原始   
                    35                    term_type                                           终端类型                             text         类别型          原始   
                    36                      sk_type                                           双卡类型                             text         类别型          原始   
                    37                  if_new_term                                       是否新机用户                             text         类别型          原始   
                    38                  calling_cnt                                       主叫通话次数                          numeric         数值型          原始   
                    39                 calling_dura                                   当月主叫通话时长                          numeric         数值型          原始   
                    40                   called_cnt                                       被叫通话次数                          numeric         数值型          原始   
                    41                  called_dura                                   当月被叫通话时长                          numeric         数值型          原始   
                    42             calling_diff_cnt                                   主叫异网通话次数                          numeric         数值型          原始   
                    43            calling_diff_dura                                 主叫异网通话分钟数                          numeric         数值型          原始   
                    44                    gprs_flow                                         gprs总流量                          numeric         数值型          原始   
                    46                 gprs_flow_4g                                         gprs4g流量                          numeric         数值型          原始   
                    47                 gprs_flow_5g                                        gprs 5g流量                          numeric         数值型          原始   
                    48               gprs_flow_busy                                     gprs-忙时-流量                          numeric         数值型          原始   
                    49               gprs_flow_idle                                     gprs-闲时-流量                          numeric         数值型          原始   
                    50               gprs_now_defer                                 可延递流量资源总量                          numeric         数值型          原始   
                    51               gprs_flow_roam                                 gprs-国内漫游-流量                          numeric         数值型          原始   
                    52               call_dura_roam                                      省际漫游-时长                          numeric         数值型          原始   
                    53                    days_roam                                       国内漫出天数                          numeric         数值型          原始   
                    54                  days_roam_p                              国内漫出天数/当月天数                          numeric         数值型   手动衍生_py   
                    55                gprs_flow_gat                               gprs-港澳台漫游-流量                          numeric         数值型          原始   
                    56                     days_gat                                    港澳台漫游-时长                          numeric         数值型          原始   
                    59                    days_gprs                                           上网天数                          numeric         数值型          原始   
                    60                  days_gprs_p                                       上网天数占比                          numeric         数值型   手动衍生_py   
                    61                    days_call                                           通话天数                          numeric         数值型          原始   
                    62                  days_call_p                                       通话天数占比                          numeric         数值型   手动衍生_py   
                    63                days_call_p_1                                     通话天数占比_1                          numeric         数值型   手动衍生_py   
                    64                days_call_p_2                                     通话天数占比_2                          numeric         数值型   手动衍生_py   
                    65                days_call_p_3                                     通话天数占比_3                          numeric         数值型   手动衍生_py   
                    66                days_call_p_4                                     通话天数占比_4                          numeric         数值型   手动衍生_py   
                    67                     nos_call                             用户通信对端手机号码数                          numeric         数值型          原始   
                    68                  nos_calling                               主叫通话对端号码个数                          numeric         数值型          原始   
                    69             nos_calling_diff                               主叫异网对端号码个数                          numeric         数值型          原始   
                    70                      sms_cnt                               短信-点对点短信-条数                          numeric         数值型          原始   
                    71               call_fee_local                                         本地通话费                          numeric         数值型          原始   
                    72                call_fee_roam                                         漫游通话费                          numeric         数值型          原始   
                    73                  gprs_income                                       流量出账收入                          numeric         数值型          原始   
                    74                     gprs_fee                                    流量出账-流量费                          numeric         数值型          原始   
                    75                     call_fee                                       套餐外语音费                          numeric         数值型          原始   
                    76              gprs_flow_video                                     视频类应用流量                          numeric         数值型          原始   
                    77              gprs_flow_short                                    小视频系app流量                          numeric         数值型          原始   
                    78              gprs_flow_music                                     音乐类应用流量                          numeric         数值型          原始   
                    79              gprs_flow_commu                                     通信类应用流量                          numeric         数值型          原始   
                    80               gprs_flow_game                                     游戏类应用流量                          numeric         数值型          原始   
                    81            greatest_gprs_app                                            app偏好                             text         类别型   手动衍生_py   
                    82    paste_dinner_innet_months                             主套餐、入网时长：交叉                          numeric         类别型   手动衍生_py   
                    83        dayvalue_calling_dura                                 次月dd日前主叫时长                          numeric         数值型          原始   
                    84           dayvalue_gprs_flow                               次月dd日前流量使用量                          numeric         数值型          原始   
                    85         dayvalue_user_status                                   次月dd日用户状态                             text         类别型          原始   
                    86       dayvalue_phone_no_null                                           次月dd日                          numeric         类别型          原始   
                    88                      flag_eg                          是否eg,模型示例的目标字段                          integer         数值型          原始   
                    89                     flag_eg2                        是否eg2,模型示例2的目标字段                             text         类别型          原始   
                    90                score_flag_eg                                     模型示例的分数                          numeric         数值型          原始   
                    91            ago_score_flag_eg                               模型示例的分数(历史)                          numeric         数值型   手动衍生_py   
                    92               score_flag_eg2                                    模型示例2的分数                          numeric         数值型          原始   
                    93           ago_score_flag_eg2                              模型示例2的分数(历史)                          numeric         数值型   手动衍生_py   
                    94                           rn  随机排序字段（为兼容解决内蒙古电信亚信平台随机抽样sql执行超时报错）......   bigint         数值型  手动衍生_sql   
                    95                     acct_day                                       日表账期字段                             text         类别型          其他   
                    
                                                               table available available_notzd available_zd                                            formula               remark must_remain  \
                    0     kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                    1     kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN       不参与自动衍生         NaN   
                    2     kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN       不参与自动衍生         NaN   
                    3     kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                    4     kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN   不参与当月自动衍生         NaN   
                    5     kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN   不参与当月自动衍生          是   
                    6     kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                    7     kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN  不参与近n月自动衍生         NaN   
                    8     kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                    9     kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                    10     kehujingyingbudb.ml_feature_add_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                    11     kehujingyingbudb.ml_feature_add_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                    12    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN          是   
                    13    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                    14                                        python       NaN             NaN          NaN                      current_date - last_stop_date                  NaN         NaN   
                    15                                        python       NaN             NaN          NaN                      last_stop_date - current_date                  NaN         NaN   
                    16    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                    17    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                    18    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN   不参与当月自动衍生         NaN   
                    19    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                    20    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                    21    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                    22    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                    23    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                    24    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                    25    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                    26    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                    27    kehujingyingbudb.ml_feature_info_yw_user_m       NaN          不可用          NaN                                                NaN                  NaN         NaN   
                    28    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                    29    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                    30    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                    31    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                    32    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                    33    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                    34    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                    35    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                    36    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN       不参与自动衍生         NaN   
                    37    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                    38    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                    39    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                    40    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                    41    kehujingyingbudb.ml_feature_info_yw_user_m       NaN          不可用          NaN                                                NaN                  NaN         NaN   
                    42    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                    43    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                    44    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                    46    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                    47    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                    48    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                    49    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                    50    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                    51    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                    52    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                    53    kehujingyingbudb.ml_feature_info_yw_user_m       NaN          不可用          NaN                                                NaN       不参与自动衍生         NaN   
                    54                                        python       NaN             NaN          NaN                             days_roam / days_month                  NaN         NaN   
                    55    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                    56    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                    59    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN       不参与自动衍生         NaN   
                    60                                        python       NaN             NaN          NaN                             days_gprs / days_month                  NaN         NaN   
                    61    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN       不参与自动衍生         NaN   
                    62                                        python       NaN             NaN          NaN                             days_call / days_month                  NaN         NaN   
                    63                                        python       NaN             NaN          NaN                            days_call_p + days_gprs                  NaN         NaN   
                    64                                        python       NaN             NaN          NaN                          days_call_p_1 + days_gprs                  NaN         NaN   
                    65                                        python       NaN             NaN          NaN                          days_call_p_2 + days_gprs                  NaN         NaN   
                    66                                        python       NaN             NaN          NaN                          days_call_p_3 + days_gprs                  NaN          是   
                    67    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                    68    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                    69    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                    70    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                    71    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                    72    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                    73    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                    74    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                    75    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                    76    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                    77    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN          是   
                    78    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN          是   
                    79    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN          是   
                    80    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN          是   
                    81                                        python       NaN             NaN          NaN  {'gprs_flow_video': 'video', 'gprs_flow_short'...                  NaN          是   
                    82                                        python       NaN             NaN          NaN                             (dinner, innet_months)                  NaN         NaN   
                    83  kehujingyingbudb.ml_feature_info_yw_user_day       NaN          不可用       不可用                                                NaN                  NaN         NaN   
                    84  kehujingyingbudb.ml_feature_info_yw_user_day       NaN          不可用       不可用                                                NaN                  NaN         NaN   
                    85  kehujingyingbudb.ml_feature_info_yw_user_day       NaN          不可用       不可用                                                NaN                  NaN         NaN   
                    86  kehujingyingbudb.ml_feature_info_yw_user_day       NaN          不可用       不可用                                                NaN                  NaN         NaN   
                    88     kehujingyingbudb.ml_target_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                    89     kehujingyingbudb.ml_target_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                    90            kehujingyingbudb.table_score_month       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                    91                                        python       NaN             NaN          NaN                              {'notago_tovalue': 1}                  NaN         NaN   
                    92            kehujingyingbudb.table_score_month       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                    93                                        python       NaN             NaN          NaN                              {'notago_tovalue': 1}                  NaN         NaN   
                    94                                           sql       NaN             NaN          NaN                                                NaN       不参与自动衍生         NaN   
                    95  kehujingyingbudb.ml_feature_info_yw_user_day       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                    
                       into_model is_cause  
                    0         NaN       否  
                    1        删除       否  
                    2        删除       否  
                    3         NaN       否  
                    4         NaN       否  
                    5         NaN       否  
                    6        删除       否  
                    7         NaN      NaN  
                    8         NaN      NaN  
                    9         NaN       否  
                    10        NaN      NaN  
                    11        NaN      NaN  
                    12        NaN      NaN  
                    13       删除       否  
                    14        NaN      NaN  
                    15        NaN      NaN  
                    16        NaN      NaN  
                    17        NaN      NaN  
                    18        NaN      NaN  
                    19        NaN      NaN  
                    20        NaN      NaN  
                    21        NaN      NaN  
                    22        NaN      NaN  
                    23        NaN      NaN  
                    24        NaN      NaN  
                    25        NaN      NaN  
                    26        NaN      NaN  
                    27        NaN      NaN  
                    28        NaN      NaN  
                    29        NaN      NaN  
                    30        NaN      NaN  
                    31        NaN      NaN  
                    32        NaN      NaN  
                    33        NaN      NaN  
                    34        NaN      NaN  
                    35        NaN      NaN  
                    36        NaN      NaN  
                    37        NaN      NaN  
                    38        NaN      NaN  
                    39        NaN      NaN  
                    40        NaN      NaN  
                    41        NaN      NaN  
                    42        NaN      NaN  
                    43        NaN      NaN  
                    44        NaN      NaN  
                    46        NaN      NaN  
                    47        NaN      NaN  
                    48        NaN      NaN  
                    49        NaN      NaN  
                    50        NaN      NaN  
                    51        NaN      NaN  
                    52        NaN      NaN  
                    53       删除      NaN  
                    54        NaN      NaN  
                    55        NaN      NaN  
                    56        NaN      NaN  
                    59       删除      NaN  
                    60        NaN      NaN  
                    61       删除      NaN  
                    62        NaN      NaN  
                    63        NaN      NaN  
                    64        NaN      NaN  
                    65        NaN      NaN  
                    66        NaN      NaN  
                    67        NaN      NaN  
                    68        NaN      NaN  
                    69        NaN      NaN  
                    70        NaN      NaN  
                    71        NaN      NaN  
                    72        NaN      NaN  
                    73        NaN      NaN  
                    74        NaN      NaN  
                    75        NaN      NaN  
                    76        NaN      NaN  
                    77        NaN      NaN  
                    78        NaN      NaN  
                    79        NaN      NaN  
                    80        NaN      NaN  
                    81        NaN      NaN  
                    82        NaN      NaN  
                    83        NaN      NaN  
                    84        NaN      NaN  
                    85        NaN      NaN  
                    86        NaN      NaN  
                    88       删除      NaN  
                    89       删除      NaN  
                    90       删除      NaN  
                    91        NaN      NaN  
                    92       删除      NaN  
                    93        NaN      NaN  
                    94       删除      NaN  
                    95        NaN      NaN  , condition="user_status='在网-正常' and \n    phone_no_null is null and\n    last_stop_date is not null and\n    innet_months >= 3 and\n    dayvalue_gprs_flow>0\n", month_tabexp=202010, model_wd_traintest='./binaryclassify/eg/traintest~202010~202012', f_field_comment='./binaryclassify/eg/traintest~202010~202012/tabexp_col_obj~202010.pkl', col_del=['user_acct_month', 'rn'], table_train='./binaryclassify/eg/traintest~202010~202012/train_data~202010.csv', table_test='./binaryclassify/eg/traintest~202010~202012/test_data~202012.csv', freq_limit=0.95, unique_limit=5000, valuecount_limit=50, random_state=None, n_recent=3, auto_pair2=False, diff_limit=None, table_psi=True, table_r=True, col_mark=['user_acct_month', 'data_use', 'acct_month', 'user_id'], dis_train_total={'count': 68000, 'Pcount': 8036, 'prop': 0.118}, dis_train_sample={'count': 3500, 'Pcount': 1077, 'prop': 0.308}, supply_must={'gprs_flow_music', 'user_status', 'days_call_p_4', 'greatest_gprs_app', 'account_id'}, supply_other={'call_fee_local', 'dayvalue_gprs_flow', 'phone_no_null', 'sms_cnt', 'last_stop_date'}, comment_all= 是否宽表字段                               field_name                                                                    comment dtype_db dtype_classify     field_src  \
                               是                          user_acct_month                                     观察期最后账期                              NaN         类别型  手动衍生_sql   
                               是                                 data_use                                         数据集名称                              NaN         类别型  手动衍生_sql   
                               是                               acct_month                                               账期                           bigint         类别型  手动衍生_sql   
                               是                            phone_no_null                                           手机号码                          numeric         类别型          原始   
                               否                              phone_no_tm                                         模糊手机号                             text         类别型          原始   
                               是                                  user_id                                           手机号id                             text         类别型          原始   
                               否                                dinner_id                                       主套餐策划id                             text         类别型          原始   
                               是                               account_id                                           帐户编号                          numeric         类别型          原始   
                               否                               innet_date                                           入网日期                             text         日期型          原始   
                               是                             innet_months                                           入网时长                           bigint         数值型          原始   
                               否                                      age                                               年龄                           bigint         数值型          原始   
                               否                                      sex                                               性别                             text         类别型          原始   
                               否                                  age_add                               table_a_add测试字段1                          integer         数值型  手动衍生_sql   
                               否                                  sex_add                               table_a_add测试字段2                             text         类别型  手动衍生_sql   
                               是                              user_status                                           用户状态                             text         类别型          原始   
                               是                           last_stop_date                                       最后停机时间                             text         日期型          原始   
                               否              monthsaready_last_stop_date                           最后停机时间：已发生时长                          numeric         数值型   手动衍生_py   
                               是              monthsremain_last_stop_date                             最后停机时间：剩余时长                          numeric         数值型   手动衍生_py   
                               否                                   dinner                                             主套餐                             text         类别型          原始   
                               否                               dinner_fee                                         套餐月租费                          numeric         数值型          原始   
                               是                          gprs_last_defer                                       流量滚存资源                           bigint         数值型          原始   
                               否                            gprs_resource                                   gprs国内资源总量                           bigint         数值型          原始   
                               是                            gprs_now_rest                                   当月gprs资源余量                          numeric         数值型          原始   
                               是                                 call_use                                     语音资源使用量                          numeric         数值型          原始   
                               否                               if_nolimit                             是否不限量套餐到达用户                             text         类别型          原始   
                               否                             if_5g_dinner                                         是否5g套餐                             text         类别型          原始   
                               否                               if_5g_term                                     是否5g终端客户                             text         类别型          原始   
                               否                                    if_jt                                       是否集团成员                             text         类别型          原始   
                               否                              start_level                                       客户星级标识                             text         类别型          原始   
                               否                                cred_type                                       机主证件类型                             text         类别型          原始   
                               否                            if_cred_multi                                        一证n号标识                           bigint         类别型          原始   
                               是                                     arpu                                           当月arpu                          numeric         数值型          原始   
                               否                                  pay_cnt                                         自充值次数                           bigint         数值型          原始   
                               否                                  pay_fee                                         自充值额度                          numeric         数值型          原始   
                               否                             acct_balance                                           账户余额                          numeric         数值型          原始   
                               否                               term_model                                       终端品牌类型                             text         类别型          原始   
                               否                               term_brand                                           终端品牌                             text         类别型          原始   
                               否                                term_type                                           终端类型                             text         类别型          原始   
                               否                                  sk_type                                           双卡类型                             text         类别型          原始   
                               否                              if_new_term                                       是否新机用户                             text         类别型          原始   
                               是                              calling_cnt                                       主叫通话次数                          numeric         数值型          原始   
                               是                             calling_dura                                   当月主叫通话时长                          numeric         数值型          原始   
                               否                               called_cnt                                       被叫通话次数                          numeric         数值型          原始   
                               否                              called_dura                                   当月被叫通话时长                          numeric         数值型          原始   
                               否                         calling_diff_cnt                                   主叫异网通话次数                          numeric         数值型          原始   
                               是                        calling_diff_dura                                 主叫异网通话分钟数                          numeric         数值型          原始   
                               否                                gprs_flow                                         gprs总流量                          numeric         数值型          原始   
                               是                             gprs_flow_4g                                         gprs4g流量                          numeric         数值型          原始   
                               是                             gprs_flow_5g                                        gprs 5g流量                          numeric         数值型          原始   
                               否                           gprs_flow_busy                                     gprs-忙时-流量                          numeric         数值型          原始   
                               否                           gprs_flow_idle                                     gprs-闲时-流量                          numeric         数值型          原始   
                               否                           gprs_now_defer                                 可延递流量资源总量                          numeric         数值型          原始   
                               是                           gprs_flow_roam                                 gprs-国内漫游-流量                          numeric         数值型          原始   
                               是                           call_dura_roam                                      省际漫游-时长                          numeric         数值型          原始   
                               否                                days_roam                                       国内漫出天数                          numeric         数值型          原始   
                               否                              days_roam_p                              国内漫出天数/当月天数                          numeric         数值型   手动衍生_py   
                               否                            gprs_flow_gat                               gprs-港澳台漫游-流量                          numeric         数值型          原始   
                               否                                 days_gat                                    港澳台漫游-时长                          numeric         数值型          原始   
                               否                                days_gprs                                           上网天数                          numeric         数值型          原始   
                               否                              days_gprs_p                                       上网天数占比                          numeric         数值型   手动衍生_py   
                               否                                days_call                                           通话天数                          numeric         数值型          原始   
                               否                              days_call_p                                       通话天数占比                          numeric         数值型   手动衍生_py   
                               否                            days_call_p_1                                     通话天数占比_1                          numeric         数值型   手动衍生_py   
                               否                            days_call_p_2                                     通话天数占比_2                          numeric         数值型   手动衍生_py   
                               否                            days_call_p_3                                     通话天数占比_3                          numeric         数值型   手动衍生_py   
                               是                            days_call_p_4                                     通话天数占比_4                          numeric         数值型   手动衍生_py   
                               否                                 nos_call                             用户通信对端手机号码数                          numeric         数值型          原始   
                               是                              nos_calling                               主叫通话对端号码个数                          numeric         数值型          原始   
                               是                         nos_calling_diff                               主叫异网对端号码个数                          numeric         数值型          原始   
                               是                                  sms_cnt                               短信-点对点短信-条数                          numeric         数值型          原始   
                               是                           call_fee_local                                         本地通话费                          numeric         数值型          原始   
                               否                            call_fee_roam                                         漫游通话费                          numeric         数值型          原始   
                               否                              gprs_income                                       流量出账收入                          numeric         数值型          原始   
                               否                                 gprs_fee                                    流量出账-流量费                          numeric         数值型          原始   
                               否                                 call_fee                                       套餐外语音费                          numeric         数值型          原始   
                               是                          gprs_flow_video                                     视频类应用流量                          numeric         数值型          原始   
                               是                          gprs_flow_short                                    小视频系app流量                          numeric         数值型          原始   
                               是                          gprs_flow_music                                     音乐类应用流量                          numeric         数值型          原始   
                               是                          gprs_flow_commu                                     通信类应用流量                          numeric         数值型          原始   
                               是                           gprs_flow_game                                     游戏类应用流量                          numeric         数值型          原始   
                               是                        greatest_gprs_app                                            app偏好                             text         类别型   手动衍生_py   
                               否                paste_dinner_innet_months                             主套餐、入网时长：交叉                          numeric         类别型   手动衍生_py   
                               否                    dayvalue_calling_dura                                 次月dd日前主叫时长                          numeric         数值型          原始   
                               是                       dayvalue_gprs_flow                               次月dd日前流量使用量                          numeric         数值型          原始   
                               否                     dayvalue_user_status                                   次月dd日用户状态                             text         类别型          原始   
                               否                   dayvalue_phone_no_null                                           次月dd日                          numeric         类别型          原始   
                               否                                 flag_eg2                        是否eg2,模型示例2的目标字段                             text         类别型          原始   
                               否                            score_flag_eg                                     模型示例的分数                          numeric         数值型          原始   
                               否                        ago_score_flag_eg                               模型示例的分数(历史)                          numeric         数值型   手动衍生_py   
                               否                           score_flag_eg2                                    模型示例2的分数                          numeric         数值型          原始   
                               否                       ago_score_flag_eg2                              模型示例2的分数(历史)                          numeric         数值型   手动衍生_py   
                               否                                       rn  随机排序字段（为兼容解决内蒙古电信亚信平台随机抽样sql执行超时报错）......   bigint         数值型  手动衍生_sql   
                               是                               sex_add~女                 table_a_add测试字段2：取值是否为女                              NaN         数值型   自动衍生_py   
                               是                               sex_add~男                 table_a_add测试字段2：取值是否为男                              NaN         数值型   自动衍生_py   
                               否                            if_nolimit~是               是否不限量套餐到达用户：取值是否为是                              NaN         数值型   自动衍生_py   
                               否                          if_5g_dinner~是                           是否5g套餐：取值是否为是                              NaN         数值型   自动衍生_py   
                               是                      avg__gprs_flow_roam                      gprs-国内漫游-流量：近3月均值                              NaN         数值型   自动衍生_py   
                               是         avg__monthsremain_last_stop_date                  最后停机时间：剩余时长：近3月均值                              NaN         数值型   自动衍生_py   
                               是                     avg__gprs_last_defer                            流量滚存资源：近3月均值                              NaN         数值型   自动衍生_py   
                               是                       avg__gprs_resource                        gprs国内资源总量：近3月均值                              NaN         数值型   自动衍生_py   
                               是                   avg__calling_diff_dura                      主叫异网通话分钟数：近3月均值                              NaN         数值型   自动衍生_py   
                               是                     avg__gprs_flow_video                          视频类应用流量：近3月均值                              NaN         数值型   自动衍生_py   
                               否                          avg__dinner_fee                              套餐月租费：近3月均值                              NaN         数值型   自动衍生_py   
                               是                        avg__gprs_flow_5g                             gprs 5g流量：近3月均值                              NaN         数值型   自动衍生_py   
                               是                         avg__nos_calling                    主叫通话对端号码个数：近3月均值                              NaN         数值型   自动衍生_py   
                               是                    avg__nos_calling_diff                    主叫异网对端号码个数：近3月均值                              NaN         数值型   自动衍生_py   
                               是                                avg__arpu                                当月arpu：近3月均值                              NaN         数值型   自动衍生_py   
                               是                         avg__calling_cnt                            主叫通话次数：近3月均值                              NaN         数值型   自动衍生_py   
                               是                     avg__gprs_flow_commu                          通信类应用流量：近3月均值                              NaN         数值型   自动衍生_py   
                               是                      avg__gprs_now_defer                      可延递流量资源总量：近3月均值                              NaN         数值型   自动衍生_py   
                               是                            avg__call_use                          语音资源使用量：近3月均值                              NaN         数值型   自动衍生_py   
                               是                        avg__gprs_flow_4g                              gprs4g流量：近3月均值                              NaN         数值型   自动衍生_py   
                               是                       avg__gprs_now_rest                        当月gprs资源余量：近3月均值                              NaN         数值型   自动衍生_py   
                               是                     avg__gprs_flow_music                          音乐类应用流量：近3月均值                              NaN         数值型   自动衍生_py   
                               是                    avg__calling_diff_cnt                        主叫异网通话次数：近3月均值                              NaN         数值型   自动衍生_py   
                               是                      avg__gprs_flow_game                          游戏类应用流量：近3月均值                              NaN         数值型   自动衍生_py   
                               是                      avg__call_dura_roam                           省际漫游-时长：近3月均值                              NaN         数值型   自动衍生_py   
                               是                     avg__gprs_flow_short                         小视频系app流量：近3月均值                              NaN         数值型   自动衍生_py   
                               是                        avg__calling_dura                        当月主叫通话时长：近3月均值                              NaN         数值型   自动衍生_py   
                               否                      sep__gprs_flow_roam                  gprs-国内漫游-流量：近3月离散系数                              NaN         数值型   自动衍生_py   
                               否         sep__monthsremain_last_stop_date              最后停机时间：剩余时长：近3月离散系数                              NaN         数值型   自动衍生_py   
                               否                     sep__gprs_last_defer                        流量滚存资源：近3月离散系数                              NaN         数值型   自动衍生_py   
                               是                       sep__gprs_resource                    gprs国内资源总量：近3月离散系数                              NaN         数值型   自动衍生_py   
                               是                   sep__calling_diff_dura                  主叫异网通话分钟数：近3月离散系数                              NaN         数值型   自动衍生_py   
                               否                     sep__gprs_flow_video                      视频类应用流量：近3月离散系数                              NaN         数值型   自动衍生_py   
                               否                          sep__dinner_fee                          套餐月租费：近3月离散系数                              NaN         数值型   自动衍生_py   
                               是                        sep__gprs_flow_5g                         gprs 5g流量：近3月离散系数                              NaN         数值型   自动衍生_py   
                               是                         sep__nos_calling                主叫通话对端号码个数：近3月离散系数                              NaN         数值型   自动衍生_py   
                               是                    sep__nos_calling_diff                主叫异网对端号码个数：近3月离散系数                              NaN         数值型   自动衍生_py   
                               否                                sep__arpu                            当月arpu：近3月离散系数                              NaN         数值型   自动衍生_py   
                               否                         sep__calling_cnt                        主叫通话次数：近3月离散系数                              NaN         数值型   自动衍生_py   
                               是                     sep__gprs_flow_commu                      通信类应用流量：近3月离散系数                              NaN         数值型   自动衍生_py   
                               否                      sep__gprs_now_defer                  可延递流量资源总量：近3月离散系数                              NaN         数值型   自动衍生_py   
                               否                            sep__call_use                      语音资源使用量：近3月离散系数                              NaN         数值型   自动衍生_py   
                               否                        sep__gprs_flow_4g                          gprs4g流量：近3月离散系数                              NaN         数值型   自动衍生_py   
                               是                       sep__gprs_now_rest                    当月gprs资源余量：近3月离散系数                              NaN         数值型   自动衍生_py   
                               否                     sep__gprs_flow_music                      音乐类应用流量：近3月离散系数                              NaN         数值型   自动衍生_py   
                               是                    sep__calling_diff_cnt                    主叫异网通话次数：近3月离散系数                              NaN         数值型   自动衍生_py   
                               否                      sep__gprs_flow_game                      游戏类应用流量：近3月离散系数                              NaN         数值型   自动衍生_py   
                               否                      sep__call_dura_roam                       省际漫游-时长：近3月离散系数                              NaN         数值型   自动衍生_py   
                               是                     sep__gprs_flow_short                     小视频系app流量：近3月离散系数                              NaN         数值型   自动衍生_py   
                               是                        sep__calling_dura                    当月主叫通话时长：近3月离散系数                              NaN         数值型   自动衍生_py   
                               否                     wave__gprs_flow_roam                    gprs-国内漫游-流量：近3月波动性                              NaN         数值型   自动衍生_py   
                               是        wave__monthsremain_last_stop_date                最后停机时间：剩余时长：近3月波动性                              NaN         数值型   自动衍生_py   
                               是                    wave__gprs_last_defer                          流量滚存资源：近3月波动性                              NaN         数值型   自动衍生_py   
                               否                      wave__gprs_resource                      gprs国内资源总量：近3月波动性                              NaN         数值型   自动衍生_py   
                               否                  wave__calling_diff_dura                    主叫异网通话分钟数：近3月波动性                              NaN         数值型   自动衍生_py   
                               是                    wave__gprs_flow_video                        视频类应用流量：近3月波动性                              NaN         数值型   自动衍生_py   
                               否                         wave__dinner_fee                            套餐月租费：近3月波动性                              NaN         数值型   自动衍生_py   
                               否                       wave__gprs_flow_5g                           gprs 5g流量：近3月波动性                              NaN         数值型   自动衍生_py   
                               否                        wave__nos_calling                  主叫通话对端号码个数：近3月波动性                              NaN         数值型   自动衍生_py   
                               否                   wave__nos_calling_diff                  主叫异网对端号码个数：近3月波动性                              NaN         数值型   自动衍生_py   
                               否                               wave__arpu                              当月arpu：近3月波动性                              NaN         数值型   自动衍生_py   
                               是                        wave__calling_cnt                          主叫通话次数：近3月波动性                              NaN         数值型   自动衍生_py   
                               是                    wave__gprs_flow_commu                        通信类应用流量：近3月波动性                              NaN         数值型   自动衍生_py   
                               是                     wave__gprs_now_defer                    可延递流量资源总量：近3月波动性                              NaN         数值型   自动衍生_py   
                               是                           wave__call_use                        语音资源使用量：近3月波动性                              NaN         数值型   自动衍生_py   
                               否                       wave__gprs_flow_4g                            gprs4g流量：近3月波动性                              NaN         数值型   自动衍生_py   
                               是                      wave__gprs_now_rest                      当月gprs资源余量：近3月波动性                              NaN         数值型   自动衍生_py   
                               是                    wave__gprs_flow_music                        音乐类应用流量：近3月波动性                              NaN         数值型   自动衍生_py   
                               是                   wave__calling_diff_cnt                      主叫异网通话次数：近3月波动性                              NaN         数值型   自动衍生_py   
                               否                     wave__gprs_flow_game                        游戏类应用流量：近3月波动性                              NaN         数值型   自动衍生_py   
                               否                     wave__call_dura_roam                         省际漫游-时长：近3月波动性                              NaN         数值型   自动衍生_py   
                               是                    wave__gprs_flow_short                       小视频系app流量：近3月波动性                              NaN         数值型   自动衍生_py   
                               是                       wave__calling_dura                      当月主叫通话时长：近3月波动性                              NaN         数值型   自动衍生_py   
                               是                     grow__gprs_flow_roam                    gprs-国内漫游-流量：近3月成长率                              NaN         数值型   自动衍生_py   
                               否        grow__monthsremain_last_stop_date                最后停机时间：剩余时长：近3月成长率                              NaN         数值型   自动衍生_py   
                               是                    grow__gprs_last_defer                          流量滚存资源：近3月成长率                              NaN         数值型   自动衍生_py   
                               是                      grow__gprs_resource                      gprs国内资源总量：近3月成长率                              NaN         数值型   自动衍生_py   
                               是                  grow__calling_diff_dura                    主叫异网通话分钟数：近3月成长率                              NaN         数值型   自动衍生_py   
                               是                    grow__gprs_flow_video                        视频类应用流量：近3月成长率                              NaN         数值型   自动衍生_py   
                               是                         grow__dinner_fee                            套餐月租费：近3月成长率                              NaN         数值型   自动衍生_py   
                               是                       grow__gprs_flow_5g                           gprs 5g流量：近3月成长率                              NaN         数值型   自动衍生_py   
                               是                        grow__nos_calling                  主叫通话对端号码个数：近3月成长率                              NaN         数值型   自动衍生_py   
                               是                   grow__nos_calling_diff                  主叫异网对端号码个数：近3月成长率                              NaN         数值型   自动衍生_py   
                               否                               grow__arpu                              当月arpu：近3月成长率                              NaN         数值型   自动衍生_py   
                               是                        grow__calling_cnt                          主叫通话次数：近3月成长率                              NaN         数值型   自动衍生_py   
                               否                    grow__gprs_flow_commu                        通信类应用流量：近3月成长率                              NaN         数值型   自动衍生_py   
                               否                     grow__gprs_now_defer                    可延递流量资源总量：近3月成长率                              NaN         数值型   自动衍生_py   
                               是                           grow__call_use                        语音资源使用量：近3月成长率                              NaN         数值型   自动衍生_py   
                               否                       grow__gprs_flow_4g                            gprs4g流量：近3月成长率                              NaN         数值型   自动衍生_py   
                               是                      grow__gprs_now_rest                      当月gprs资源余量：近3月成长率                              NaN         数值型   自动衍生_py   
                               是                    grow__gprs_flow_music                        音乐类应用流量：近3月成长率                              NaN         数值型   自动衍生_py   
                               是                   grow__calling_diff_cnt                      主叫异网通话次数：近3月成长率                              NaN         数值型   自动衍生_py   
                               否                     grow__gprs_flow_game                        游戏类应用流量：近3月成长率                              NaN         数值型   自动衍生_py   
                               否                     grow__call_dura_roam                         省际漫游-时长：近3月成长率                              NaN         数值型   自动衍生_py   
                               否                    grow__gprs_flow_short                       小视频系app流量：近3月成长率                              NaN         数值型   自动衍生_py   
                               否                       grow__calling_dura                      当月主叫通话时长：近3月成长率                              NaN         数值型   自动衍生_py   
                               是                      max__gprs_flow_roam                    gprs-国内漫游-流量：近3月最大值                              NaN         数值型   自动衍生_py   
                               是         max__monthsremain_last_stop_date                最后停机时间：剩余时长：近3月最大值                              NaN         数值型   自动衍生_py   
                               是                     max__gprs_last_defer                          流量滚存资源：近3月最大值                              NaN         数值型   自动衍生_py   
                               是                       max__gprs_resource                      gprs国内资源总量：近3月最大值                              NaN         数值型   自动衍生_py   
                               是                   max__calling_diff_dura                    主叫异网通话分钟数：近3月最大值                              NaN         数值型   自动衍生_py   
                               否                     max__gprs_flow_video                        视频类应用流量：近3月最大值                              NaN         数值型   自动衍生_py   
                               是                          max__dinner_fee                            套餐月租费：近3月最大值                              NaN         数值型   自动衍生_py   
                               否                        max__gprs_flow_5g                           gprs 5g流量：近3月最大值                              NaN         数值型   自动衍生_py   
                               是                         max__nos_calling                  主叫通话对端号码个数：近3月最大值                              NaN         数值型   自动衍生_py   
                               是                    max__nos_calling_diff                  主叫异网对端号码个数：近3月最大值                              NaN         数值型   自动衍生_py   
                               是                                max__arpu                              当月arpu：近3月最大值                              NaN         数值型   自动衍生_py   
                               是                         max__calling_cnt                          主叫通话次数：近3月最大值                              NaN         数值型   自动衍生_py   
                               是                     max__gprs_flow_commu                        通信类应用流量：近3月最大值                              NaN         数值型   自动衍生_py   
                               否                      max__gprs_now_defer                    可延递流量资源总量：近3月最大值                              NaN         数值型   自动衍生_py   
                               是                            max__call_use                        语音资源使用量：近3月最大值                              NaN         数值型   自动衍生_py   
                               否                        max__gprs_flow_4g                            gprs4g流量：近3月最大值                              NaN         数值型   自动衍生_py   
                               是                       max__gprs_now_rest                      当月gprs资源余量：近3月最大值                              NaN         数值型   自动衍生_py   
                               是                     max__gprs_flow_music                        音乐类应用流量：近3月最大值                              NaN         数值型   自动衍生_py   
                               是                    max__calling_diff_cnt                      主叫异网通话次数：近3月最大值                              NaN         数值型   自动衍生_py   
                               否                      max__gprs_flow_game                        游戏类应用流量：近3月最大值                              NaN         数值型   自动衍生_py   
                               是                      max__call_dura_roam                         省际漫游-时长：近3月最大值                              NaN         数值型   自动衍生_py   
                               否                     max__gprs_flow_short                       小视频系app流量：近3月最大值                              NaN         数值型   自动衍生_py   
                               是                        max__calling_dura                      当月主叫通话时长：近3月最大值                              NaN         数值型   自动衍生_py   
                               是                      min__gprs_flow_roam                    gprs-国内漫游-流量：近3月最小值                              NaN         数值型   自动衍生_py   
                               否         min__monthsremain_last_stop_date                最后停机时间：剩余时长：近3月最小值                              NaN         数值型   自动衍生_py   
                               是                     min__gprs_last_defer                          流量滚存资源：近3月最小值                              NaN         数值型   自动衍生_py   
                               是                       min__gprs_resource                      gprs国内资源总量：近3月最小值                              NaN         数值型   自动衍生_py   
                               是                   min__calling_diff_dura                    主叫异网通话分钟数：近3月最小值                              NaN         数值型   自动衍生_py   
                               是                     min__gprs_flow_video                        视频类应用流量：近3月最小值                              NaN         数值型   自动衍生_py   
                               否                          min__dinner_fee                            套餐月租费：近3月最小值                              NaN         数值型   自动衍生_py   
                               是                        min__gprs_flow_5g                           gprs 5g流量：近3月最小值                              NaN         数值型   自动衍生_py   
                               是                         min__nos_calling                  主叫通话对端号码个数：近3月最小值                              NaN         数值型   自动衍生_py   
                               是                    min__nos_calling_diff                  主叫异网对端号码个数：近3月最小值                              NaN         数值型   自动衍生_py   
                               是                                min__arpu                              当月arpu：近3月最小值                              NaN         数值型   自动衍生_py   
                               是                         min__calling_cnt                          主叫通话次数：近3月最小值                              NaN         数值型   自动衍生_py   
                               是                     min__gprs_flow_commu                        通信类应用流量：近3月最小值                              NaN         数值型   自动衍生_py   
                               是                      min__gprs_now_defer                    可延递流量资源总量：近3月最小值                              NaN         数值型   自动衍生_py   
                               是                            min__call_use                        语音资源使用量：近3月最小值                              NaN         数值型   自动衍生_py   
                               是                        min__gprs_flow_4g                            gprs4g流量：近3月最小值                              NaN         数值型   自动衍生_py   
                               是                       min__gprs_now_rest                      当月gprs资源余量：近3月最小值                              NaN         数值型   自动衍生_py   
                               是                     min__gprs_flow_music                        音乐类应用流量：近3月最小值                              NaN         数值型   自动衍生_py   
                               是                    min__calling_diff_cnt                      主叫异网通话次数：近3月最小值                              NaN         数值型   自动衍生_py   
                               是                      min__gprs_flow_game                        游戏类应用流量：近3月最小值                              NaN         数值型   自动衍生_py   
                               是                      min__call_dura_roam                         省际漫游-时长：近3月最小值                              NaN         数值型   自动衍生_py   
                               是                     min__gprs_flow_short                       小视频系app流量：近3月最小值                              NaN         数值型   自动衍生_py   
                               是                        min__calling_dura                      当月主叫通话时长：近3月最小值                              NaN         数值型   自动衍生_py   
                               否                      std__gprs_flow_roam                    gprs-国内漫游-流量：近3月标准差                              NaN         数值型   自动衍生_py   
                               否         std__monthsremain_last_stop_date                最后停机时间：剩余时长：近3月标准差                              NaN         数值型   自动衍生_py   
                               是                     std__gprs_last_defer                          流量滚存资源：近3月标准差                              NaN         数值型   自动衍生_py   
                               是                       std__gprs_resource                      gprs国内资源总量：近3月标准差                              NaN         数值型   自动衍生_py   
                               是                   std__calling_diff_dura                    主叫异网通话分钟数：近3月标准差                              NaN         数值型   自动衍生_py   
                               是                     std__gprs_flow_video                        视频类应用流量：近3月标准差                              NaN         数值型   自动衍生_py   
                               否                          std__dinner_fee                            套餐月租费：近3月标准差                              NaN         数值型   自动衍生_py   
                               否                        std__gprs_flow_5g                           gprs 5g流量：近3月标准差                              NaN         数值型   自动衍生_py   
                               是                         std__nos_calling                  主叫通话对端号码个数：近3月标准差                              NaN         数值型   自动衍生_py   
                               是                    std__nos_calling_diff                  主叫异网对端号码个数：近3月标准差                              NaN         数值型   自动衍生_py   
                               否                                std__arpu                              当月arpu：近3月标准差                              NaN         数值型   自动衍生_py   
                               是                         std__calling_cnt                          主叫通话次数：近3月标准差                              NaN         数值型   自动衍生_py   
                               是                     std__gprs_flow_commu                        通信类应用流量：近3月标准差                              NaN         数值型   自动衍生_py   
                               否                      std__gprs_now_defer                    可延递流量资源总量：近3月标准差                              NaN         数值型   自动衍生_py   
                               是                            std__call_use                        语音资源使用量：近3月标准差                              NaN         数值型   自动衍生_py   
                               是                        std__gprs_flow_4g                            gprs4g流量：近3月标准差                              NaN         数值型   自动衍生_py   
                               是                       std__gprs_now_rest                      当月gprs资源余量：近3月标准差                              NaN         数值型   自动衍生_py   
                               否                     std__gprs_flow_music                        音乐类应用流量：近3月标准差                              NaN         数值型   自动衍生_py   
                               是                    std__calling_diff_cnt                      主叫异网通话次数：近3月标准差                              NaN         数值型   自动衍生_py   
                               否                      std__gprs_flow_game                        游戏类应用流量：近3月标准差                              NaN         数值型   自动衍生_py   
                               是                      std__call_dura_roam                         省际漫游-时长：近3月标准差                              NaN         数值型   自动衍生_py   
                               否                     std__gprs_flow_short                       小视频系app流量：近3月标准差                              NaN         数值型   自动衍生_py   
                               是                        std__calling_dura                      当月主叫通话时长：近3月标准差                              NaN         数值型   自动衍生_py   
                               否                 more0cnt__gprs_flow_roam             gprs-国内漫游-流量：近3月大于0的月份数                              NaN         数值型   自动衍生_py   
                               是    more0cnt__monthsremain_last_stop_date         最后停机时间：剩余时长：近3月大于0的月份数                              NaN         数值型   自动衍生_py   
                               否                more0cnt__gprs_last_defer                   流量滚存资源：近3月大于0的月份数                              NaN         数值型   自动衍生_py   
                               否                  more0cnt__gprs_resource               gprs国内资源总量：近3月大于0的月份数                              NaN         数值型   自动衍生_py   
                               否              more0cnt__calling_diff_dura             主叫异网通话分钟数：近3月大于0的月份数                              NaN         数值型   自动衍生_py   
                               否                more0cnt__gprs_flow_video                 视频类应用流量：近3月大于0的月份数                              NaN         数值型   自动衍生_py   
                               否                     more0cnt__dinner_fee                     套餐月租费：近3月大于0的月份数                              NaN         数值型   自动衍生_py   
                               否                   more0cnt__gprs_flow_5g                    gprs 5g流量：近3月大于0的月份数                              NaN         数值型   自动衍生_py   
                               是                    more0cnt__nos_calling           主叫通话对端号码个数：近3月大于0的月份数                              NaN         数值型   自动衍生_py   
                               否               more0cnt__nos_calling_diff           主叫异网对端号码个数：近3月大于0的月份数                              NaN         数值型   自动衍生_py   
                               否                           more0cnt__arpu                       当月arpu：近3月大于0的月份数                              NaN         数值型   自动衍生_py   
                               否                    more0cnt__calling_cnt                   主叫通话次数：近3月大于0的月份数                              NaN         数值型   自动衍生_py   
                               否                more0cnt__gprs_flow_commu                 通信类应用流量：近3月大于0的月份数                              NaN         数值型   自动衍生_py   
                               否                 more0cnt__gprs_now_defer             可延递流量资源总量：近3月大于0的月份数                              NaN         数值型   自动衍生_py   
                               否                       more0cnt__call_use                 语音资源使用量：近3月大于0的月份数                              NaN         数值型   自动衍生_py   
                               否                   more0cnt__gprs_flow_4g                     gprs4g流量：近3月大于0的月份数                              NaN         数值型   自动衍生_py   
                               否                  more0cnt__gprs_now_rest               当月gprs资源余量：近3月大于0的月份数                              NaN         数值型   自动衍生_py   
                               否                more0cnt__gprs_flow_music                 音乐类应用流量：近3月大于0的月份数                              NaN         数值型   自动衍生_py   
                               否               more0cnt__calling_diff_cnt               主叫异网通话次数：近3月大于0的月份数                              NaN         数值型   自动衍生_py   
                               否                 more0cnt__gprs_flow_game                 游戏类应用流量：近3月大于0的月份数                              NaN         数值型   自动衍生_py   
                               否                 more0cnt__call_dura_roam                  省际漫游-时长：近3月大于0的月份数                              NaN         数值型   自动衍生_py   
                               否                more0cnt__gprs_flow_short                小视频系app流量：近3月大于0的月份数                              NaN         数值型   自动衍生_py   
                               是                   more0cnt__calling_dura               当月主叫通话时长：近3月大于0的月份数                              NaN         数值型   自动衍生_py   
                               否               moreq25cnt__gprs_flow_roam  gprs-国内漫游-流量：近3月大于第一四分位数的月份数                              NaN         数值型   自动衍生_py   
                               否  moreq25cnt__monthsremain_last_stop_date  最后停机时间：剩余时长：近3月大于第一四分位数的月份数......                    NaN         数值型   自动衍生_py   
                               是              moreq25cnt__gprs_last_defer        流量滚存资源：近3月大于第一四分位数的月份数                              NaN         数值型   自动衍生_py   
                               是                moreq25cnt__gprs_resource    gprs国内资源总量：近3月大于第一四分位数的月份数                              NaN         数值型   自动衍生_py   
                               否            moreq25cnt__calling_diff_dura  主叫异网通话分钟数：近3月大于第一四分位数的月份数                              NaN         数值型   自动衍生_py   
                               是              moreq25cnt__gprs_flow_video      视频类应用流量：近3月大于第一四分位数的月份数                              NaN         数值型   自动衍生_py   
                               否                   moreq25cnt__dinner_fee          套餐月租费：近3月大于第一四分位数的月份数                              NaN         数值型   自动衍生_py   
                               是                 moreq25cnt__gprs_flow_5g         gprs 5g流量：近3月大于第一四分位数的月份数                              NaN         数值型   自动衍生_py   
                               是                  moreq25cnt__nos_calling  主叫通话对端号码个数：近3月大于第一四分位数的月份数......                      NaN         数值型   自动衍生_py   
                               是             moreq25cnt__nos_calling_diff  主叫异网对端号码个数：近3月大于第一四分位数的月份数......                      NaN         数值型   自动衍生_py   
                               是                         moreq25cnt__arpu            当月arpu：近3月大于第一四分位数的月份数                              NaN         数值型   自动衍生_py   
                               是                  moreq25cnt__calling_cnt        主叫通话次数：近3月大于第一四分位数的月份数                              NaN         数值型   自动衍生_py   
                               是              moreq25cnt__gprs_flow_commu      通信类应用流量：近3月大于第一四分位数的月份数                              NaN         数值型   自动衍生_py   
                               否               moreq25cnt__gprs_now_defer  可延递流量资源总量：近3月大于第一四分位数的月份数                              NaN         数值型   自动衍生_py   
                               是                     moreq25cnt__call_use      语音资源使用量：近3月大于第一四分位数的月份数                              NaN         数值型   自动衍生_py   
                               是                 moreq25cnt__gprs_flow_4g          gprs4g流量：近3月大于第一四分位数的月份数                              NaN         数值型   自动衍生_py   
                               否                moreq25cnt__gprs_now_rest    当月gprs资源余量：近3月大于第一四分位数的月份数                              NaN         数值型   自动衍生_py   
                               是              moreq25cnt__gprs_flow_music      音乐类应用流量：近3月大于第一四分位数的月份数                              NaN         数值型   自动衍生_py   
                               是             moreq25cnt__calling_diff_cnt    主叫异网通话次数：近3月大于第一四分位数的月份数                              NaN         数值型   自动衍生_py   
                               是               moreq25cnt__gprs_flow_game      游戏类应用流量：近3月大于第一四分位数的月份数                              NaN         数值型   自动衍生_py   
                               否               moreq25cnt__call_dura_roam       省际漫游-时长：近3月大于第一四分位数的月份数                              NaN         数值型   自动衍生_py   
                               是              moreq25cnt__gprs_flow_short     小视频系app流量：近3月大于第一四分位数的月份数                              NaN         数值型   自动衍生_py   
                               是                 moreq25cnt__calling_dura    当月主叫通话时长：近3月大于第一四分位数的月份数                              NaN         数值型   自动衍生_py   
                               否                     valuecnt__sex_add~女        table_a_add测试字段2：近3月取值为女的月份数                              NaN         数值型   自动衍生_py   
                               否                     valuecnt__sex_add~男        table_a_add测试字段2：近3月取值为男的月份数                              NaN         数值型   自动衍生_py   
                               是                  valuecnt__if_nolimit~是      是否不限量套餐到达用户：近3月取值为是的月份数                              NaN         数值型   自动衍生_py   
                               是                valuecnt__if_5g_dinner~是                  是否5g套餐：近3月取值为是的月份数                              NaN         数值型   自动衍生_py   
                               是                                  flag_eg                                           预测目标                          integer         类别型  手动衍生_sql   
                    
                                                             table available available_notzd available_zd                                            formula               remark must_remain  \
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                        kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                        kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN       不参与自动衍生         NaN   
                        kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN       不参与自动衍生         NaN   
                        kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                        kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN   不参与当月自动衍生         NaN   
                        kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN   不参与当月自动衍生          是   
                        kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                        kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN  不参与近n月自动衍生         NaN   
                        kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                        kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                         kehujingyingbudb.ml_feature_add_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                         kehujingyingbudb.ml_feature_add_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                        kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN          是   
                        kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                            python       NaN             NaN          NaN                      current_date - last_stop_date                  NaN         NaN   
                                                            python       NaN             NaN          NaN                      last_stop_date - current_date                  NaN         NaN   
                        kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                        kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                        kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN   不参与当月自动衍生         NaN   
                        kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                        kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                        kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                        kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                        kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                        kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                        kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                        kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                        kehujingyingbudb.ml_feature_info_yw_user_m       NaN          不可用          NaN                                                NaN                  NaN         NaN   
                        kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                        kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                        kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                        kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                        kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                        kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                        kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                        kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                        kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN       不参与自动衍生         NaN   
                        kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                        kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                        kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                        kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                        kehujingyingbudb.ml_feature_info_yw_user_m       NaN          不可用          NaN                                                NaN                  NaN         NaN   
                        kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                        kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                        kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                        kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                        kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                        kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                        kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                        kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                        kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                        kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                        kehujingyingbudb.ml_feature_info_yw_user_m       NaN          不可用          NaN                                                NaN       不参与自动衍生         NaN   
                                                            python       NaN             NaN          NaN                             days_roam / days_month                  NaN         NaN   
                        kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                        kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                        kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN       不参与自动衍生         NaN   
                                                            python       NaN             NaN          NaN                             days_gprs / days_month                  NaN         NaN   
                        kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN       不参与自动衍生         NaN   
                                                            python       NaN             NaN          NaN                             days_call / days_month                  NaN         NaN   
                                                            python       NaN             NaN          NaN                            days_call_p + days_gprs                  NaN         NaN   
                                                            python       NaN             NaN          NaN                          days_call_p_1 + days_gprs                  NaN         NaN   
                                                            python       NaN             NaN          NaN                          days_call_p_2 + days_gprs                  NaN         NaN   
                                                            python       NaN             NaN          NaN                          days_call_p_3 + days_gprs                  NaN          是   
                        kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                        kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                        kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                        kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                        kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                        kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                        kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                        kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                        kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                        kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                        kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN          是   
                        kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN          是   
                        kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN          是   
                        kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN          是   
                                                            python       NaN             NaN          NaN  {'gprs_flow_video': 'video', 'gprs_flow_short'...                  NaN          是   
                                                            python       NaN             NaN          NaN                             (dinner, innet_months)                  NaN         NaN   
                      kehujingyingbudb.ml_feature_info_yw_user_day       NaN          不可用       不可用                                                NaN                  NaN         NaN   
                      kehujingyingbudb.ml_feature_info_yw_user_day       NaN          不可用       不可用                                                NaN                  NaN         NaN   
                      kehujingyingbudb.ml_feature_info_yw_user_day       NaN          不可用       不可用                                                NaN                  NaN         NaN   
                      kehujingyingbudb.ml_feature_info_yw_user_day       NaN          不可用       不可用                                                NaN                  NaN         NaN   
                         kehujingyingbudb.ml_target_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                kehujingyingbudb.table_score_month       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                            python       NaN             NaN          NaN                              {'notago_tovalue': 1}                  NaN         NaN   
                                kehujingyingbudb.table_score_month       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                            python       NaN             NaN          NaN                              {'notago_tovalue': 1}                  NaN         NaN   
                                                               sql       NaN             NaN          NaN                                                NaN       不参与自动衍生         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                                                               NaN       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                         kehujingyingbudb.ml_target_info_yw_user_m       NaN             NaN          NaN                                                NaN                  NaN         NaN   
                    
                     into_model is_cause                                          base_init  
                            NaN      NaN                                    user_acct_month  
                            NaN      NaN                                           data_use  
                            NaN       否                                         acct_month  
                           删除       否                                      phone_no_null  
                           删除       否                                        phone_no_tm  
                            NaN       否                                            user_id  
                            NaN       否                                          dinner_id  
                            NaN       否                                         account_id  
                           删除       否                                         innet_date  
                            NaN      NaN                                       innet_months  
                            NaN      NaN                                                age  
                            NaN       否                                                sex  
                            NaN      NaN                                            age_add  
                            NaN      NaN                                            sex_add  
                            NaN      NaN                                        user_status  
                           删除       否                                     last_stop_date  
                            NaN      NaN                                   [last_stop_date]  
                            NaN      NaN                                   [last_stop_date]  
                            NaN      NaN                                             dinner  
                            NaN      NaN                                         dinner_fee  
                            NaN      NaN                                    gprs_last_defer  
                            NaN      NaN                                      gprs_resource  
                            NaN      NaN                                      gprs_now_rest  
                            NaN      NaN                                           call_use  
                            NaN      NaN                                         if_nolimit  
                            NaN      NaN                                       if_5g_dinner  
                            NaN      NaN                                         if_5g_term  
                            NaN      NaN                                              if_jt  
                            NaN      NaN                                        start_level  
                            NaN      NaN                                          cred_type  
                            NaN      NaN                                      if_cred_multi  
                            NaN      NaN                                               arpu  
                            NaN      NaN                                            pay_cnt  
                            NaN      NaN                                            pay_fee  
                            NaN      NaN                                       acct_balance  
                            NaN      NaN                                         term_model  
                            NaN      NaN                                         term_brand  
                            NaN      NaN                                          term_type  
                            NaN      NaN                                            sk_type  
                            NaN      NaN                                        if_new_term  
                            NaN      NaN                                        calling_cnt  
                            NaN      NaN                                       calling_dura  
                            NaN      NaN                                         called_cnt  
                            NaN      NaN                                        called_dura  
                            NaN      NaN                                   calling_diff_cnt  
                            NaN      NaN                                  calling_diff_dura  
                            NaN      NaN                                          gprs_flow  
                            NaN      NaN                                       gprs_flow_4g  
                            NaN      NaN                                       gprs_flow_5g  
                            NaN      NaN                                     gprs_flow_busy  
                            NaN      NaN                                     gprs_flow_idle  
                            NaN      NaN                                     gprs_now_defer  
                            NaN      NaN                                     gprs_flow_roam  
                            NaN      NaN                                     call_dura_roam  
                           删除      NaN                                          days_roam  
                            NaN      NaN                                                NaN  
                            NaN      NaN                                      gprs_flow_gat  
                            NaN      NaN                                           days_gat  
                           删除      NaN                                          days_gprs  
                            NaN      NaN                                        [days_gprs]  
                           删除      NaN                                          days_call  
                            NaN      NaN                                        [days_call]  
                            NaN      NaN                [days_call_p, days_gprs, days_call]  
                            NaN      NaN  [days_call_p_1, days_gprs, days_call_p, days_c...  
                            NaN      NaN  [days_call_p_2, days_gprs, days_call_p_1, days...  
                            NaN      NaN  [days_call_p_3, days_gprs, days_call_p_2, days...  
                            NaN      NaN                                           nos_call  
                            NaN      NaN                                        nos_calling  
                            NaN      NaN                                   nos_calling_diff  
                            NaN      NaN                                            sms_cnt  
                            NaN      NaN                                     call_fee_local  
                            NaN      NaN                                      call_fee_roam  
                            NaN      NaN                                        gprs_income  
                            NaN      NaN                                           gprs_fee  
                            NaN      NaN                                           call_fee  
                            NaN      NaN                                    gprs_flow_video  
                            NaN      NaN                                    gprs_flow_short  
                            NaN      NaN                                    gprs_flow_music  
                            NaN      NaN                                    gprs_flow_commu  
                            NaN      NaN                                     gprs_flow_game  
                            NaN      NaN  [gprs_flow_video, gprs_flow_short, gprs_flow_m...  
                            NaN      NaN                             [dinner, innet_months]  
                            NaN      NaN                              dayvalue_calling_dura  
                            NaN      NaN                                 dayvalue_gprs_flow  
                            NaN      NaN                               dayvalue_user_status  
                            NaN      NaN                             dayvalue_phone_no_null  
                           删除      NaN                                           flag_eg2  
                           删除      NaN                                      score_flag_eg  
                            NaN      NaN                                    [score_flag_eg]  
                           删除      NaN                                     score_flag_eg2  
                            NaN      NaN                                   [score_flag_eg2]  
                           删除      NaN                                                 rn  
                            NaN      NaN                                            sex_add  
                            NaN      NaN                                            sex_add  
                            NaN      NaN                                         if_nolimit  
                            NaN      NaN                                       if_5g_dinner  
                            NaN      NaN                                     gprs_flow_roam  
                            NaN      NaN      [monthsremain_last_stop_date, last_stop_date]  
                            NaN      NaN                                    gprs_last_defer  
                            NaN      NaN                                      gprs_resource  
                            NaN      NaN                                  calling_diff_dura  
                            NaN      NaN                                    gprs_flow_video  
                            NaN      NaN                                         dinner_fee  
                            NaN      NaN                                       gprs_flow_5g  
                            NaN      NaN                                        nos_calling  
                            NaN      NaN                                   nos_calling_diff  
                            NaN      NaN                                               arpu  
                            NaN      NaN                                        calling_cnt  
                            NaN      NaN                                    gprs_flow_commu  
                            NaN      NaN                                     gprs_now_defer  
                            NaN      NaN                                           call_use  
                            NaN      NaN                                       gprs_flow_4g  
                            NaN      NaN                                      gprs_now_rest  
                            NaN      NaN                                    gprs_flow_music  
                            NaN      NaN                                   calling_diff_cnt  
                            NaN      NaN                                     gprs_flow_game  
                            NaN      NaN                                     call_dura_roam  
                            NaN      NaN                                    gprs_flow_short  
                            NaN      NaN                                       calling_dura  
                            NaN      NaN                                     gprs_flow_roam  
                            NaN      NaN      [monthsremain_last_stop_date, last_stop_date]  
                            NaN      NaN                                    gprs_last_defer  
                            NaN      NaN                                      gprs_resource  
                            NaN      NaN                                  calling_diff_dura  
                            NaN      NaN                                    gprs_flow_video  
                            NaN      NaN                                         dinner_fee  
                            NaN      NaN                                       gprs_flow_5g  
                            NaN      NaN                                        nos_calling  
                            NaN      NaN                                   nos_calling_diff  
                            NaN      NaN                                               arpu  
                            NaN      NaN                                        calling_cnt  
                            NaN      NaN                                    gprs_flow_commu  
                            NaN      NaN                                     gprs_now_defer  
                            NaN      NaN                                           call_use  
                            NaN      NaN                                       gprs_flow_4g  
                            NaN      NaN                                      gprs_now_rest  
                            NaN      NaN                                    gprs_flow_music  
                            NaN      NaN                                   calling_diff_cnt  
                            NaN      NaN                                     gprs_flow_game  
                            NaN      NaN                                     call_dura_roam  
                            NaN      NaN                                    gprs_flow_short  
                            NaN      NaN                                       calling_dura  
                            NaN      NaN                                     gprs_flow_roam  
                            NaN      NaN      [monthsremain_last_stop_date, last_stop_date]  
                            NaN      NaN                                    gprs_last_defer  
                            NaN      NaN                                      gprs_resource  
                            NaN      NaN                                  calling_diff_dura  
                            NaN      NaN                                    gprs_flow_video  
                            NaN      NaN                                         dinner_fee  
                            NaN      NaN                                       gprs_flow_5g  
                            NaN      NaN                                        nos_calling  
                            NaN      NaN                                   nos_calling_diff  
                            NaN      NaN                                               arpu  
                            NaN      NaN                                        calling_cnt  
                            NaN      NaN                                    gprs_flow_commu  
                            NaN      NaN                                     gprs_now_defer  
                            NaN      NaN                                           call_use  
                            NaN      NaN                                       gprs_flow_4g  
                            NaN      NaN                                      gprs_now_rest  
                            NaN      NaN                                    gprs_flow_music  
                            NaN      NaN                                   calling_diff_cnt  
                            NaN      NaN                                     gprs_flow_game  
                            NaN      NaN                                     call_dura_roam  
                            NaN      NaN                                    gprs_flow_short  
                            NaN      NaN                                       calling_dura  
                            NaN      NaN                                     gprs_flow_roam  
                            NaN      NaN      [monthsremain_last_stop_date, last_stop_date]  
                            NaN      NaN                                    gprs_last_defer  
                            NaN      NaN                                      gprs_resource  
                            NaN      NaN                                  calling_diff_dura  
                            NaN      NaN                                    gprs_flow_video  
                            NaN      NaN                                         dinner_fee  
                            NaN      NaN                                       gprs_flow_5g  
                            NaN      NaN                                        nos_calling  
                            NaN      NaN                                   nos_calling_diff  
                            NaN      NaN                                               arpu  
                            NaN      NaN                                        calling_cnt  
                            NaN      NaN                                    gprs_flow_commu  
                            NaN      NaN                                     gprs_now_defer  
                            NaN      NaN                                           call_use  
                            NaN      NaN                                       gprs_flow_4g  
                            NaN      NaN                                      gprs_now_rest  
                            NaN      NaN                                    gprs_flow_music  
                            NaN      NaN                                   calling_diff_cnt  
                            NaN      NaN                                     gprs_flow_game  
                            NaN      NaN                                     call_dura_roam  
                            NaN      NaN                                    gprs_flow_short  
                            NaN      NaN                                       calling_dura  
                            NaN      NaN                                     gprs_flow_roam  
                            NaN      NaN      [monthsremain_last_stop_date, last_stop_date]  
                            NaN      NaN                                    gprs_last_defer  
                            NaN      NaN                                      gprs_resource  
                            NaN      NaN                                  calling_diff_dura  
                            NaN      NaN                                    gprs_flow_video  
                            NaN      NaN                                         dinner_fee  
                            NaN      NaN                                       gprs_flow_5g  
                            NaN      NaN                                        nos_calling  
                            NaN      NaN                                   nos_calling_diff  
                            NaN      NaN                                               arpu  
                            NaN      NaN                                        calling_cnt  
                            NaN      NaN                                    gprs_flow_commu  
                            NaN      NaN                                     gprs_now_defer  
                            NaN      NaN                                           call_use  
                            NaN      NaN                                       gprs_flow_4g  
                            NaN      NaN                                      gprs_now_rest  
                            NaN      NaN                                    gprs_flow_music  
                            NaN      NaN                                   calling_diff_cnt  
                            NaN      NaN                                     gprs_flow_game  
                            NaN      NaN                                     call_dura_roam  
                            NaN      NaN                                    gprs_flow_short  
                            NaN      NaN                                       calling_dura  
                            NaN      NaN                                     gprs_flow_roam  
                            NaN      NaN      [monthsremain_last_stop_date, last_stop_date]  
                            NaN      NaN                                    gprs_last_defer  
                            NaN      NaN                                      gprs_resource  
                            NaN      NaN                                  calling_diff_dura  
                            NaN      NaN                                    gprs_flow_video  
                            NaN      NaN                                         dinner_fee  
                            NaN      NaN                                       gprs_flow_5g  
                            NaN      NaN                                        nos_calling  
                            NaN      NaN                                   nos_calling_diff  
                            NaN      NaN                                               arpu  
                            NaN      NaN                                        calling_cnt  
                            NaN      NaN                                    gprs_flow_commu  
                            NaN      NaN                                     gprs_now_defer  
                            NaN      NaN                                           call_use  
                            NaN      NaN                                       gprs_flow_4g  
                            NaN      NaN                                      gprs_now_rest  
                            NaN      NaN                                    gprs_flow_music  
                            NaN      NaN                                   calling_diff_cnt  
                            NaN      NaN                                     gprs_flow_game  
                            NaN      NaN                                     call_dura_roam  
                            NaN      NaN                                    gprs_flow_short  
                            NaN      NaN                                       calling_dura  
                            NaN      NaN                                     gprs_flow_roam  
                            NaN      NaN      [monthsremain_last_stop_date, last_stop_date]  
                            NaN      NaN                                    gprs_last_defer  
                            NaN      NaN                                      gprs_resource  
                            NaN      NaN                                  calling_diff_dura  
                            NaN      NaN                                    gprs_flow_video  
                            NaN      NaN                                         dinner_fee  
                            NaN      NaN                                       gprs_flow_5g  
                            NaN      NaN                                        nos_calling  
                            NaN      NaN                                   nos_calling_diff  
                            NaN      NaN                                               arpu  
                            NaN      NaN                                        calling_cnt  
                            NaN      NaN                                    gprs_flow_commu  
                            NaN      NaN                                     gprs_now_defer  
                            NaN      NaN                                           call_use  
                            NaN      NaN                                       gprs_flow_4g  
                            NaN      NaN                                      gprs_now_rest  
                            NaN      NaN                                    gprs_flow_music  
                            NaN      NaN                                   calling_diff_cnt  
                            NaN      NaN                                     gprs_flow_game  
                            NaN      NaN                                     call_dura_roam  
                            NaN      NaN                                    gprs_flow_short  
                            NaN      NaN                                       calling_dura  
                            NaN      NaN                                     gprs_flow_roam  
                            NaN      NaN      [monthsremain_last_stop_date, last_stop_date]  
                            NaN      NaN                                    gprs_last_defer  
                            NaN      NaN                                      gprs_resource  
                            NaN      NaN                                  calling_diff_dura  
                            NaN      NaN                                    gprs_flow_video  
                            NaN      NaN                                         dinner_fee  
                            NaN      NaN                                       gprs_flow_5g  
                            NaN      NaN                                        nos_calling  
                            NaN      NaN                                   nos_calling_diff  
                            NaN      NaN                                               arpu  
                            NaN      NaN                                        calling_cnt  
                            NaN      NaN                                    gprs_flow_commu  
                            NaN      NaN                                     gprs_now_defer  
                            NaN      NaN                                           call_use  
                            NaN      NaN                                       gprs_flow_4g  
                            NaN      NaN                                      gprs_now_rest  
                            NaN      NaN                                    gprs_flow_music  
                            NaN      NaN                                   calling_diff_cnt  
                            NaN      NaN                                     gprs_flow_game  
                            NaN      NaN                                     call_dura_roam  
                            NaN      NaN                                    gprs_flow_short  
                            NaN      NaN                                       calling_dura  
                            NaN      NaN                                     gprs_flow_roam  
                            NaN      NaN      [monthsremain_last_stop_date, last_stop_date]  
                            NaN      NaN                                    gprs_last_defer  
                            NaN      NaN                                      gprs_resource  
                            NaN      NaN                                  calling_diff_dura  
                            NaN      NaN                                    gprs_flow_video  
                            NaN      NaN                                         dinner_fee  
                            NaN      NaN                                       gprs_flow_5g  
                            NaN      NaN                                        nos_calling  
                            NaN      NaN                                   nos_calling_diff  
                            NaN      NaN                                               arpu  
                            NaN      NaN                                        calling_cnt  
                            NaN      NaN                                    gprs_flow_commu  
                            NaN      NaN                                     gprs_now_defer  
                            NaN      NaN                                           call_use  
                            NaN      NaN                                       gprs_flow_4g  
                            NaN      NaN                                      gprs_now_rest  
                            NaN      NaN                                    gprs_flow_music  
                            NaN      NaN                                   calling_diff_cnt  
                            NaN      NaN                                     gprs_flow_game  
                            NaN      NaN                                     call_dura_roam  
                            NaN      NaN                                    gprs_flow_short  
                            NaN      NaN                                       calling_dura  
                            NaN      NaN                                            sex_add  
                            NaN      NaN                                            sex_add  
                            NaN      NaN                                         if_nolimit  
                            NaN      NaN                                       if_5g_dinner  
                           删除      NaN                                            flag_eg  , iv_valid=std__nos_calling                         0.071647
                    max__nos_calling_diff                    0.098839
                    sep__nos_calling                         0.067140
                    gprs_last_defer                          0.234745
                    grow__gprs_flow_music                    0.282338
                    gprs_flow_5g                             0.076381
                    avg__gprs_flow_5g                        0.087447
                    wave__calling_dura                       0.057318
                    max__call_dura_roam                      0.060406
                    sep__calling_diff_cnt                    0.057789
                    min__gprs_now_defer                      0.143553
                    valuecnt__if_nolimit~是                  0.152853
                    moreq25cnt__call_use                     0.050641
                    grow__calling_diff_cnt                   0.079929
                    min__calling_dura                        0.085188
                    moreq25cnt__calling_dura                 0.065792
                    std__gprs_resource                       0.124406
                    avg__gprs_resource                       0.346212
                    max__nos_calling                         0.100981
                    std__calling_diff_cnt                    0.086768
                    grow__gprs_flow_5g                       0.064845
                    moreq25cnt__gprs_flow_video              0.465368
                    min__gprs_flow_music                     0.196130
                    avg__gprs_flow_short                     0.364086
                    max__calling_cnt                         0.086983
                    min__gprs_flow_4g                        0.699743
                    sex_add~女                               0.059919
                    gprs_flow_short                          0.367584
                    avg__calling_dura                        0.123055
                    moreq25cnt__gprs_flow_game               0.153826
                    more0cnt__monthsremain_last_stop_date    0.066298
                    avg__gprs_flow_4g                        0.822106
                    min__gprs_flow_5g                        0.072039
                    wave__calling_cnt                        0.057898
                    max__calling_diff_cnt                    0.109190
                    moreq25cnt__calling_diff_cnt             0.069732
                    moreq25cnt__gprs_flow_commu              0.438763
                    wave__gprs_now_rest                      0.340497
                    wave__gprs_now_defer                     0.089754
                    grow__calling_diff_dura                  0.069273
                    monthsremain_last_stop_date              0.061074
                    min__call_dura_roam                      0.050893
                    avg__monthsremain_last_stop_date         0.072756
                    calling_diff_dura                        0.071489
                    avg__gprs_flow_roam                      0.355485
                    avg__gprs_flow_video                     0.479546
                    max__monthsremain_last_stop_date         0.079513
                    min__gprs_resource                       0.348081
                    moreq25cnt__arpu                         0.127207
                    nos_calling                              0.078344
                    max__gprs_now_rest                       0.271280
                    calling_cnt                              0.072450
                    grow__gprs_now_rest                      0.358064
                    std__gprs_now_rest                       0.462801
                    gprs_flow_4g                             0.668554
                    wave__gprs_flow_music                    0.343531
                    min__gprs_last_defer                     0.222349
                    gprs_now_rest                            0.281777
                    max__gprs_flow_music                     0.270206
                    wave__gprs_flow_video                    0.454530
                    grow__calling_cnt                        0.069576
                    avg__calling_diff_cnt                    0.116566
                    wave__gprs_flow_commu                    0.444092
                    avg__calling_diff_dura                   0.111985
                    min__nos_calling_diff                    0.092425
                    moreq25cnt__calling_cnt                  0.067326
                    min__calling_diff_cnt                    0.101469
                    wave__call_use                           0.058815
                    avg__gprs_now_defer                      0.147083
                    sep__gprs_flow_5g                        0.104839
                    max__calling_dura                        0.090203
                    gprs_flow_roam                           0.279504
                    valuecnt__if_5g_dinner~是                0.096198
                    moreq25cnt__nos_calling                  0.077577
                    avg__gprs_now_rest                       0.169803
                    max__gprs_resource                       0.345439
                    grow__nos_calling                        0.051624
                    moreq25cnt__gprs_flow_5g                 0.074023
                    avg__nos_calling_diff                    0.103289
                    sep__calling_diff_dura                   0.100410
                    avg__call_dura_roam                      0.064205
                    avg__gprs_last_defer                     0.196759
                    avg__nos_calling                         0.100635
                    min__call_use                            0.101612
                    nos_calling_diff                         0.075756
                    std__call_use                            0.083448
                    arpu                                     0.253012
                    sep__nos_calling_diff                    0.099007
                    min__nos_calling                         0.099487
                    min__arpu                                0.313118
                    min__gprs_flow_short                     0.317284
                    sep__gprs_flow_short                     0.367913
                    gprs_flow_commu                          0.444720
                    sep__calling_dura                        0.063050
                    min__calling_cnt                         0.089515
                    moreq25cnt__gprs_last_defer              0.071004
                    min__gprs_flow_video                     0.472755
                    wave__calling_diff_cnt                   0.053769
                    sep__gprs_now_rest                       0.298653
                    sep__gprs_flow_commu                     0.528029
                    avg__gprs_flow_commu                     0.487465
                    max__calling_diff_dura                   0.112441
                    min__gprs_flow_game                      0.104372
                    grow__gprs_flow_video                    0.371923
                    avg__gprs_flow_music                     0.303213
                    moreq25cnt__gprs_resource                0.068176
                    more0cnt__nos_calling                    0.062142
                    max__gprs_flow_roam                      0.324741
                    max__dinner_fee                          0.253655
                    call_dura_roam                           0.050222
                    avg__arpu                                0.300378
                    moreq25cnt__gprs_flow_short              0.372622
                    grow__call_use                           0.087214
                    min__gprs_flow_commu                     0.464157
                    calling_dura                             0.066668
                    std__call_dura_roam                      0.059133
                    grow__gprs_resource                      0.327149
                    std__calling_dura                        0.066433
                    grow__gprs_flow_roam                     0.223842
                    grow__dinner_fee                         0.194004
                    grow__gprs_last_defer                    0.218835
                    gprs_flow_video                          0.445931
                    min__calling_diff_dura                   0.103003
                    max__gprs_flow_commu                     0.516502
                    avg__call_use                            0.141039
                    std__gprs_flow_4g                        0.651930
                    sex_add~男                               0.063709
                    moreq25cnt__nos_calling_diff             0.085656
                    min__gprs_now_rest                       0.302605
                    innet_months                             0.060878
                    std__calling_diff_dura                   0.071499
                    sep__gprs_resource                       0.149219
                    more0cnt__calling_dura                   0.062654
                    std__calling_cnt                         0.059114
                    max__arpu                                0.226123
                    moreq25cnt__gprs_flow_4g                 0.065345
                    min__gprs_flow_roam                      0.225352
                    wave__gprs_flow_short                    0.405889
                    grow__nos_calling_diff                   0.054199
                    std__gprs_last_defer                     0.119484
                    gprs_flow_game                           0.128835
                    avg__gprs_flow_game                      0.121663
                    max__gprs_last_defer                     0.241440
                    std__nos_calling_diff                    0.075823
                    avg__calling_cnt                         0.083667
                    moreq25cnt__gprs_flow_music              0.325590
                    wave__gprs_last_defer                    0.117484
                    std__gprs_flow_commu                     0.441472
                    std__gprs_flow_video                     0.416308
                    call_use                                 0.102225
                    wave__monthsremain_last_stop_date        0.072336
                    max__call_use                            0.162606
                    dtype: float64, iv_init=innet_months                   0.060878
                    age                            0.049462
                    age_add                        0.049462
                    dinner_fee                     0.244330
                    gprs_last_defer                0.234745
                    gprs_resource                  0.342531
                    gprs_now_rest                  0.281777
                    call_use                       0.102225
                    arpu                           0.253012
                    calling_cnt                    0.072450
                    calling_dura                   0.066668
                    calling_diff_cnt               0.079822
                    calling_diff_dura              0.071489
                    gprs_flow                      0.667891
                    gprs_flow_4g                   0.668554
                    gprs_flow_5g                   0.076381
                    gprs_flow_busy                 0.667891
                    gprs_now_defer                 0.140403
                    gprs_flow_roam                 0.279504
                    call_dura_roam                 0.050222
                    nos_calling                    0.078344
                    nos_calling_diff               0.075756
                    gprs_flow_video                0.445931
                    gprs_flow_short                0.367584
                    gprs_flow_music                0.278350
                    gprs_flow_commu                0.444720
                    gprs_flow_game                 0.128835
                    monthsaready_last_stop_date    0.061074
                    monthsremain_last_stop_date    0.061074
                    sex~其他_ivlow                 0.000824
                    sex~女                         0.059919
                    sex~男                         0.063709
                    sex_add~其他_ivlow             0.000824
                    sex_add~女                     0.059919
                    sex_add~男                     0.063709
                    if_nolimit~否                  0.150501
                    if_nolimit~是                  0.150501
                    if_5g_dinner~否                0.091953
                    if_5g_dinner~是                0.091953
                    dtype: float64, iv_all=innet_months                             0.060878
                    age                                      0.049462
                    age_add                                  0.049462
                    dinner_fee                               0.244330
                    gprs_last_defer                          0.234745
                    gprs_resource                            0.342531
                    gprs_now_rest                            0.281777
                    call_use                                 0.102225
                    arpu                                     0.253012
                    calling_cnt                              0.072450
                    calling_dura                             0.066668
                    calling_diff_cnt                         0.079822
                    calling_diff_dura                        0.071489
                    gprs_flow                                0.667891
                    gprs_flow_4g                             0.668554
                    gprs_flow_5g                             0.076381
                    gprs_flow_busy                           0.667891
                    gprs_now_defer                           0.140403
                    gprs_flow_roam                           0.279504
                    call_dura_roam                           0.050222
                    nos_calling                              0.078344
                    nos_calling_diff                         0.075756
                    gprs_flow_video                          0.445931
                    gprs_flow_short                          0.367584
                    gprs_flow_music                          0.278350
                    gprs_flow_commu                          0.444720
                    gprs_flow_game                           0.128835
                    monthsaready_last_stop_date              0.061074
                    monthsremain_last_stop_date              0.061074
                    sex~其他_ivlow                           0.000824
                    sex~女                                   0.059919
                    sex~男                                   0.063709
                    sex_add~其他_ivlow                       0.000824
                    sex_add~女                               0.059919
                    sex_add~男                               0.063709
                    if_nolimit~否                            0.150501
                    if_nolimit~是                            0.150501
                    if_5g_dinner~否                          0.091953
                    if_5g_dinner~是                          0.091953
                    avg__gprs_flow_roam                      0.355485
                    avg__monthsremain_last_stop_date         0.072756
                    avg__gprs_last_defer                     0.196759
                    avg__gprs_resource                       0.346212
                    avg__calling_diff_dura                   0.111985
                    avg__gprs_flow_video                     0.479546
                    avg__dinner_fee                          0.247031
                    avg__gprs_flow_5g                        0.087447
                    avg__nos_calling                         0.100635
                    avg__nos_calling_diff                    0.103289
                    avg__arpu                                0.300378
                    avg__calling_cnt                         0.083667
                    avg__gprs_flow_commu                     0.487465
                    avg__gprs_now_defer                      0.147083
                    avg__call_use                            0.141039
                    avg__gprs_flow_4g                        0.822106
                    avg__gprs_now_rest                       0.169803
                    avg__gprs_flow_music                     0.303213
                    avg__calling_diff_cnt                    0.116566
                    avg__gprs_flow_game                      0.121663
                    avg__call_dura_roam                      0.064205
                    avg__gprs_flow_short                     0.364086
                    avg__calling_dura                        0.123055
                    sep__monthsremain_last_stop_date         0.072756
                    sep__gprs_last_defer                     0.048379
                    sep__gprs_resource                       0.149219
                    sep__calling_diff_dura                   0.100410
                    sep__gprs_flow_video                     0.434753
                    sep__gprs_flow_5g                        0.104839
                    sep__nos_calling                         0.067140
                    sep__nos_calling_diff                    0.099007
                    sep__calling_cnt                         0.047395
                    sep__gprs_flow_commu                     0.528029
                    sep__call_use                            0.036712
                    sep__gprs_flow_4g                        0.038168
                    sep__gprs_now_rest                       0.298653
                    sep__gprs_flow_music                     0.343463
                    sep__calling_diff_cnt                    0.057789
                    sep__gprs_flow_game                      0.121663
                    sep__gprs_flow_short                     0.367913
                    sep__calling_dura                        0.063050
                    wave__monthsremain_last_stop_date        0.072336
                    wave__gprs_last_defer                    0.117484
                    wave__gprs_resource                      0.149219
                    wave__calling_diff_dura                  0.046088
                    wave__gprs_flow_video                    0.454530
                    wave__dinner_fee                         0.043149
                    wave__gprs_flow_5g                       0.046464
                    wave__nos_calling                        0.049937
                    wave__nos_calling_diff                   0.049335
                    wave__calling_cnt                        0.057898
                    wave__gprs_flow_commu                    0.444092
                    wave__gprs_now_defer                     0.089754
                    wave__call_use                           0.058815
                    wave__gprs_now_rest                      0.340497
                    wave__gprs_flow_music                    0.343531
                    wave__calling_diff_cnt                   0.053769
                    wave__gprs_flow_game                     0.101260
                    wave__gprs_flow_short                    0.405889
                    wave__calling_dura                       0.057318
                    grow__gprs_flow_roam                     0.223842
                    grow__monthsremain_last_stop_date        0.072756
                    grow__gprs_last_defer                    0.218835
                    grow__gprs_resource                      0.327149
                    grow__calling_diff_dura                  0.069273
                    grow__gprs_flow_video                    0.371923
                    grow__dinner_fee                         0.194004
                    grow__gprs_flow_5g                       0.064845
                    grow__nos_calling                        0.051624
                    grow__nos_calling_diff                   0.054199
                    grow__calling_cnt                        0.069576
                    grow__gprs_flow_commu                    0.444720
                    grow__gprs_now_defer                     0.082589
                    grow__call_use                           0.087214
                    grow__gprs_now_rest                      0.358064
                    grow__gprs_flow_music                    0.282338
                    grow__calling_diff_cnt                   0.079929
                    grow__gprs_flow_game                     0.128835
                    grow__call_dura_roam                     0.036088
                    grow__gprs_flow_short                    0.367584
                    grow__calling_dura                       0.063605
                    max__gprs_flow_roam                      0.324741
                    max__monthsremain_last_stop_date         0.079513
                    max__gprs_last_defer                     0.241440
                    max__gprs_resource                       0.345439
                    max__calling_diff_dura                   0.112441
                    max__gprs_flow_video                     0.467403
                    max__dinner_fee                          0.253655
                    max__gprs_flow_5g                        0.085480
                    max__nos_calling                         0.100981
                    max__nos_calling_diff                    0.098839
                    max__arpu                                0.226123
                    max__calling_cnt                         0.086983
                    max__gprs_flow_commu                     0.516502
                    max__gprs_now_defer                      0.139385
                    max__call_use                            0.162606
                    max__gprs_flow_4g                        0.764068
                    max__gprs_now_rest                       0.271280
                    max__gprs_flow_music                     0.270206
                    max__calling_diff_cnt                    0.109190
                    max__gprs_flow_game                      0.121663
                    max__call_dura_roam                      0.060406
                    max__gprs_flow_short                     0.347461
                    max__calling_dura                        0.090203
                    min__gprs_flow_roam                      0.225352
                    min__monthsremain_last_stop_date         0.061074
                    min__gprs_last_defer                     0.222349
                    min__gprs_resource                       0.348081
                    min__calling_diff_dura                   0.103003
                    min__gprs_flow_video                     0.472755
                    min__dinner_fee                          0.244493
                    min__gprs_flow_5g                        0.072039
                    min__nos_calling                         0.099487
                    min__nos_calling_diff                    0.092425
                    min__arpu                                0.313118
                    min__calling_cnt                         0.089515
                    min__gprs_flow_commu                     0.464157
                    min__gprs_now_defer                      0.143553
                    min__call_use                            0.101612
                    min__gprs_flow_4g                        0.699743
                    min__gprs_now_rest                       0.302605
                    min__gprs_flow_music                     0.196130
                    min__calling_diff_cnt                    0.101469
                    min__gprs_flow_game                      0.104372
                    min__call_dura_roam                      0.050893
                    min__gprs_flow_short                     0.317284
                    min__calling_dura                        0.085188
                    std__gprs_flow_roam                      0.313348
                    std__monthsremain_last_stop_date         0.037932
                    std__gprs_last_defer                     0.119484
                    std__gprs_resource                       0.124406
                    std__calling_diff_dura                   0.071499
                    std__gprs_flow_video                     0.416308
                    std__gprs_flow_5g                        0.082972
                    std__nos_calling                         0.071647
                    std__nos_calling_diff                    0.075823
                    std__arpu                                0.042934
                    std__calling_cnt                         0.059114
                    std__gprs_flow_commu                     0.441472
                    std__call_use                            0.083448
                    std__gprs_flow_4g                        0.651930
                    std__gprs_now_rest                       0.462801
                    std__gprs_flow_music                     0.270206
                    std__calling_diff_cnt                    0.086768
                    std__gprs_flow_game                      0.121663
                    std__call_dura_roam                      0.059133
                    std__gprs_flow_short                     0.339176
                    std__calling_dura                        0.066433
                    more0cnt__monthsremain_last_stop_date    0.066298
                    more0cnt__gprs_last_defer                0.071004
                    more0cnt__calling_diff_dura              0.069732
                    more0cnt__gprs_flow_video                0.465368
                    more0cnt__gprs_flow_5g                   0.074023
                    more0cnt__nos_calling                    0.062142
                    more0cnt__nos_calling_diff               0.085656
                    more0cnt__calling_cnt                    0.062654
                    more0cnt__gprs_flow_commu                0.438763
                    more0cnt__gprs_now_defer                 0.085698
                    more0cnt__call_use                       0.050641
                    more0cnt__gprs_flow_4g                   0.036260
                    more0cnt__gprs_flow_music                0.325590
                    more0cnt__calling_diff_cnt               0.069732
                    more0cnt__gprs_flow_game                 0.153826
                    more0cnt__gprs_flow_short                0.372622
                    more0cnt__calling_dura                   0.062654
                    moreq25cnt__gprs_last_defer              0.071004
                    moreq25cnt__gprs_resource                0.068176
                    moreq25cnt__calling_diff_dura            0.069732
                    moreq25cnt__gprs_flow_video              0.465368
                    moreq25cnt__gprs_flow_5g                 0.074023
                    moreq25cnt__nos_calling                  0.077577
                    moreq25cnt__nos_calling_diff             0.085656
                    moreq25cnt__arpu                         0.127207
                    moreq25cnt__calling_cnt                  0.067326
                    moreq25cnt__gprs_flow_commu              0.438763
                    moreq25cnt__gprs_now_defer               0.085698
                    moreq25cnt__call_use                     0.050641
                    moreq25cnt__gprs_flow_4g                 0.065345
                    moreq25cnt__gprs_flow_music              0.325590
                    moreq25cnt__calling_diff_cnt             0.069732
                    moreq25cnt__gprs_flow_game               0.153826
                    moreq25cnt__gprs_flow_short              0.372622
                    moreq25cnt__calling_dura                 0.065792
                    valuecnt__sex_add~女                     0.059919
                    valuecnt__sex_add~男                     0.063709
                    valuecnt__if_nolimit~是                  0.152853
                    valuecnt__if_5g_dinner~是                0.096198
                    dtype: float64, woe_accum_df=                                       value     0    1       woe  weight  woe_weight   ALL
                    sep__gprs_flow_commu    (0.008387, 0.173051]     1   30  4.094345  0.0295    0.120783    31
                    sep__gprs_flow_5g       (0.094318, 0.846791]     5   30  2.484907  0.0275    0.068335    35
                    min__gprs_flow_video            (615.0, inf]    21  116  2.402215  0.1055    0.253434   137
                    min__gprs_flow_roam         (3015086.5, inf]    13   68  2.347706  0.0615    0.144384    81
                    wave__gprs_flow_short       (-inf, 0.944885]    14   67  2.258782  0.0600    0.135527    81
                    ...                                      ...   ...  ...       ...     ...         ...   ...
                    more0cnt__gprs_flow_4g           (-inf, 0.5]   190   47 -0.703729 -0.0480    0.033779   237
                    std__gprs_flow_4g       (-inf, 51620.894531]  1304  320 -0.711724 -0.3320    0.236292  1624
                    min__gprs_now_rest           (0.5, 245757.5]   619  144 -0.765145 -0.1655    0.126631   763
                    sep__nos_calling            (-inf, 0.007463]   273   61 -0.805451 -0.0755    0.060812   334
                    grow__gprs_resource     (0.995958, 0.998502]    51   11 -0.840783 -0.0145    0.012191    62
                    
                    [548 rows x 7 columns], na_to_value={}, morecnt_thre_dict={('more0cnt', '近3月大于0的月份数'): gprs_flow_roam                 0
                    monthsremain_last_stop_date    0
                    gprs_last_defer                0
                    gprs_resource                  0
                    calling_diff_dura              0
                    gprs_flow_video                0
                    dinner_fee                     0
                    gprs_flow_5g                   0
                    nos_calling                    0
                    nos_calling_diff               0
                    arpu                           0
                    calling_cnt                    0
                    gprs_flow_commu                0
                    gprs_now_defer                 0
                    call_use                       0
                    gprs_flow_4g                   0
                    gprs_now_rest                  0
                    gprs_flow_music                0
                    calling_diff_cnt               0
                    gprs_flow_game                 0
                    call_dura_roam                 0
                    gprs_flow_short                0
                    calling_dura                   0
                    dtype: int64, ('moreq25cnt', '近3月大于第一四分位数的月份数'): gprs_flow_roam                     0.00
                    monthsremain_last_stop_date      -36.00
                    gprs_last_defer                    0.00
                    gprs_resource                     10.00
                    calling_diff_dura                  0.00
                    gprs_flow_video                    0.00
                    dinner_fee                         8.00
                    gprs_flow_5g                       0.00
                    nos_calling                        1.00
                    nos_calling_diff                   0.00
                    arpu                              10.00
                    calling_cnt                        1.00
                    gprs_flow_commu                    0.00
                    gprs_now_defer                     0.00
                    call_use                           0.00
                    gprs_flow_4g                    1067.50
                    gprs_now_rest                  58679.75
                    gprs_flow_music                    0.00
                    calling_diff_cnt                   0.00
                    gprs_flow_game                     0.00
                    call_dura_roam                     0.00
                    gprs_flow_short                    0.00
                    calling_dura                       1.00
                    Name: 0.25, dtype: float64}, now_methods_desc={'add': '之和', 'sub': '之差', 'mult': '之积', 'div': '之比'}, recent_methods_desc={'avg': '近3月均值', 'sep': '近3月离散系数', 'wave': '近3月波动性', 'grow': '近3月成长率', 'max': '近3月最大值', 'min': '近3月最小值', 'std': '近3月标准差'}, dis_exam=None, num_valid=0                  gprs_flow_roam
                    1     monthsremain_last_stop_date
                    2                 gprs_last_defer
                    3                   gprs_resource
                    4               calling_diff_dura
                    5                 gprs_flow_video
                    6                      dinner_fee
                    7                    gprs_flow_5g
                    8                     nos_calling
                    9                    innet_months
                    10               nos_calling_diff
                    11                           arpu
                    12                    calling_cnt
                    13                gprs_flow_commu
                    14                 gprs_now_defer
                    15                       call_use
                    16                   gprs_flow_4g
                    17                  gprs_now_rest
                    18                gprs_flow_music
                    19               calling_diff_cnt
                    20                 gprs_flow_game
                    21                 call_dura_roam
                    22                gprs_flow_short
                    23                   calling_dura
                    dtype: object, char_validvalue=Index(['sex_add~女', 'sex_add~男', 'if_nolimit~是', 'if_5g_dinner~是'], dtype='object'), train_Psi=PsiTransformer_DF(Ncase='0', Pcase='1', bins=None, col_ignore=[],
                                      fit_pop_all=False, precision=6, print_indent='',
                                      psi_limit=0.1, trans_na_error=True,
                                      warn_mark=' PsiTransformer'), dis_test_total={'count': 68000, 'Pcount': 8036, 'prop': 0.118}, dis_test_model={'count': 10817, 'Pcount': 1659, 'prop': 0.153}, dis_test_sample={'count': 1000, 'Pcount': 154, 'prop': 0.154}))


Traceback (most recent call last):
  File "D:\Python for Windows\lib\site-packages\IPython\core\interactiveshell.py", line 3296, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-14-dce813cd5c1b>", line 1, in <module>
    rint('\n\n# 创建数据处理流水线、算法序列\n '.replace('#', '#' * 70))
NameError: name 'rint' is not defined

                   ###################################################################### 创建数据处理流水线、算法序列
                    
20220704-10:17:00  创建数据转换流水线1


D:\工作\模型脚本\ModelProject\selfmodule\toolmodule\dataprep.py:9: UserWarning: Pipeline_DF：verbose参数值被赋予print_indent后默认参数设置为None
  import time


D:\工作\模型脚本\ModelProject\selfmodule\toolmodule\dataprep.py:9: UserWarning: FeatureUnion_DF：verbose参数值被赋予print_indent后默认参数设置为None
  import time
20220704-10:17:00  创建数据转换流水线2
20220704-10:17:00  创建数据转换流水线3
20220704-10:17:00  创建算法序列

                   ###################################################################### 训练测试过程
                    
                   Out[16]: 20220704-10:17:13  'retrain_limit=25'
20220704-10:18:41  开始时间：2022-07-04 10:18:41
20220704-10:18:51  模型名称：模型示例
20220704-10:18:51  参数设置：
                       Info.model_name: 模型示例
                       Info.trainproc_ratiolist: [1, 2, 10]
                       field_comment: (167, 16)
                       Info.freq_limit: 0.95
                       Info.unique_limit: 5000
                       Info.iv_limit: 0.05
                       Info.r_limit: 0.95
                       Info.random_state: None
20220704-10:18:51  mark: ~202010~202012
20220704-10:18:51  目标字段：flag_eg; 正负例取值：1、0
20220704-10:18:58  field_comment.shape: (167, 16)
20220704-10:18:58      len(col_need): 167
                   Out[22]: 20220704-10:19:00  
                        phone_no_null
                       last_stop_date
                              flag_eg
                   Name: field_name, dtype: object
20220704-10:19:03      删除field_comment中into_model取值为‘删除’的3个字段：['phone_no_null', 'last_stop_date', 'flag_eg']
20220704-10:19:03      len(col_need): 167


Traceback (most recent call last):
  File "D:\Python for Windows\lib\site-packages\IPython\core\interactiveshell.py", line 3296, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-24-498c9bd7f4d6>", line 1, in <module>
    is_del
NameError: name 'is_del' is not defined
                   Out[26]: 20220704-10:27:52  {'user_acct_month'}
20220704-10:27:56      删除Info.col_del中的1个字段：{'user_acct_month'}
20220704-10:27:56      len(col_need): 166

20220704-10:30:38      删除Info.supply_other、col_mark中的5个字段：{'call_fee_local', 'dayvalue_gprs_flow', 'phone_no_null', 'sms_cnt', 'last_stop_date'}
20220704-10:30:38      len(col_need): 161



Traceback (most recent call last):
  File "D:\Python for Windows\lib\site-packages\IPython\core\interactiveshell.py", line 3296, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-29-cbf89806bade>", line 1, in <module>
    condition = Info.condition if if_condition else None
NameError: name 'if_condition' is not defined
20220704-10:32:00  ------------------------- 读取数据: ./binaryclassify/eg/traintest~202010~202012/train_data~202010.csv 2022-07-04 10:32:00 -------------------------
20220704-10:32:00      src: file
20220704-10:32:00      condition: None
20220704-10:32:00      col_need(161): ['data_use', 'acct_month', 'user_id', 'account_id', 'innet_months', 'user_status', 'monthsremain_last_stop_date', 'gprs_last_defer', 'gprs_now_rest', 'call_use', 'arpu', 'calling_cnt', 'calling_dura', 'calling_diff_dura', 'gprs_flow_4g', 'gprs_flow_5g', 'gprs_flow_roam', 'call_dura_roam', 'days_call_p_4', 'nos_calling', 'nos_calling_diff', 'gprs_flow_video', 'gprs_flow_short', 'gprs_flow_music', 'gprs_flow_commu', 'gprs_flow_game', 'greatest_gprs_app', 'sex_add~女', 'sex_add~男', 'avg__gprs_flow_roam', 'avg__monthsremain_last_stop_date', 'avg__gprs_last_defer', 'avg__gprs_resource', 'avg__calling_diff_dura', 'avg__gprs_flow_video', 'avg__gprs_flow_5g', 'avg__nos_calling', 'avg__nos_calling_diff', 'avg__arpu', 'avg__calling_cnt', 'avg__gprs_flow_commu', 'avg__gprs_now_defer', 'avg__call_use', 'avg__gprs_flow_4g', 'avg__gprs_now_rest', 'avg__gprs_flow_music', 'avg__calling_diff_cnt', 'avg__gprs_flow_game', 'avg__call_dura_roam', 'avg__gprs_flow_short', 'avg__calling_dura', 'sep__gprs_resource', 'sep__calling_diff_dura', 'sep__gprs_flow_5g', 'sep__nos_calling', 'sep__nos_calling_diff', 'sep__gprs_flow_commu', 'sep__gprs_now_rest', 'sep__calling_diff_cnt', 'sep__gprs_flow_short', 'sep__calling_dura', 'wave__monthsremain_last_stop_date', 'wave__gprs_last_defer', 'wave__gprs_flow_video', 'wave__calling_cnt', 'wave__gprs_flow_commu', 'wave__gprs_now_defer', 'wave__call_use', 'wave__gprs_now_rest', 'wave__gprs_flow_music', 'wave__calling_diff_cnt', 'wave__gprs_flow_short', 'wave__calling_dura', 'grow__gprs_flow_roam', 'grow__gprs_last_defer', 'grow__gprs_resource', 'grow__calling_diff_dura', 'grow__gprs_flow_video', 'grow__dinner_fee', 'grow__gprs_flow_5g', 'grow__nos_calling', 'grow__nos_calling_diff', 'grow__calling_cnt', 'grow__call_use', 'grow__gprs_now_rest', 'grow__gprs_flow_music', 'grow__calling_diff_cnt', 'max__gprs_flow_roam', 'max__monthsremain_last_stop_date', 'max__gprs_last_defer', 'max__gprs_resource', 'max__calling_diff_dura', 'max__dinner_fee', 'max__nos_calling', 'max__nos_calling_diff', 'max__arpu', 'max__calling_cnt', 'max__gprs_flow_commu', 'max__call_use', 'max__gprs_now_rest', 'max__gprs_flow_music', 'max__calling_diff_cnt', 'max__call_dura_roam', 'max__calling_dura', 'min__gprs_flow_roam', 'min__gprs_last_defer', 'min__gprs_resource', 'min__calling_diff_dura', 'min__gprs_flow_video', 'min__gprs_flow_5g', 'min__nos_calling', 'min__nos_calling_diff', 'min__arpu', 'min__calling_cnt', 'min__gprs_flow_commu', 'min__gprs_now_defer', 'min__call_use', 'min__gprs_flow_4g', 'min__gprs_now_rest', 'min__gprs_flow_music', 'min__calling_diff_cnt', 'min__gprs_flow_game', 'min__call_dura_roam', 'min__gprs_flow_short', 'min__calling_dura', 'std__gprs_last_defer', 'std__gprs_resource', 'std__calling_diff_dura', 'std__gprs_flow_video', 'std__nos_calling', 'std__nos_calling_diff', 'std__calling_cnt', 'std__gprs_flow_commu', 'std__call_use', 'std__gprs_flow_4g', 'std__gprs_now_rest', 'std__calling_diff_cnt', 'std__call_dura_roam', 'std__calling_dura', 'more0cnt__monthsremain_last_stop_date', 'more0cnt__nos_calling', 'more0cnt__calling_dura', 'moreq25cnt__gprs_last_defer', 'moreq25cnt__gprs_resource', 'moreq25cnt__gprs_flow_video', 'moreq25cnt__gprs_flow_5g', 'moreq25cnt__nos_calling', 'moreq25cnt__nos_calling_diff', 'moreq25cnt__arpu', 'moreq25cnt__calling_cnt', 'moreq25cnt__gprs_flow_commu', 'moreq25cnt__call_use', 'moreq25cnt__gprs_flow_4g', 'moreq25cnt__gprs_flow_music', 'moreq25cnt__calling_diff_cnt', 'moreq25cnt__gprs_flow_game', 'moreq25cnt__gprs_flow_short', 'moreq25cnt__calling_dura', 'valuecnt__if_nolimit~是', 'valuecnt__if_5g_dinner~是', 'flag_eg']
20220704-10:32:00      col_del: None
20220704-10:32:00      col_char(9): ['user_acct_month', 'data_use', 'acct_month', 'phone_no_null', 'user_id', 'account_id', 'user_status', 'greatest_gprs_app', 'flag_eg']
20220704-10:32:00      col_num(157): ['innet_months', 'monthsremain_last_stop_date', 'gprs_last_defer', 'gprs_now_rest', 'call_use', 'arpu', 'calling_cnt', 'calling_dura', 'calling_diff_dura', 'gprs_flow_4g', 'gprs_flow_5g', 'gprs_flow_roam', 'call_dura_roam', 'days_call_p_4', 'nos_calling', 'nos_calling_diff', 'sms_cnt', 'call_fee_local', 'gprs_flow_video', 'gprs_flow_short', 'gprs_flow_music', 'gprs_flow_commu', 'gprs_flow_game', 'dayvalue_gprs_flow', 'sex_add~女', 'sex_add~男', 'avg__gprs_flow_roam', 'avg__monthsremain_last_stop_date', 'avg__gprs_last_defer', 'avg__gprs_resource', 'avg__calling_diff_dura', 'avg__gprs_flow_video', 'avg__gprs_flow_5g', 'avg__nos_calling', 'avg__nos_calling_diff', 'avg__arpu', 'avg__calling_cnt', 'avg__gprs_flow_commu', 'avg__gprs_now_defer', 'avg__call_use', 'avg__gprs_flow_4g', 'avg__gprs_now_rest', 'avg__gprs_flow_music', 'avg__calling_diff_cnt', 'avg__gprs_flow_game', 'avg__call_dura_roam', 'avg__gprs_flow_short', 'avg__calling_dura', 'sep__gprs_resource', 'sep__calling_diff_dura', 'sep__gprs_flow_5g', 'sep__nos_calling', 'sep__nos_calling_diff', 'sep__gprs_flow_commu', 'sep__gprs_now_rest', 'sep__calling_diff_cnt', 'sep__gprs_flow_short', 'sep__calling_dura', 'wave__monthsremain_last_stop_date', 'wave__gprs_last_defer', 'wave__gprs_flow_video', 'wave__calling_cnt', 'wave__gprs_flow_commu', 'wave__gprs_now_defer', 'wave__call_use', 'wave__gprs_now_rest', 'wave__gprs_flow_music', 'wave__calling_diff_cnt', 'wave__gprs_flow_short', 'wave__calling_dura', 'grow__gprs_flow_roam', 'grow__gprs_last_defer', 'grow__gprs_resource', 'grow__calling_diff_dura', 'grow__gprs_flow_video', 'grow__dinner_fee', 'grow__gprs_flow_5g', 'grow__nos_calling', 'grow__nos_calling_diff', 'grow__calling_cnt', 'grow__call_use', 'grow__gprs_now_rest', 'grow__gprs_flow_music', 'grow__calling_diff_cnt', 'max__gprs_flow_roam', 'max__monthsremain_last_stop_date', 'max__gprs_last_defer', 'max__gprs_resource', 'max__calling_diff_dura', 'max__dinner_fee', 'max__nos_calling', 'max__nos_calling_diff', 'max__arpu', 'max__calling_cnt', 'max__gprs_flow_commu', 'max__call_use', 'max__gprs_now_rest', 'max__gprs_flow_music', 'max__calling_diff_cnt', 'max__call_dura_roam', 'max__calling_dura', 'min__gprs_flow_roam', 'min__gprs_last_defer', 'min__gprs_resource', 'min__calling_diff_dura', 'min__gprs_flow_video', 'min__gprs_flow_5g', 'min__nos_calling', 'min__nos_calling_diff', 'min__arpu', 'min__calling_cnt', 'min__gprs_flow_commu', 'min__gprs_now_defer', 'min__call_use', 'min__gprs_flow_4g', 'min__gprs_now_rest', 'min__gprs_flow_music', 'min__calling_diff_cnt', 'min__gprs_flow_game', 'min__call_dura_roam', 'min__gprs_flow_short', 'min__calling_dura', 'std__gprs_last_defer', 'std__gprs_resource', 'std__calling_diff_dura', 'std__gprs_flow_video', 'std__nos_calling', 'std__nos_calling_diff', 'std__calling_cnt', 'std__gprs_flow_commu', 'std__call_use', 'std__gprs_flow_4g', 'std__gprs_now_rest', 'std__calling_diff_cnt', 'std__call_dura_roam', 'std__calling_dura', 'more0cnt__monthsremain_last_stop_date', 'more0cnt__nos_calling', 'more0cnt__calling_dura', 'moreq25cnt__gprs_last_defer', 'moreq25cnt__gprs_resource', 'moreq25cnt__gprs_flow_video', 'moreq25cnt__gprs_flow_5g', 'moreq25cnt__nos_calling', 'moreq25cnt__nos_calling_diff', 'moreq25cnt__arpu', 'moreq25cnt__calling_cnt', 'moreq25cnt__gprs_flow_commu', 'moreq25cnt__call_use', 'moreq25cnt__gprs_flow_4g', 'moreq25cnt__gprs_flow_music', 'moreq25cnt__calling_diff_cnt', 'moreq25cnt__gprs_flow_game', 'moreq25cnt__gprs_flow_short', 'moreq25cnt__calling_dura', 'valuecnt__if_nolimit~是', 'valuecnt__if_5g_dinner~是']
20220704-10:32:00      col_date: None
20220704-10:32:00      nrows: None
20220704-10:32:00      if_coltolower: False
20220704-10:32:00      kwargs: {}

20220704-10:32:00      读取
20220704-10:32:00  -------------------------读取完毕: (3500, 161) 2022-07-04 10:32:00 -------------------------

                   Out[32]: 20220704-10:32:08  False
20220704-10:32:12  ------------------------- 读取数据: ./binaryclassify/eg/traintest~202010~202012/test_data~202012.csv 2022-07-04 10:32:12 -------------------------
20220704-10:32:12      src: file
20220704-10:32:12      condition: None
20220704-10:32:12      col_need(161): ['data_use', 'acct_month', 'user_id', 'account_id', 'innet_months', 'user_status', 'monthsremain_last_stop_date', 'gprs_last_defer', 'gprs_now_rest', 'call_use', 'arpu', 'calling_cnt', 'calling_dura', 'calling_diff_dura', 'gprs_flow_4g', 'gprs_flow_5g', 'gprs_flow_roam', 'call_dura_roam', 'days_call_p_4', 'nos_calling', 'nos_calling_diff', 'gprs_flow_video', 'gprs_flow_short', 'gprs_flow_music', 'gprs_flow_commu', 'gprs_flow_game', 'greatest_gprs_app', 'sex_add~女', 'sex_add~男', 'avg__gprs_flow_roam', 'avg__monthsremain_last_stop_date', 'avg__gprs_last_defer', 'avg__gprs_resource', 'avg__calling_diff_dura', 'avg__gprs_flow_video', 'avg__gprs_flow_5g', 'avg__nos_calling', 'avg__nos_calling_diff', 'avg__arpu', 'avg__calling_cnt', 'avg__gprs_flow_commu', 'avg__gprs_now_defer', 'avg__call_use', 'avg__gprs_flow_4g', 'avg__gprs_now_rest', 'avg__gprs_flow_music', 'avg__calling_diff_cnt', 'avg__gprs_flow_game', 'avg__call_dura_roam', 'avg__gprs_flow_short', 'avg__calling_dura', 'sep__gprs_resource', 'sep__calling_diff_dura', 'sep__gprs_flow_5g', 'sep__nos_calling', 'sep__nos_calling_diff', 'sep__gprs_flow_commu', 'sep__gprs_now_rest', 'sep__calling_diff_cnt', 'sep__gprs_flow_short', 'sep__calling_dura', 'wave__monthsremain_last_stop_date', 'wave__gprs_last_defer', 'wave__gprs_flow_video', 'wave__calling_cnt', 'wave__gprs_flow_commu', 'wave__gprs_now_defer', 'wave__call_use', 'wave__gprs_now_rest', 'wave__gprs_flow_music', 'wave__calling_diff_cnt', 'wave__gprs_flow_short', 'wave__calling_dura', 'grow__gprs_flow_roam', 'grow__gprs_last_defer', 'grow__gprs_resource', 'grow__calling_diff_dura', 'grow__gprs_flow_video', 'grow__dinner_fee', 'grow__gprs_flow_5g', 'grow__nos_calling', 'grow__nos_calling_diff', 'grow__calling_cnt', 'grow__call_use', 'grow__gprs_now_rest', 'grow__gprs_flow_music', 'grow__calling_diff_cnt', 'max__gprs_flow_roam', 'max__monthsremain_last_stop_date', 'max__gprs_last_defer', 'max__gprs_resource', 'max__calling_diff_dura', 'max__dinner_fee', 'max__nos_calling', 'max__nos_calling_diff', 'max__arpu', 'max__calling_cnt', 'max__gprs_flow_commu', 'max__call_use', 'max__gprs_now_rest', 'max__gprs_flow_music', 'max__calling_diff_cnt', 'max__call_dura_roam', 'max__calling_dura', 'min__gprs_flow_roam', 'min__gprs_last_defer', 'min__gprs_resource', 'min__calling_diff_dura', 'min__gprs_flow_video', 'min__gprs_flow_5g', 'min__nos_calling', 'min__nos_calling_diff', 'min__arpu', 'min__calling_cnt', 'min__gprs_flow_commu', 'min__gprs_now_defer', 'min__call_use', 'min__gprs_flow_4g', 'min__gprs_now_rest', 'min__gprs_flow_music', 'min__calling_diff_cnt', 'min__gprs_flow_game', 'min__call_dura_roam', 'min__gprs_flow_short', 'min__calling_dura', 'std__gprs_last_defer', 'std__gprs_resource', 'std__calling_diff_dura', 'std__gprs_flow_video', 'std__nos_calling', 'std__nos_calling_diff', 'std__calling_cnt', 'std__gprs_flow_commu', 'std__call_use', 'std__gprs_flow_4g', 'std__gprs_now_rest', 'std__calling_diff_cnt', 'std__call_dura_roam', 'std__calling_dura', 'more0cnt__monthsremain_last_stop_date', 'more0cnt__nos_calling', 'more0cnt__calling_dura', 'moreq25cnt__gprs_last_defer', 'moreq25cnt__gprs_resource', 'moreq25cnt__gprs_flow_video', 'moreq25cnt__gprs_flow_5g', 'moreq25cnt__nos_calling', 'moreq25cnt__nos_calling_diff', 'moreq25cnt__arpu', 'moreq25cnt__calling_cnt', 'moreq25cnt__gprs_flow_commu', 'moreq25cnt__call_use', 'moreq25cnt__gprs_flow_4g', 'moreq25cnt__gprs_flow_music', 'moreq25cnt__calling_diff_cnt', 'moreq25cnt__gprs_flow_game', 'moreq25cnt__gprs_flow_short', 'moreq25cnt__calling_dura', 'valuecnt__if_nolimit~是', 'valuecnt__if_5g_dinner~是', 'flag_eg']
20220704-10:32:12      col_del: None
20220704-10:32:12      col_char(9): ['user_acct_month', 'data_use', 'acct_month', 'phone_no_null', 'user_id', 'account_id', 'user_status', 'greatest_gprs_app', 'flag_eg']
20220704-10:32:12      col_num(157): ['innet_months', 'monthsremain_last_stop_date', 'gprs_last_defer', 'gprs_now_rest', 'call_use', 'arpu', 'calling_cnt', 'calling_dura', 'calling_diff_dura', 'gprs_flow_4g', 'gprs_flow_5g', 'gprs_flow_roam', 'call_dura_roam', 'days_call_p_4', 'nos_calling', 'nos_calling_diff', 'sms_cnt', 'call_fee_local', 'gprs_flow_video', 'gprs_flow_short', 'gprs_flow_music', 'gprs_flow_commu', 'gprs_flow_game', 'dayvalue_gprs_flow', 'sex_add~女', 'sex_add~男', 'avg__gprs_flow_roam', 'avg__monthsremain_last_stop_date', 'avg__gprs_last_defer', 'avg__gprs_resource', 'avg__calling_diff_dura', 'avg__gprs_flow_video', 'avg__gprs_flow_5g', 'avg__nos_calling', 'avg__nos_calling_diff', 'avg__arpu', 'avg__calling_cnt', 'avg__gprs_flow_commu', 'avg__gprs_now_defer', 'avg__call_use', 'avg__gprs_flow_4g', 'avg__gprs_now_rest', 'avg__gprs_flow_music', 'avg__calling_diff_cnt', 'avg__gprs_flow_game', 'avg__call_dura_roam', 'avg__gprs_flow_short', 'avg__calling_dura', 'sep__gprs_resource', 'sep__calling_diff_dura', 'sep__gprs_flow_5g', 'sep__nos_calling', 'sep__nos_calling_diff', 'sep__gprs_flow_commu', 'sep__gprs_now_rest', 'sep__calling_diff_cnt', 'sep__gprs_flow_short', 'sep__calling_dura', 'wave__monthsremain_last_stop_date', 'wave__gprs_last_defer', 'wave__gprs_flow_video', 'wave__calling_cnt', 'wave__gprs_flow_commu', 'wave__gprs_now_defer', 'wave__call_use', 'wave__gprs_now_rest', 'wave__gprs_flow_music', 'wave__calling_diff_cnt', 'wave__gprs_flow_short', 'wave__calling_dura', 'grow__gprs_flow_roam', 'grow__gprs_last_defer', 'grow__gprs_resource', 'grow__calling_diff_dura', 'grow__gprs_flow_video', 'grow__dinner_fee', 'grow__gprs_flow_5g', 'grow__nos_calling', 'grow__nos_calling_diff', 'grow__calling_cnt', 'grow__call_use', 'grow__gprs_now_rest', 'grow__gprs_flow_music', 'grow__calling_diff_cnt', 'max__gprs_flow_roam', 'max__monthsremain_last_stop_date', 'max__gprs_last_defer', 'max__gprs_resource', 'max__calling_diff_dura', 'max__dinner_fee', 'max__nos_calling', 'max__nos_calling_diff', 'max__arpu', 'max__calling_cnt', 'max__gprs_flow_commu', 'max__call_use', 'max__gprs_now_rest', 'max__gprs_flow_music', 'max__calling_diff_cnt', 'max__call_dura_roam', 'max__calling_dura', 'min__gprs_flow_roam', 'min__gprs_last_defer', 'min__gprs_resource', 'min__calling_diff_dura', 'min__gprs_flow_video', 'min__gprs_flow_5g', 'min__nos_calling', 'min__nos_calling_diff', 'min__arpu', 'min__calling_cnt', 'min__gprs_flow_commu', 'min__gprs_now_defer', 'min__call_use', 'min__gprs_flow_4g', 'min__gprs_now_rest', 'min__gprs_flow_music', 'min__calling_diff_cnt', 'min__gprs_flow_game', 'min__call_dura_roam', 'min__gprs_flow_short', 'min__calling_dura', 'std__gprs_last_defer', 'std__gprs_resource', 'std__calling_diff_dura', 'std__gprs_flow_video', 'std__nos_calling', 'std__nos_calling_diff', 'std__calling_cnt', 'std__gprs_flow_commu', 'std__call_use', 'std__gprs_flow_4g', 'std__gprs_now_rest', 'std__calling_diff_cnt', 'std__call_dura_roam', 'std__calling_dura', 'more0cnt__monthsremain_last_stop_date', 'more0cnt__nos_calling', 'more0cnt__calling_dura', 'moreq25cnt__gprs_last_defer', 'moreq25cnt__gprs_resource', 'moreq25cnt__gprs_flow_video', 'moreq25cnt__gprs_flow_5g', 'moreq25cnt__nos_calling', 'moreq25cnt__nos_calling_diff', 'moreq25cnt__arpu', 'moreq25cnt__calling_cnt', 'moreq25cnt__gprs_flow_commu', 'moreq25cnt__call_use', 'moreq25cnt__gprs_flow_4g', 'moreq25cnt__gprs_flow_music', 'moreq25cnt__calling_diff_cnt', 'moreq25cnt__gprs_flow_game', 'moreq25cnt__gprs_flow_short', 'moreq25cnt__calling_dura', 'valuecnt__if_nolimit~是', 'valuecnt__if_5g_dinner~是']
20220704-10:32:12      col_date: None
20220704-10:32:12      nrows: None
20220704-10:32:12      if_coltolower: False
20220704-10:32:12      kwargs: {}

20220704-10:32:12      读取
20220704-10:32:12  -------------------------读取完毕: (1000, 161) 2022-07-04 10:32:12 -------------------------

20220704-10:32:12  合并训练、测试数据
20220704-10:32:17  data.shape: (4500, 161)

20220704-10:32:17  数据分布：
                       202010  data_timein  0    423
                       202010  data_timein  1    77
                       202010  data_train  0    2000
                       202010  data_train  1    1000
                       202012  data_timeout  0    846
                       202012  data_timeout  1    154
                       dtype: int64

20220704-10:32:33  数据集整合：
                   Out[38]: 20220704-10:33:15  'train'
                   Out[39]: 20220704-10:33:19  
                           data_use acct_month      user_id      account_id  innet_months user_status  monthsremain_last_stop_date  gprs_last_defer  gprs_now_rest  call_use   arpu  calling_cnt  \
                   500   data_train     202010  14357873779         1464511         173.0   在网-正常                         -7.0              0.0        30674.0      11.0  14.50          5.0   
                   501   data_train     202010  23883026199         6536083         161.0   在网-正常                        -70.0            300.0     11100167.0       0.0  18.00          0.0   
                   502   data_train     202010  23785437441        42961293         119.0   在网-正常                        -25.0             10.0     10506248.0      18.0   8.00         16.0   
                   503   data_train     202010  24498499740        63527749         256.0   在网-正常                         -7.0              0.0            0.0     151.0  73.00        108.0   
                   504   data_train     202010  20361264058         2140997         217.0   在网-正常                         -7.0             10.0        20482.0      89.0  35.25         35.0   
                   ...          ...        ...          ...             ...           ...         ...                          ...              ...            ...       ...    ...          ...   
                   3495  data_train     202010  78573110660  30100000000000           7.0   在网-正常                         -6.0              0.0            0.0       0.0   9.78          0.0   
                   3496  data_train     202010  76680325400        35251403         164.0   在网-正常                        -26.0              0.0            7.0      16.0   8.00          8.0   
                   3497  data_train     202010  16614929462       104934381         116.0   在网-正常                         -1.0            100.0     10690559.0       2.0  28.15          2.0   
                   3498  data_train     202010  27301750037  30100000000000          93.0   在网-正常                        -48.0             30.0        61423.0       0.0   6.03          0.0   
                   3499  data_train     202010  23777067604  30100000000000          57.0   在网-正常                        -12.0            300.0     11098008.0       2.0  38.00          2.0   
                   
                         calling_dura  calling_diff_dura  gprs_flow_4g  ...  moreq25cnt__nos_calling  moreq25cnt__nos_calling_diff  moreq25cnt__arpu  moreq25cnt__calling_cnt  \
                   500           11.0               11.0       10833.0  ...                      3.0                           3.0               3.0                      3.0   
                   501            0.0                0.0           0.0  ...                      0.0                           0.0               3.0                      0.0   
                   502           18.0               18.0           0.0  ...                      1.0                           3.0               0.0                      3.0   
                   503          557.0               44.0    22961644.0  ...                      3.0                           3.0               3.0                      3.0   
                   504          119.0               27.0      320127.0  ...                      3.0                           3.0               3.0                      3.0   
                   ...            ...                ...           ...  ...                      ...                           ...               ...                      ...   
                   3495           0.0                0.0           0.0  ...                      1.0                           1.0               0.0                      1.0   
                   3496          16.0                3.0       27668.0  ...                      2.0                           2.0               0.0                      3.0   
                   3497           2.0                2.0       10368.0  ...                      1.0                           2.0               3.0                      2.0   
                   3498           0.0                0.0          89.0  ...                      1.0                           1.0               0.0                      0.0   
                   3499           2.0                1.0       26701.0  ...                      3.0                           3.0               3.0                      3.0   
                   
                         moreq25cnt__gprs_flow_commu  moreq25cnt__call_use  moreq25cnt__gprs_flow_4g  moreq25cnt__gprs_flow_music  moreq25cnt__calling_diff_cnt  moreq25cnt__gprs_flow_game  \
                   500                           1.0                   3.0                       3.0                          0.0                           3.0                         0.0   
                   501                           0.0                   1.0                       0.0                          0.0                           0.0                         0.0   
                   502                           0.0                   3.0                       0.0                          0.0                           3.0                         0.0   
                   503                           3.0                   3.0                       3.0                          2.0                           3.0                         0.0   
                   504                           0.0                   3.0                       3.0                          0.0                           3.0                         0.0   
                   ...                           ...                   ...                       ...                          ...                           ...                         ...   
                   3495                          0.0                   1.0                       0.0                          0.0                           1.0                         0.0   
                   3496                          0.0                   3.0                       3.0                          0.0                           3.0                         0.0   
                   3497                          0.0                   2.0                       3.0                          0.0                           2.0                         0.0   
                   3498                          0.0                   0.0                       1.0                          0.0                           0.0                         0.0   
                   3499                          0.0                   3.0                       3.0                          0.0                           3.0                         0.0   
                   
                         moreq25cnt__gprs_flow_short moreq25cnt__calling_dura  valuecnt__if_nolimit~是  valuecnt__if_5g_dinner~是  flag_eg  
                   500                           1.0                      3.0                      0.0                        0.0        0  
                   501                           0.0                      0.0                      0.0                        0.0        1  
                   502                           0.0                      3.0                      0.0                        0.0        0  
                   503                           0.0                      3.0                      3.0                        0.0        1  
                   504                           0.0                      3.0                      0.0                        0.0        0  
                   ...                           ...                      ...                      ...                        ...      ...  
                   3495                          0.0                      1.0                      0.0                        0.0        0  
                   3496                          0.0                      3.0                      0.0                        0.0        0  
                   3497                          0.0                      2.0                      0.0                        0.0        0  
                   3498                          0.0                      0.0                      0.0                        0.0        0  
                   3499                          0.0                      3.0                      0.0                        0.0        0  
                   
                   [3000 rows x 161 columns]
20220704-10:33:41  -------------------------- train --------------------------
                   Out[41]: 20220704-10:33:45  {'0', '1'}
                   Out[42]: 20220704-10:33:47  {'0', '1'}
20220704-10:33:55  校验账期:                    20220704-10:33:55      通过


D:\Program Files\PyCharm 2021.2.2\plugins\python\helpers\pydev\pydevconsole.py:4: UserWarning: Pandas doesn't allow columns to be created via a new attribute name - see https://pandas.pydata.org/pandas-docs/stable/indexing.html#attribute-access
  from _pydev_bundle._pydev_getopt import gnu_getopt
                   Out[45]: 20220704-10:34:12  
                   0    2000
                   1    1000
                   Name: flag_eg, dtype: int64
                   Out[46]: 20220704-10:34:17  OrderedDict()
                   Out[48]: 20220704-10:34:25  [10]
                   Out[49]: 20220704-10:34:28  [1, 2, 10]
                   Out[50]: 20220704-10:34:31  2.0
                   Out[51]: 20220704-10:54:14  OrderedDict()
                   Out[52]: 20220704-10:54:17  
                   0    2000
                   1    1000
                   Name: flag_eg, dtype: int64
                   Out[53]: 20220704-10:54:24  2.0
                   Out[54]: 20220704-10:54:29  [1, 2, 10]
                   Out[55]: 20220704-10:54:41  [10]
                   Out[56]: 20220704-10:54:53  2.0
                   Out[57]: 20220704-10:55:04  [10]
20220704-10:55:10  trainproc_ratiolist：[1, 2, 10]
                   Out[60]: 20220704-10:55:20  [1, 2]
20220704-10:56:52  正负例实际比例最高：1:2.0，将trainproc_ratiolist纠正为:[1, 2]


Traceback (most recent call last):
  File "D:\Python for Windows\lib\site-packages\IPython\core\interactiveshell.py", line 3296, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-63-bf74826859a3>", line 4, in <module>
    train_sample_set[key] = train_sample(d, Info, ratio, Info.random_state)
NameError: name 'train_sample' is not defined
20220704-10:57:34  随机抽样 1:1
20220704-10:57:34      正例样本：1000
20220704-10:57:34      负例样本：2000
20220704-10:57:34          从负例中随机抽取1000（1000*1）
20220704-10:57:34  随机抽样 1:2
20220704-10:57:34      正例样本：1000
20220704-10:57:34      负例样本：2000
20220704-10:57:34          从负例中随机抽取2000（1000*2）
                   Out[66]: 20220704-10:57:44  'ratio_1_2'
                   Out[67]: 20220704-10:57:51  
                   OrderedDict([('ratio_1_1',
                                         data_use acct_month      user_id      account_id  innet_months user_status  monthsremain_last_stop_date  gprs_last_defer  gprs_now_rest  call_use   arpu  calling_cnt  \
                                 501   data_train     202010  23883026199         6536083         161.0   在网-正常                        -70.0            300.0     11100167.0       0.0  18.00          0.0   
                                 503   data_train     202010  24498499740        63527749         256.0   在网-正常                         -7.0              0.0            0.0     151.0  73.00        108.0   
                                 506   data_train     202010  20066574592        53196251         115.0   在网-正常                        -22.0              0.0            0.0      50.0  82.59         26.0   
                                 513   data_train     202010  78528839233  30100000000000          32.0   在网-正常                         -5.0            500.0    116367360.0      40.0  40.52          3.0   
                                 515   data_train     202010  81615377856        40307873         165.0   在网-正常                        -26.0             10.0     10506216.0       0.0   8.00          0.0   
                                 ...          ...        ...          ...             ...           ...         ...                          ...              ...            ...       ...    ...          ...   
                                 2379  data_train     202010  17297007663  30100000000000          63.0   在网-正常                          0.0           6867.0     31206974.0     110.0  92.00         75.0   
                                 950   data_train     202010  21722720190       114642707         108.0   在网-正常                          0.0              0.0     10688039.0      65.0  48.29         42.0   
                                 622   data_train     202010  24016020497        52615923         163.0   在网-正常                         -4.0              0.0    104857600.0       0.0  68.70          0.0   
                                 505   data_train     202010  20484426373       106770355         169.0   在网-正常                        -16.0              0.0      2693819.0      60.0  34.60         65.0   
                                 2946  data_train     202010  20253943327  30100000000000          39.0   在网-正常                          0.0          10240.0     47185909.0       0.0  85.00          0.0   
                                 
                                       calling_dura  calling_diff_dura  gprs_flow_4g  ...  moreq25cnt__nos_calling  moreq25cnt__nos_calling_diff  moreq25cnt__arpu  moreq25cnt__calling_cnt  \
                                 501            0.0                0.0           0.0  ...                      0.0                           0.0               3.0                      0.0   
                                 503          557.0               44.0    22961644.0  ...                      3.0                           3.0               3.0                      3.0   
                                 506           71.0               12.0    13445897.0  ...                      3.0                           3.0               3.0                      3.0   
                                 513           48.0                0.0       69846.0  ...                      3.0                           2.0               3.0                      3.0   
                                 515            0.0                0.0        5382.0  ...                      0.0                           0.0               0.0                      0.0   
                                 ...            ...                ...           ...  ...                      ...                           ...               ...                      ...   
                                 2379         113.0               50.0    12525946.0  ...                      3.0                           3.0               3.0                      3.0   
                                 950           91.0               24.0    10558319.0  ...                      3.0                           3.0               3.0                      3.0   
                                 622            0.0                0.0       34287.0  ...                      0.0                           0.0               3.0                      0.0   
                                 505          143.0               57.0     7916551.0  ...                      3.0                           3.0               3.0                      3.0   
                                 2946           0.0                0.0           0.0  ...                      1.0                           0.0               3.0                      1.0   
                                 
                                       moreq25cnt__gprs_flow_commu  moreq25cnt__call_use  moreq25cnt__gprs_flow_4g  moreq25cnt__gprs_flow_music  moreq25cnt__calling_diff_cnt  moreq25cnt__gprs_flow_game  \
                                 501                           0.0                   1.0                       0.0                          0.0                           0.0                         0.0   
                                 503                           3.0                   3.0                       3.0                          2.0                           3.0                         0.0   
                                 506                           0.0                   3.0                       3.0                          0.0                           3.0                         0.0   
                                 513                           0.0                   3.0                       3.0                          0.0                           1.0                         0.0   
                                 515                           0.0                   0.0                       2.0                          0.0                           0.0                         0.0   
                                 ...                           ...                   ...                       ...                          ...                           ...                         ...   
                                 2379                          1.0                   3.0                       3.0                          0.0                           3.0                         0.0   
                                 950                           3.0                   3.0                       3.0                          2.0                           3.0                         0.0   
                                 622                           0.0                   0.0                       3.0                          0.0                           0.0                         0.0   
                                 505                           2.0                   3.0                       2.0                          1.0                           3.0                         0.0   
                                 2946                          0.0                   0.0                       0.0                          0.0                           0.0                         0.0   
                                 
                                       moreq25cnt__gprs_flow_short moreq25cnt__calling_dura  valuecnt__if_nolimit~是  valuecnt__if_5g_dinner~是  flag_eg  
                                 501                           0.0                      0.0                      0.0                        0.0        1  
                                 503                           0.0                      3.0                      3.0                        0.0        1  
                                 506                           0.0                      3.0                      2.0                        1.0        1  
                                 513                           0.0                      3.0                      0.0                        0.0        1  
                                 515                           0.0                      0.0                      0.0                        0.0        1  
                                 ...                           ...                      ...                      ...                        ...      ...  
                                 2379                          1.0                      3.0                      0.0                        0.0        0  
                                 950                           2.0                      3.0                      0.0                        0.0        0  
                                 622                           0.0                      0.0                      0.0                        0.0        0  
                                 505                           2.0                      3.0                      0.0                        0.0        0  
                                 2946                          0.0                      1.0                      0.0                        3.0        0  
                                 
                                 [2000 rows x 161 columns]),
                                ('ratio_1_2',
                                         data_use acct_month      user_id      account_id  innet_months user_status  monthsremain_last_stop_date  gprs_last_defer  gprs_now_rest  call_use   arpu  calling_cnt  \
                                 501   data_train     202010  23883026199         6536083         161.0   在网-正常                        -70.0            300.0     11100167.0       0.0  18.00          0.0   
                                 503   data_train     202010  24498499740        63527749         256.0   在网-正常                         -7.0              0.0            0.0     151.0  73.00        108.0   
                                 506   data_train     202010  20066574592        53196251         115.0   在网-正常                        -22.0              0.0            0.0      50.0  82.59         26.0   
                                 513   data_train     202010  78528839233  30100000000000          32.0   在网-正常                         -5.0            500.0    116367360.0      40.0  40.52          3.0   
                                 515   data_train     202010  81615377856        40307873         165.0   在网-正常                        -26.0             10.0     10506216.0       0.0   8.00          0.0   
                                 ...          ...        ...          ...             ...           ...         ...                          ...              ...            ...       ...    ...          ...   
                                 2090  data_train     202010  24128910785       118350294         104.0   在网-正常                        -15.0              0.0            0.0       1.0   8.00          1.0   
                                 2794  data_train     202010  81732009518        42805690         166.0   在网-正常                        -54.0              0.0            0.0       3.0   8.15          7.0   
                                 918   data_train     202010  81349238245        37232868         129.0   在网-正常                        -58.0              0.0            0.0       6.0   8.00          3.0   
                                 1622  data_train     202010  21917239640         4068567         212.0   在网-正常                        -55.0             40.0        81918.0       0.0  10.00          0.0   
                                 2283  data_train     202010  27475297390        66057918         141.0   在网-正常                         -9.0              0.0            0.0       2.0  38.00          1.0   
                                 
                                       calling_dura  calling_diff_dura  gprs_flow_4g  ...  moreq25cnt__nos_calling  moreq25cnt__nos_calling_diff  moreq25cnt__arpu  moreq25cnt__calling_cnt  \
                                 501            0.0                0.0           0.0  ...                      0.0                           0.0               3.0                      0.0   
                                 503          557.0               44.0    22961644.0  ...                      3.0                           3.0               3.0                      3.0   
                                 506           71.0               12.0    13445897.0  ...                      3.0                           3.0               3.0                      3.0   
                                 513           48.0                0.0       69846.0  ...                      3.0                           2.0               3.0                      3.0   
                                 515            0.0                0.0        5382.0  ...                      0.0                           0.0               0.0                      0.0   
                                 ...            ...                ...           ...  ...                      ...                           ...               ...                      ...   
                                 2090           1.0                0.0        7414.0  ...                      2.0                           1.0               0.0                      1.0   
                                 2794          12.0                0.0       64561.0  ...                      3.0                           1.0               0.0                      3.0   
                                 918            6.0                2.0           0.0  ...                      3.0                           3.0               0.0                      3.0   
                                 1622           0.0                0.0        6792.0  ...                      0.0                           0.0               0.0                      0.0   
                                 2283           2.0                0.0       18502.0  ...                      1.0                           1.0               3.0                      0.0   
                                 
                                       moreq25cnt__gprs_flow_commu  moreq25cnt__call_use  moreq25cnt__gprs_flow_4g  moreq25cnt__gprs_flow_music  moreq25cnt__calling_diff_cnt  moreq25cnt__gprs_flow_game  \
                                 501                           0.0                   1.0                       0.0                          0.0                           0.0                         0.0   
                                 503                           3.0                   3.0                       3.0                          2.0                           3.0                         0.0   
                                 506                           0.0                   3.0                       3.0                          0.0                           3.0                         0.0   
                                 513                           0.0                   3.0                       3.0                          0.0                           1.0                         0.0   
                                 515                           0.0                   0.0                       2.0                          0.0                           0.0                         0.0   
                                 ...                           ...                   ...                       ...                          ...                           ...                         ...   
                                 2090                          0.0                   3.0                       3.0                          0.0                           1.0                         0.0   
                                 2794                          0.0                   3.0                       3.0                          0.0                           1.0                         0.0   
                                 918                           0.0                   3.0                       1.0                          0.0                           3.0                         0.0   
                                 1622                          0.0                   1.0                       3.0                          0.0                           0.0                         0.0   
                                 2283                          0.0                   2.0                       3.0                          0.0                           0.0                         0.0   
                                 
                                       moreq25cnt__gprs_flow_short moreq25cnt__calling_dura  valuecnt__if_nolimit~是  valuecnt__if_5g_dinner~是  flag_eg  
                                 501                           0.0                      0.0                      0.0                        0.0        1  
                                 503                           0.0                      3.0                      3.0                        0.0        1  
                                 506                           0.0                      3.0                      2.0                        1.0        1  
                                 513                           0.0                      3.0                      0.0                        0.0        1  
                                 515                           0.0                      0.0                      0.0                        0.0        1  
                                 ...                           ...                      ...                      ...                        ...      ...  
                                 2090                          0.0                      1.0                      0.0                        0.0        0  
                                 2794                          0.0                      3.0                      0.0                        0.0        0  
                                 918                           0.0                      3.0                      0.0                        0.0        0  
                                 1622                          0.0                      1.0                      0.0                        0.0        0  
                                 2283                          0.0                      2.0                      0.0                        0.0        0  
                                 
                                 [3000 rows x 161 columns])])
                   Out[68]: 20220704-10:58:02  collections.OrderedDict
                   Out[69]: 20220704-10:58:13  odict_keys(['ratio_1_1', 'ratio_1_2'])
                   Out[71]: 20220704-10:58:24  
                   OrderedDict([('ratio_1_1',
                                         data_use acct_month      user_id      account_id  innet_months user_status  monthsremain_last_stop_date  gprs_last_defer  gprs_now_rest  call_use   arpu  calling_cnt  \
                                 501   data_train     202010  23883026199         6536083         161.0   在网-正常                        -70.0            300.0     11100167.0       0.0  18.00          0.0   
                                 503   data_train     202010  24498499740        63527749         256.0   在网-正常                         -7.0              0.0            0.0     151.0  73.00        108.0   
                                 506   data_train     202010  20066574592        53196251         115.0   在网-正常                        -22.0              0.0            0.0      50.0  82.59         26.0   
                                 513   data_train     202010  78528839233  30100000000000          32.0   在网-正常                         -5.0            500.0    116367360.0      40.0  40.52          3.0   
                                 515   data_train     202010  81615377856        40307873         165.0   在网-正常                        -26.0             10.0     10506216.0       0.0   8.00          0.0   
                                 ...          ...        ...          ...             ...           ...         ...                          ...              ...            ...       ...    ...          ...   
                                 2379  data_train     202010  17297007663  30100000000000          63.0   在网-正常                          0.0           6867.0     31206974.0     110.0  92.00         75.0   
                                 950   data_train     202010  21722720190       114642707         108.0   在网-正常                          0.0              0.0     10688039.0      65.0  48.29         42.0   
                                 622   data_train     202010  24016020497        52615923         163.0   在网-正常                         -4.0              0.0    104857600.0       0.0  68.70          0.0   
                                 505   data_train     202010  20484426373       106770355         169.0   在网-正常                        -16.0              0.0      2693819.0      60.0  34.60         65.0   
                                 2946  data_train     202010  20253943327  30100000000000          39.0   在网-正常                          0.0          10240.0     47185909.0       0.0  85.00          0.0   
                                 
                                       calling_dura  calling_diff_dura  gprs_flow_4g  ...  moreq25cnt__nos_calling  moreq25cnt__nos_calling_diff  moreq25cnt__arpu  moreq25cnt__calling_cnt  \
                                 501            0.0                0.0           0.0  ...                      0.0                           0.0               3.0                      0.0   
                                 503          557.0               44.0    22961644.0  ...                      3.0                           3.0               3.0                      3.0   
                                 506           71.0               12.0    13445897.0  ...                      3.0                           3.0               3.0                      3.0   
                                 513           48.0                0.0       69846.0  ...                      3.0                           2.0               3.0                      3.0   
                                 515            0.0                0.0        5382.0  ...                      0.0                           0.0               0.0                      0.0   
                                 ...            ...                ...           ...  ...                      ...                           ...               ...                      ...   
                                 2379         113.0               50.0    12525946.0  ...                      3.0                           3.0               3.0                      3.0   
                                 950           91.0               24.0    10558319.0  ...                      3.0                           3.0               3.0                      3.0   
                                 622            0.0                0.0       34287.0  ...                      0.0                           0.0               3.0                      0.0   
                                 505          143.0               57.0     7916551.0  ...                      3.0                           3.0               3.0                      3.0   
                                 2946           0.0                0.0           0.0  ...                      1.0                           0.0               3.0                      1.0   
                                 
                                       moreq25cnt__gprs_flow_commu  moreq25cnt__call_use  moreq25cnt__gprs_flow_4g  moreq25cnt__gprs_flow_music  moreq25cnt__calling_diff_cnt  moreq25cnt__gprs_flow_game  \
                                 501                           0.0                   1.0                       0.0                          0.0                           0.0                         0.0   
                                 503                           3.0                   3.0                       3.0                          2.0                           3.0                         0.0   
                                 506                           0.0                   3.0                       3.0                          0.0                           3.0                         0.0   
                                 513                           0.0                   3.0                       3.0                          0.0                           1.0                         0.0   
                                 515                           0.0                   0.0                       2.0                          0.0                           0.0                         0.0   
                                 ...                           ...                   ...                       ...                          ...                           ...                         ...   
                                 2379                          1.0                   3.0                       3.0                          0.0                           3.0                         0.0   
                                 950                           3.0                   3.0                       3.0                          2.0                           3.0                         0.0   
                                 622                           0.0                   0.0                       3.0                          0.0                           0.0                         0.0   
                                 505                           2.0                   3.0                       2.0                          1.0                           3.0                         0.0   
                                 2946                          0.0                   0.0                       0.0                          0.0                           0.0                         0.0   
                                 
                                       moreq25cnt__gprs_flow_short moreq25cnt__calling_dura  valuecnt__if_nolimit~是  valuecnt__if_5g_dinner~是  flag_eg  
                                 501                           0.0                      0.0                      0.0                        0.0        1  
                                 503                           0.0                      3.0                      3.0                        0.0        1  
                                 506                           0.0                      3.0                      2.0                        1.0        1  
                                 513                           0.0                      3.0                      0.0                        0.0        1  
                                 515                           0.0                      0.0                      0.0                        0.0        1  
                                 ...                           ...                      ...                      ...                        ...      ...  
                                 2379                          1.0                      3.0                      0.0                        0.0        0  
                                 950                           2.0                      3.0                      0.0                        0.0        0  
                                 622                           0.0                      0.0                      0.0                        0.0        0  
                                 505                           2.0                      3.0                      0.0                        0.0        0  
                                 2946                          0.0                      1.0                      0.0                        3.0        0  
                                 
                                 [2000 rows x 161 columns]),
                                ('ratio_1_2',
                                         data_use acct_month      user_id      account_id  innet_months user_status  monthsremain_last_stop_date  gprs_last_defer  gprs_now_rest  call_use   arpu  calling_cnt  \
                                 501   data_train     202010  23883026199         6536083         161.0   在网-正常                        -70.0            300.0     11100167.0       0.0  18.00          0.0   
                                 503   data_train     202010  24498499740        63527749         256.0   在网-正常                         -7.0              0.0            0.0     151.0  73.00        108.0   
                                 506   data_train     202010  20066574592        53196251         115.0   在网-正常                        -22.0              0.0            0.0      50.0  82.59         26.0   
                                 513   data_train     202010  78528839233  30100000000000          32.0   在网-正常                         -5.0            500.0    116367360.0      40.0  40.52          3.0   
                                 515   data_train     202010  81615377856        40307873         165.0   在网-正常                        -26.0             10.0     10506216.0       0.0   8.00          0.0   
                                 ...          ...        ...          ...             ...           ...         ...                          ...              ...            ...       ...    ...          ...   
                                 2090  data_train     202010  24128910785       118350294         104.0   在网-正常                        -15.0              0.0            0.0       1.0   8.00          1.0   
                                 2794  data_train     202010  81732009518        42805690         166.0   在网-正常                        -54.0              0.0            0.0       3.0   8.15          7.0   
                                 918   data_train     202010  81349238245        37232868         129.0   在网-正常                        -58.0              0.0            0.0       6.0   8.00          3.0   
                                 1622  data_train     202010  21917239640         4068567         212.0   在网-正常                        -55.0             40.0        81918.0       0.0  10.00          0.0   
                                 2283  data_train     202010  27475297390        66057918         141.0   在网-正常                         -9.0              0.0            0.0       2.0  38.00          1.0   
                                 
                                       calling_dura  calling_diff_dura  gprs_flow_4g  ...  moreq25cnt__nos_calling  moreq25cnt__nos_calling_diff  moreq25cnt__arpu  moreq25cnt__calling_cnt  \
                                 501            0.0                0.0           0.0  ...                      0.0                           0.0               3.0                      0.0   
                                 503          557.0               44.0    22961644.0  ...                      3.0                           3.0               3.0                      3.0   
                                 506           71.0               12.0    13445897.0  ...                      3.0                           3.0               3.0                      3.0   
                                 513           48.0                0.0       69846.0  ...                      3.0                           2.0               3.0                      3.0   
                                 515            0.0                0.0        5382.0  ...                      0.0                           0.0               0.0                      0.0   
                                 ...            ...                ...           ...  ...                      ...                           ...               ...                      ...   
                                 2090           1.0                0.0        7414.0  ...                      2.0                           1.0               0.0                      1.0   
                                 2794          12.0                0.0       64561.0  ...                      3.0                           1.0               0.0                      3.0   
                                 918            6.0                2.0           0.0  ...                      3.0                           3.0               0.0                      3.0   
                                 1622           0.0                0.0        6792.0  ...                      0.0                           0.0               0.0                      0.0   
                                 2283           2.0                0.0       18502.0  ...                      1.0                           1.0               3.0                      0.0   
                                 
                                       moreq25cnt__gprs_flow_commu  moreq25cnt__call_use  moreq25cnt__gprs_flow_4g  moreq25cnt__gprs_flow_music  moreq25cnt__calling_diff_cnt  moreq25cnt__gprs_flow_game  \
                                 501                           0.0                   1.0                       0.0                          0.0                           0.0                         0.0   
                                 503                           3.0                   3.0                       3.0                          2.0                           3.0                         0.0   
                                 506                           0.0                   3.0                       3.0                          0.0                           3.0                         0.0   
                                 513                           0.0                   3.0                       3.0                          0.0                           1.0                         0.0   
                                 515                           0.0                   0.0                       2.0                          0.0                           0.0                         0.0   
                                 ...                           ...                   ...                       ...                          ...                           ...                         ...   
                                 2090                          0.0                   3.0                       3.0                          0.0                           1.0                         0.0   
                                 2794                          0.0                   3.0                       3.0                          0.0                           1.0                         0.0   
                                 918                           0.0                   3.0                       1.0                          0.0                           3.0                         0.0   
                                 1622                          0.0                   1.0                       3.0                          0.0                           0.0                         0.0   
                                 2283                          0.0                   2.0                       3.0                          0.0                           0.0                         0.0   
                                 
                                       moreq25cnt__gprs_flow_short moreq25cnt__calling_dura  valuecnt__if_nolimit~是  valuecnt__if_5g_dinner~是  flag_eg  
                                 501                           0.0                      0.0                      0.0                        0.0        1  
                                 503                           0.0                      3.0                      3.0                        0.0        1  
                                 506                           0.0                      3.0                      2.0                        1.0        1  
                                 513                           0.0                      3.0                      0.0                        0.0        1  
                                 515                           0.0                      0.0                      0.0                        0.0        1  
                                 ...                           ...                      ...                      ...                        ...      ...  
                                 2090                          0.0                      1.0                      0.0                        0.0        0  
                                 2794                          0.0                      3.0                      0.0                        0.0        0  
                                 918                           0.0                      3.0                      0.0                        0.0        0  
                                 1622                          0.0                      1.0                      0.0                        0.0        0  
                                 2283                          0.0                      2.0                      0.0                        0.0        0  
                                 
                                 [3000 rows x 161 columns])])
                   Out[72]: 20220704-10:58:40  'data_train'


Traceback (most recent call last):
  File "D:\Python for Windows\lib\site-packages\IPython\core\interactiveshell.py", line 3296, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-74-35e5c8a5ab93>", line 1, in <module>
    gc.collect()
NameError: name 'gc' is not defined
                   Out[75]: 20220704-10:59:01  False
                   Out[76]: 20220704-10:59:09  False


D:\Program Files\PyCharm 2021.2.2\plugins\python\helpers\pydev\pydevconsole.py:2: UserWarning: 请确定模型评估数据集名称, data_set.keys():['data_train']
  Entry point module to start the interactive console.

20220704-10:59:25  遍历不同的抽样比例、数据预处理流水线、算法 进行训练测试:



Traceback (most recent call last):
  File "D:\Python for Windows\lib\site-packages\IPython\core\interactiveshell.py", line 3296, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-79-038800dff362>", line 4, in <module>
    model_flows, _ = model_cycle(data_set, pipelines, models, Info, field_comment, col_pre, skip, False)
NameError: name 'model_cycle' is not defined
20220704-10:59:40  ------------------------------------------ 抽样比例：ratio_1_1 ------------------------------------------

20220704-10:59:40  ------------------------- 流水线：pipeline1 -------------------------
20220704-10:59:40  train_X: (2000, 159)


D:\工作\模型脚本\ModelProject\selfmodule\toolmodule\dataprep.py:483: UserWarning:     FeaturePrefilter_DF unique_limit(5000)小于X行数(2000), 添加unique_limit_actual：len(X)*0.99=1980
  warnings.warn(s); time.sleep(seconds)


D:\工作\模型脚本\ModelProject\selfmodule\toolmodule\dataprep.py:995: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead.  To get a de-fragmented frame, use `newframe = frame.copy()`
  X_woe[i] = X[i].map(self.col_tabl_[i].woe)
20220704-10:59:56  转换完毕，进入模型(X+Y)：(2000, 136)

20220704-10:59:56  训练测试 LGBMClassifier_DF - boosting_type='gbdt', colsample_bytree=0.9916168768550919, importance_type='split', is_unbalance=False, learning_rate=0.02269504678452342, max_depth=-1, min_child_samples=165, min_child_weight=0.001, min_split_gain=0.0, n_estimators=169, n_jobs=-1, num_leaves=22, reg_alpha=0.36607148130872236, reg_lambda=0.10119960284131346, silent=True, subsample=0.9304256141925331, subsample_for_bin=40000, subsample_freq=0
20220704-10:59:56  data_train测试效果：
                        累计人数占比 累计人数 累计人数_1 累计查准率 累计查全率 累计提升度
                                1.1%       22         22     100.0%       2.2%        2.0
                                5.0%      100         96      96.0%       9.6%        1.9
                               10.0%      200        190      95.0%      19.0%        1.9
                               20.0%      400        357      89.2%      35.7%        1.8
                               30.0%      600        490      81.7%      49.0%        1.6
                               40.0%      800        616      77.0%      61.6%        1.5
                               50.0%     1000        708      70.8%      70.8%        1.4
                               60.0%     1200        790      65.8%      79.0%        1.3
                               70.0%     1400        868      62.0%      86.8%        1.2
                               80.0%     1600        921      57.6%      92.1%        1.2
                               90.0%     1800        971      53.9%      97.1%        1.1
                              100.0%     2000       1000      50.0%     100.0%        1.0

20220704-10:59:56  训练测试 LGBMClassifier_DF - boosting_type='dart', objective='binary', num_leaves=511, learning_rate=0.1, colsample_bytree=0.8, subsample=0.6, subsample_freq=20
20220704-10:59:56  data_train测试效果：
                        累计人数占比 累计人数 累计人数_1 累计查准率 累计查全率 累计提升度
                                1.0%       20         20     100.0%       2.0%        2.0
                                5.0%      100        100     100.0%      10.0%        2.0
                               10.0%      200        200     100.0%      20.0%        2.0
                               20.0%      400        394      98.5%      39.4%        2.0
                               30.0%      600        575      95.8%      57.5%        1.9
                               40.0%      800        735      91.9%      73.5%        1.8
                               50.0%     1000        857      85.7%      85.7%        1.7
                               60.0%     1200        926      77.2%      92.6%        1.5
                               70.0%     1400        963      68.8%      96.3%        1.4
                               80.0%     1600        982      61.4%      98.2%        1.2
                               90.0%     1800        990      55.0%      99.0%        1.1
                              100.0%     2000       1000      50.0%     100.0%        1.0

20220704-10:59:56  训练测试 XGBClassifier_DF - 默认参数


D:\Python for Windows\lib\site-packages\xgboost\sklearn.py:1224: UserWarning: The use of label encoder in XGBClassifier is deprecated and will be removed in a future release. To remove this warning, do the following: 1) Pass option use_label_encoder=False when constructing XGBClassifier object; and 2) Encode your labels (y) as integers starting with 0, i.e. 0, 1, 2, ..., [num_class - 1].
  warnings.warn(label_encoder_deprecation_msg, UserWarning)
20220704-10:59:57  data_train测试效果：
                        累计人数占比 累计人数 累计人数_1 累计查准率 累计查全率 累计提升度
                                1.1%       21         21     100.0%       2.1%        2.0
                                5.0%      100        100     100.0%      10.0%        2.0
                               10.0%      200        200     100.0%      20.0%        2.0
                               20.0%      400        400     100.0%      40.0%        2.0
                               30.0%      600        600     100.0%      60.0%        2.0
                               40.0%      800        800     100.0%      80.0%        2.0
                               50.0%     1000        976      97.6%      97.6%        2.0
                               60.0%     1200        995      82.9%      99.5%        1.7
                               70.0%     1400       1000      71.4%     100.0%        1.4
                               80.0%     1600       1000      62.5%     100.0%        1.2
                               90.0%     1800       1000      55.6%     100.0%        1.1
                              100.0%     2000       1000      50.0%     100.0%        1.0

20220704-10:59:57  训练测试 RandomForestClassifier_DF - 默认参数
20220704-10:59:58  data_train测试效果：
                        累计人数占比 累计人数 累计人数_1 累计查准率 累计查全率 累计提升度
                               14.0%      279        279     100.0%      27.9%        2.0
                               14.0%      279        279     100.0%      27.9%        2.0
                               14.0%      279        279     100.0%      27.9%        2.0
                               28.0%      560        560     100.0%      56.0%        2.0
                               37.8%      756        756     100.0%      75.6%        2.0
                               44.2%      884        883      99.9%      88.3%        2.0
                               50.0%     1001        983      98.2%      98.3%        2.0
                               60.2%     1205        996      82.7%      99.6%        1.7
                               71.7%     1433        998      69.6%      99.8%        1.4
                               86.9%     1738       1000      57.5%     100.0%        1.2
                              100.0%     2000       1000      50.0%     100.0%        1.0
                              100.0%     2000       1000      50.0%     100.0%        1.0

20220704-10:59:58  训练测试 RandomForestClassifier_DF - n_estimators=500, max_features=0.06, max_depth=10, min_samples_split=1000, min_samples_leaf=1000
20220704-10:59:58  data_train测试效果：
                        累计人数占比 累计人数 累计人数_1 累计查准率 累计查全率 累计提升度
                              100.0%     2000       1000      50.0%     100.0%        1.0
                              100.0%     2000       1000      50.0%     100.0%        1.0
                              100.0%     2000       1000      50.0%     100.0%        1.0
                              100.0%     2000       1000      50.0%     100.0%        1.0
                              100.0%     2000       1000      50.0%     100.0%        1.0
                              100.0%     2000       1000      50.0%     100.0%        1.0
                              100.0%     2000       1000      50.0%     100.0%        1.0
                              100.0%     2000       1000      50.0%     100.0%        1.0
                              100.0%     2000       1000      50.0%     100.0%        1.0
                              100.0%     2000       1000      50.0%     100.0%        1.0
                              100.0%     2000       1000      50.0%     100.0%        1.0
                              100.0%     2000       1000      50.0%     100.0%        1.0

20220704-10:59:58  训练测试 RandomForestClassifier_DF - n_estimators=100, max_features=0.06, max_depth=10, min_samples_split=1000, min_samples_leaf=1000
20220704-10:59:58  data_train测试效果：
                        累计人数占比 累计人数 累计人数_1 累计查准率 累计查全率 累计提升度
                              100.0%     2000       1000      50.0%     100.0%        1.0
                              100.0%     2000       1000      50.0%     100.0%        1.0
                              100.0%     2000       1000      50.0%     100.0%        1.0
                              100.0%     2000       1000      50.0%     100.0%        1.0
                                0.0%        0          0       nan%       0.0%        NaN
                              100.0%     2000       1000      50.0%     100.0%        1.0
                              100.0%     2000       1000      50.0%     100.0%        1.0
                              100.0%     2000       1000      50.0%     100.0%        1.0
                                0.0%        0          0       nan%       0.0%        NaN
                              100.0%     2000       1000      50.0%     100.0%        1.0
                              100.0%     2000       1000      50.0%     100.0%        1.0
                              100.0%     2000       1000      50.0%     100.0%        1.0

20220704-10:59:58  训练测试 LogisticRegression_DF - solver='liblinear'
20220704-10:59:58  data_train测试效果：
                        累计人数占比 累计人数 累计人数_1 累计查准率 累计查全率 累计提升度
                                1.0%       20         20     100.0%       2.0%        2.0
                                5.0%      100         98      98.0%       9.8%        2.0
                               10.0%      200        193      96.5%      19.3%        1.9
                               20.0%      400        363      90.8%      36.3%        1.8
                               30.0%      600        503      83.8%      50.3%        1.7
                               40.0%      800        615      76.9%      61.5%        1.5
                               50.0%     1000        707      70.7%      70.7%        1.4
                               60.0%     1200        789      65.8%      78.9%        1.3
                               70.0%     1400        860      61.4%      86.0%        1.2
                               80.0%     1600        922      57.6%      92.2%        1.2
                               90.0%     1800        972      54.0%      97.2%        1.1
                              100.0%     2000       1000      50.0%     100.0%        1.0

20220704-10:59:58  ------------------------- 流水线：pipeline2 -------------------------
20220704-10:59:58  train_X: (2000, 159)


D:\工作\模型脚本\ModelProject\selfmodule\toolmodule\dataprep.py:483: UserWarning:     FeaturePrefilter_DF unique_limit(5000)小于X行数(2000), 添加unique_limit_actual：len(X)*0.99=1980
  warnings.warn(s); time.sleep(seconds)


D:\工作\模型脚本\ModelProject\selfmodule\toolmodule\dataprep.py:995: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead.  To get a de-fragmented frame, use `newframe = frame.copy()`
  X_woe[i] = X[i].map(self.col_tabl_[i].woe)
20220704-11:00:15  转换完毕，进入模型(X+Y)：(2000, 135)

20220704-11:00:15  训练测试 LGBMClassifier_DF - boosting_type='gbdt', colsample_bytree=0.9916168768550919, importance_type='split', is_unbalance=False, learning_rate=0.02269504678452342, max_depth=-1, min_child_samples=165, min_child_weight=0.001, min_split_gain=0.0, n_estimators=169, n_jobs=-1, num_leaves=22, reg_alpha=0.36607148130872236, reg_lambda=0.10119960284131346, silent=True, subsample=0.9304256141925331, subsample_for_bin=40000, subsample_freq=0
20220704-11:00:15  data_train测试效果：
                        累计人数占比 累计人数 累计人数_1 累计查准率 累计查全率 累计提升度
                                1.0%       20         20     100.0%       2.0%        2.0
                                5.0%      100         97      97.0%       9.7%        1.9
                               10.0%      200        192      96.0%      19.2%        1.9
                               20.0%      400        360      90.0%      36.0%        1.8
                               30.0%      600        510      85.0%      51.0%        1.7
                               40.0%      800        645      80.6%      64.5%        1.6
                               50.0%     1000        758      75.8%      75.8%        1.5
                               60.0%     1200        847      70.6%      84.7%        1.4
                               70.0%     1400        912      65.1%      91.2%        1.3
                               80.0%     1600        954      59.6%      95.4%        1.2
                               90.0%     1800        985      54.7%      98.5%        1.1
                              100.0%     2000       1000      50.0%     100.0%        1.0

20220704-11:00:15  训练测试 LGBMClassifier_DF - boosting_type='dart', objective='binary', num_leaves=511, learning_rate=0.1, colsample_bytree=0.8, subsample=0.6, subsample_freq=20
20220704-11:00:16  data_train测试效果：
                        累计人数占比 累计人数 累计人数_1 累计查准率 累计查全率 累计提升度
                                1.0%       20         20     100.0%       2.0%        2.0
                                5.0%      100         99      99.0%       9.9%        2.0
                               10.0%      200        199      99.5%      19.9%        2.0
                               20.0%      400        399      99.8%      39.9%        2.0
                               30.0%      600        595      99.2%      59.5%        2.0
                               40.0%      800        784      98.0%      78.4%        2.0
                               50.0%     1000        940      94.0%      94.0%        1.9
                               60.0%     1200        986      82.2%      98.6%        1.6
                               70.0%     1400        991      70.8%      99.1%        1.4
                               80.0%     1600        995      62.2%      99.5%        1.2
                               90.0%     1800        998      55.4%      99.8%        1.1
                              100.0%     2000       1000      50.0%     100.0%        1.0

20220704-11:00:16  训练测试 XGBClassifier_DF - 默认参数


D:\Python for Windows\lib\site-packages\xgboost\sklearn.py:1224: UserWarning: The use of label encoder in XGBClassifier is deprecated and will be removed in a future release. To remove this warning, do the following: 1) Pass option use_label_encoder=False when constructing XGBClassifier object; and 2) Encode your labels (y) as integers starting with 0, i.e. 0, 1, 2, ..., [num_class - 1].
  warnings.warn(label_encoder_deprecation_msg, UserWarning)
20220704-11:00:16  data_train测试效果：
                        累计人数占比 累计人数 累计人数_1 累计查准率 累计查全率 累计提升度
                                1.0%       20         20     100.0%       2.0%        2.0
                                5.0%      100        100     100.0%      10.0%        2.0
                               10.0%      200        200     100.0%      20.0%        2.0
                               20.0%      400        400     100.0%      40.0%        2.0
                               30.0%      600        600     100.0%      60.0%        2.0
                               40.0%      800        800     100.0%      80.0%        2.0
                               50.0%     1000       1000     100.0%     100.0%        2.0
                               60.0%     1200       1000      83.3%     100.0%        1.7
                               70.0%     1400       1000      71.4%     100.0%        1.4
                               80.0%     1600       1000      62.5%     100.0%        1.2
                               90.0%     1800       1000      55.6%     100.0%        1.1
                              100.0%     2000       1000      50.0%     100.0%        1.0

20220704-11:00:16  训练测试 RandomForestClassifier_DF - 默认参数
20220704-11:00:17  data_train测试效果：
                        累计人数占比 累计人数 累计人数_1 累计查准率 累计查全率 累计提升度
                               13.6%      272        272     100.0%      27.2%        2.0
                               13.6%      272        272     100.0%      27.2%        2.0
                               13.6%      272        272     100.0%      27.2%        2.0
                               28.0%      560        560     100.0%      56.0%        2.0
                               39.1%      781        781     100.0%      78.1%        2.0
                               45.2%      905        905     100.0%      90.5%        2.0
                               50.7%     1015        994      97.9%      99.4%        2.0
                               60.5%     1210        999      82.6%      99.9%        1.7
                               72.3%     1446       1000      69.2%     100.0%        1.4
                               88.3%     1767       1000      56.6%     100.0%        1.1
                              100.0%     2000       1000      50.0%     100.0%        1.0
                              100.0%     2000       1000      50.0%     100.0%        1.0

20220704-11:00:17  训练测试 RandomForestClassifier_DF - n_estimators=500, max_features=0.06, max_depth=10, min_samples_split=1000, min_samples_leaf=1000
20220704-11:00:17  data_train测试效果：
                        累计人数占比 累计人数 累计人数_1 累计查准率 累计查全率 累计提升度
                              100.0%     2000       1000      50.0%     100.0%        1.0
                              100.0%     2000       1000      50.0%     100.0%        1.0
                              100.0%     2000       1000      50.0%     100.0%        1.0
                              100.0%     2000       1000      50.0%     100.0%        1.0
                              100.0%     2000       1000      50.0%     100.0%        1.0
                              100.0%     2000       1000      50.0%     100.0%        1.0
                              100.0%     2000       1000      50.0%     100.0%        1.0
                              100.0%     2000       1000      50.0%     100.0%        1.0
                              100.0%     2000       1000      50.0%     100.0%        1.0
                              100.0%     2000       1000      50.0%     100.0%        1.0
                              100.0%     2000       1000      50.0%     100.0%        1.0
                              100.0%     2000       1000      50.0%     100.0%        1.0

20220704-11:00:17  训练测试 RandomForestClassifier_DF - n_estimators=100, max_features=0.06, max_depth=10, min_samples_split=1000, min_samples_leaf=1000
20220704-11:00:17  data_train测试效果：
                        累计人数占比 累计人数 累计人数_1 累计查准率 累计查全率 累计提升度
                              100.0%     2000       1000      50.0%     100.0%        1.0
                              100.0%     2000       1000      50.0%     100.0%        1.0
                              100.0%     2000       1000      50.0%     100.0%        1.0
                              100.0%     2000       1000      50.0%     100.0%        1.0
                              100.0%     2000       1000      50.0%     100.0%        1.0
                              100.0%     2000       1000      50.0%     100.0%        1.0
                              100.0%     2000       1000      50.0%     100.0%        1.0
                              100.0%     2000       1000      50.0%     100.0%        1.0
                              100.0%     2000       1000      50.0%     100.0%        1.0
                              100.0%     2000       1000      50.0%     100.0%        1.0
                              100.0%     2000       1000      50.0%     100.0%        1.0
                              100.0%     2000       1000      50.0%     100.0%        1.0

20220704-11:00:17  训练测试 LogisticRegression_DF - solver='liblinear'
20220704-11:00:18  data_train测试效果：
                        累计人数占比 累计人数 累计人数_1 累计查准率 累计查全率 累计提升度
                                1.0%       20         19      95.0%       1.9%        1.9
                                5.0%      100         98      98.0%       9.8%        2.0
                               10.0%      200        191      95.5%      19.1%        1.9
                               20.0%      400        361      90.2%      36.1%        1.8
                               30.0%      600        495      82.5%      49.5%        1.6
                               40.0%      800        599      74.9%      59.9%        1.5
                               50.0%     1000        687      68.7%      68.7%        1.4
                               60.0%     1200        769      64.1%      76.9%        1.3
                               70.0%     1400        847      60.5%      84.7%        1.2
                               80.0%     1600        906      56.6%      90.6%        1.1
                               90.0%     1800        953      52.9%      95.3%        1.1
                              100.0%     2000       1000      50.0%     100.0%        1.0

20220704-11:00:18  ------------------------------------------ 抽样比例：ratio_1_2 ------------------------------------------

20220704-11:00:18  ------------------------- 流水线：pipeline1 -------------------------
20220704-11:00:18  train_X: (3000, 159)


D:\工作\模型脚本\ModelProject\selfmodule\toolmodule\dataprep.py:483: UserWarning:     FeaturePrefilter_DF unique_limit(5000)小于X行数(3000), 添加unique_limit_actual：len(X)*0.99=2970
  warnings.warn(s); time.sleep(seconds)


D:\工作\模型脚本\ModelProject\selfmodule\toolmodule\dataprep.py:995: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead.  To get a de-fragmented frame, use `newframe = frame.copy()`
  X_woe[i] = X[i].map(self.col_tabl_[i].woe)
20220704-11:00:36  转换完毕，进入模型(X+Y)：(3000, 146)

20220704-11:00:36  训练测试 LGBMClassifier_DF - boosting_type='gbdt', colsample_bytree=0.9916168768550919, importance_type='split', is_unbalance=False, learning_rate=0.02269504678452342, max_depth=-1, min_child_samples=165, min_child_weight=0.001, min_split_gain=0.0, n_estimators=169, n_jobs=-1, num_leaves=22, reg_alpha=0.36607148130872236, reg_lambda=0.10119960284131346, silent=True, subsample=0.9304256141925331, subsample_for_bin=40000, subsample_freq=0
20220704-11:00:36  data_train测试效果：
                        累计人数占比 累计人数 累计人数_1 累计查准率 累计查全率 累计提升度
                                1.0%       30         28      93.3%       2.8%        2.8
                                5.0%      150        140      93.3%      14.0%        2.8
                               10.0%      300        258      86.0%      25.8%        2.6
                               20.0%      600        446      74.3%      44.6%        2.2
                               30.0%      900        593      65.9%      59.3%        2.0
                               40.0%     1200        701      58.4%      70.1%        1.8
                               50.0%     1500        790      52.7%      79.0%        1.6
                               60.0%     1800        859      47.7%      85.9%        1.4
                               70.0%     2100        907      43.2%      90.7%        1.3
                               80.0%     2400        951      39.6%      95.1%        1.2
                               90.0%     2700        978      36.2%      97.8%        1.1
                              100.0%     3000       1000      33.3%     100.0%        1.0

20220704-11:00:36  训练测试 LGBMClassifier_DF - boosting_type='dart', objective='binary', num_leaves=511, learning_rate=0.1, colsample_bytree=0.8, subsample=0.6, subsample_freq=20
20220704-11:00:36  data_train测试效果：
                        累计人数占比 累计人数 累计人数_1 累计查准率 累计查全率 累计提升度
                                1.0%       30         30     100.0%       3.0%        3.0
                                5.0%      150        149      99.3%      14.9%        3.0
                               10.0%      300        294      98.0%      29.4%        2.9
                               20.0%      600        564      94.0%      56.4%        2.8
                               30.0%      900        787      87.4%      78.7%        2.6
                               40.0%     1200        897      74.8%      89.7%        2.2
                               50.0%     1500        948      63.2%      94.8%        1.9
                               60.0%     1800        967      53.7%      96.7%        1.6
                               70.0%     2100        982      46.8%      98.2%        1.4
                               80.0%     2400        992      41.3%      99.2%        1.2
                               90.0%     2700        997      36.9%      99.7%        1.1
                              100.0%     3000       1000      33.3%     100.0%        1.0

20220704-11:00:36  训练测试 XGBClassifier_DF - 默认参数


D:\Python for Windows\lib\site-packages\xgboost\sklearn.py:1224: UserWarning: The use of label encoder in XGBClassifier is deprecated and will be removed in a future release. To remove this warning, do the following: 1) Pass option use_label_encoder=False when constructing XGBClassifier object; and 2) Encode your labels (y) as integers starting with 0, i.e. 0, 1, 2, ..., [num_class - 1].
  warnings.warn(label_encoder_deprecation_msg, UserWarning)
20220704-11:00:37  data_train测试效果：
                        累计人数占比 累计人数 累计人数_1 累计查准率 累计查全率 累计提升度
                                1.0%       30         30     100.0%       3.0%        3.0
                                5.0%      150        150     100.0%      15.0%        3.0
                               10.0%      300        300     100.0%      30.0%        3.0
                               20.0%      600        600     100.0%      60.0%        3.0
                               30.0%      900        899      99.9%      89.9%        3.0
                               40.0%     1200        986      82.2%      98.6%        2.5
                               50.0%     1500        996      66.4%      99.6%        2.0
                               60.0%     1800        999      55.5%      99.9%        1.7
                               70.0%     2100       1000      47.6%     100.0%        1.4
                               80.0%     2400       1000      41.7%     100.0%        1.3
                               90.0%     2700       1000      37.0%     100.0%        1.1
                              100.0%     3000       1000      33.3%     100.0%        1.0

20220704-11:00:37  训练测试 RandomForestClassifier_DF - 默认参数
20220704-11:00:37  data_train测试效果：
                        累计人数占比 累计人数 累计人数_1 累计查准率 累计查全率 累计提升度
                                5.8%      174        174     100.0%      17.4%        3.0
                                5.8%      174        174     100.0%      17.4%        3.0
                               13.6%      407        407     100.0%      40.7%        3.0
                               21.2%      637        637     100.0%      63.7%        3.0
                               30.7%      922        915      99.2%      91.5%        3.0
                               40.7%     1221        994      81.4%      99.4%        2.4
                               51.5%     1545        998      64.6%      99.8%        1.9
                               72.6%     2177        998      45.8%      99.8%        1.4
                               72.6%     2177        998      45.8%      99.8%        1.4
                              100.0%     3000       1000      33.3%     100.0%        1.0
                              100.0%     3000       1000      33.3%     100.0%        1.0
                              100.0%     3000       1000      33.3%     100.0%        1.0

20220704-11:00:37  训练测试 RandomForestClassifier_DF - n_estimators=500, max_features=0.06, max_depth=10, min_samples_split=1000, min_samples_leaf=1000
20220704-11:00:38  data_train测试效果：
                        累计人数占比 累计人数 累计人数_1 累计查准率 累计查全率 累计提升度
                              100.0%     3000       1000      33.3%     100.0%        1.0
                              100.0%     3000       1000      33.3%     100.0%        1.0
                              100.0%     3000       1000      33.3%     100.0%        1.0
                              100.0%     3000       1000      33.3%     100.0%        1.0
                              100.0%     3000       1000      33.3%     100.0%        1.0
                              100.0%     3000       1000      33.3%     100.0%        1.0
                              100.0%     3000       1000      33.3%     100.0%        1.0
                              100.0%     3000       1000      33.3%     100.0%        1.0
                              100.0%     3000       1000      33.3%     100.0%        1.0
                              100.0%     3000       1000      33.3%     100.0%        1.0
                              100.0%     3000       1000      33.3%     100.0%        1.0
                              100.0%     3000       1000      33.3%     100.0%        1.0

20220704-11:00:38  训练测试 RandomForestClassifier_DF - n_estimators=100, max_features=0.06, max_depth=10, min_samples_split=1000, min_samples_leaf=1000
20220704-11:00:38  data_train测试效果：
                        累计人数占比 累计人数 累计人数_1 累计查准率 累计查全率 累计提升度
                              100.0%     3000       1000      33.3%     100.0%        1.0
                              100.0%     3000       1000      33.3%     100.0%        1.0
                              100.0%     3000       1000      33.3%     100.0%        1.0
                              100.0%     3000       1000      33.3%     100.0%        1.0
                              100.0%     3000       1000      33.3%     100.0%        1.0
                              100.0%     3000       1000      33.3%     100.0%        1.0
                              100.0%     3000       1000      33.3%     100.0%        1.0
                              100.0%     3000       1000      33.3%     100.0%        1.0
                              100.0%     3000       1000      33.3%     100.0%        1.0
                              100.0%     3000       1000      33.3%     100.0%        1.0
                              100.0%     3000       1000      33.3%     100.0%        1.0
                              100.0%     3000       1000      33.3%     100.0%        1.0

20220704-11:00:38  训练测试 LogisticRegression_DF - solver='liblinear'
20220704-11:00:38  data_train测试效果：
                        累计人数占比 累计人数 累计人数_1 累计查准率 累计查全率 累计提升度
                                1.0%       30         30     100.0%       3.0%        3.0
                                5.0%      150        138      92.0%      13.8%        2.8
                               10.0%      300        257      85.7%      25.7%        2.6
                               20.0%      600        451      75.2%      45.1%        2.3
                               30.0%      900        577      64.1%      57.7%        1.9
                               40.0%     1200        682      56.8%      68.2%        1.7
                               50.0%     1500        768      51.2%      76.8%        1.5
                               60.0%     1800        843      46.8%      84.3%        1.4
                               70.0%     2100        890      42.4%      89.0%        1.3
                               80.0%     2400        930      38.8%      93.0%        1.2
                               90.1%     2703        972      36.0%      97.2%        1.1
                              100.0%     3000       1000      33.3%     100.0%        1.0

20220704-11:00:38  ------------------------- 流水线：pipeline2 -------------------------
20220704-11:00:38  train_X: (3000, 159)


D:\工作\模型脚本\ModelProject\selfmodule\toolmodule\dataprep.py:483: UserWarning:     FeaturePrefilter_DF unique_limit(5000)小于X行数(3000), 添加unique_limit_actual：len(X)*0.99=2970
  warnings.warn(s); time.sleep(seconds)


D:\工作\模型脚本\ModelProject\selfmodule\toolmodule\dataprep.py:995: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead.  To get a de-fragmented frame, use `newframe = frame.copy()`
  X_woe[i] = X[i].map(self.col_tabl_[i].woe)
20220704-11:00:57  转换完毕，进入模型(X+Y)：(3000, 146)

20220704-11:00:57  训练测试 LGBMClassifier_DF - boosting_type='gbdt', colsample_bytree=0.9916168768550919, importance_type='split', is_unbalance=False, learning_rate=0.02269504678452342, max_depth=-1, min_child_samples=165, min_child_weight=0.001, min_split_gain=0.0, n_estimators=169, n_jobs=-1, num_leaves=22, reg_alpha=0.36607148130872236, reg_lambda=0.10119960284131346, silent=True, subsample=0.9304256141925331, subsample_for_bin=40000, subsample_freq=0
20220704-11:00:57  data_train测试效果：
                        累计人数占比 累计人数 累计人数_1 累计查准率 累计查全率 累计提升度
                                1.0%       30         29      96.7%       2.9%        2.9
                                5.0%      150        141      94.0%      14.1%        2.8
                               10.0%      300        267      89.0%      26.7%        2.7
                               20.0%      600        462      77.0%      46.2%        2.3
                               30.0%      900        639      71.0%      63.9%        2.1
                               40.0%     1200        779      64.9%      77.9%        1.9
                               50.0%     1500        863      57.5%      86.3%        1.7
                               60.0%     1800        924      51.3%      92.4%        1.5
                               70.0%     2100        962      45.8%      96.2%        1.4
                               80.0%     2400        982      40.9%      98.2%        1.2
                               90.0%     2700        995      36.9%      99.5%        1.1
                              100.0%     3000       1000      33.3%     100.0%        1.0

20220704-11:00:57  训练测试 LGBMClassifier_DF - boosting_type='dart', objective='binary', num_leaves=511, learning_rate=0.1, colsample_bytree=0.8, subsample=0.6, subsample_freq=20
20220704-11:00:58  data_train测试效果：
                        累计人数占比 累计人数 累计人数_1 累计查准率 累计查全率 累计提升度
                                1.0%       30         30     100.0%       3.0%        3.0
                                5.0%      150        150     100.0%      15.0%        3.0
                               10.0%      300        297      99.0%      29.7%        3.0
                               20.0%      600        589      98.2%      58.9%        2.9
                               30.0%      900        869      96.6%      86.9%        2.9
                               40.0%     1200        978      81.5%      97.8%        2.4
                               50.0%     1500        987      65.8%      98.7%        2.0
                               60.0%     1800        990      55.0%      99.0%        1.6
                               70.0%     2100        991      47.2%      99.1%        1.4
                               80.0%     2400        992      41.3%      99.2%        1.2
                               90.0%     2700        996      36.9%      99.6%        1.1
                              100.0%     3000       1000      33.3%     100.0%        1.0

20220704-11:00:58  训练测试 XGBClassifier_DF - 默认参数


D:\Python for Windows\lib\site-packages\xgboost\sklearn.py:1224: UserWarning: The use of label encoder in XGBClassifier is deprecated and will be removed in a future release. To remove this warning, do the following: 1) Pass option use_label_encoder=False when constructing XGBClassifier object; and 2) Encode your labels (y) as integers starting with 0, i.e. 0, 1, 2, ..., [num_class - 1].
  warnings.warn(label_encoder_deprecation_msg, UserWarning)
20220704-11:00:59  data_train测试效果：
                        累计人数占比 累计人数 累计人数_1 累计查准率 累计查全率 累计提升度
                                1.0%       30         30     100.0%       3.0%        3.0
                                5.0%      150        150     100.0%      15.0%        3.0
                               10.0%      300        300     100.0%      30.0%        3.0
                               20.0%      600        600     100.0%      60.0%        3.0
                               30.0%      900        900     100.0%      90.0%        3.0
                               40.0%     1200       1000      83.3%     100.0%        2.5
                               50.0%     1500       1000      66.7%     100.0%        2.0
                               60.0%     1800       1000      55.6%     100.0%        1.7
                               70.0%     2100       1000      47.6%     100.0%        1.4
                               80.0%     2400       1000      41.7%     100.0%        1.3
                               90.0%     2700       1000      37.0%     100.0%        1.1
                              100.0%     3000       1000      33.3%     100.0%        1.0

20220704-11:00:59  训练测试 RandomForestClassifier_DF - 默认参数
20220704-11:00:59  data_train测试效果：
                        累计人数占比 累计人数 累计人数_1 累计查准率 累计查全率 累计提升度
                                5.9%      176        176     100.0%      17.6%        3.0
                                5.9%      176        176     100.0%      17.6%        3.0
                               13.7%      412        412     100.0%      41.2%        3.0
                               21.3%      640        640     100.0%      64.0%        3.0
                               31.1%      932        930      99.8%      93.0%        3.0
                               51.5%     1546       1000      64.7%     100.0%        1.9
                               51.5%     1546       1000      64.7%     100.0%        1.9
                               74.3%     2230       1000      44.8%     100.0%        1.3
                               74.3%     2230       1000      44.8%     100.0%        1.3
                              100.0%     3000       1000      33.3%     100.0%        1.0
                              100.0%     3000       1000      33.3%     100.0%        1.0
                              100.0%     3000       1000      33.3%     100.0%        1.0

20220704-11:00:59  训练测试 RandomForestClassifier_DF - n_estimators=500, max_features=0.06, max_depth=10, min_samples_split=1000, min_samples_leaf=1000
20220704-11:01:00  data_train测试效果：
                        累计人数占比 累计人数 累计人数_1 累计查准率 累计查全率 累计提升度
                              100.0%     3000       1000      33.3%     100.0%        1.0
                              100.0%     3000       1000      33.3%     100.0%        1.0
                              100.0%     3000       1000      33.3%     100.0%        1.0
                              100.0%     3000       1000      33.3%     100.0%        1.0
                              100.0%     3000       1000      33.3%     100.0%        1.0
                              100.0%     3000       1000      33.3%     100.0%        1.0
                              100.0%     3000       1000      33.3%     100.0%        1.0
                              100.0%     3000       1000      33.3%     100.0%        1.0
                              100.0%     3000       1000      33.3%     100.0%        1.0
                              100.0%     3000       1000      33.3%     100.0%        1.0
                              100.0%     3000       1000      33.3%     100.0%        1.0
                              100.0%     3000       1000      33.3%     100.0%        1.0

20220704-11:01:00  训练测试 RandomForestClassifier_DF - n_estimators=100, max_features=0.06, max_depth=10, min_samples_split=1000, min_samples_leaf=1000
20220704-11:01:00  data_train测试效果：
                        累计人数占比 累计人数 累计人数_1 累计查准率 累计查全率 累计提升度
                              100.0%     3000       1000      33.3%     100.0%        1.0
                              100.0%     3000       1000      33.3%     100.0%        1.0
                              100.0%     3000       1000      33.3%     100.0%        1.0
                              100.0%     3000       1000      33.3%     100.0%        1.0
                              100.0%     3000       1000      33.3%     100.0%        1.0
                              100.0%     3000       1000      33.3%     100.0%        1.0
                              100.0%     3000       1000      33.3%     100.0%        1.0
                              100.0%     3000       1000      33.3%     100.0%        1.0
                              100.0%     3000       1000      33.3%     100.0%        1.0
                              100.0%     3000       1000      33.3%     100.0%        1.0
                              100.0%     3000       1000      33.3%     100.0%        1.0
                              100.0%     3000       1000      33.3%     100.0%        1.0

20220704-11:01:00  训练测试 LogisticRegression_DF - solver='liblinear'
20220704-11:01:01  data_train测试效果：
                        累计人数占比 累计人数 累计人数_1 累计查准率 累计查全率 累计提升度
                                1.0%       30         29      96.7%       2.9%        2.9
                                5.0%      150        137      91.3%      13.7%        2.7
                               10.0%      300        255      85.0%      25.5%        2.6
                               20.0%      600        444      74.0%      44.4%        2.2
                               30.0%      900        569      63.2%      56.9%        1.9
                               40.0%     1200        665      55.4%      66.5%        1.7
                               50.0%     1500        737      49.1%      73.7%        1.5
                               60.0%     1800        810      45.0%      81.0%        1.4
                               70.0%     2100        869      41.4%      86.9%        1.2
                               80.0%     2400        922      38.4%      92.2%        1.2
                               90.0%     2700        966      35.8%      96.6%        1.1
                              100.0%     3000       1000      33.3%     100.0%        1.0

                   Out[85]: 20220704-11:09:37  
                   ChainMap({"LogisticRegression_DF - solver='liblinear'": LogisticRegression_DF(C=1.0, class_weight=None, dual=False, fit_intercept=True,
                                         intercept_scaling=1, l1_ratio=None, max_iter=100,
                                         multi_class='warn', n_jobs=None, penalty='l2',
                                         print_indent='', random_state=None, solver='liblinear',
                                         tol=0.0001, trans_na_error=True, verbose=0,
                                         warm_start=False)}, {'RandomForestClassifier_DF - n_estimators=500, max_features=0.06, max_depth=10, min_samples_split=1000, min_samples_leaf=1000': RandomForestClassifier_DF(bootstrap=True, class_weight=None, criterion='gini',
                                             max_depth=10, max_features=0.06, max_leaf_nodes=None,
                                             min_impurity_decrease=0.0, min_impurity_split=None,
                                             min_samples_leaf=1000, min_samples_split=1000,
                                             min_weight_fraction_leaf=0.0, n_estimators=500,
                                             n_jobs=None, oob_score=False, print_indent='',
                                             random_state=None, trans_na_error=True, verbose=0,
                                             warm_start=False), 'RandomForestClassifier_DF - n_estimators=100, max_features=0.06, max_depth=10, min_samples_split=1000, min_samples_leaf=1000': RandomForestClassifier_DF(bootstrap=True, class_weight=None, criterion='gini',
                                             max_depth=10, max_features=0.06, max_leaf_nodes=None,
                                             min_impurity_decrease=0.0, min_impurity_split=None,
                                             min_samples_leaf=1000, min_samples_split=1000,
                                             min_weight_fraction_leaf=0.0, n_estimators=100,
                                             n_jobs=None, oob_score=False, print_indent='',
                                             random_state=None, trans_na_error=True, verbose=0,
                                             warm_start=False)}, {'RandomForestClassifier_DF - 默认参数': RandomForestClassifier_DF(bootstrap=True, class_weight=None, criterion='gini',
                                             max_depth=None, max_features='auto',
                                             max_leaf_nodes=None, min_impurity_decrease=0.0,
                                             min_impurity_split=None, min_samples_leaf=1,
                                             min_samples_split=2, min_weight_fraction_leaf=0.0,
                                             n_estimators='warn', n_jobs=None, oob_score=False,
                                             print_indent='', random_state=None,
                                             trans_na_error=True, verbose=0, warm_start=False)}, {'XGBClassifier_DF - 默认参数': XGBClassifier_DF(base_score=None, booster=None, colsample_bylevel=None,
                                    colsample_bynode=None, colsample_bytree=None,
                                    enable_categorical=False, gamma=None, gpu_id=None,
                                    importance_type=None, interaction_constraints=None,
                                    learning_rate=None, max_delta_step=None, max_depth=None,
                                    min_child_weight=None, missing=nan, monotone_constraints=None,
                                    n_estimators=100, n_jobs=None, num_parallel_tree=None,
                                    objective='binary:logistic', predictor=None, print_indent='',
                                    random_state=None, reg_alpha=None, reg_lambda=None,
                                    scale_pos_weight=None, subsample=None, trans_na_error=True,
                                    tree_method=None, use_label_encoder=True, ...)}, {"LGBMClassifier_DF - boosting_type='dart', objective='binary', num_leaves=511, learning_rate=0.1, colsample_bytree=0.8, subsample=0.6, subsample_freq=20": LGBMClassifier_DF(boosting_type='dart', class_weight=None, colsample_bytree=0.8,
                                     importance_type='split', is_unbalance=False,
                                     learning_rate=0.1, max_depth=-1, min_child_samples=20,
                                     min_child_weight=0.001, min_split_gain=0.0, n_estimators=100,
                                     n_jobs=-1, num_leaves=511, objective='binary',
                                     print_indent='', random_state=None, reg_alpha=0.0,
                                     reg_lambda=0.0, silent=True, subsample=0.6,
                                     subsample_for_bin=200000, subsample_freq=20)}, {"LGBMClassifier_DF - boosting_type='gbdt', colsample_bytree=0.9916168768550919, importance_type='split', is_unbalance=False, learning_rate=0.02269504678452342, max_depth=-1, min_child_samples=165, min_child_weight=0.001, min_split_gain=0.0, n_estimators=169, n_jobs=-1, num_leaves=22, reg_alpha=0.36607148130872236, reg_lambda=0.10119960284131346, silent=True, subsample=0.9304256141925331, subsample_for_bin=40000, subsample_freq=0": LGBMClassifier_DF(boosting_type='gbdt', class_weight=None,
                                     colsample_bytree=0.9916168768550919, importance_type='split',
                                     is_unbalance=False, learning_rate=0.02269504678452342,
                                     max_depth=-1, min_child_samples=165, min_child_weight=0.001,
                                     min_split_gain=0.0, n_estimators=169, n_jobs=-1,
                                     num_leaves=22, objective=None, print_indent='',
                                     random_state=None, reg_alpha=0.36607148130872236,
                                     reg_lambda=0.10119960284131346, silent=True,
                                     subsample=0.9304256141925331, subsample_for_bin=40000,
                                     subsample_freq=0)})
20220704-11:13:41  ------------------------------------------ 抽样比例：ratio_1_1 ------------------------------------------

20220704-11:13:41  ------------------------------------------ 抽样比例：ratio_1_2 ------------------------------------------

20220704-11:13:48  ------------------------- 流水线：pipeline1 -------------------------
20220704-11:13:48  ------------------------- 流水线：pipeline2 -------------------------
                   Out[90]: 20220704-11:14:01  
                   Pipeline_DF(memory=None,
                               steps=[('union2',
                                       FeatureUnion_DF(n_jobs=None,
                                                       transformer_list=[('num_pipe2',
                                                                          Pipeline_DF(memory=None,
                                                                                      steps=[('select_num',
                                                                                              NumStrSpliter_DF(ob_to_cat=False,
                                                                                                               print_indent='                ',
                                                                                                               select='num',
                                                                                                               trans_na_error=False)),
                                                                                             ('imputer_num',
                                                                                              SimpleImputer_DF(add_indicator=False,
                                                                                                               copy=True,
                                                                                                               fill_value=0,
                                                                                                               missing_values=nan,
                                                                                                               print_indent='                ',
                                                                                                               strategy='...
                                                       transformer_weights=None, verbose=None)),
                                      ('woe_notto_pipe2',
                                       WoeTransformer_DF(Ncase='0', Pcase='1', deal_0='to_1',
                                                         iv_limit=0.05, maxgap_limit=50,
                                                         precision=6, print_indent='    ',
                                                         psi_limit=0.1, r_limit=0.95, to_woe=False,
                                                         trans_na_error=True, turnpoint_limit=inf,
                                                         warn_mark='pipeline2')),
                                      ('toint_pipe2',
                                       ObjectBacktoInt_DF(print_indent='    ', trans_na_error=True,
                                                          useless=None))],
                               verbose=None)
                   Out[93]: 20220704-11:20:31  
                           data_use acct_month      user_id      account_id  innet_months user_status  monthsremain_last_stop_date  gprs_last_defer  gprs_now_rest  call_use   arpu  calling_cnt  \
                   501   data_train     202010  23883026199         6536083         161.0   在网-正常                        -70.0            300.0     11100167.0       0.0  18.00          0.0   
                   503   data_train     202010  24498499740        63527749         256.0   在网-正常                         -7.0              0.0            0.0     151.0  73.00        108.0   
                   506   data_train     202010  20066574592        53196251         115.0   在网-正常                        -22.0              0.0            0.0      50.0  82.59         26.0   
                   513   data_train     202010  78528839233  30100000000000          32.0   在网-正常                         -5.0            500.0    116367360.0      40.0  40.52          3.0   
                   515   data_train     202010  81615377856        40307873         165.0   在网-正常                        -26.0             10.0     10506216.0       0.0   8.00          0.0   
                   ...          ...        ...          ...             ...           ...         ...                          ...              ...            ...       ...    ...          ...   
                   2090  data_train     202010  24128910785       118350294         104.0   在网-正常                        -15.0              0.0            0.0       1.0   8.00          1.0   
                   2794  data_train     202010  81732009518        42805690         166.0   在网-正常                        -54.0              0.0            0.0       3.0   8.15          7.0   
                   918   data_train     202010  81349238245        37232868         129.0   在网-正常                        -58.0              0.0            0.0       6.0   8.00          3.0   
                   1622  data_train     202010  21917239640         4068567         212.0   在网-正常                        -55.0             40.0        81918.0       0.0  10.00          0.0   
                   2283  data_train     202010  27475297390        66057918         141.0   在网-正常                         -9.0              0.0            0.0       2.0  38.00          1.0   
                   
                         calling_dura  calling_diff_dura  gprs_flow_4g  ...  moreq25cnt__nos_calling  moreq25cnt__nos_calling_diff  moreq25cnt__arpu  moreq25cnt__calling_cnt  \
                   501            0.0                0.0           0.0  ...                      0.0                           0.0               3.0                      0.0   
                   503          557.0               44.0    22961644.0  ...                      3.0                           3.0               3.0                      3.0   
                   506           71.0               12.0    13445897.0  ...                      3.0                           3.0               3.0                      3.0   
                   513           48.0                0.0       69846.0  ...                      3.0                           2.0               3.0                      3.0   
                   515            0.0                0.0        5382.0  ...                      0.0                           0.0               0.0                      0.0   
                   ...            ...                ...           ...  ...                      ...                           ...               ...                      ...   
                   2090           1.0                0.0        7414.0  ...                      2.0                           1.0               0.0                      1.0   
                   2794          12.0                0.0       64561.0  ...                      3.0                           1.0               0.0                      3.0   
                   918            6.0                2.0           0.0  ...                      3.0                           3.0               0.0                      3.0   
                   1622           0.0                0.0        6792.0  ...                      0.0                           0.0               0.0                      0.0   
                   2283           2.0                0.0       18502.0  ...                      1.0                           1.0               3.0                      0.0   
                   
                         moreq25cnt__gprs_flow_commu  moreq25cnt__call_use  moreq25cnt__gprs_flow_4g  moreq25cnt__gprs_flow_music  moreq25cnt__calling_diff_cnt  moreq25cnt__gprs_flow_game  \
                   501                           0.0                   1.0                       0.0                          0.0                           0.0                         0.0   
                   503                           3.0                   3.0                       3.0                          2.0                           3.0                         0.0   
                   506                           0.0                   3.0                       3.0                          0.0                           3.0                         0.0   
                   513                           0.0                   3.0                       3.0                          0.0                           1.0                         0.0   
                   515                           0.0                   0.0                       2.0                          0.0                           0.0                         0.0   
                   ...                           ...                   ...                       ...                          ...                           ...                         ...   
                   2090                          0.0                   3.0                       3.0                          0.0                           1.0                         0.0   
                   2794                          0.0                   3.0                       3.0                          0.0                           1.0                         0.0   
                   918                           0.0                   3.0                       1.0                          0.0                           3.0                         0.0   
                   1622                          0.0                   1.0                       3.0                          0.0                           0.0                         0.0   
                   2283                          0.0                   2.0                       3.0                          0.0                           0.0                         0.0   
                   
                         moreq25cnt__gprs_flow_short moreq25cnt__calling_dura  valuecnt__if_nolimit~是  valuecnt__if_5g_dinner~是  flag_eg  
                   501                           0.0                      0.0                      0.0                        0.0        1  
                   503                           0.0                      3.0                      3.0                        0.0        1  
                   506                           0.0                      3.0                      2.0                        1.0        1  
                   513                           0.0                      3.0                      0.0                        0.0        1  
                   515                           0.0                      0.0                      0.0                        0.0        1  
                   ...                           ...                      ...                      ...                        ...      ...  
                   2090                          0.0                      1.0                      0.0                        0.0        0  
                   2794                          0.0                      3.0                      0.0                        0.0        0  
                   918                           0.0                      3.0                      0.0                        0.0        0  
                   1622                          0.0                      1.0                      0.0                        0.0        0  
                   2283                          0.0                      2.0                      0.0                        0.0        0  
                   
                   [3000 rows x 161 columns]
                   Out[96]: 20220704-11:20:56  
                   501     1
                   503     1
                   506     1
                   513     1
                   515     1
                          ..
                   2090    0
                   2794    0
                   918     0
                   1622    0
                   2283    0
                   Name: flag_eg, Length: 3000, dtype: object
20220704-11:21:14  train_X: (3000, 159)


D:\工作\模型脚本\ModelProject\selfmodule\toolmodule\dataprep.py:483: UserWarning:     FeaturePrefilter_DF unique_limit(5000)小于X行数(3000), 添加unique_limit_actual：len(X)*0.99=2970
  warnings.warn(s); time.sleep(seconds)


D:\工作\模型脚本\ModelProject\selfmodule\toolmodule\dataprep.py:995: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead.  To get a de-fragmented frame, use `newframe = frame.copy()`
  X_woe[i] = X[i].map(self.col_tabl_[i].woe)


Traceback (most recent call last):
  File "D:\Python for Windows\lib\site-packages\IPython\core\interactiveshell.py", line 3296, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-99-3b19b63cbc15>", line 27, in <module>
    sys.stdout = original
NameError: name 'original' is not defined


Traceback (most recent call last):
  File "D:\Python for Windows\lib\site-packages\IPython\core\interactiveshell.py", line 3296, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-109-4bf5bce3a158>", line 1, in <module>
    message_model
NameError: name 'message_model' is not defined
