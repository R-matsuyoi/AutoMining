20220627-17:06:55  加载训练结果：./binaryclassify/eg/traintest~202010~202012/train_result~202010~202012.pkl
20220627-17:06:55  从训练结果中获取Info,并加入预测所需信息


                   ###################################################################### 加工预测账期近n月基础数据
                    
20220627-17:06:55  开始时间：2022-06-27 17:06:55
20220627-17:06:55  ---- month: 202012
20220627-17:06:55  ---- 参数设置：
                       ---- step: predict
                       ---- Info.model_name: 模型示例
                       ---- Info.n_recent: 3

                   ------------------------------------- 检查各前置表 --------------------------------------------------- 
20220627-17:06:55  检查 kehujingyingbudb.ml_xy_eg_m
20220627-17:06:55      78 列
20220627-17:06:56      202012账期： 15000行
20220627-17:06:56      202011账期： 10000行
20220627-17:06:56      202010账期： 15000行


20220627-17:06:56          dis_predict_total {'count':             count
                   acct_month       
                   202012      15000}
20220627-17:06:56  数据量：select  count(1) from kehujingyingbudb.ml_xy_eg_m where acct_month=202012 and user_status='在网-正常' and 
                       phone_no_null is null and
                       last_stop_date is not null and
                       innet_months >= 3 and
                       dayvalue_gprs_flow>0

20220627-17:06:56      dis_predict_model {'count': 10817}


                   ------------------- 关联近n月数据：kehujingyingbudb.mid_eg_recent_predict_202012 ------------------------------- 


20220627-17:06:56  ---- 关联近n月数据：
                       drop table if exists kehujingyingbudb.mid_eg_recent_predict_202012;
                       create  table kehujingyingbudb.mid_eg_recent_predict_202012 as
                       select user_acct_month, data_use, acct_month, phone_no_null, user_id, account_id, innet_months, sex_add, user_status, last_stop_date, dinner_fee, gprs_last_defer, gprs_resource, gprs_now_rest, call_use, if_nolimit, if_5g_dinner, arpu, calling_cnt, calling_dura, calling_diff_cnt, calling_diff_dura, gprs_flow_4g, gprs_flow_5g, gprs_now_defer, gprs_flow_roam, call_dura_roam, nos_calling, nos_calling_diff, sms_cnt, call_fee_local, gprs_flow_video, gprs_flow_short, gprs_flow_music, gprs_flow_commu, gprs_flow_game, dayvalue_gprs_flow 
                       from (
                       select a.user_acct_month, a.data_use, b.*
                       from (select acct_month user_acct_month, 'data_predict' data_use, * from kehujingyingbudb.ml_xy_eg_m where acct_month=202012 and user_status='在网-正常' and 
                           phone_no_null is null and
                           last_stop_date is not null and
                           innet_months >= 3 and
                           dayvalue_gprs_flow>0
                       ) a
                       inner join (select * from kehujingyingbudb.ml_xy_eg_m where acct_month>=202010 and acct_month<=202012) b on a.user_id = b.user_id
                       ) t;
20220627-17:06:56      sql执行完毕
20220627-17:06:56  统计kehujingyingbudb.mid_eg_recent_predict_202012行列数
20220627-17:06:57      28813行，37列

                   --------------------------------- 核验各账期数据量  ---------------------------------------------- 
20220627-17:06:57  sql语句：
                       select user_acct_month, data_use, acct_month, count(1) 
                       from kehujingyingbudb.mid_eg_recent_predict_202012 
                       group by user_acct_month, data_use, acct_month 
                       order by user_acct_month, data_use, acct_month

20220627-17:06:57  结果：
                      user_acct_month      data_use  acct_month  count
                   0           202012  data_predict      202010  10817
                   1           202012  data_predict      202011   7179
                   2           202012  data_predict      202012  10817


D:\工作\模型脚本\ModelProject\selfmodule\tablemodule\tablefun.py:900: UserWarning: 下列账期用户量不同，请检查！
                              acct_month  count
user_acct_month data_use                       
202012          data_predict      202010  10817
                data_predict      202011   7179
                data_predict      202012  10817
  warnings.warn(w); time.sleep(seconds)
20220627-17:07:00  
                   ---- 删除中间表
20220627-17:07:00  drop table if exists kehujingyingbudb.mid_eg_user_predict_202012;
20220627-17:07:00      sql执行完毕

20220627-17:07:00  ---- 返回结果表名：kehujingyingbudb.mid_eg_recent_predict_202012
20220627-17:07:00  ---- 将Info保存至./binaryclassify/eg/traintest~202010~202012/Info~base_predict.pkl

20220627-17:07:00  结束时间：2022-06-27 17:07:00
20220627-17:07:00  耗时：4 s


20220627-17:07:00  将数据拆分成 4 份分别预测

20220627-17:07:10  =========================================== 0份：['0', '1', '2'] ==========================================
20220627-17:07:10  修改Info，用于分批预测
20220627-17:07:10  condition: right(cast(user_id as text), 1) in ('0', '1', '2')
                   table_predict:./binaryclassify/eg//predictscore~202012/predict_data~202012~0.csv
                   table_score:./binaryclassify/eg//predictscore~202012/predict_score_data~202010~202012~202012~0.csv

                   ###################################################################### 预测集加工
                    
20220627-17:07:10  开始时间：2022-06-27 17:07:10
20220627-17:07:10  参数设置：
                       Info.model_name: 模型示例
                       Info.auto_pair2: False
                       Info.iv_limit: 0.05
                       stage: create
                       step: predict
                       Info.r_limit: 0.95
                       table_in: kehujingyingbudb.mid_eg_recent_predict_202012

20220627-17:07:13  ------------------------- 读取数据: kehujingyingbudb.mid_eg_recent_predict_202012 2022-06-27 17:07:13 -------------------------
20220627-17:07:13      src: gp
20220627-17:07:13      condition: right(cast(user_id as text), 1) in ('0', '1', '2')
20220627-17:07:13      col_need(34): ['user_acct_month', 'data_use', 'acct_month', 'user_id', 'account_id', 'innet_months', 'sex_add', 'last_stop_date', 'dinner_fee', 'gprs_last_defer', 'gprs_resource', 'gprs_now_rest', 'call_use', 'if_nolimit', 'if_5g_dinner', 'arpu', 'calling_cnt', 'calling_dura', 'calling_diff_cnt', 'calling_diff_dura', 'gprs_flow_4g', 'gprs_flow_5g', 'gprs_now_defer', 'gprs_flow_roam', 'call_dura_roam', 'nos_calling', 'nos_calling_diff', 'sms_cnt', 'call_fee_local', 'gprs_flow_video', 'gprs_flow_short', 'gprs_flow_music', 'gprs_flow_commu', 'gprs_flow_game']
20220627-17:07:13      col_del: None
20220627-17:07:13      col_char(8): ['user_acct_month', 'data_use', 'acct_month', 'user_id', 'account_id', 'sex_add', 'if_nolimit', 'if_5g_dinner']
20220627-17:07:13      col_num(25): ['innet_months', 'dinner_fee', 'gprs_last_defer', 'gprs_resource', 'gprs_now_rest', 'call_use', 'arpu', 'calling_cnt', 'calling_dura', 'calling_diff_cnt', 'calling_diff_dura', 'gprs_flow_4g', 'gprs_flow_5g', 'gprs_now_defer', 'gprs_flow_roam', 'call_dura_roam', 'nos_calling', 'nos_calling_diff', 'sms_cnt', 'call_fee_local', 'gprs_flow_video', 'gprs_flow_short', 'gprs_flow_music', 'gprs_flow_commu', 'gprs_flow_game']
20220627-17:07:13      col_date(1): ['last_stop_date']
20220627-17:07:13      nrows: None
20220627-17:07:13      if_coltolower: True
20220627-17:07:13      kwargs: {}

20220627-17:07:13      读取
20220627-17:07:15      shape: (8820, 34)

20220627-17:07:15  -------------------------读取完毕: (8820, 34) 2022-06-27 17:07:15 -------------------------

20220627-17:07:15  手动衍生_py2个字段: {'monthsremain_last_stop_date': '最后停机时间：剩余时长', 'greatest_gprs_app': 'app偏好'}
20220627-17:07:15  monthsremain_last_stop_date: last_stop_date - current_date
20220627-17:07:15  greatest_gprs_app: {'gprs_flow_video': 'video', 'gprs_flow_short': 'short', 'gprs_flow_music': 'music', 'gprs_flow_commu': 'commu', 'gprs_flow_game': 'game'}
20220627-17:07:17  数据量: (8820, 36)

20220627-17:07:17  检查数据
20220627-17:07:17  各账期数据量分布：
                       202010  data_predict    3310
                       202011  data_predict    2200
                       202012  data_predict    3310
                       dtype: int64
20220627-17:07:17  各账期数据量不一致
20220627-17:07:17  以nan填充缺少账期的记录
20220627-17:07:17      修改后：
                       202010  data_predict    3310
                       202011  data_predict    3310
                       202012  data_predict    3310
                       dtype: int64)
20220627-17:07:17  
                   diff_limitweiNone,不考察近n月字段各账期取值分布, dis_exam返回None！


20220627-17:07:17  填充数值型&类别型字段缺失值
20220627-17:07:17  日期型字段缺失值情况：
                       last_stop_date    1110
                       dtype: int64

                   ----------------------------------------- 当月 类别型 onthot 
20220627-17:07:17  ['sex_add~女', 'sex_add~男']

                   ----------------------------------------- 当月 数值型&类别型 原始数据 
20220627-17:07:17  (3310, 29)
20220627-17:07:17  筛选衍生字段的 原始/手动衍生_sql 字段

                   ----------------------------------------- 近n月 数值型 近3月均值 
20220627-17:07:17  字段个数：22, 添加字段：None
20220627-17:07:17  (3310, 51)

                   ----------------------------------------- 近n月 数值型 近3月离散系数 
20220627-17:07:17  字段个数：10, 添加字段：None
20220627-17:07:17  (3310, 61)

                   ----------------------------------------- 近n月 数值型 近3月波动性 
20220627-17:07:17  字段个数：12, 添加字段：None
20220627-17:07:17  (3310, 73)

                   ----------------------------------------- 近n月 数值型 近3月成长率 
20220627-17:07:17  字段个数：9, 添加字段：None
20220627-17:07:17  (3310, 82)

                   ----------------------------------------- 近n月 数值型 近3月最大值 
20220627-17:07:17  字段个数：17, 添加字段：None
20220627-17:07:17  (3310, 99)

                   ----------------------------------------- 近n月 数值型 近3月最小值 
20220627-17:07:17  字段个数：19, 添加字段：None
20220627-17:07:18  (3310, 118)

                   ----------------------------------------- 近n月 数值型 近3月标准差 
20220627-17:07:18  字段个数：14, 添加字段：None
20220627-17:07:18  (3310, 132)

                   ----------------------------------------- 近n月 数值型 大于x的月份数 
20220627-17:07:18  ('more0cnt', '近3月大于0的月份数')
20220627-17:07:18  ('moreq25cnt', '近3月大于第一四分位数的月份数')
20220627-17:07:18  (3310, 151)

                   ----------------------------------------- 近n月 类别型 取某值的月份数 
20220627-17:07:18  字段个数：2, 添加字段：None
20220627-17:07:18  (3310, 153)

                   ----------------------------------------- 汇总最终宽表 
20220627-17:07:18  table.shape:(3310, 153)

20220627-17:07:18  保存宽表结果至：./binaryclassify/eg//predictscore~202012/predict_data~202012~0.csv

20220627-17:07:18  计算字段之间的相关性系数
20220627-17:07:18  
                       count    10440.0
                       mean    0.161
                       std    0.189
                       min    0.0
                       25%    0.041
                       50%    0.095
                       75%    0.199
                       max    1.0
                       dtype: float64


                   ------------------------------- 计算宽表字段psi ------------------------------------ 
                    
                    20220627-17:07:18  my toolmodule.dataprep.PsiTransformer_DF transform
                    20220627-17:07:18      开始时间：2022-06-27 17:07:18
                    20220627-17:07:18      data in : (3310, 163)
                    20220627-17:07:18      self已带有id_X属性 2466191260808
                    20220627-17:07:18      首次从X获取id_X_new属性 2000966308920
                    20220627-17:07:18      data in2: (3310, 157)
                    20220627-17:07:18      对154个数值字段进行分箱：['innet_months', 'monthsremain_last_stop_date', 'gprs_last_defer', 'gprs_now_rest', 'call_use', 'arpu', 'calling_cnt', 'calling_dura', 'calling_diff_dura', 'gprs_flow_4g', 'gprs_flow_5g', 'gprs_flow_roam', 'call_dura_roam', 'days_call_p_4', 'nos_calling', 'nos_calling_diff', 'gprs_flow_video', 'gprs_flow_short', 'gprs_flow_music', 'gprs_flow_commu', 'gprs_flow_game', 'sex_add~女', 'sex_add~男', 'avg__gprs_flow_roam', 'avg__monthsremain_last_stop_date', 'avg__gprs_last_defer', 'avg__gprs_resource', 'avg__calling_diff_dura', 'avg__gprs_flow_video', 'avg__gprs_flow_5g', 'avg__nos_calling', 'avg__nos_calling_diff', 'avg__arpu', 'avg__calling_cnt', 'avg__gprs_flow_commu', 'avg__gprs_now_defer', 'avg__call_use', 'avg__gprs_flow_4g', 'avg__gprs_now_rest', 'avg__gprs_flow_music', 'avg__calling_diff_cnt', 'avg__gprs_flow_game', 'avg__call_dura_roam', 'avg__gprs_flow_short', 'avg__calling_dura', 'sep__gprs_resource', 'sep__calling_diff_dura', 'sep__gprs_flow_5g', 'sep__nos_calling', 'sep__nos_calling_diff', 'sep__gprs_flow_commu', 'sep__gprs_now_rest', 'sep__calling_diff_cnt', 'sep__gprs_flow_short', 'sep__calling_dura', 'wave__monthsremain_last_stop_date', 'wave__gprs_last_defer', 'wave__gprs_flow_video', 'wave__calling_cnt', 'wave__gprs_flow_commu', 'wave__gprs_now_defer', 'wave__call_use', 'wave__gprs_now_rest', 'wave__gprs_flow_music', 'wave__calling_diff_cnt', 'wave__gprs_flow_short', 'wave__calling_dura', 'grow__gprs_flow_roam', 'grow__gprs_last_defer', 'grow__gprs_resource', 'grow__calling_diff_dura', 'grow__gprs_flow_video', 'grow__dinner_fee', 'grow__gprs_flow_5g', 'grow__nos_calling', 'grow__nos_calling_diff', 'grow__calling_cnt', 'grow__call_use', 'grow__gprs_now_rest', 'grow__gprs_flow_music', 'grow__calling_diff_cnt', 'max__gprs_flow_roam', 'max__monthsremain_last_stop_date', 'max__gprs_last_defer', 'max__gprs_resource', 'max__calling_diff_dura', 'max__dinner_fee', 'max__nos_calling', 'max__nos_calling_diff', 'max__arpu', 'max__calling_cnt', 'max__gprs_flow_commu', 'max__call_use', 'max__gprs_now_rest', 'max__gprs_flow_music', 'max__calling_diff_cnt', 'max__call_dura_roam', 'max__calling_dura', 'min__gprs_flow_roam', 'min__gprs_last_defer', 'min__gprs_resource', 'min__calling_diff_dura', 'min__gprs_flow_video', 'min__gprs_flow_5g', 'min__nos_calling', 'min__nos_calling_diff', 'min__arpu', 'min__calling_cnt', 'min__gprs_flow_commu', 'min__gprs_now_defer', 'min__call_use', 'min__gprs_flow_4g', 'min__gprs_now_rest', 'min__gprs_flow_music', 'min__calling_diff_cnt', 'min__gprs_flow_game', 'min__call_dura_roam', 'min__gprs_flow_short', 'min__calling_dura', 'std__gprs_last_defer', 'std__gprs_resource', 'std__calling_diff_dura', 'std__gprs_flow_video', 'std__nos_calling', 'std__nos_calling_diff', 'std__calling_cnt', 'std__gprs_flow_commu', 'std__call_use', 'std__gprs_flow_4g', 'std__gprs_now_rest', 'std__calling_diff_cnt', 'std__call_dura_roam', 'std__calling_dura', 'more0cnt__monthsremain_last_stop_date', 'more0cnt__nos_calling', 'more0cnt__calling_dura', 'moreq25cnt__gprs_last_defer', 'moreq25cnt__gprs_resource', 'moreq25cnt__gprs_flow_video', 'moreq25cnt__gprs_flow_5g', 'moreq25cnt__nos_calling', 'moreq25cnt__nos_calling_diff', 'moreq25cnt__arpu', 'moreq25cnt__calling_cnt', 'moreq25cnt__gprs_flow_commu', 'moreq25cnt__call_use', 'moreq25cnt__gprs_flow_4g', 'moreq25cnt__gprs_flow_music', 'moreq25cnt__calling_diff_cnt', 'moreq25cnt__gprs_flow_game', 'moreq25cnt__gprs_flow_short', 'moreq25cnt__calling_dura', 'valuecnt__if_nolimit~是', 'valuecnt__if_5g_dinner~是']
                    20220627-17:07:19      timedata_predict 计算稳定度（不区分正负例）：self.col_psi_all_
                    20220627-17:07:30      data out: (3310, 157)
                    20220627-17:07:30      transform轨迹：PsiTransformer_DF(Ncase='0', Pcase='1', bins=None, col_ignore=None, fit_pop_all=False, precision=6, , psi_limit=0.1, trans_na_error=True, warn_mark=' PsiTransformer')
                    20220627-17:07:30      结束时间：2022-06-27 17:07:30 耗时(11s)
20220627-17:07:30  保存Psi至：./binaryclassify/eg//predictscore~202012/predict_Psi~202010~202012~0.pkl
20220627-17:07:30  保存dis_exam至：./binaryclassify/eg//predictscore~202012/predict_dis_exam~202012~0.pkl
20220627-17:07:30  结束时间：2022-06-27 17:07:30
20220627-17:07:30  耗时：20 s


D:\Python for Windows\lib\site-packages\pandas\core\apply.py:1101: UserWarning: stage取值为create时,r_limit, iv_limit参数无效，将被忽略
  convert=self.convert_dtype,


D:\Python for Windows\lib\site-packages\pandas\core\apply.py:1101: UserWarning:      PsiTransformer timedata_predict 计算稳定性(不区分正负例) ['account_id']字段多出2322个取值, .head(5):
                      old  new
field      value              
account_id 101572366  NaN  1.0
           101798527  NaN  1.0
           101817036  NaN  1.0
           101875592  NaN  1.0
           101994315  NaN  1.0
  convert=self.convert_dtype,


D:\Python for Windows\lib\site-packages\pandas\core\apply.py:1101: UserWarning:      PsiTransformer timedata_predict 计算稳定性(不区分正负例)，38个字段稳定性>=psi_limit（0.1）：
grow__gprs_resource                      4.439453
grow__gprs_last_defer                    2.232931
grow__gprs_now_rest                      2.140172
max__monthsremain_last_stop_date         1.405633
avg__monthsremain_last_stop_date         0.790859
more0cnt__monthsremain_last_stop_date    0.512769
sep__gprs_resource                       0.445397
account_id                               0.431740
min__gprs_now_rest                       0.405154
wave__monthsremain_last_stop_date        0.386798
wave__gprs_flow_video                    0.383782
sep__gprs_now_rest                       0.363417
wave__gprs_now_rest                      0.307127
moreq25cnt__arpu                         0.289794
grow__gprs_flow_roam                     0.232755
min__gprs_now_defer                      0.222008
wave__gprs_flow_music                    0.208796
moreq25cnt__gprs_flow_4g                 0.202080
sep__gprs_flow_commu                     0.192000
moreq25cnt__calling_dura                 0.185917
wave__gprs_now_defer                     0.184252
wave__gprs_flow_commu                    0.170403
wave__gprs_flow_short                    0.167556
sep__nos_calling_diff                    0.167060
wave__calling_dura                       0.165424
wave__calling_cnt                        0.164051
more0cnt__nos_calling                    0.155792
min__arpu                                0.155312
moreq25cnt__calling_cnt                  0.149721
sep__gprs_flow_short                     0.145582
moreq25cnt__calling_diff_cnt             0.144663
moreq25cnt__gprs_flow_music              0.139598
min__calling_dura                        0.135355
moreq25cnt__call_use                     0.132729
min__calling_cnt                         0.123867
min__gprs_last_defer                     0.113372
moreq25cnt__gprs_last_defer              0.111238
moreq25cnt__nos_calling                  0.110344
dtype: float64
  convert=self.convert_dtype,


D:\Python for Windows\lib\site-packages\pandas\core\apply.py:1101: UserWarning:      PsiTransformer data_predict X未带有y_carrier属性，不计算稳定度（区分正负例）
  convert=self.convert_dtype,

                   ###################################################################### 预测打分过程
                    
20220627-17:07:30  开始时间：2022-06-27 17:07:30
20220627-17:07:30  模型名称：模型示例
20220627-17:07:30  预测账期：202012
20220627-17:07:30  提取模型结果: ratio_1_2 | pipeline1 | RandomForestClassifier_DF - 默认参数
20220627-17:07:30  模型 [宽带探索]~训练~测试 账期：~202010~202012
20220627-17:07:30  最优模型的流水线是pipeline1
20220627-17:07:30  建模时效果评估数据集：data_timeout

20220627-17:07:30  ------------------------- 读取数据: ./binaryclassify/eg//predictscore~202012/predict_data~202012~0.csv 2022-06-27 17:07:30 -------------------------
20220627-17:07:30      src: file
20220627-17:07:30      condition: None
20220627-17:07:30      col_need(151): ['acct_month', 'user_id', 'sms_cnt', 'call_fee_local', 'account_id', 'innet_months', 'monthsremain_last_stop_date', 'gprs_last_defer', 'gprs_now_rest', 'call_use', 'arpu', 'calling_cnt', 'calling_dura', 'calling_diff_dura', 'gprs_flow_4g', 'gprs_flow_5g', 'gprs_flow_roam', 'call_dura_roam', 'nos_calling', 'nos_calling_diff', 'gprs_flow_video', 'gprs_flow_short', 'gprs_flow_commu', 'gprs_flow_game', 'greatest_gprs_app', 'sex_add~女', 'sex_add~男', 'avg__gprs_flow_roam', 'avg__monthsremain_last_stop_date', 'avg__gprs_last_defer', 'avg__gprs_resource', 'avg__calling_diff_dura', 'avg__gprs_flow_video', 'avg__gprs_flow_5g', 'avg__nos_calling', 'avg__nos_calling_diff', 'avg__arpu', 'avg__calling_cnt', 'avg__gprs_flow_commu', 'avg__gprs_now_defer', 'avg__call_use', 'avg__gprs_flow_4g', 'avg__gprs_now_rest', 'avg__gprs_flow_music', 'avg__calling_diff_cnt', 'avg__gprs_flow_game', 'avg__call_dura_roam', 'avg__gprs_flow_short', 'avg__calling_dura', 'sep__gprs_resource', 'sep__calling_diff_dura', 'sep__gprs_flow_5g', 'sep__nos_calling', 'sep__nos_calling_diff', 'sep__gprs_flow_commu', 'sep__gprs_now_rest', 'sep__calling_diff_cnt', 'sep__gprs_flow_short', 'sep__calling_dura', 'wave__monthsremain_last_stop_date', 'wave__gprs_last_defer', 'wave__gprs_flow_video', 'wave__calling_cnt', 'wave__gprs_flow_commu', 'wave__gprs_now_defer', 'wave__call_use', 'wave__gprs_now_rest', 'wave__gprs_flow_music', 'wave__calling_diff_cnt', 'wave__gprs_flow_short', 'wave__calling_dura', 'grow__gprs_flow_roam', 'grow__gprs_last_defer', 'grow__gprs_resource', 'grow__gprs_flow_video', 'grow__gprs_flow_5g', 'grow__calling_cnt', 'grow__gprs_now_rest', 'grow__gprs_flow_music', 'grow__calling_diff_cnt', 'max__gprs_flow_roam', 'max__monthsremain_last_stop_date', 'max__gprs_last_defer', 'max__gprs_resource', 'max__calling_diff_dura', 'max__dinner_fee', 'max__nos_calling', 'max__nos_calling_diff', 'max__arpu', 'max__calling_cnt', 'max__gprs_flow_commu', 'max__call_use', 'max__gprs_now_rest', 'max__gprs_flow_music', 'max__calling_diff_cnt', 'max__call_dura_roam', 'max__calling_dura', 'min__gprs_flow_roam', 'min__gprs_last_defer', 'min__gprs_resource', 'min__calling_diff_dura', 'min__gprs_flow_video', 'min__nos_calling', 'min__nos_calling_diff', 'min__arpu', 'min__calling_cnt', 'min__gprs_flow_commu', 'min__gprs_now_defer', 'min__call_use', 'min__gprs_flow_4g', 'min__gprs_now_rest', 'min__gprs_flow_music', 'min__calling_diff_cnt', 'min__call_dura_roam', 'min__gprs_flow_short', 'min__calling_dura', 'std__gprs_last_defer', 'std__gprs_resource', 'std__calling_diff_dura', 'std__gprs_flow_video', 'std__nos_calling', 'std__nos_calling_diff', 'std__calling_cnt', 'std__gprs_flow_commu', 'std__call_use', 'std__gprs_flow_4g', 'std__gprs_now_rest', 'std__calling_diff_cnt', 'std__call_dura_roam', 'std__calling_dura', 'more0cnt__monthsremain_last_stop_date', 'more0cnt__nos_calling', 'more0cnt__calling_dura', 'moreq25cnt__gprs_last_defer', 'moreq25cnt__gprs_resource', 'moreq25cnt__gprs_flow_video', 'moreq25cnt__gprs_flow_5g', 'moreq25cnt__nos_calling', 'moreq25cnt__nos_calling_diff', 'moreq25cnt__arpu', 'moreq25cnt__calling_cnt', 'moreq25cnt__gprs_flow_commu', 'moreq25cnt__call_use', 'moreq25cnt__gprs_flow_4g', 'moreq25cnt__gprs_flow_music', 'moreq25cnt__calling_diff_cnt', 'moreq25cnt__gprs_flow_game', 'moreq25cnt__gprs_flow_short', 'moreq25cnt__calling_dura', 'valuecnt__if_nolimit~是', 'valuecnt__if_5g_dinner~是']
20220627-17:07:30      col_del: None
20220627-17:07:30      col_char: None
20220627-17:07:30      col_num: None
20220627-17:07:30      col_date: None
20220627-17:07:30      nrows: None
20220627-17:07:30      if_coltolower: False
20220627-17:07:30      kwargs: {}

20220627-17:07:30      读取
20220627-17:07:30  -------------------------读取完毕: (3310, 151) 2022-06-27 17:07:30 -------------------------

20220627-17:07:30  补齐流水线删除的11个fit_in_colnames_字段
20220627-17:07:30      数据量：(3310, 162)

20220627-17:07:30  数据账期校验:
20220627-17:07:30      通过

20220627-17:07:30  top原因匹配
20220627-17:07:30      最优模型 - pipeline1 - 数据转换
20220627-17:07:30      col_notcause：['acct_month', 'phone_no_null', 'user_id', 'account_id', 'last_stop_date']
20220627-17:07:30      从流水线中获取WoeTransformer_DF
20220627-17:07:30      向WoeTransformer_DF.psi_.col_ignore补充流水线中删除的字段，不做稳定度检验（未读取，用np.nan填充）

20220627-17:07:30      数据分箱（union1） 2022-06-27 17:07:30
20220627-17:07:33      转换前shape：(3310, 162)
20220627-17:07:33      转换后shape：(3310, 152)

20220627-17:07:33      woe转换 2022-06-27 17:07:33
20220627-17:07:41      转换前shape：(3310, 152)
20220627-17:07:41      转换后shape：(3310, 145)

20220627-17:07:41      确定动因字段 2022-06-27 17:07:41
20220627-17:07:41      剔除非动因字段（0个）：set()
20220627-17:07:41      动因字段：145个

20220627-17:07:41      计算动因字段的相关矩阵，删除高相关字段
20220627-17:07:41      输入为相关性系数矩阵
20220627-17:07:41      提取相关性超过0.8的字段
20220627-17:07:42      需要删除68个高度相关字段: ['sep__gprs_flow_short', 'max__gprs_flow_music', 'std__gprs_flow_commu', 'moreq25cnt__gprs_flow_music', 'min__gprs_now_defer', 'wave__gprs_last_defer', 'avg__gprs_resource', 'moreq25cnt__gprs_flow_commu', 'max__gprs_flow_roam', 'std__gprs_flow_video', 'avg__gprs_flow_commu', 'max__calling_diff_cnt', 'moreq25cnt__calling_dura', 'min__calling_dura', 'moreq25cnt__calling_diff_cnt', 'moreq25cnt__gprs_flow_short', 'arpu', 'gprs_last_defer', 'wave__gprs_flow_commu', 'avg__gprs_flow_music', 'more0cnt__calling_dura', 'avg__arpu', 'avg__gprs_flow_game', 'min__call_use', 'avg__calling_cnt', 'sex_add~女', 'grow__gprs_flow_5g', 'calling_diff_dura', 'avg__gprs_flow_short', 'wave__gprs_flow_video', 'gprs_flow_4g', 'avg__monthsremain_last_stop_date', 'moreq25cnt__calling_cnt', 'more0cnt__monthsremain_last_stop_date', 'avg__calling_diff_dura', 'gprs_now_rest', 'avg__call_use', 'moreq25cnt__gprs_flow_video', 'avg__gprs_now_rest', 'max__gprs_resource', 'avg__gprs_last_defer', 'std__gprs_flow_4g', 'min__nos_calling_diff', 'max__nos_calling_diff', 'sep__gprs_now_rest', 'min__calling_diff_cnt', 'min__gprs_flow_short', 'gprs_flow_short', 'moreq25cnt__nos_calling', 'grow__gprs_flow_video', 'nos_calling', 'avg__nos_calling_diff', 'min__calling_diff_dura', 'gprs_flow_game', 'min__gprs_flow_commu', 'grow__gprs_flow_music', 'nos_calling_diff', 'min__calling_cnt', 'calling_dura', 'gprs_flow_roam', 'wave__gprs_flow_short', 'wave__gprs_now_rest', 'moreq25cnt__nos_calling_diff', 'gprs_flow_video', 'std__call_dura_roam', 'min__gprs_flow_4g', 'gprs_flow_commu', 'avg__gprs_flow_video']
20220627-17:07:42      动因字段：77个

20220627-17:07:42      从原因中删除用户量过小的 字段-取值
20220627-17:07:42      阈值 valuecount_limit= 50
20220627-17:07:42      将7个字段的7个取值（用户量<=50）从原因中剔除（对应的woe置为-999）

20220627-17:07:42      原因排序 2022-06-27 17:07:42
20220627-17:07:42      top1 2022-06-27 17:07:42
20220627-17:07:42      top2 2022-06-27 17:07:42
20220627-17:07:42      top3 2022-06-27 17:07:42
20220627-17:07:42      排序结束 2022-06-27 17:07:42

20220627-17:07:42      将woe<=woe_thred（0)的原因置空
20220627-17:07:42      top1: colwoe_top1字段最小值0.288 > woe_thred（0）,无需处理
20220627-17:07:42      top2: colwoe_top2字段最小值0.115 > woe_thred（0）,无需处理
20220627-17:07:42      top3: 将6行woe<=woe_thred（0)的colname_top3, colcomment_top3, colvalue_top3, colwoe_top3置空


20220627-17:07:42  模型预测

20220627-17:07:42  匹配各分数档位查准率、提升度（非累计）



Traceback (most recent call last):
  File "D:\Python for Windows\lib\site-packages\IPython\core\interactiveshell.py", line 3296, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-114-f19257eccca4>", line 19, in <module>
    pred_res[model_name] = predict_fun(train_result, Info_i, n_reason)
  File "D:\工作\模型脚本\ModelProject\selfmodule\binarymodule\predictscore.py", line 366, in predict_fun
    raise Exception(s)
Exception: 存在缺失值：{'precision': 559, 'lift': 559}
20220627-17:07:58  开始时间：2022-06-27 17:07:58


Traceback (most recent call last):
  File "D:\Python for Windows\lib\site-packages\IPython\core\interactiveshell.py", line 3296, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-115-b06bbef44b8b>", line 5, in <module>
    if str(table_in) == 'nan':
NameError: name 'table_in' is not defined
20220627-17:09:26  开始时间：2022-06-27 17:09:26
20220627-17:09:26  参数设置：
                       Info.model_name: 模型示例
                       Info.auto_pair2: False
                       Info.iv_limit: 0.05
                       stage: create
                       step: predict
                       Info.r_limit: 0.95
                       table_in: kehujingyingbudb.mid_eg_recent_predict_202012



D:\Program Files\PyCharm 2021.2.2\plugins\python\helpers\pydev\pydevconsole.py:60: UserWarning: stage取值为create时,r_limit, iv_limit参数无效，将被忽略
  # InterpreterInterface
20220627-17:09:42  ------------------------- 读取数据: kehujingyingbudb.mid_eg_recent_predict_202012 2022-06-27 17:09:42 -------------------------
20220627-17:09:42      src: gp
20220627-17:09:42      condition: right(cast(user_id as text), 1) in ('0', '1', '2')
20220627-17:09:42      col_need(34): ['user_acct_month', 'data_use', 'acct_month', 'user_id', 'account_id', 'innet_months', 'sex_add', 'last_stop_date', 'dinner_fee', 'gprs_last_defer', 'gprs_resource', 'gprs_now_rest', 'call_use', 'if_nolimit', 'if_5g_dinner', 'arpu', 'calling_cnt', 'calling_dura', 'calling_diff_cnt', 'calling_diff_dura', 'gprs_flow_4g', 'gprs_flow_5g', 'gprs_now_defer', 'gprs_flow_roam', 'call_dura_roam', 'nos_calling', 'nos_calling_diff', 'sms_cnt', 'call_fee_local', 'gprs_flow_video', 'gprs_flow_short', 'gprs_flow_music', 'gprs_flow_commu', 'gprs_flow_game']
20220627-17:09:42      col_del: None
20220627-17:09:42      col_char(8): ['user_acct_month', 'data_use', 'acct_month', 'user_id', 'account_id', 'sex_add', 'if_nolimit', 'if_5g_dinner']
20220627-17:09:42      col_num(25): ['innet_months', 'dinner_fee', 'gprs_last_defer', 'gprs_resource', 'gprs_now_rest', 'call_use', 'arpu', 'calling_cnt', 'calling_dura', 'calling_diff_cnt', 'calling_diff_dura', 'gprs_flow_4g', 'gprs_flow_5g', 'gprs_now_defer', 'gprs_flow_roam', 'call_dura_roam', 'nos_calling', 'nos_calling_diff', 'sms_cnt', 'call_fee_local', 'gprs_flow_video', 'gprs_flow_short', 'gprs_flow_music', 'gprs_flow_commu', 'gprs_flow_game']
20220627-17:09:42      col_date(1): ['last_stop_date']
20220627-17:09:42      nrows: None
20220627-17:09:42      if_coltolower: True
20220627-17:09:42      kwargs: {}

20220627-17:09:42      读取
20220627-17:09:45      shape: (8820, 34)

20220627-17:09:45  -------------------------读取完毕: (8820, 34) 2022-06-27 17:09:45 -------------------------

                   Out[121]: 20220627-17:13:37  Series([], Name: field_name, dtype: object)
                   Out[122]: 20220627-17:13:47  
                   Empty DataFrame
                   Columns: [field_name, comment, dtype_db, dtype_classify, field_src, table, available, available_notzd, available_zd, formula, remark, must_remain, into_model, is_cause]
                   Index: []
                   Out[124]: 20220627-17:13:54  []
                   Out[125]: 20220627-17:14:00  []
                   Out[126]: 20220627-17:14:05  
                   Empty DataFrame
                   Columns: []
                   Index: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, ...]
                   
                   [8820 rows x 0 columns]
                   Out[127]: 20220627-17:14:10  'kehujingyingbudb.table_score_month'
                   Out[128]: 20220627-17:14:19  
                   0       kehujingyingbudb.ml_feature_info_yw_user_m
                   1       kehujingyingbudb.ml_feature_info_yw_user_m
                   3       kehujingyingbudb.ml_feature_info_yw_user_m
                   5       kehujingyingbudb.ml_feature_info_yw_user_m
                   7       kehujingyingbudb.ml_feature_info_yw_user_m
                   11       kehujingyingbudb.ml_feature_add_yw_user_m
                   12      kehujingyingbudb.ml_feature_info_yw_user_m
                   13      kehujingyingbudb.ml_feature_info_yw_user_m
                   17      kehujingyingbudb.ml_feature_info_yw_user_m
                   18      kehujingyingbudb.ml_feature_info_yw_user_m
                   19      kehujingyingbudb.ml_feature_info_yw_user_m
                   20      kehujingyingbudb.ml_feature_info_yw_user_m
                   21      kehujingyingbudb.ml_feature_info_yw_user_m
                   22      kehujingyingbudb.ml_feature_info_yw_user_m
                   23      kehujingyingbudb.ml_feature_info_yw_user_m
                   29      kehujingyingbudb.ml_feature_info_yw_user_m
                   38      kehujingyingbudb.ml_feature_info_yw_user_m
                   39      kehujingyingbudb.ml_feature_info_yw_user_m
                   42      kehujingyingbudb.ml_feature_info_yw_user_m
                   43      kehujingyingbudb.ml_feature_info_yw_user_m
                   46      kehujingyingbudb.ml_feature_info_yw_user_m
                   47      kehujingyingbudb.ml_feature_info_yw_user_m
                   50      kehujingyingbudb.ml_feature_info_yw_user_m
                   51      kehujingyingbudb.ml_feature_info_yw_user_m
                   52      kehujingyingbudb.ml_feature_info_yw_user_m
                   68      kehujingyingbudb.ml_feature_info_yw_user_m
                   69      kehujingyingbudb.ml_feature_info_yw_user_m
                   70      kehujingyingbudb.ml_feature_info_yw_user_m
                   71      kehujingyingbudb.ml_feature_info_yw_user_m
                   76      kehujingyingbudb.ml_feature_info_yw_user_m
                   77      kehujingyingbudb.ml_feature_info_yw_user_m
                   78      kehujingyingbudb.ml_feature_info_yw_user_m
                   79      kehujingyingbudb.ml_feature_info_yw_user_m
                   80      kehujingyingbudb.ml_feature_info_yw_user_m
                   84    kehujingyingbudb.ml_feature_info_yw_user_day
                   Name: table, dtype: object
                   Out[129]: 
                               field_name                 comment dtype_db dtype_classify     field_src                                         table available available_notzd available_zd formula  \
                   0           acct_month                    账期   bigint         数值型          原始    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN     NaN   
                   1        phone_no_null                手机号码  numeric         类别型          原始    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN     NaN   
                   3              user_id                手机号id     text         类别型          原始    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN     NaN   
                   5           account_id                帐户编号  numeric         类别型          原始    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN     NaN   
                   7         innet_months                入网时长   bigint         数值型          原始    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN     NaN   
                   11             sex_add    table_a_add测试字段2     text         类别型  手动衍生_sql     kehujingyingbudb.ml_feature_add_yw_user_m       NaN             NaN          NaN     NaN   
                   12         user_status                用户状态     text         类别型          原始    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN     NaN   
                   13      last_stop_date            最后停机时间     text         日期型          原始    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN     NaN   
                   17          dinner_fee              套餐月租费  numeric         数值型          原始    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN     NaN   
                   18     gprs_last_defer            流量滚存资源   bigint         数值型          原始    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN     NaN   
                   19       gprs_resource        gprs国内资源总量   bigint         数值型          原始    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN     NaN   
                   20       gprs_now_rest        当月gprs资源余量  numeric         数值型          原始    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN     NaN   
                   21            call_use          语音资源使用量  numeric         数值型          原始    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN     NaN   
                   22          if_nolimit  是否不限量套餐到达用户     text         类别型          原始    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN     NaN   
                   23        if_5g_dinner              是否5g套餐     text         类别型          原始    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN     NaN   
                   29                arpu                当月arpu  numeric         数值型          原始    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN     NaN   
                   38         calling_cnt            主叫通话次数  numeric         数值型          原始    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN     NaN   
                   39        calling_dura        当月主叫通话时长  numeric         数值型          原始    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN     NaN   
                   42    calling_diff_cnt        主叫异网通话次数  numeric         数值型          原始    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN     NaN   
                   43   calling_diff_dura      主叫异网通话分钟数  numeric         数值型          原始    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN     NaN   
                   46        gprs_flow_4g              gprs4g流量  numeric         数值型          原始    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN     NaN   
                   47        gprs_flow_5g             gprs 5g流量  numeric         数值型          原始    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN     NaN   
                   50      gprs_now_defer      可延递流量资源总量  numeric         数值型          原始    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN     NaN   
                   51      gprs_flow_roam      gprs-国内漫游-流量  numeric         数值型          原始    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN     NaN   
                   52      call_dura_roam           省际漫游-时长  numeric         数值型          原始    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN     NaN   
                   68         nos_calling    主叫通话对端号码个数  numeric         数值型          原始    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN     NaN   
                   69    nos_calling_diff    主叫异网对端号码个数  numeric         数值型          原始    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN     NaN   
                   70             sms_cnt    短信-点对点短信-条数  numeric         数值型          原始    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN     NaN   
                   71      call_fee_local              本地通话费  numeric         数值型          原始    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN     NaN   
                   76     gprs_flow_video          视频类应用流量  numeric         数值型          原始    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN     NaN   
                   77     gprs_flow_short         小视频系app流量  numeric         数值型          原始    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN     NaN   
                   78     gprs_flow_music          音乐类应用流量  numeric         数值型          原始    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN     NaN   
                   79     gprs_flow_commu          通信类应用流量  numeric         数值型          原始    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN     NaN   
                   80      gprs_flow_game          游戏类应用流量  numeric         数值型          原始    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN     NaN   
                   84  dayvalue_gprs_flow    次月dd日前流量使用量  numeric         数值型          原始  kehujingyingbudb.ml_feature_info_yw_user_day       NaN          不可用       不可用     NaN   
                   
                                    remark must_remain into_model is_cause  
                   0                   NaN         NaN        NaN       否  
                   1        不参与自动衍生         NaN       删除       否  
                   3                   NaN         NaN        NaN       否  
                   5    不参与当月自动衍生          是        NaN       否  
                   7   不参与近n月自动衍生         NaN        NaN      NaN  
                   11                  NaN         NaN        NaN      NaN  
                   12                  NaN          是        NaN      NaN  
                   13                  NaN         NaN       删除       否  
                   17                  NaN         NaN        NaN      NaN  
                   18   不参与当月自动衍生         NaN        NaN      NaN  
                   19                  NaN         NaN        NaN      NaN  
                   20                  NaN         NaN        NaN      NaN  
                   21                  NaN         NaN        NaN      NaN  
                   22                  NaN         NaN        NaN      NaN  
                   23                  NaN         NaN        NaN      NaN  
                   29                  NaN         NaN        NaN      NaN  
                   38                  NaN         NaN        NaN      NaN  
                   39                  NaN         NaN        NaN      NaN  
                   42                  NaN         NaN        NaN      NaN  
                   43                  NaN         NaN        NaN      NaN  
                   46                  NaN         NaN        NaN      NaN  
                   47                  NaN         NaN        NaN      NaN  
                   50                  NaN         NaN        NaN      NaN  
                   51                  NaN         NaN        NaN      NaN  
                   52                  NaN         NaN        NaN      NaN  
                   68                  NaN         NaN        NaN      NaN  
                   69                  NaN         NaN        NaN      NaN  
                   70                  NaN         NaN        NaN      NaN  
                   71                  NaN         NaN        NaN      NaN  
                   76                  NaN         NaN        NaN      NaN  
                   77                  NaN          是        NaN      NaN  
                   78                  NaN          是        NaN      NaN  
                   79                  NaN          是        NaN      NaN  
                   80                  NaN          是        NaN      NaN  
                   84                  NaN         NaN        NaN      NaN  
                   Out[130]: 20220627-17:14:49  
                   Empty DataFrame
                   Columns: [field_name, comment, dtype_db, dtype_classify, field_src, table, available, available_notzd, available_zd, formula, remark, must_remain, into_model, is_cause]
                   Index: []
                   Out[131]: 
                               field_name                 comment dtype_db dtype_classify     field_src                                         table available available_notzd available_zd formula  \
                   0           acct_month                    账期   bigint         数值型          原始    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN     NaN   
                   1        phone_no_null                手机号码  numeric         类别型          原始    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN     NaN   
                   3              user_id                手机号id     text         类别型          原始    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN     NaN   
                   5           account_id                帐户编号  numeric         类别型          原始    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN     NaN   
                   7         innet_months                入网时长   bigint         数值型          原始    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN     NaN   
                   11             sex_add    table_a_add测试字段2     text         类别型  手动衍生_sql     kehujingyingbudb.ml_feature_add_yw_user_m       NaN             NaN          NaN     NaN   
                   12         user_status                用户状态     text         类别型          原始    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN     NaN   
                   13      last_stop_date            最后停机时间     text         日期型          原始    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN     NaN   
                   17          dinner_fee              套餐月租费  numeric         数值型          原始    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN     NaN   
                   18     gprs_last_defer            流量滚存资源   bigint         数值型          原始    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN     NaN   
                   19       gprs_resource        gprs国内资源总量   bigint         数值型          原始    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN     NaN   
                   20       gprs_now_rest        当月gprs资源余量  numeric         数值型          原始    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN     NaN   
                   21            call_use          语音资源使用量  numeric         数值型          原始    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN     NaN   
                   22          if_nolimit  是否不限量套餐到达用户     text         类别型          原始    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN     NaN   
                   23        if_5g_dinner              是否5g套餐     text         类别型          原始    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN     NaN   
                   29                arpu                当月arpu  numeric         数值型          原始    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN     NaN   
                   38         calling_cnt            主叫通话次数  numeric         数值型          原始    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN     NaN   
                   39        calling_dura        当月主叫通话时长  numeric         数值型          原始    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN     NaN   
                   42    calling_diff_cnt        主叫异网通话次数  numeric         数值型          原始    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN     NaN   
                   43   calling_diff_dura      主叫异网通话分钟数  numeric         数值型          原始    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN     NaN   
                   46        gprs_flow_4g              gprs4g流量  numeric         数值型          原始    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN     NaN   
                   47        gprs_flow_5g             gprs 5g流量  numeric         数值型          原始    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN     NaN   
                   50      gprs_now_defer      可延递流量资源总量  numeric         数值型          原始    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN     NaN   
                   51      gprs_flow_roam      gprs-国内漫游-流量  numeric         数值型          原始    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN     NaN   
                   52      call_dura_roam           省际漫游-时长  numeric         数值型          原始    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN     NaN   
                   68         nos_calling    主叫通话对端号码个数  numeric         数值型          原始    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN     NaN   
                   69    nos_calling_diff    主叫异网对端号码个数  numeric         数值型          原始    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN     NaN   
                   70             sms_cnt    短信-点对点短信-条数  numeric         数值型          原始    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN     NaN   
                   71      call_fee_local              本地通话费  numeric         数值型          原始    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN     NaN   
                   76     gprs_flow_video          视频类应用流量  numeric         数值型          原始    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN     NaN   
                   77     gprs_flow_short         小视频系app流量  numeric         数值型          原始    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN     NaN   
                   78     gprs_flow_music          音乐类应用流量  numeric         数值型          原始    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN     NaN   
                   79     gprs_flow_commu          通信类应用流量  numeric         数值型          原始    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN     NaN   
                   80      gprs_flow_game          游戏类应用流量  numeric         数值型          原始    kehujingyingbudb.ml_feature_info_yw_user_m       NaN             NaN          NaN     NaN   
                   84  dayvalue_gprs_flow    次月dd日前流量使用量  numeric         数值型          原始  kehujingyingbudb.ml_feature_info_yw_user_day       NaN          不可用       不可用     NaN   
                   
                                    remark must_remain into_model is_cause  
                   0                   NaN         NaN        NaN       否  
                   1        不参与自动衍生         NaN       删除       否  
                   3                   NaN         NaN        NaN       否  
                   5    不参与当月自动衍生          是        NaN       否  
                   7   不参与近n月自动衍生         NaN        NaN      NaN  
                   11                  NaN         NaN        NaN      NaN  
                   12                  NaN          是        NaN      NaN  
                   13                  NaN         NaN       删除       否  
                   17                  NaN         NaN        NaN      NaN  
                   18   不参与当月自动衍生         NaN        NaN      NaN  
                   19                  NaN         NaN        NaN      NaN  
                   20                  NaN         NaN        NaN      NaN  
                   21                  NaN         NaN        NaN      NaN  
                   22                  NaN         NaN        NaN      NaN  
                   23                  NaN         NaN        NaN      NaN  
                   29                  NaN         NaN        NaN      NaN  
                   38                  NaN         NaN        NaN      NaN  
                   39                  NaN         NaN        NaN      NaN  
                   42                  NaN         NaN        NaN      NaN  
                   43                  NaN         NaN        NaN      NaN  
                   46                  NaN         NaN        NaN      NaN  
                   47                  NaN         NaN        NaN      NaN  
                   50                  NaN         NaN        NaN      NaN  
                   51                  NaN         NaN        NaN      NaN  
                   52                  NaN         NaN        NaN      NaN  
                   68                  NaN         NaN        NaN      NaN  
                   69                  NaN         NaN        NaN      NaN  
                   70                  NaN         NaN        NaN      NaN  
                   71                  NaN         NaN        NaN      NaN  
                   76                  NaN         NaN        NaN      NaN  
                   77                  NaN          是        NaN      NaN  
                   78                  NaN          是        NaN      NaN  
                   79                  NaN          是        NaN      NaN  
                   80                  NaN          是        NaN      NaN  
                   84                  NaN         NaN        NaN      NaN  
                   Out[132]: 20220627-17:16:07  
                   0       kehujingyingbudb.ml_feature_info_yw_user_m
                   1       kehujingyingbudb.ml_feature_info_yw_user_m
                   3       kehujingyingbudb.ml_feature_info_yw_user_m
                   5       kehujingyingbudb.ml_feature_info_yw_user_m
                   7       kehujingyingbudb.ml_feature_info_yw_user_m
                   11       kehujingyingbudb.ml_feature_add_yw_user_m
                   12      kehujingyingbudb.ml_feature_info_yw_user_m
                   13      kehujingyingbudb.ml_feature_info_yw_user_m
                   17      kehujingyingbudb.ml_feature_info_yw_user_m
                   18      kehujingyingbudb.ml_feature_info_yw_user_m
                   19      kehujingyingbudb.ml_feature_info_yw_user_m
                   20      kehujingyingbudb.ml_feature_info_yw_user_m
                   21      kehujingyingbudb.ml_feature_info_yw_user_m
                   22      kehujingyingbudb.ml_feature_info_yw_user_m
                   23      kehujingyingbudb.ml_feature_info_yw_user_m
                   29      kehujingyingbudb.ml_feature_info_yw_user_m
                   38      kehujingyingbudb.ml_feature_info_yw_user_m
                   39      kehujingyingbudb.ml_feature_info_yw_user_m
                   42      kehujingyingbudb.ml_feature_info_yw_user_m
                   43      kehujingyingbudb.ml_feature_info_yw_user_m
                   46      kehujingyingbudb.ml_feature_info_yw_user_m
                   47      kehujingyingbudb.ml_feature_info_yw_user_m
                   50      kehujingyingbudb.ml_feature_info_yw_user_m
                   51      kehujingyingbudb.ml_feature_info_yw_user_m
                   52      kehujingyingbudb.ml_feature_info_yw_user_m
                   68      kehujingyingbudb.ml_feature_info_yw_user_m
                   69      kehujingyingbudb.ml_feature_info_yw_user_m
                   70      kehujingyingbudb.ml_feature_info_yw_user_m
                   71      kehujingyingbudb.ml_feature_info_yw_user_m
                   76      kehujingyingbudb.ml_feature_info_yw_user_m
                   77      kehujingyingbudb.ml_feature_info_yw_user_m
                   78      kehujingyingbudb.ml_feature_info_yw_user_m
                   79      kehujingyingbudb.ml_feature_info_yw_user_m
                   80      kehujingyingbudb.ml_feature_info_yw_user_m
                   84    kehujingyingbudb.ml_feature_info_yw_user_day
                   Name: table, dtype: object
                   Out[133]: 20220627-17:16:30  'kehujingyingbudb.table_score_month'


Traceback (most recent call last):
  File "D:\Python for Windows\lib\site-packages\IPython\core\interactiveshell.py", line 3213, in run_ast_nodes
    code = compiler(mod, cell_name, "exec")
  File "D:\Python for Windows\lib\codeop.py", line 133, in __call__
    codeob = compile(source, filename, symbol, self.flags, 1)
  File "<ipython-input-138-43f8aaad2deb>", line 2
SyntaxError: 'return' outside function
20220627-17:17:07  手动衍生_py2个字段: {'monthsremain_last_stop_date': '最后停机时间：剩余时长', 'greatest_gprs_app': 'app偏好'}
                   Out[141]: 20220627-17:17:17  range(0, 2)
                   Out[142]: 20220627-17:17:53  range(0, 2)
20220627-17:18:23  手动衍生_py2个字段: {'monthsremain_last_stop_date': '最后停机时间：剩余时长', 'greatest_gprs_app': 'app偏好'}
20220627-17:18:23  monthsremain_last_stop_date: last_stop_date - current_date
20220627-17:18:23  greatest_gprs_app: {'gprs_flow_video': 'video', 'gprs_flow_short': 'short', 'gprs_flow_music': 'music', 'gprs_flow_commu': 'commu', 'gprs_flow_game': 'game'}
20220627-17:18:37  数据量: (8820, 36)

20220627-17:18:37  检查数据
20220627-17:18:37  各账期数据量分布：
                       202010  data_predict    3310
                       202011  data_predict    2200
                       202012  data_predict    3310
                       dtype: int64
20220627-17:18:37  各账期数据量不一致
20220627-17:18:37  以nan填充缺少账期的记录
20220627-17:18:37      修改后：
                       202010  data_predict    3310
                       202011  data_predict    3310
                       202012  data_predict    3310
                       dtype: int64)
20220627-17:18:37  
                   diff_limitweiNone,不考察近n月字段各账期取值分布, dis_exam返回None！


Traceback (most recent call last):
  File "D:\Python for Windows\lib\site-packages\IPython\core\interactiveshell.py", line 3296, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-145-ea78505bbb59>", line 1, in <module>
    rint('\n')
NameError: name 'rint' is not defined


20220627-17:18:49  填充数值型&类别型字段缺失值
20220627-17:18:53  日期型字段缺失值情况：
                       last_stop_date    1110
                       dtype: int64

                   ----------------------------------------- 当月 类别型 onthot 
20220627-17:19:08  ['sex_add~女', 'sex_add~男']

                   ----------------------------------------- 当月 数值型&类别型 原始数据 
20220627-17:19:13  (3310, 29)
                   Out[152]: 20220627-17:19:17  'create'
20220627-17:20:59  开始时间：2022-06-27 17:20:59
20220627-17:20:59  模型名称：模型示例
20220627-17:20:59  预测账期：202012
20220627-17:20:59  提取模型结果: ratio_1_2 | pipeline1 | RandomForestClassifier_DF - 默认参数
20220627-17:20:59  模型 [宽带探索]~训练~测试 账期：~202010~202012
20220627-17:20:59  最优模型的流水线是pipeline1
20220627-17:20:59  建模时效果评估数据集：data_timeout

20220627-17:21:04  ------------------------- 读取数据: ./binaryclassify/eg//predictscore~202012/predict_data~202012~0.csv 2022-06-27 17:21:04 -------------------------
20220627-17:21:04      src: file
20220627-17:21:04      condition: None
20220627-17:21:04      col_need(151): ['acct_month', 'user_id', 'sms_cnt', 'call_fee_local', 'account_id', 'innet_months', 'monthsremain_last_stop_date', 'gprs_last_defer', 'gprs_now_rest', 'call_use', 'arpu', 'calling_cnt', 'calling_dura', 'calling_diff_dura', 'gprs_flow_4g', 'gprs_flow_5g', 'gprs_flow_roam', 'call_dura_roam', 'nos_calling', 'nos_calling_diff', 'gprs_flow_video', 'gprs_flow_short', 'gprs_flow_commu', 'gprs_flow_game', 'greatest_gprs_app', 'sex_add~女', 'sex_add~男', 'avg__gprs_flow_roam', 'avg__monthsremain_last_stop_date', 'avg__gprs_last_defer', 'avg__gprs_resource', 'avg__calling_diff_dura', 'avg__gprs_flow_video', 'avg__gprs_flow_5g', 'avg__nos_calling', 'avg__nos_calling_diff', 'avg__arpu', 'avg__calling_cnt', 'avg__gprs_flow_commu', 'avg__gprs_now_defer', 'avg__call_use', 'avg__gprs_flow_4g', 'avg__gprs_now_rest', 'avg__gprs_flow_music', 'avg__calling_diff_cnt', 'avg__gprs_flow_game', 'avg__call_dura_roam', 'avg__gprs_flow_short', 'avg__calling_dura', 'sep__gprs_resource', 'sep__calling_diff_dura', 'sep__gprs_flow_5g', 'sep__nos_calling', 'sep__nos_calling_diff', 'sep__gprs_flow_commu', 'sep__gprs_now_rest', 'sep__calling_diff_cnt', 'sep__gprs_flow_short', 'sep__calling_dura', 'wave__monthsremain_last_stop_date', 'wave__gprs_last_defer', 'wave__gprs_flow_video', 'wave__calling_cnt', 'wave__gprs_flow_commu', 'wave__gprs_now_defer', 'wave__call_use', 'wave__gprs_now_rest', 'wave__gprs_flow_music', 'wave__calling_diff_cnt', 'wave__gprs_flow_short', 'wave__calling_dura', 'grow__gprs_flow_roam', 'grow__gprs_last_defer', 'grow__gprs_resource', 'grow__gprs_flow_video', 'grow__gprs_flow_5g', 'grow__calling_cnt', 'grow__gprs_now_rest', 'grow__gprs_flow_music', 'grow__calling_diff_cnt', 'max__gprs_flow_roam', 'max__monthsremain_last_stop_date', 'max__gprs_last_defer', 'max__gprs_resource', 'max__calling_diff_dura', 'max__dinner_fee', 'max__nos_calling', 'max__nos_calling_diff', 'max__arpu', 'max__calling_cnt', 'max__gprs_flow_commu', 'max__call_use', 'max__gprs_now_rest', 'max__gprs_flow_music', 'max__calling_diff_cnt', 'max__call_dura_roam', 'max__calling_dura', 'min__gprs_flow_roam', 'min__gprs_last_defer', 'min__gprs_resource', 'min__calling_diff_dura', 'min__gprs_flow_video', 'min__nos_calling', 'min__nos_calling_diff', 'min__arpu', 'min__calling_cnt', 'min__gprs_flow_commu', 'min__gprs_now_defer', 'min__call_use', 'min__gprs_flow_4g', 'min__gprs_now_rest', 'min__gprs_flow_music', 'min__calling_diff_cnt', 'min__call_dura_roam', 'min__gprs_flow_short', 'min__calling_dura', 'std__gprs_last_defer', 'std__gprs_resource', 'std__calling_diff_dura', 'std__gprs_flow_video', 'std__nos_calling', 'std__nos_calling_diff', 'std__calling_cnt', 'std__gprs_flow_commu', 'std__call_use', 'std__gprs_flow_4g', 'std__gprs_now_rest', 'std__calling_diff_cnt', 'std__call_dura_roam', 'std__calling_dura', 'more0cnt__monthsremain_last_stop_date', 'more0cnt__nos_calling', 'more0cnt__calling_dura', 'moreq25cnt__gprs_last_defer', 'moreq25cnt__gprs_resource', 'moreq25cnt__gprs_flow_video', 'moreq25cnt__gprs_flow_5g', 'moreq25cnt__nos_calling', 'moreq25cnt__nos_calling_diff', 'moreq25cnt__arpu', 'moreq25cnt__calling_cnt', 'moreq25cnt__gprs_flow_commu', 'moreq25cnt__call_use', 'moreq25cnt__gprs_flow_4g', 'moreq25cnt__gprs_flow_music', 'moreq25cnt__calling_diff_cnt', 'moreq25cnt__gprs_flow_game', 'moreq25cnt__gprs_flow_short', 'moreq25cnt__calling_dura', 'valuecnt__if_nolimit~是', 'valuecnt__if_5g_dinner~是']
20220627-17:21:04      col_del: None
20220627-17:21:04      col_char: None
20220627-17:21:04      col_num: None
20220627-17:21:04      col_date: None
20220627-17:21:04      nrows: None
20220627-17:21:04      if_coltolower: False
20220627-17:21:04      kwargs: {}

20220627-17:21:04      读取
20220627-17:21:04  -------------------------读取完毕: (3310, 151) 2022-06-27 17:21:04 -------------------------

20220627-17:21:12  补齐流水线删除的11个fit_in_colnames_字段
20220627-17:21:12      数据量：(3310, 162)

20220627-17:21:12  数据账期校验:
20220627-17:21:12      通过

20220627-17:21:17  top原因匹配
20220627-17:21:17      最优模型 - pipeline1 - 数据转换
20220627-17:21:17      col_notcause：['acct_month', 'phone_no_null', 'user_id', 'account_id', 'last_stop_date']
20220627-17:21:17      从流水线中获取WoeTransformer_DF
20220627-17:21:17      向WoeTransformer_DF.psi_.col_ignore补充流水线中删除的字段，不做稳定度检验（未读取，用np.nan填充）

20220627-17:21:17      数据分箱（union1） 2022-06-27 17:21:17
20220627-17:21:20      转换前shape：(3310, 162)
20220627-17:21:20      转换后shape：(3310, 152)

20220627-17:21:20      woe转换 2022-06-27 17:21:20


D:\工作\模型脚本\ModelProject\selfmodule\toolmodule\dataprep.py:1322: UserWarning:     pipeline1 PsiTransformer time2 计算稳定性(不区分正负例)，37个字段稳定性>=psi_limit（0.1）：
grow__gprs_resource                      4.439453
grow__gprs_last_defer                    2.232931
grow__gprs_now_rest                      2.140172
max__monthsremain_last_stop_date         1.405633
avg__monthsremain_last_stop_date         0.790859
more0cnt__monthsremain_last_stop_date    0.512769
sep__gprs_resource                       0.445397
min__gprs_now_rest                       0.405154
wave__monthsremain_last_stop_date        0.386798
wave__gprs_flow_video                    0.383782
sep__gprs_now_rest                       0.363417
wave__gprs_now_rest                      0.307127
moreq25cnt__arpu                         0.289794
grow__gprs_flow_roam                     0.232755
min__gprs_now_defer                      0.222008
wave__gprs_flow_music                    0.208796
moreq25cnt__gprs_flow_4g                 0.202080
sep__gprs_flow_commu                     0.192000
moreq25cnt__calling_dura                 0.185917
wave__gprs_now_defer                     0.184252
wave__gprs_flow_commu                    0.170403
wave__gprs_flow_short                    0.167556
sep__nos_calling_diff                    0.167060
wave__calling_dura                       0.165424
wave__calling_cnt                        0.164051
more0cnt__nos_calling                    0.155792
min__arpu                                0.155312
moreq25cnt__calling_cnt                  0.149721
sep__gprs_flow_short                     0.145582
moreq25cnt__calling_diff_cnt             0.144663
moreq25cnt__gprs_flow_music              0.139598
min__calling_dura                        0.135355
moreq25cnt__call_use                     0.132729
min__calling_cnt                         0.123867
min__gprs_last_defer                     0.113372
moreq25cnt__gprs_last_defer              0.111238
moreq25cnt__nos_calling                  0.110344
dtype: float64
  warnings.warn(s); time.sleep(seconds)


D:\工作\模型脚本\ModelProject\selfmodule\toolmodule\dataprep.py:1334: UserWarning:     pipeline1 PsiTransformer  X未带有y_carrier属性，不计算稳定度（区分正负例）
  warnings.warn(ss); time.sleep(seconds)
20220627-17:21:29      转换前shape：(3310, 152)
20220627-17:21:29      转换后shape：(3310, 145)

20220627-17:21:29      确定动因字段 2022-06-27 17:21:29
20220627-17:21:29      剔除非动因字段（0个）：set()
20220627-17:21:29      动因字段：145个

20220627-17:21:29      计算动因字段的相关矩阵，删除高相关字段
20220627-17:21:29      输入为相关性系数矩阵
20220627-17:21:29      提取相关性超过0.8的字段
20220627-17:21:29      需要删除68个高度相关字段: ['sep__gprs_flow_short', 'max__gprs_flow_music', 'std__gprs_flow_commu', 'moreq25cnt__gprs_flow_music', 'min__gprs_now_defer', 'wave__gprs_last_defer', 'avg__gprs_resource', 'moreq25cnt__gprs_flow_commu', 'max__gprs_flow_roam', 'std__gprs_flow_video', 'avg__gprs_flow_commu', 'max__calling_diff_cnt', 'moreq25cnt__calling_dura', 'min__calling_dura', 'moreq25cnt__calling_diff_cnt', 'moreq25cnt__gprs_flow_short', 'arpu', 'gprs_last_defer', 'wave__gprs_flow_commu', 'avg__gprs_flow_music', 'more0cnt__calling_dura', 'avg__arpu', 'avg__gprs_flow_game', 'min__call_use', 'avg__calling_cnt', 'sex_add~女', 'grow__gprs_flow_5g', 'calling_diff_dura', 'avg__gprs_flow_short', 'wave__gprs_flow_video', 'gprs_flow_4g', 'avg__monthsremain_last_stop_date', 'moreq25cnt__calling_cnt', 'more0cnt__monthsremain_last_stop_date', 'avg__calling_diff_dura', 'gprs_now_rest', 'avg__call_use', 'moreq25cnt__gprs_flow_video', 'avg__gprs_now_rest', 'max__gprs_resource', 'avg__gprs_last_defer', 'std__gprs_flow_4g', 'min__nos_calling_diff', 'max__nos_calling_diff', 'sep__gprs_now_rest', 'min__calling_diff_cnt', 'min__gprs_flow_short', 'gprs_flow_short', 'moreq25cnt__nos_calling', 'grow__gprs_flow_video', 'nos_calling', 'avg__nos_calling_diff', 'min__calling_diff_dura', 'gprs_flow_game', 'min__gprs_flow_commu', 'grow__gprs_flow_music', 'nos_calling_diff', 'min__calling_cnt', 'calling_dura', 'gprs_flow_roam', 'wave__gprs_flow_short', 'wave__gprs_now_rest', 'moreq25cnt__nos_calling_diff', 'gprs_flow_video', 'std__call_dura_roam', 'min__gprs_flow_4g', 'gprs_flow_commu', 'avg__gprs_flow_video']
20220627-17:21:29      动因字段：77个

20220627-17:21:29      从原因中删除用户量过小的 字段-取值
20220627-17:21:29      阈值 valuecount_limit= 50
20220627-17:21:29      将7个字段的7个取值（用户量<=50）从原因中剔除（对应的woe置为-999）



D:\工作\模型脚本\ModelProject\selfmodule\binarymodule\predictscore.py:153: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead.  To get a de-fragmented frame, use `newframe = frame.copy()`
  data_colname[c] = c
20220627-17:21:29      原因排序 2022-06-27 17:21:29
20220627-17:21:29      top1 2022-06-27 17:21:29
20220627-17:21:29      top2 2022-06-27 17:21:29
20220627-17:21:29      top3 2022-06-27 17:21:29
20220627-17:21:30      排序结束 2022-06-27 17:21:30

20220627-17:21:30      将woe<=woe_thred（0)的原因置空
20220627-17:21:30      top1: colwoe_top1字段最小值0.288 > woe_thred（0）,无需处理
20220627-17:21:30      top2: colwoe_top2字段最小值0.115 > woe_thred（0）,无需处理
20220627-17:21:30      top3: 将6行woe<=woe_thred（0)的colname_top3, colcomment_top3, colvalue_top3, colwoe_top3置空


20220627-17:21:34  模型预测

20220627-17:21:38  匹配各分数档位查准率、提升度（非累计）

                   Out[165]: 20220627-17:21:46  
                      分数 人数_1 人数_0 人数 precision lift 累计人数_1 累计人数_0 累计人数 累计人数占比 累计查准率 累计查全率 累计提升度
                      90.0     15      7   22     68.2%  4.4         15          7       22         2.2%      68.2%       9.7%        4.4
                      70.0     29     18   47     61.7%  4.0         44         25       69         6.9%      63.8%      28.6%        4.1
                      60.0     19     31   50     38.0%  2.5         63         56      119        11.9%      52.9%      40.9%        3.4
                      41.0     22     61   83     26.5%  1.7         85        117      202        20.2%      42.1%      55.2%        2.7
                      40.0     24     97  121     19.8%  1.3        109        214      323        32.3%      33.7%      70.8%        2.2
                      30.0     21    152  173     12.1%  0.8        130        366      496        49.6%      26.2%      84.4%        1.7
                     25.43      0      5    5      0.0%  0.0        130        371      501        50.1%      25.9%      84.4%        1.7
                      20.0     15    171  186      8.1%  0.5        145        542      687        68.7%      21.1%      94.2%        1.4
                      10.0      6    187  193      3.1%  0.2        151        729      880        88.0%      17.2%      98.1%        1.1
                      10.0      0      0    0      nan%  NaN        151        729      880        88.0%      17.2%      98.1%        1.1
                       0.0      3    117  120      2.5%  0.2        154        846     1000       100.0%      15.4%     100.0%        1.0
                       0.0      0      0    0      nan%  NaN        154        846     1000       100.0%      15.4%     100.0%        1.0
                                                                                                                                         
                        90     15      7   22     68.2%  4.4         15          7       22         2.2%      68.2%       9.7%        4.4
                        80     19      6   25     76.0%  4.9         34         13       47         4.7%      72.3%      22.1%        4.7
                        70     10     12   22     45.5%  3.0         44         25       69         6.9%      63.8%      28.6%        4.1
                        60     19     31   50     38.0%  2.5         63         56      119        11.9%      52.9%      40.9%        3.4
                        50     22     57   79     27.8%  1.8         85        113      198        19.8%      42.9%      55.2%        2.8
                        40     24    101  125     19.2%  1.2        109        214      323        32.3%      33.7%      70.8%        2.2
                        30     21    152  173     12.1%  0.8        130        366      496        49.6%      26.2%      84.4%        1.7
                        20     15    176  191      7.9%  0.5        145        542      687        68.7%      21.1%      94.2%        1.4
                        10      6    187  193      3.1%  0.2        151        729      880        88.0%      17.2%      98.1%        1.1
                         0      3    117  120      2.5%  0.2        154        846     1000       100.0%      15.4%     100.0%        1.0
                   Out[166]: 20220627-17:22:06  'data_timeout'
                   Out[167]: 20220627-17:22:15  
                   {'data_train':    分数 人数_1 人数_0 人数  查准率 提升度 累计人数_1 累计人数_0 累计人数 累计人数占比 累计查准率 累计查全率 累计提升度
                      100.0    178      0  178  100.0%    3.0        178          0      178         5.9%     100.0%      17.8%        3.0
                      100.0      0      0    0    nan%    NaN        178          0      178         5.9%     100.0%      17.8%        3.0
                       90.0    253      0  253  100.0%    3.0        431          0      431        14.4%     100.0%      43.1%        3.0
                       80.0    248      0  248  100.0%    3.0        679          0      679        22.6%     100.0%      67.9%        3.0
                       60.0    255      7  262   97.3%    2.9        934          7      941        31.4%      99.3%      93.4%        3.0
                       30.0     63    208  271   23.2%    0.7        997        215     1212        40.4%      82.3%      99.7%        2.5
                       20.0      1    359  360    0.3%    0.0        998        574     1572        52.4%      63.5%      99.8%        1.9
                       10.0      2    623  625    0.3%    0.0       1000       1197     2197        73.2%      45.5%     100.0%        1.4
                       10.0      0      0    0    nan%    NaN       1000       1197     2197        73.2%      45.5%     100.0%        1.4
                        0.0      0    803  803    0.0%    0.0       1000       2000     3000       100.0%      33.3%     100.0%        1.0
                        0.0      0      0    0    nan%    NaN       1000       2000     3000       100.0%      33.3%     100.0%        1.0
                        0.0      0      0    0    nan%    NaN       1000       2000     3000       100.0%      33.3%     100.0%        1.0
                                                                                                                                          
                         90    431      0  431  100.0%    3.0        431          0      431        14.4%     100.0%      43.1%        3.0
                         80    248      0  248  100.0%    3.0        679          0      679        22.6%     100.0%      67.9%        3.0
                         70    158      0  158  100.0%    3.0        837          0      837        27.9%     100.0%      83.7%        3.0
                         60     97      7  104   93.3%    2.8        934          7      941        31.4%      99.3%      93.4%        3.0
                         50     38     15   53   71.7%    2.2        972         22      994        33.1%      97.8%      97.2%        2.9
                         40     22     44   66   33.3%    1.0        994         66     1060        35.3%      93.8%      99.4%        2.8
                         30      3    149  152    2.0%    0.1        997        215     1212        40.4%      82.3%      99.7%        2.5
                         20      1    359  360    0.3%    0.0        998        574     1572        52.4%      63.5%      99.8%        1.9
                         10      2    623  625    0.3%    0.0       1000       1197     2197        73.2%      45.5%     100.0%        1.4
                          0      0    803  803    0.0%    0.0       1000       2000     3000       100.0%      33.3%     100.0%        1.0,
                    'data_timein':    分数 人数_1 人数_0 人数 查准率 提升度 累计人数_1 累计人数_0 累计人数 累计人数占比 累计查准率 累计查全率 累计提升度
                       90.0     11      4   15  73.3%    4.8         11          4       15         3.0%      73.3%      14.3%        4.8
                       80.0      4     10   14  28.6%    1.9         15         14       29         5.8%      51.7%      19.5%        3.4
                      60.38      4     17   21  19.0%    1.2         19         31       50        10.0%      38.0%      24.7%        2.5
                       50.0     17     38   55  30.9%    2.0         36         69      105        21.0%      34.3%      46.8%        2.2
                       40.0     13     59   72  18.1%    1.2         49        128      177        35.4%      27.7%      63.6%        1.8
                       30.0      9     90   99   9.1%    0.6         58        218      276        55.2%      21.0%      75.3%        1.4
                       30.0      0      0    0   nan%    NaN         58        218      276        55.2%      21.0%      75.3%        1.4
                       20.0      7     78   85   8.2%    0.5         65        296      361        72.2%      18.0%      84.4%        1.2
                       20.0      0      0    0   nan%    NaN         65        296      361        72.2%      18.0%      84.4%        1.2
                       10.0      7     85   92   7.6%    0.5         72        381      453        90.6%      15.9%      93.5%        1.0
                       10.0      0      0    0   nan%    NaN         72        381      453        90.6%      15.9%      93.5%        1.0
                        0.0      5     42   47  10.6%    0.7         77        423      500       100.0%      15.4%     100.0%        1.0
                                                                                                                                         
                         90     11      4   15  73.3%    4.8         11          4       15         3.0%      73.3%      14.3%        4.8
                         80      4     10   14  28.6%    1.9         15         14       29         5.8%      51.7%      19.5%        3.4
                         70      4     16   20  20.0%    1.3         19         30       49         9.8%      38.8%      24.7%        2.5
                         60      5     15   20  25.0%    1.6         24         45       69        13.8%      34.8%      31.2%        2.3
                         50     12     24   36  33.3%    2.2         36         69      105        21.0%      34.3%      46.8%        2.2
                         40     13     59   72  18.1%    1.2         49        128      177        35.4%      27.7%      63.6%        1.8
                         30      9     90   99   9.1%    0.6         58        218      276        55.2%      21.0%      75.3%        1.4
                         20      7     78   85   8.2%    0.5         65        296      361        72.2%      18.0%      84.4%        1.2
                         10      7     85   92   7.6%    0.5         72        381      453        90.6%      15.9%      93.5%        1.0
                          0      5     42   47  10.6%    0.7         77        423      500       100.0%      15.4%     100.0%        1.0,
                    'data_timeout':    分数 人数_1 人数_0 人数 查准率 提升度 累计人数_1 累计人数_0 累计人数 累计人数占比 累计查准率 累计查全率 累计提升度
                       90.0     15      7   22  68.2%    4.4         15          7       22         2.2%      68.2%       9.7%        4.4
                       70.0     29     18   47  61.7%    4.0         44         25       69         6.9%      63.8%      28.6%        4.1
                       60.0     19     31   50  38.0%    2.5         63         56      119        11.9%      52.9%      40.9%        3.4
                       41.0     22     61   83  26.5%    1.7         85        117      202        20.2%      42.1%      55.2%        2.7
                       40.0     24     97  121  19.8%    1.3        109        214      323        32.3%      33.7%      70.8%        2.2
                       30.0     21    152  173  12.1%    0.8        130        366      496        49.6%      26.2%      84.4%        1.7
                      25.43      0      5    5   0.0%    0.0        130        371      501        50.1%      25.9%      84.4%        1.7
                       20.0     15    171  186   8.1%    0.5        145        542      687        68.7%      21.1%      94.2%        1.4
                       10.0      6    187  193   3.1%    0.2        151        729      880        88.0%      17.2%      98.1%        1.1
                       10.0      0      0    0   nan%    NaN        151        729      880        88.0%      17.2%      98.1%        1.1
                        0.0      3    117  120   2.5%    0.2        154        846     1000       100.0%      15.4%     100.0%        1.0
                        0.0      0      0    0   nan%    NaN        154        846     1000       100.0%      15.4%     100.0%        1.0
                                                                                                                                         
                         90     15      7   22  68.2%    4.4         15          7       22         2.2%      68.2%       9.7%        4.4
                         80     19      6   25  76.0%    4.9         34         13       47         4.7%      72.3%      22.1%        4.7
                         70     10     12   22  45.5%    3.0         44         25       69         6.9%      63.8%      28.6%        4.1
                         60     19     31   50  38.0%    2.5         63         56      119        11.9%      52.9%      40.9%        3.4
                         50     22     57   79  27.8%    1.8         85        113      198        19.8%      42.9%      55.2%        2.8
                         40     24    101  125  19.2%    1.2        109        214      323        32.3%      33.7%      70.8%        2.2
                         30     21    152  173  12.1%    0.8        130        366      496        49.6%      26.2%      84.4%        1.7
                         20     15    176  191   7.9%    0.5        145        542      687        68.7%      21.1%      94.2%        1.4
                         10      6    187  193   3.1%    0.2        151        729      880        88.0%      17.2%      98.1%        1.1
                          0      3    117  120   2.5%    0.2        154        846     1000       100.0%      15.4%     100.0%        1.0}
                   Out[168]: 20220627-17:25:25  'data_timeout'
                   Out[170]: 20220627-17:25:34  
                      分数 人数_1 人数_0 人数 precision lift 累计人数_1 累计人数_0 累计人数 累计人数占比 累计查准率 累计查全率 累计提升度
                      90.0     15      7   22     68.2%  4.4         15          7       22         2.2%      68.2%       9.7%        4.4
                      70.0     29     18   47     61.7%  4.0         44         25       69         6.9%      63.8%      28.6%        4.1
                      60.0     19     31   50     38.0%  2.5         63         56      119        11.9%      52.9%      40.9%        3.4
                      41.0     22     61   83     26.5%  1.7         85        117      202        20.2%      42.1%      55.2%        2.7
                      40.0     24     97  121     19.8%  1.3        109        214      323        32.3%      33.7%      70.8%        2.2
                      30.0     21    152  173     12.1%  0.8        130        366      496        49.6%      26.2%      84.4%        1.7
                     25.43      0      5    5      0.0%  0.0        130        371      501        50.1%      25.9%      84.4%        1.7
                      20.0     15    171  186      8.1%  0.5        145        542      687        68.7%      21.1%      94.2%        1.4
                      10.0      6    187  193      3.1%  0.2        151        729      880        88.0%      17.2%      98.1%        1.1
                      10.0      0      0    0      nan%  NaN        151        729      880        88.0%      17.2%      98.1%        1.1
                       0.0      3    117  120      2.5%  0.2        154        846     1000       100.0%      15.4%     100.0%        1.0
                       0.0      0      0    0      nan%  NaN        154        846     1000       100.0%      15.4%     100.0%        1.0
                                                                                                                                         
                        90     15      7   22     68.2%  4.4         15          7       22         2.2%      68.2%       9.7%        4.4
                        80     19      6   25     76.0%  4.9         34         13       47         4.7%      72.3%      22.1%        4.7
                        70     10     12   22     45.5%  3.0         44         25       69         6.9%      63.8%      28.6%        4.1
                        60     19     31   50     38.0%  2.5         63         56      119        11.9%      52.9%      40.9%        3.4
                        50     22     57   79     27.8%  1.8         85        113      198        19.8%      42.9%      55.2%        2.8
                        40     24    101  125     19.2%  1.2        109        214      323        32.3%      33.7%      70.8%        2.2
                        30     21    152  173     12.1%  0.8        130        366      496        49.6%      26.2%      84.4%        1.7
                        20     15    176  191      7.9%  0.5        145        542      687        68.7%      21.1%      94.2%        1.4
                        10      6    187  193      3.1%  0.2        151        729      880        88.0%      17.2%      98.1%        1.1
                         0      3    117  120      2.5%  0.2        154        846     1000       100.0%      15.4%     100.0%        1.0
                   Out[171]: 20220627-17:26:11  
                      分数 人数_1 人数_0 人数 precision lift 累计人数_1 累计人数_0 累计人数 累计人数占比 累计查准率 累计查全率 累计提升度
                      90.0     15      7   22     68.2%  4.4         15          7       22         2.2%      68.2%       9.7%        4.4
                      70.0     29     18   47     61.7%  4.0         44         25       69         6.9%      63.8%      28.6%        4.1
                      60.0     19     31   50     38.0%  2.5         63         56      119        11.9%      52.9%      40.9%        3.4
                      41.0     22     61   83     26.5%  1.7         85        117      202        20.2%      42.1%      55.2%        2.7
                      40.0     24     97  121     19.8%  1.3        109        214      323        32.3%      33.7%      70.8%        2.2
                      30.0     21    152  173     12.1%  0.8        130        366      496        49.6%      26.2%      84.4%        1.7
                     25.43      0      5    5      0.0%  0.0        130        371      501        50.1%      25.9%      84.4%        1.7
                      20.0     15    171  186      8.1%  0.5        145        542      687        68.7%      21.1%      94.2%        1.4
                      10.0      6    187  193      3.1%  0.2        151        729      880        88.0%      17.2%      98.1%        1.1
                      10.0      0      0    0      nan%  NaN        151        729      880        88.0%      17.2%      98.1%        1.1
                       0.0      3    117  120      2.5%  0.2        154        846     1000       100.0%      15.4%     100.0%        1.0
                       0.0      0      0    0      nan%  NaN        154        846     1000       100.0%      15.4%     100.0%        1.0
                   Out[173]: 20220627-17:34:32  
                      分数 人数_1 人数_0 人数 precision lift 累计人数_1 累计人数_0 累计人数 累计人数占比 累计查准率 累计查全率 累计提升度
                      90.0     15      7   22     68.2%  4.4         15          7       22         2.2%      68.2%       9.7%        4.4
                      70.0     29     18   47     61.7%  4.0         44         25       69         6.9%      63.8%      28.6%        4.1
                      60.0     19     31   50     38.0%  2.5         63         56      119        11.9%      52.9%      40.9%        3.4
                      41.0     22     61   83     26.5%  1.7         85        117      202        20.2%      42.1%      55.2%        2.7
                      40.0     24     97  121     19.8%  1.3        109        214      323        32.3%      33.7%      70.8%        2.2
                      30.0     21    152  173     12.1%  0.8        130        366      496        49.6%      26.2%      84.4%        1.7
                     25.43      0      5    5      0.0%  0.0        130        371      501        50.1%      25.9%      84.4%        1.7
                      20.0     15    171  186      8.1%  0.5        145        542      687        68.7%      21.1%      94.2%        1.4
                      10.0      6    187  193      3.1%  0.2        151        729      880        88.0%      17.2%      98.1%        1.1
                      10.0      0      0    0      nan%  NaN        151        729      880        88.0%      17.2%      98.1%        1.1
                       0.0      3    117  120      2.5%  0.2        154        846     1000       100.0%      15.4%     100.0%        1.0
                       0.0      0      0    0      nan%  NaN        154        846     1000       100.0%      15.4%     100.0%        1.0
                                                                                                                                         
                        90     15      7   22     68.2%  4.4         15          7       22         2.2%      68.2%       9.7%        4.4
                        80     19      6   25     76.0%  4.9         34         13       47         4.7%      72.3%      22.1%        4.7
                        70     10     12   22     45.5%  3.0         44         25       69         6.9%      63.8%      28.6%        4.1
                        60     19     31   50     38.0%  2.5         63         56      119        11.9%      52.9%      40.9%        3.4
                        50     22     57   79     27.8%  1.8         85        113      198        19.8%      42.9%      55.2%        2.8
                        40     24    101  125     19.2%  1.2        109        214      323        32.3%      33.7%      70.8%        2.2
                        30     21    152  173     12.1%  0.8        130        366      496        49.6%      26.2%      84.4%        1.7
                        20     15    176  191      7.9%  0.5        145        542      687        68.7%      21.1%      94.2%        1.4
                        10      6    187  193      3.1%  0.2        151        729      880        88.0%      17.2%      98.1%        1.1
                         0      3    117  120      2.5%  0.2        154        846     1000       100.0%      15.4%     100.0%        1.0
                   Out[175]: 20220627-17:34:48  
                      分数 人数_1 人数_0 人数 precision lift 累计人数_1 累计人数_0 累计人数 累计人数占比 累计查准率 累计查全率 累计提升度
                      90.0     15      7   22     68.2%  4.4         15          7       22         2.2%      68.2%       9.7%        4.4
                      70.0     29     18   47     61.7%  4.0         44         25       69         6.9%      63.8%      28.6%        4.1
                      60.0     19     31   50     38.0%  2.5         63         56      119        11.9%      52.9%      40.9%        3.4
                      41.0     22     61   83     26.5%  1.7         85        117      202        20.2%      42.1%      55.2%        2.7
                      40.0     24     97  121     19.8%  1.3        109        214      323        32.3%      33.7%      70.8%        2.2
                      30.0     21    152  173     12.1%  0.8        130        366      496        49.6%      26.2%      84.4%        1.7
                     25.43      0      5    5      0.0%  0.0        130        371      501        50.1%      25.9%      84.4%        1.7
                      20.0     15    171  186      8.1%  0.5        145        542      687        68.7%      21.1%      94.2%        1.4
                      10.0      6    187  193      3.1%  0.2        151        729      880        88.0%      17.2%      98.1%        1.1
                      10.0      0      0    0      nan%  NaN        151        729      880        88.0%      17.2%      98.1%        1.1
                       0.0      3    117  120      2.5%  0.2        154        846     1000       100.0%      15.4%     100.0%        1.0
                       0.0      0      0    0      nan%  NaN        154        846     1000       100.0%      15.4%     100.0%        1.0
                   Out[177]: 20220627-17:35:30  
                   Empty DataFrame
                   Columns: [分数, 人数_1, 人数_0, 人数, precision, lift, 累计人数_1, 累计人数_0, 累计人数, 累计人数占比, 累计查准率, 累计查全率, 累计提升度]
                   Index: []
                   Out[180]: 20220627-17:35:35  
                      分数 人数_1 人数_0 人数 precision lift 累计人数_1 累计人数_0 累计人数 累计人数占比 累计查准率 累计查全率 累计提升度
                      90.0     15      7   22     68.2%  4.4         15          7       22         2.2%      68.2%       9.7%        4.4
                      70.0     29     18   47     61.7%  4.0         44         25       69         6.9%      63.8%      28.6%        4.1
                      60.0     19     31   50     38.0%  2.5         63         56      119        11.9%      52.9%      40.9%        3.4
                      41.0     22     61   83     26.5%  1.7         85        117      202        20.2%      42.1%      55.2%        2.7
                      40.0     24     97  121     19.8%  1.3        109        214      323        32.3%      33.7%      70.8%        2.2
                      30.0     21    152  173     12.1%  0.8        130        366      496        49.6%      26.2%      84.4%        1.7
                     25.43      0      5    5      0.0%  0.0        130        371      501        50.1%      25.9%      84.4%        1.7
                      20.0     15    171  186      8.1%  0.5        145        542      687        68.7%      21.1%      94.2%        1.4
                      10.0      6    187  193      3.1%  0.2        151        729      880        88.0%      17.2%      98.1%        1.1
                      10.0      0      0    0      nan%  NaN        151        729      880        88.0%      17.2%      98.1%        1.1
                       0.0      3    117  120      2.5%  0.2        154        846     1000       100.0%      15.4%     100.0%        1.0
                       0.0      0      0    0      nan%  NaN        154        846     1000       100.0%      15.4%     100.0%        1.0
                   Out[184]: 20220627-17:44:15  
                      分数 人数_1 人数_0 人数 precision lift 累计人数_1 累计人数_0 累计人数 累计人数占比 累计查准率 累计查全率 累计提升度
                      90.0     15      7   22     68.2%  4.4         15          7       22         2.2%      68.2%       9.7%        4.4
                      70.0     29     18   47     61.7%  4.0         44         25       69         6.9%      63.8%      28.6%        4.1
                      60.0     19     31   50     38.0%  2.5         63         56      119        11.9%      52.9%      40.9%        3.4
                      41.0     22     61   83     26.5%  1.7         85        117      202        20.2%      42.1%      55.2%        2.7
                      40.0     24     97  121     19.8%  1.3        109        214      323        32.3%      33.7%      70.8%        2.2
                      30.0     21    152  173     12.1%  0.8        130        366      496        49.6%      26.2%      84.4%        1.7
                     25.43      0      5    5      0.0%  0.0        130        371      501        50.1%      25.9%      84.4%        1.7
                      20.0     15    171  186      8.1%  0.5        145        542      687        68.7%      21.1%      94.2%        1.4
                      10.0      6    187  193      3.1%  0.2        151        729      880        88.0%      17.2%      98.1%        1.1
                      10.0      0      0    0      nan%  NaN        151        729      880        88.0%      17.2%      98.1%        1.1
                       0.0      3    117  120      2.5%  0.2        154        846     1000       100.0%      15.4%     100.0%        1.0
                       0.0      0      0    0      nan%  NaN        154        846     1000       100.0%      15.4%     100.0%        1.0
                                                                                                                                         
                        90     15      7   22     68.2%  4.4         15          7       22         2.2%      68.2%       9.7%        4.4
                        80     19      6   25     76.0%  4.9         34         13       47         4.7%      72.3%      22.1%        4.7
                        70     10     12   22     45.5%  3.0         44         25       69         6.9%      63.8%      28.6%        4.1
                        60     19     31   50     38.0%  2.5         63         56      119        11.9%      52.9%      40.9%        3.4
                        50     22     57   79     27.8%  1.8         85        113      198        19.8%      42.9%      55.2%        2.8
                        40     24    101  125     19.2%  1.2        109        214      323        32.3%      33.7%      70.8%        2.2
                        30     21    152  173     12.1%  0.8        130        366      496        49.6%      26.2%      84.4%        1.7
                        20     15    176  191      7.9%  0.5        145        542      687        68.7%      21.1%      94.2%        1.4
                        10      6    187  193      3.1%  0.2        151        729      880        88.0%      17.2%      98.1%        1.1
                         0      3    117  120      2.5%  0.2        154        846     1000       100.0%      15.4%     100.0%        1.0
                   Out[186]: 20220627-17:45:37  RangeIndex(start=0, stop=23, step=1)
                   Out[189]: 20220627-17:45:43  
                      分数 人数_1 人数_0 人数 precision lift 累计人数_1 累计人数_0 累计人数 累计人数占比 累计查准率 累计查全率 累计提升度
                      90.0     15      7   22     68.2%  4.4         15          7       22         2.2%      68.2%       9.7%        4.4
                      70.0     29     18   47     61.7%  4.0         44         25       69         6.9%      63.8%      28.6%        4.1
                      60.0     19     31   50     38.0%  2.5         63         56      119        11.9%      52.9%      40.9%        3.4
                      41.0     22     61   83     26.5%  1.7         85        117      202        20.2%      42.1%      55.2%        2.7
                      40.0     24     97  121     19.8%  1.3        109        214      323        32.3%      33.7%      70.8%        2.2
                      30.0     21    152  173     12.1%  0.8        130        366      496        49.6%      26.2%      84.4%        1.7
                     25.43      0      5    5      0.0%  0.0        130        371      501        50.1%      25.9%      84.4%        1.7
                      20.0     15    171  186      8.1%  0.5        145        542      687        68.7%      21.1%      94.2%        1.4
                      10.0      6    187  193      3.1%  0.2        151        729      880        88.0%      17.2%      98.1%        1.1
                      10.0      0      0    0      nan%  NaN        151        729      880        88.0%      17.2%      98.1%        1.1
                       0.0      3    117  120      2.5%  0.2        154        846     1000       100.0%      15.4%     100.0%        1.0
                       0.0      0      0    0      nan%  NaN        154        846     1000       100.0%      15.4%     100.0%        1.0
                   Out[191]: 20220627-17:45:47  
                        分数 人数_1 人数_0 人数 precision lift 累计人数_1 累计人数_0 累计人数 累计人数占比 累计查准率 累计查全率 累计提升度
                   0    90.0     15      7   22     68.2%  4.4         15          7       22         2.2%      68.2%       9.7%        4.4
                   1    70.0     29     18   47     61.7%  4.0         44         25       69         6.9%      63.8%      28.6%        4.1
                   2    60.0     19     31   50     38.0%  2.5         63         56      119        11.9%      52.9%      40.9%        3.4
                   3    41.0     22     61   83     26.5%  1.7         85        117      202        20.2%      42.1%      55.2%        2.7
                   4    40.0     24     97  121     19.8%  1.3        109        214      323        32.3%      33.7%      70.8%        2.2
                   5    30.0     21    152  173     12.1%  0.8        130        366      496        49.6%      26.2%      84.4%        1.7
                   6   25.43      0      5    5      0.0%  0.0        130        371      501        50.1%      25.9%      84.4%        1.7
                   7    20.0     15    171  186      8.1%  0.5        145        542      687        68.7%      21.1%      94.2%        1.4
                   8    10.0      6    187  193      3.1%  0.2        151        729      880        88.0%      17.2%      98.1%        1.1
                   9    10.0      0      0    0      nan%  NaN        151        729      880        88.0%      17.2%      98.1%        1.1
                   10    0.0      3    117  120      2.5%  0.2        154        846     1000       100.0%      15.4%     100.0%        1.0
                   11    0.0      0      0    0      nan%  NaN        154        846     1000       100.0%      15.4%     100.0%        1.0
                   Out[193]: 20220627-17:45:59  
                        分数 人数_1 人数_0 人数  precision lift 累计人数_1 累计人数_0 累计人数 累计人数占比 累计查准率 累计查全率 累计提升度
                   0    90.0     15      7   22      0.682  4.4         15          7       22         2.2%      68.2%       9.7%        4.4
                   1    70.0     29     18   47      0.617  4.0         44         25       69         6.9%      63.8%      28.6%        4.1
                   2    60.0     19     31   50      0.380  2.5         63         56      119        11.9%      52.9%      40.9%        3.4
                   3    41.0     22     61   83      0.265  1.7         85        117      202        20.2%      42.1%      55.2%        2.7
                   4    40.0     24     97  121      0.198  1.3        109        214      323        32.3%      33.7%      70.8%        2.2
                   5    30.0     21    152  173      0.121  0.8        130        366      496        49.6%      26.2%      84.4%        1.7
                   6   25.43      0      5    5      0.000  0.0        130        371      501        50.1%      25.9%      84.4%        1.7
                   7    20.0     15    171  186      0.081  0.5        145        542      687        68.7%      21.1%      94.2%        1.4
                   8    10.0      6    187  193      0.031  0.2        151        729      880        88.0%      17.2%      98.1%        1.1
                   9    10.0      0      0    0        NaN  NaN        151        729      880        88.0%      17.2%      98.1%        1.1
                   10    0.0      3    117  120      0.025  0.2        154        846     1000       100.0%      15.4%     100.0%        1.0
                   11    0.0      0      0    0        NaN  NaN        154        846     1000       100.0%      15.4%     100.0%        1.0
                   Out[195]: 20220627-17:46:40  
                   0      -inf
                   1      0.00
                   2     10.00
                   3     10.00
                   4     20.00
                   5     25.43
                   6     30.00
                   7     40.00
                   8     41.00
                   9     60.00
                   10    70.00
                   11    90.00
                   12      inf
                   dtype: float64
                   Out[200]: 20220627-17:47:14  
                   0       5
                   1       5
                   2       7
                   3       3
                   4       1
                          ..
                   3305    9
                   3306    7
                   3307    7
                   3308    5
                   3309    5
                   Name: score_cut, Length: 3310, dtype: int32
                   Out[202]: 20220627-17:47:20  
                         acct_month      user_id      account_id  innet_months  monthsremain_last_stop_date  gprs_last_defer  gprs_now_rest  call_use    arpu  calling_cnt  calling_dura  \
                   0         202012  10000211351        38192486         133.0                         -2.0              0.0     20971506.0       3.0   48.00          2.0           3.0   
                   1         202012  10005096232        48514984         184.0                        -12.0          30720.0     62678241.0      48.0   98.10         34.0          59.0   
                   10        202012  10022443581        34631073         142.0                        -30.0             40.0        81920.0       0.0   26.50          0.0           0.0   
                   15        202012  10030281412        30334795         158.0                        -85.0             10.0     10505833.0      30.0    8.45          7.0          31.0   
                   18        202012  10043604731        66157037         140.0                        -32.0             30.0            0.0     146.0  112.00         67.0         151.0   
                   ...          ...          ...             ...           ...                          ...              ...            ...       ...     ...          ...           ...   
                   3255      202012  82548811190  30100000000000          31.0                         -3.0              0.0     14003236.0       0.0  140.00          0.0           0.0   
                   3281      202012  82982964601  30100000000000          14.0                         -3.0              0.0     16807984.0       0.0   29.76          4.0           4.0   
                   517       202012  14808438831         5705095         217.0                        -67.0             40.0        81930.0       1.0   10.00          1.0           1.0   
                   548       202012  15103368321       103872022         117.0                        -36.0             10.0     10506241.0       0.0    8.00          0.0           0.0   
                   567       202012  15309188901        51325182         215.0                        -98.0             10.0     10506250.0       0.0    8.00          0.0           0.0   
                   
                         calling_diff_dura  gprs_flow_4g  gprs_flow_5g  gprs_flow_roam  ...  grow__call_use  grow__nos_calling  grow__nos_calling_diff  user_status  min__gprs_flow_5g  \
                   0                   0.0       16651.0          0.00          8748.0  ...             NaN                NaN                     NaN          NaN                NaN   
                   1                  41.0     3441156.0          0.00             0.0  ...             NaN                NaN                     NaN          NaN                NaN   
                   10                  0.0       87110.0          0.05             0.0  ...             NaN                NaN                     NaN          NaN                NaN   
                   15                 31.0       38406.0          0.00             0.0  ...             NaN                NaN                     NaN          NaN                NaN   
                   18                101.0      619496.0          0.00         14011.0  ...             NaN                NaN                     NaN          NaN                NaN   
                   ...                 ...           ...           ...             ...  ...             ...                ...                     ...          ...                ...   
                   3255                0.0    17451640.0          0.00      17452050.0  ...             NaN                NaN                     NaN          NaN                NaN   
                   3281                4.0    19834058.0          0.00             0.0  ...             NaN                NaN                     NaN          NaN                NaN   
                   517                 0.0           0.0          0.00             0.0  ...             NaN                NaN                     NaN          NaN                NaN   
                   548                 0.0        6903.0          0.00          1805.0  ...             NaN                NaN                     NaN          NaN                NaN   
                   567                 0.0         930.0          0.00             0.0  ...             NaN                NaN                     NaN          NaN                NaN   
                   
                         gprs_flow_music  min__gprs_flow_game  grow__dinner_fee  days_call_p_4 grow__calling_diff_dura   score  model_name  score_cut  precision  lift  
                   0                 NaN                  NaN               NaN            NaN                     NaN  30.000    模型示例          5      0.121   0.8  
                   1                 NaN                  NaN               NaN            NaN                     NaN  30.000    模型示例          5      0.121   0.8  
                   10                NaN                  NaN               NaN            NaN                     NaN  30.000    模型示例          5      0.121   0.8  
                   15                NaN                  NaN               NaN            NaN                     NaN  30.000    模型示例          5      0.121   0.8  
                   18                NaN                  NaN               NaN            NaN                     NaN  30.000    模型示例          5      0.121   0.8  
                   ...               ...                  ...               ...            ...                     ...     ...         ...        ...        ...   ...  
                   3255              NaN                  NaN               NaN            NaN                     NaN  60.000    模型示例          2      0.380   2.5  
                   3281              NaN                  NaN               NaN            NaN                     NaN  60.000    模型示例          2      0.380   2.5  
                   517               NaN                  NaN               NaN            NaN                     NaN  28.333    模型示例          6      0.000   0.0  
                   548               NaN                  NaN               NaN            NaN                     NaN  28.000    模型示例          6      0.000   0.0  
                   567               NaN                  NaN               NaN            NaN                     NaN  26.667    模型示例          6      0.000   0.0  
                   
                   [3310 rows x 167 columns]


Traceback (most recent call last):
  File "D:\Python for Windows\lib\site-packages\IPython\core\interactiveshell.py", line 3296, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-206-0292068e13f5>", line 7, in <module>
    raise Exception(s)
Exception: 存在缺失值：{'precision': 559, 'lift': 559}


Traceback (most recent call last):
  File "D:\Python for Windows\lib\site-packages\IPython\core\interactiveshell.py", line 3296, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-207-39274240e77d>", line 1, in <module>
    data_predict[data_predict.precision.isnull(), ['score', 'precision']]
  File "D:\Python for Windows\lib\site-packages\pandas\core\frame.py", line 3458, in __getitem__
    indexer = self.columns.get_loc(key)
  File "D:\Python for Windows\lib\site-packages\pandas\core\indexes\base.py", line 3361, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas\_libs\index.pyx", line 76, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 82, in pandas._libs.index.IndexEngine.get_loc
TypeError: '(0       False
1       False
10      False
15      False
18      False
        ...  
3255    False
3281    False
517     False
548     False
567     False
Name: precision, Length: 3310, dtype: bool, ['score', 'precision'])' is an invalid key
                   Out[208]: 20220627-17:48:50  
                         score  precision
                   9      10.0        NaN
                   17     10.0        NaN
                   23     10.0        NaN
                   32     10.0        NaN
                   41     10.0        NaN
                   ...     ...        ...
                   3292   10.0        NaN
                   3301   10.0        NaN
                   3302   10.0        NaN
                   3304   10.0        NaN
                   3305   10.0        NaN
                   
                   [559 rows x 2 columns]
                   Out[209]: 20220627-17:49:26  array([10.])
                   Out[210]: 20220627-17:49:38  
                   0      -inf
                   1      0.00
                   2     10.00
                   3     10.00
                   4     20.00
                   5     25.43
                   6     30.00
                   7     40.00
                   8     41.00
                   9     60.00
                   10    70.00
                   11    90.00
                   12      inf
                   dtype: float64
                   Out[213]: 20220627-17:49:54  
                   0      -inf
                   1      0.00
                   2     10.00
                   3     10.00
                   4     20.00
                   5     25.43
                   6     30.00
                   7     40.00
                   8     41.00
                   9     60.00
                   10    70.00
                   11    90.00
                   12      inf
                   dtype: float64
                   Out[218]: 20220627-17:51:02  
                   0      -inf
                   1      0.00
                   2     10.00
                   3     10.00
                   4     20.00
                   5     25.43
                   6     30.00
                   7     40.00
                   8     41.00
                   9     60.00
                   10    70.00
                   11    90.00
                   12      inf
                   dtype: float64
                   Out[220]: 20220627-17:51:18  
                   0      -inf
                   1      0.00
                   2     10.00
                   3     10.00
                   4     20.00
                   5     25.43
                   6     30.00
                   7     40.00
                   8     41.00
                   9     60.00
                   10    70.00
                   11    90.00
                   12      inf
                   dtype: float64
                   Out[221]: 20220627-17:51:37  
                   0      -inf
                   1      0.00
                   2     10.00
                   3     10.00
                   4     20.00
                   5     25.43
                   6     30.00
                   7     40.00
                   8     41.00
                   9     60.00
                   10    70.00
                   11    90.00
                   12      inf
                   dtype: float64


Traceback (most recent call last):
  File "D:\Python for Windows\lib\site-packages\IPython\core\interactiveshell.py", line 3296, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)


Traceback (most recent call last):
  File "D:\Python for Windows\lib\site-packages\IPython\core\interactiveshell.py", line 3296, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)


Traceback (most recent call last):
  File "D:\Python for Windows\lib\site-packages\IPython\core\interactiveshell.py", line 3296, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)


Traceback (most recent call last):
  File "D:\Python for Windows\lib\site-packages\IPython\core\interactiveshell.py", line 3296, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)


Traceback (most recent call last):
  File "D:\Python for Windows\lib\site-packages\IPython\core\interactiveshell.py", line 3296, in run_code
                       20220627-17:51:51  exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-222-565cd3a19b0a>", line 1, in <module>
  File "D:\Python for Windows\lib\site-packages\pandas\core\generic.py", line 5487, in __getattr__
                       20220627-17:51:51  return object.__getattribute__(self, name)
AttributeError                   : 
20220627-17:51:51  
                   During handling of the above exception, another exception occurred:


Traceback (most recent call last):
  File "D:\Python for Windows\lib\site-packages\IPython\core\interactiveshell.py", line 3220, in run_ast_nodes
                       20220627-17:51:51  if (yield from self.run_code(code, result)):
  File "D:\Python for Windows\lib\site-packages\IPython\core\interactiveshell.py", line 3313, in run_code
                       20220627-17:51:51  self.showtraceback(running_compiled_code=True)
  File "D:\Program Files\PyCharm 2021.2.2\plugins\python\helpers\pydev\_pydev_bundle\pydev_ipython_console_011.py", line 188, in showtraceback
                       20220627-17:51:51  traceback.print_exception(etype, value, tb)
  File "D:\Python for Windows\lib\traceback.py", line 105, in print_exception
                       20220627-17:51:51  print(line, file=file, end="")
  File "D:\工作\模型脚本\ModelProject\selfmodule\toolmodule\privy_outredirect.py", line 88, in write
                       20220627-17:51:51  self.terminalerr.write(m)
  File "D:\工作\模型脚本\ModelProject\selfmodule\toolmodule\privy_outredirect.py", line 101, in write
                       20220627-17:51:51  self.log.write(m)
UnicodeEncodeError                   : 20220627-17:51:51  'gbk' codec can't encode character '\xe7' in position 75: illegal multibyte sequence
20220627-17:51:51  
                   During handling of the above exception, another exception occurred:


Traceback (most recent call last):
  File "D:\Python for Windows\lib\site-packages\IPython\core\interactiveshell.py", line 2874, in _run_cell
                       20220627-17:51:51  return runner(coro)
  File "D:\Python for Windows\lib\site-packages\IPython\core\async_helpers.py", line 67, in _pseudo_sync_runner
                       20220627-17:51:51  coro.send(None)
  File "D:\Python for Windows\lib\site-packages\IPython\core\interactiveshell.py", line 3049, in run_cell_async
                       20220627-17:51:51  interactivity=interactivity, compiler=compiler, result=result)
  File "D:\Python for Windows\lib\site-packages\IPython\core\interactiveshell.py", line 3239, in run_ast_nodes
                       20220627-17:51:51  self.showtraceback()
  File "D:\Program Files\PyCharm 2021.2.2\plugins\python\helpers\pydev\_pydev_bundle\pydev_ipython_console_011.py", line 188, in showtraceback
                       20220627-17:51:51  traceback.print_exception(etype, value, tb)
  File "D:\Python for Windows\lib\traceback.py", line 105, in print_exception
                       20220627-17:51:51  print(line, file=file, end="")
  File "D:\工作\模型脚本\ModelProject\selfmodule\toolmodule\privy_outredirect.py", line 88, in write
                       20220627-17:51:51  self.terminalerr.write(m)
  File "D:\工作\模型脚本\ModelProject\selfmodule\toolmodule\privy_outredirect.py", line 101, in write
                       20220627-17:51:51  self.log.write(m)
UnicodeEncodeError                   : 20220627-17:51:51  'gbk' codec can't encode character '\xe7' in position 75: illegal multibyte sequence
20220627-17:51:51  
                   During handling of the above exception, another exception occurred:


Traceback (most recent call last):
  File "D:\Program Files\PyCharm 2021.2.2\plugins\python\helpers\pydev\_pydev_bundle\pydev_code_executor.py", line 108, in add_exec
                       20220627-17:51:51  more = self.do_add_exec(code_fragment)
  File "D:\Program Files\PyCharm 2021.2.2\plugins\python\helpers\pydev\_pydev_bundle\pydev_ipython_console.py", line 36, in do_add_exec
                       20220627-17:51:51  res = bool(self.interpreter.add_exec(code_fragment.text))
  File "D:\Program Files\PyCharm 2021.2.2\plugins\python\helpers\pydev\_pydev_bundle\pydev_ipython_console_011.py", line 482, in add_exec
                       20220627-17:51:51  self.ipython.run_cell(line, store_history=True)
  File "D:\Python for Windows\lib\site-packages\IPython\core\interactiveshell.py", line 2848, in run_cell
                       20220627-17:51:51  raw_cell, store_history, silent, shell_futures)
  File "D:\Python for Windows\lib\site-packages\IPython\core\interactiveshell.py", line 2879, in _run_cell
                       20220627-17:51:51  self.showtraceback(running_compiled_code=True)
  File "D:\Program Files\PyCharm 2021.2.2\plugins\python\helpers\pydev\_pydev_bundle\pydev_ipython_console_011.py", line 188, in showtraceback
                       20220627-17:51:51  traceback.print_exception(etype, value, tb)
  File "D:\Python for Windows\lib\traceback.py", line 105, in print_exception
                       20220627-17:51:51  print(line, file=file, end="")
  File "D:\工作\模型脚本\ModelProject\selfmodule\toolmodule\privy_outredirect.py", line 88, in write
                       20220627-17:51:51  self.terminalerr.write(m)
  File "D:\工作\模型脚本\ModelProject\selfmodule\toolmodule\privy_outredirect.py", line 101, in write
                       20220627-17:51:51  self.log.write(m)
UnicodeEncodeError                   : 20220627-17:51:51  'gbk' codec can't encode character '\xe7' in position 75: illegal multibyte sequence
20220627-17:51:51  
                   During handling of the above exception, another exception occurred:


Traceback (most recent call last):
  File "D:\Program Files\PyCharm 2021.2.2\plugins\python\helpers\pydev\pydevconsole.py", line 258, in process_exec_queue
                       20220627-17:51:51  interpreter.add_exec(code_fragment)
  File "D:\Program Files\PyCharm 2021.2.2\plugins\python\helpers\pydev\_pydev_bundle\pydev_code_executor.py", line 130, in add_exec
                       20220627-17:51:51  traceback.print_exc()
  File "D:\Python for Windows\lib\traceback.py", line 163, in print_exc
                       20220627-17:51:51  print_exception(*sys.exc_info(), limit=limit, file=file, chain=chain)
  File "D:\Python for Windows\lib\traceback.py", line 105, in print_exception
                       20220627-17:51:51  print(line, file=file, end="")
  File "D:\工作\模型脚本\ModelProject\selfmodule\toolmodule\privy_outredirect.py", line 88, in write
                       20220627-17:51:51  self.terminalerr.write(m)
  File "D:\工作\模型脚本\ModelProject\selfmodule\toolmodule\privy_outredirect.py", line 101, in write
                       20220627-17:51:51  self.log.write(m)
UnicodeEncodeError                   : 20220627-17:51:51  'gbk' codec can't encode character '\xe7' in position 75: illegal multibyte sequence
20220627-17:51:51  
                   During handling of the above exception, another exception occurred:


Traceback (most recent call last):
  File "D:\Program Files\PyCharm 2021.2.2\plugins\python\helpers\pydev\pydevconsole.py", line 483, in <module>
                       20220627-17:51:51  pydevconsole.start_client(host, port)
  File "D:\Program Files\PyCharm 2021.2.2\plugins\python\helpers\pydev\pydevconsole.py", line 411, in start_client
                       20220627-17:51:51  process_exec_queue(interpreter)
  File "D:\Program Files\PyCharm 2021.2.2\plugins\python\helpers\pydev\pydevconsole.py", line 266, in process_exec_queue
                       20220627-17:51:51  traceback.print_exception(type, value, tb, file=sys.__stderr__)
UnboundLocalError                   : 20220627-17:51:51  local variable 'traceback' referenced before assignment